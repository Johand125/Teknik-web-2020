var __extends=this&&this.__extends||function(f,e){function k(){this.constructor=f}for(var d in e)e.hasOwnProperty(d)&&(f[d]=e[d]);f.prototype=null===e?Object.create(e):(k.prototype=e.prototype,new k)},ItslearningWeb;
(function(f){(function(e){var f=function(){return function(d){this.context=d;this.selectedItemsCount=function(){var b=$("td [id^='"+e.courseManagerInstance.context.Controls.SelectedItemsClientId+"']:not([id='"+e.courseManagerInstance.context.Controls.SelectAllItemsCheckboxClientId+"'])");if(!b||0===b.length)return 0;if(e.courseManagerInstance.context.Controls.PerformAllCheckbox.is(":checked"))return e.courseManagerInstance.context.Settings.CoursesVirtualCount;var a=0,c=0;for(b=b.get();c<b.length;c++)b[c].checked&&
a++;return a};this.hideArchiveFilter=function(b){var a=$("."+e.courseManagerInstance.context.Settings.ArchiveDateCssClass).parent();$("#"+e.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").first().attr("id")===b.target.id?a.hide():a.show()};this.clickOnAction=function(b){if($(b.currentTarget).parent().hasClass(e.courseManagerInstance.context.Settings.ToolbarItemDisabledCssClass))return!1;var a=e.courseManagerInstance.selectedItemsCount();return 0!==a&&confirm(CCL.CommonFunctions.formatString(b.data.text,
a))};this.context=d;e.courseManagerInstance=this;$("#"+e.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").first().is(":checked")&&$("."+e.courseManagerInstance.context.Settings.ArchiveDateCssClass).parent().hide();$("#"+e.courseManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").click(this.hideArchiveFilter);e.courseManagerInstance.context.Controls.DeleteAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.DeleteConfirmText},
this.clickOnAction);e.courseManagerInstance.context.Controls.ArchiveAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.ArchiveConfirmText},this.clickOnAction);e.courseManagerInstance.context.Controls.UnarchiveAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.UnarchiveConfirmText},this.clickOnAction);if(e.courseManagerInstance.context.Controls.EnrolAction.length)e.courseManagerInstance.context.Controls.EnrolAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.EnrolConfirmText},
this.clickOnAction);if(e.courseManagerInstance.context.Controls.WithdrawAction.length)e.courseManagerInstance.context.Controls.WithdrawAction.on("click",null,{text:e.courseManagerInstance.context.LanguageTerms.WithdrawConfirmText},this.clickOnAction)}}();e.CourseManager=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var b=this;this.settings=this.settings=d;$(function(){function a(){g.is(":checked")?(h.removeProp("readonly"),h.off("click",c)):(h.prop("readonly","readonly"),h.on("click",c))}function c(){return!1}var g=$("#"+b.settings.PlannerCheckboxClientId),h=$("#"+b.settings.TopicsInPlannerCheckboxClientId);a();g.on("change",function(){a()})})}}();e.EditDefaultCourseSettings=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.context=b;e.editPolicyInstance=this;b.Settings.IsBroadcastMassMessageEnabled&&b.Settings.CanChangeOrganization&&b.Settings.CanSitePermissionBeSelectedForMassMessaging&&$("#"+b.Controls.OrganizationsDropdownClientId).change(function(c){a.onOrganizationChanged(c)})}d.prototype.checkEsafetyChanged=function(){if(e.editPolicyInstance.context.Settings.IsInstantMessageSystemEnabled&&e.editPolicyInstance.context.Settings.IsEditMode){var b=[];
CCL.CommonFunctions.checkAndAddRole(e.editPolicyInstance.context.Settings.EsafetyStaffChecked,e.editPolicyInstance.context.Controls.StaffCheckboxClientId,e.editPolicyInstance.context.LanguageTerms.Staff,b);CCL.CommonFunctions.checkAndAddRole(e.editPolicyInstance.context.Settings.EsafetyStudentChecked,e.editPolicyInstance.context.Controls.StudentCheckboxClientId,e.editPolicyInstance.context.LanguageTerms.Student,b);CCL.CommonFunctions.checkAndAddRole(e.editPolicyInstance.context.Settings.EsafetyGuestChecked,
e.editPolicyInstance.context.Controls.GuestCheckboxClientId,e.editPolicyInstance.context.LanguageTerms.Guest,b);var a="";$("#"+e.editPolicyInstance.context.Controls.InitiateCommunicationCheckBoxClientId).is(":checked")&&(a="\n"+e.editPolicyInstance.context.LanguageTerms.AdditionEsafetyText);switch(b.length){case 1:alert(CCL.CommonFunctions.formatString(e.editPolicyInstance.context.LanguageTerms.UncheckedOneEsafetyRoleText,b[0])+a);break;case 2:alert(CCL.CommonFunctions.formatString(e.editPolicyInstance.context.LanguageTerms.UncheckedTwoEsafetyRolesText,
b[0],b[1])+a);break;case 3:alert(CCL.CommonFunctions.formatString(e.editPolicyInstance.context.LanguageTerms.UncheckedThreeEsafetyRolesText)+a)}}};d.prototype.toogleEsafetyDropDown=function(b,a){document.getElementById(b).style.visibility=document.getElementById(a).checked?"visible":"hidden"};d.prototype.onOrganizationChanged=function(b){(b=b.target)&&this.toggleSiteOptionInBroadcastMassMessagingDropdown(b.options[b.selectedIndex].value===this.context.Settings.SiteOrganizationId.toString())};d.prototype.toggleSiteOptionInBroadcastMassMessagingDropdown=
function(b){var a=$("#"+this.context.Controls.BroadcastMassMessageDropdownClientId+" option[value='"+this.context.Settings.BroadcastMassMessageSchoolPermission+"']");b?(b=$("<option value='"+this.context.Settings.BroadcastMassMessageSitePermission+"'>"+this.context.LanguageTerms.Site+"</option>"),a.before(b)):(b=$("#"+this.context.Controls.BroadcastMassMessageDropdownClientId+" option:selected").val(),$("#"+this.context.Controls.BroadcastMassMessageDropdownClientId+" option[value='"+this.context.Settings.BroadcastMassMessageSitePermission+
"']").remove(),b===this.context.Settings.BroadcastMassMessageSitePermission.toString()&&a.attr("selected","selected"))};return d}();e.EditPolicy=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(b){var a=this;this.controls={checkbox:null,newActionButton:null,radioButtons:null,textArea:null,confirmButton:null};this.sections={recentActions:null,newAction:null,reason:null,confirmation:null};this.initialize=function(c){a.initializeSections(c);a.initializeControls(c);setTimeout(a.revealElements,0)};this.initializeSections=function(c){a.sections.recentActions=$("#"+c.RecentActionsSectionId);a.sections.newAction=$("#"+c.NewActionSectionId);
a.sections.reason=$("#"+c.ReasonSectionId);a.sections.confirmation=$("#"+c.ConfirmationSectionId)};this.initializeControls=function(c){a.controls.checkbox=$("#"+c.CheckboxId);a.controls.newActionButton=$("#"+c.NewActionButtonId);a.controls.radioButtons=$("#"+c.NewActionSectionId+" input");a.controls.textArea=$("#"+c.TextAreaId);a.controls.confirmButton=$("#"+c.ConfirmButtonId);a.controls.checkbox.change(a.onCheckboxClick);a.controls.newActionButton.on("click",a.onNewActionButtonClick);a.controls.radioButtons.on("change",
a.onRadioButtonClick);CCL.TextAreaExtensions.setMaxLength(a.controls.textArea,c.ReasonMaxLength);a.controls.textArea.on("input change",a.onTextAreaUpdate)};this.onCheckboxClick=function(c){c.target.checked||(a.hasNewActionButtonBeenPressed=!1);a.revealElements()};this.onNewActionButtonClick=function(){a.hasNewActionButtonBeenPressed=!0;a.revealElements()};this.onRadioButtonClick=function(){a.revealElements()};this.onTextAreaUpdate=function(){a.revealElements()};this.revealElements=function(){var c=
!1,b=!0,h=!1,d=!1,e=!1,f=!1;a.isUserConfirmed()&&(c=!0,a.hasNewActionButtonBeenPressed&&(b=!1,h=!0,a.isActionSelected()&&(e=d=!0,a.isReasonProvided()&&(f=!0))));a.showOrHideElement(a.sections.recentActions,c);a.showOrHideElement(a.controls.newActionButton,b);a.showOrHideElement(a.sections.newAction,h,function(){a.controls.radioButtons.each(function(){$(this).prop("checked",!1)})});a.showOrHideElement(a.sections.reason,d,function(){a.controls.textArea.val("")});a.showOrHideElement(a.sections.confirmation,
e);a.controls.confirmButton.prop("disabled",!f)};this.showOrHideElement=function(a,b,h){void 0===h&&(h=function(){});b?a.show():(a.hide(),h())};this.isUserConfirmed=function(){return a.controls.checkbox.is(":checked")};this.isActionSelected=function(){return a.controls.radioButtons.is(":checked")};this.isReasonProvided=function(){return""!=a.controls.textArea.val().trim()};$(function(){return a.initialize(b)})}}();e.Default=d})(e.Gdpr||(e.Gdpr={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){var c=this;this.context=a;this.onDialogAddButtonClick=function(a){var b=[];a.forEach(function(a,c){a!==f.CheckboxStateMachine.State.Saved&&a!==f.CheckboxStateMachine.State.AttachedByUser||b.push(c)});c.selectedHierarchyIds.val(b.join());c.isHierarchySelectionChanged=!0};this.onDialogClosed=function(){c.isHierarchySelectionChanged&&c.context.Scripts.SelectHierarchyScript()};this.setupHierarchyLinkClickHandler()}Object.defineProperty(b.prototype,
"selectedHierarchyIds",{get:function(){return $("#"+this.context.Controls.SelectedHierarchyIds)},enumerable:!0,configurable:!0});b.prototype.setupHierarchyLinkClickHandler=function(){var a=this,c=f.Controls.HierarchyDialog.hierarchyDialogManagerInstance,b=this.selectedHierarchyIds.val()?this.selectedHierarchyIds.val().split(","):[];if(c)$("#"+this.context.Controls.AddHierarchyLinkId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){a.isHierarchySelectionChanged=!1;var g=new Map;
b.forEach(function(a){g.set(parseInt(a),f.CheckboxStateMachine.State.Saved)});c.openDialog({itemStates:g,disabledItemIds:[],header:a.context.Resources.HierarchyDialogHeader,afterOkClickCallback:a.onDialogAddButtonClick,afterCloseDialogCallback:a.onDialogClosed,allowFolderSelection:!0},{})})};return b}();e.AddEditModuleApps=d})(e.ManageApps||(e.ManageApps={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(){function a(a,b,h,d){this.utility=a;this.editorCallbacks=b;this.cssClasses=h;this.terms=d}a.prototype.buildCommonMarkup=function(a,b,h,d,e,f,k,p,r,u,w,t){void 0===p&&(p=null);void 0===r&&(r=!1);void 0===u&&(u=!1);void 0===w&&(w=!0);h&&this.buildSectionTitle(a,d,e);p&&p();this.buildContentMarkup(a,b.editable&&k,!u&&r,f,u,w,t)};a.prototype.buildSectionTitle=function(a,b,h){$("<div>").addClass(b).text(h).appendTo(a)};a.prototype.getEditorBinding=
function(a,b){var c=this;return{element:b,event:a,watermarkText:this.getTextContainerWatermark(a),cachedText:this.getCachedText(a),cachedPlainText:this.getCachedPlainText(a),isPlainText:this.isPlainText(a),sendTextAjax:function(g){return c.sendTextAjax(a,b,g)}}};a.prototype.checkEventHasAttachedResources=function(a,b){return a.bookedResources&&0<a.bookedResources.length||a.plansCount&&0<a.plansCount||0<this.utility.getAddedElementsCount(b)};a.prototype.buildContentMarkup=function(a,b,h,d,l,k,n){var c=
this,g=$("<div>");n&&g.addClass(this.utility.settings.cssClasses.ModernInputTextEditor).addClass(this.utility.settings.cssClasses.ModernInputTextIsValid).appendTo(a);var m=$("<div>").addClass(this.cssClasses.inlineEditContainer).appendTo(n?g:a);a=$("<div>");l?a.text(d.cachedText):(a.html(d.cachedText),h&&CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a));a.addClass(this.utility.settings.cssClasses.UserInput).appendTo(m);b&&(d.isPlainText?(m.addClass(this.utility.settings.cssClasses.TextContainerEditable),
a.css("cursor","pointer"),d.cachedText.trim()||a.addClass(this.utility.settings.cssClasses.TextContainerWatermark).text(d.watermarkText),a.one("click",function(){(new f.InlineEdit.InlineEditContent(m,c.utility,c.editorCallbacks,d,l,k,n?n.inputValidationFunction:null)).makeTextContentInlineEditable();if(n){var a=new e.InputValidator(c.utility,g,n);a.createValidationMessageContainer();c.editorCallbacks.onEditFinished=function(){a.resetValidation()}}})):a.prop("title",this.terms.isNotEditableTooltip));
l||CCL.CommonFunctions.executeScripts(d.cachedText)};return a}();d.MarkupBuilderBase=b})(f.EventTextContent||(f.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a){this.utility=a}a.prototype.buildMarkup=function(a,b){(b.editable||b.PreviousEvent.ExtraDescription&&b.PreviousEvent.ExtraDescription.length)&&$("<div>").addClass(this.utility.settings.cssClasses.DescriptionApiLabel).text(this.utility.settings.terms.ApiDescriptionLabel).appendTo(a);$("<div>").addClass(this.utility.settings.cssClasses.UserInput).addClass(this.utility.settings.cssClasses.DescriptionApi).html(b.apiDescription).appendTo($(a))};
return a}();d.ApiDescriptionMarkupBuilder=b})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,c){this.settings=a;this.controls=c;this.defaultTitleHeight=20;this.defaultDescriptionHeight=86;this.cssClasses=this.settings.cssClasses;this.utility=new e.Utility(a,c)}b.prototype.getContentAreaIdWithColorClass=function(a,c){var b=this,h={},d=0;for(a=this.getFilterItemsList(a);d<a.length;d++){var e=a[d],f=e.getElementsByClassName(this.cssClasses.ColorItem)[0];h[c+e.dataset.itemid]=Object.assign([],f.classList).filter(function(a){return a!==
b.cssClasses.ColorItem}).join()}return h};b.prototype.getFilterItemIds=function(a,c){var b=[],h=0;for(a=this.getFilterItemsList(a);h<a.length;h++){var d=a[h];!c===!this.filterItemChecked(d)&&b.push(+d.dataset.itemid)}return b};b.prototype.getFilterItemIdsWithColors=function(a,c){var b=[],h=[],d=0;for(a=this.getFilterItemsList(a);d<a.length;d++){var e=a[d];!c===!this.filterItemChecked(e)&&(b.push(+e.dataset.itemid),h.push(+e.dataset.itemcolor))}return{persons:b.join(),colors:h.join()}};b.prototype.getAllCourseIds=
function(){for(var a=[],c=0,b=this.getFilterItemsList(this.controls.myCalendars.courseList);c<b.length;c++)a.push(+b[c].dataset.itemid);return a};b.prototype.getContentAreaIdsWithColorClasses=function(){var a=this.getContentAreaIdWithColorClass(this.controls.myCalendars.courseList,this.utility.settings.locationPrefixes.courseValuePrefix),c=this.getContentAreaIdWithColorClass(this.controls.myCalendars.projectList,this.utility.settings.locationPrefixes.projectValuePrefix);return Object.assign({0:"person-color"},
a,c)};b.prototype.toggleDescriptionInlineEditorModes=function(a,c){c&&!a.isPlainTextInDescription?(this.controls.AddEventReadOnlyDescriptionContainer.innerHTML=a.description,this.controls.AddEventReadOnlyDescriptionContainer.style.display="block",this.controls.AddEventEditableDescriptionContainer.style.display="none",CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick($(this.controls.AddEventReadOnlyDescriptionContainer))):(this.controls.AddEventReadOnlyDescriptionContainer&&(this.controls.AddEventReadOnlyDescriptionContainer.innerHTML=
"",this.controls.AddEventReadOnlyDescriptionContainer.style.display="none"),this.controls.AddEventEditableDescriptionContainer.style.display="block",this.controls.addEventDescriptionBox[0].value=c&&a.descriptionPlainText||"");this.settings.customerSettings.enableFrenchCalendarLayout&&(c&&!a.isPlainTextInExtraDescription?(this.controls.AddEventReadOnlyExtraDescriptionContainer.innerHTML=a.extraDescription,this.controls.AddEventReadOnlyExtraDescriptionContainer.style.display="block",this.controls.AddEventEditableExtraDescriptionContainer.style.display=
"none",CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick($(this.controls.AddEventEditableExtraDescriptionContainer))):(this.controls.AddEventReadOnlyExtraDescriptionContainer&&(this.controls.AddEventReadOnlyExtraDescriptionContainer.innerHTML="",this.controls.AddEventReadOnlyExtraDescriptionContainer.style.display="none"),this.controls.AddEventEditableExtraDescriptionContainer.style.display="block",this.controls.addEventExtraDescriptionBox[0].value=c&&a.extraDescriptionPlainText||""))};
b.prototype.resetInputFieldsToDefault=function(a){this.controls.addEventChooseCategoryErrorMessageLabel[0].style.display="none";this.controls.addEventResponseErrorMessageLabel[0].style.display="none";this.controls.AddEventTitleTextBox[0].value=a;this.controls.addEventDescriptionBox[0].value="";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].value="");this.controls.AddEventTitleTextBox[0].style.height=this.defaultTitleHeight+"px";this.controls.addEventDescriptionBox[0].style.height=
this.defaultDescriptionHeight+"px";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].style.height=this.defaultDescriptionHeight+"px")};b.prototype.adjustHeights=function(){this.controls.AddEventTitleTextBox[0].style.height=this.controls.AddEventTitleTextBox[0].scrollHeight+"px";this.controls.addEventDescriptionBox[0].style.height=this.controls.addEventDescriptionBox[0].scrollHeight+"px";this.controls.addEventExtraDescriptionBox[0]&&(this.controls.addEventExtraDescriptionBox[0].style.height=
this.controls.addEventExtraDescriptionBox[0].scrollHeight+"px")};b.prototype.setUserInputsIfNeeded=function(a){if(a){var c=this.controls.eventDetailsMainContainer.querySelector("."+this.cssClasses.Title+" > ."+this.cssClasses.UserInput);a.EventTitle=c&&!c.classList.contains(this.cssClasses.TextContainerWatermark)&&c.innerText||"";a.isPlainTextInDescription&&(c=this.controls.eventDetailsMainContainer.querySelector("."+this.cssClasses.Description+" > ."+this.cssClasses.UserInput),a.description=c&&!c.classList.contains(this.cssClasses.TextContainerWatermark)&&
c.innerHTML||"");this.settings.customerSettings.enableFrenchCalendarLayout&&a.showExtraDescription&&a.isPlainTextInExtraDescription&&(c=this.controls.eventDetailsMainContainer.querySelector("."+this.cssClasses.DescriptionExtra+" > ."+this.cssClasses.UserInput),a.extraDescription=c&&!c.classList.contains(this.cssClasses.TextContainerWatermark)&&c.innerHTML||"")}};b.prototype.getFilterItemsList=function(a){return a&&Object.assign([],a.getElementsByClassName(this.cssClasses.FilterItem))||[]};b.prototype.filterItemChecked=
function(a){return a.querySelector("input").checked};return b}();e.Schedule=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,c){var b=this;this.controls=a;this.settings=c;e.multipleCourseSearchSelectorDialogClientInstance=this;this.modalDialog=window[this.dialogId];this.controls.CourseSearchButton&&(this.controls.CourseSearchButton.onclick=function(){b.inputSelectize.isOpen?b.inputSelectize.close():b.inputSelectize.open()});this.controls.AddButton.onclick=function(a){b.preventDefaultOnSave&&a.preventDefault();b.updateSelectedCourses();b.settings.OnSaveCallback&&
b.settings.OnSaveCallback(a)};this.modalDialog.setCustomScripts({afterCloseDialog:function(){b.modalDialog.clearLastActiveElement();b.inputSelectize.blur()},afterOpenDialog:function(){b.inputSelectize.close();b.inputSelectize.focus();setTimeout(function(){b.refreshSelectedCourses()},10)}});this.initSelectize();this.inputSelectize.hideInput=function(){this.setTextboxValue("");this.$control_input.css({opacity:0});this.isInputHidden=!0};var h=this.inputSelectize.$dropdown,d=this.inputSelectize.$control;
this.inputSelectize.positionDropdown=function(){h.position({my:"left top",at:"left bottom",of:d,collision:"none"});h.css("width",d.outerWidth())}}Object.defineProperty(b.prototype,"dialogId",{get:function(){return this.controls.Container.id},enumerable:!0,configurable:!0});b.prototype.setCoursesToSelectFrom=function(a){this.settings.CoursesAvailableToSelect=a;this.inputSelectize.clearOptions();this.updateSearchInput()};b.prototype.setMaxItems=function(a){this.inputSelectize.settings.maxItems=a};b.prototype.openDialog=
function(a,c,b){void 0===b&&(b=!0);this.settings.OnSaveCallback=c;this.preventDefaultOnSave=b;this.modalDialog.openDialog(!1);this.selectedCourses=a};Object.defineProperty(b.prototype,"selectedCourses",{get:function(){return this.selectedCoursesArray},set:function(a){this.selectedCoursesArray=a},enumerable:!0,configurable:!0});b.prototype.updateSelectedCourses=function(){var a=this;this.selectedCourses=this.inputSelectize.items?this.inputSelectize.items.map(function(c){return a.settings.CoursesAvailableToSelect.filter(function(a){return a.CourseId===
parseInt(c,10)})[0]}):[]};b.prototype.getAvailableCoursesCount=function(){return this.settings.CoursesAvailableToSelect.length};b.prototype.clear=function(){this.inputSelectize.clear(!0)};b.prototype.toggleError=function(a){var c=this.controls.Container.querySelector("."+this.settings.CssClasses.SelectizeInput);a?c.classList.add(this.settings.CssClasses.ModernInputInvalid):c.classList.remove(this.settings.CssClasses.ModernInputInvalid)};b.prototype.initSelectize=function(){var a=this,c=$(this.controls.CourseSearchInput);
c.selectize({valueField:"Value",plugins:{"selectize-plugin-a11y":{},remove_button:{title:this.settings.Terms.Remove},no_results:{message:this.settings.Terms.NoMatches}},searchField:["Label"],highlight:!1,openOnFocus:!0,closeAfterSelect:!0,preload:"focus",addPrecedence:!0,persist:!1,loadThrottle:null,maxOptions:0<this.settings.MaxNumberOfCoursesToShow?this.settings.MaxNumberOfCoursesToShow:void 0,placeholder:this.settings.Terms.FindCourses,diacritics:!1,render:{item:function(c,b){return'<div class="itsl-selectize-item"><span class="'+
a.settings.CssClasses.CourseIconClass+" "+c.ColorCssClass+'"></span><span class="itsl-selectize-item-label">'+b(c.Label)+"</span></div>"},option:function(c,b){return'<div class="itsl-selectize-option"><span class="'+a.settings.CssClasses.CourseIconClass+" "+c.ColorCssClass+'"></span><span class="itsl-selectize-option-label">'+b(c.Label)+"</span></div>"}},load:function(){a.settings.CoursesAvailableToSelect.forEach(function(c){a.inputSelectize.addOption({Label:c.Title,Value:c.CourseId,ColorCssClass:c.ColorCssClass})});
a.inputSelectize.refreshOptions()},onItemAdd:function(){a.updateSearchInput();a.inputSelectize.$control[0].scrollTop=a.inputSelectize.$control[0].scrollHeight;a.settings.OnItemAddCallback&&a.settings.OnItemAddCallback()},onItemRemove:function(){a.updateSearchInput();a.settings.OnItemRemoveCallback&&a.settings.OnItemRemoveCallback()},onFocus:function(){a.updateSearchInput()}});this.inputSelectize=c[0].selectize;this.inputSelectize.$control.click(function(){return a.inputSelectize.open()});this.inputSelectize.$control_input.keypress(function(a){a.which===
CCL.CommonConstants.keyCodes.enter&&a.preventDefault()}).keyup(function(c){c.which===CCL.CommonConstants.keyCodes.escape&&a.inputSelectize.isFocused&&c.stopPropagation()})};b.prototype.refreshSelectedCourses=function(){var a=this.selectedCourses?this.selectedCourses.map(function(a){return a.CourseId.toString()}):[];this.inputSelectize.setValue(a,!0)};b.prototype.updateSearchInput=function(){this.inputSelectize.loadedSearches={};this.inputSelectize.lastQuery=null;this.inputSelectize.refreshOptions()};
return b}();e.MultipleCourseSearchSelector=d})(e.MultipleCourseSearchSelector||(e.MultipleCourseSearchSelector={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){this.settings=a;window[b.instanceName]=this}b.prototype.countDown=function(a,c){var b=this,h=document.querySelector("[id$='"+this.settings.TimerPrefix+a+"']"),d=document.querySelector("[id$='"+this.settings.EditLinkPrefix+a+"']");d&&h&&(0<c?(h.innerHTML=this.settings.EditMessagePart1+" "+c+" "+this.settings.EditMessagePart2,--c,setTimeout(function(){b.countDown(a,c)},6E4)):(h.style.display="none",d.style.display="none"))};b.getInstance=
function(){return window[b.instanceName]};b.instanceName="ThreadViewTableClientInstance";return b}();e.ThreadViewTable=d})(e.Discussion||(e.Discussion={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,c){var b=this;this.controls=a;this.settings=c;this.modalDialog=window[this.getDialogId()];this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){var a=window[b.settings.TreeViewSelectorContainerId];a.init({allowFolderSelection:!0,itemStates:b.currentParams.itemStates,disabledItemIds:b.currentParams.disabledItemIds});var c=0<a.countCheckedItems();b.controls.OkButton.prop("disabled",
!c);b.controls.Container.on(a.settings.StateChangedEventName,function(a,c){b.controls.OkButton.prop("disabled",0===c)});a.onFolderContentLoaded();c=b.controls.Container.find(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.ItemId)).first();a.expandFolder(c)},afterCloseDialog:function(){void 0!==b.currentParams.afterCloseDialogCallback&&b.currentParams.afterCloseDialogCallback()}})}b.prototype.openDialog=function(a,c){this.currentParams=a;$.extend(c,{treeViewContainerId:this.settings.TreeViewSelectorContainerId});
this.ajaxParams=c;this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,c,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1)};b.prototype.closeDialog=function(){CssModal.closeDialog()};b.prototype.getDialogId=function(){return this.controls.Container.prop("id")};b.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.on("click",function(c){a.currentParams.afterOkClickCallback(a.currentParams.itemStates);a.closeDialog();c.preventDefault()})};
return b}();e.HierarchyDialogManager=d})(e.HierarchyDialog||(e.HierarchyDialog={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.options=new Map;this.optionsGroup=b;this.options=new Map;a.forEach(function(a){return c.options.set(a[0],a[1])});this.optionsGroup.on("keydown","label",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.enter||a.keyCode===CCL.CommonConstants.keyCodes.space)return $(a.target).click(),a.preventDefault(),!1})}d.prototype.isSelected=function(b){return this.isOptionSelected(this.options.get(b))};d.prototype.addOnChangeHandler=
function(b){this.optionsGroup.on("change","input:radio",b)};d.prototype.isOptionSelected=function(b){return b.is(":checked")};return d}();e.OptionRadioButtonManagerBase=f})(f.OptionRadioButton||(f.OptionRadioButton={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,c){var b=this;this.controls=a;this.settings=c;this.optionRadioManager=new f.OptionRadioButton.OptionRadioButtonManagerBase(this.controls.RadioButtonGroup,[[e.PrivacyChangedDialogActionType.MakeReadOnly,this.controls.RadioButtonReadOnly],[e.PrivacyChangedDialogActionType.LeaveOpen,this.controls.RadioButtonLeaveOpen]]);this.optionRadioManager.addOnChangeHandler(function(){b.switchState()});e.privacyChangedDialogManagerInstance.toggleOkButton(0===
this.getSelectedProfilesIds().length);this.controls.ProfileCheckboxesByCss.off("change").on("change",function(a){e.privacyChangedDialogManagerInstance.toggleOkButton(0===b.getSelectedProfilesIds().length)})}b.prototype.getCurrentProfileId=function(){return this.settings.CurrentProfileId};b.prototype.selectedActionType=function(){return this.optionRadioManager.isSelected(e.PrivacyChangedDialogActionType.MakeReadOnly)?e.PrivacyChangedDialogActionType.MakeReadOnly:e.PrivacyChangedDialogActionType.LeaveOpen};
b.prototype.getSelectedProfilesIds=function(){for(var a=this,c=[],b=function(b){if(b.is(":checked")){var g=h.settings.PersonProfiles.find(function(c){return c.PersonProfileId.toString()===b.attr("id").replace(a.settings.ProfileCheckboxPrefix,"")});c.push(g.PersonProfileId)}},h=this,d=0,e=this.controls.ProfileCheckboxes;d<e.length;d++)b(e[d]);return c};b.prototype.getSelectedProfileNames=function(){for(var a=this,c=[],b=function(b){if(b.is(":checked")){var g=h.settings.PersonProfiles.find(function(c){return c.PersonProfileId.toString()===
b.attr("id").replace(a.settings.ProfileCheckboxPrefix,"")});c.push(g.PersonProfileName)}},h=this,d=0,e=this.controls.ProfileCheckboxes;d<e.length;d++)b(e[d]);return c};b.prototype.areGroupConversationsIncludedChecked=function(){return this.controls.IncludeGroupConversationsCheckbox.is(":checked")};b.prototype.switchState=function(){this.optionRadioManager.isSelected(e.PrivacyChangedDialogActionType.MakeReadOnly)?(this.controls.ReadOnlySection.show(),e.privacyChangedDialogManagerInstance.toggleOkButton(0===
this.getSelectedProfilesIds().length)):(this.controls.ReadOnlySection.hide(),e.privacyChangedDialogManagerInstance.toggleOkButton(!1))};return b}();e.PrivacyChangedDialogContentManager=d})(e.PersonProfile||(e.PersonProfile={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,c){this.controls=a;this.settings=c;this.modalDialog=window[this.getDialogId()]}b.prototype.toggleOkButton=function(a){this.controls.OkButton.prop("disabled",a)};b.prototype.openDialog=function(a,c){this.params=a;this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,c,!1);this.modalDialog.setTitle(this.settings.HeaderText);this.setupOkButtonClickHandler();this.modalDialog.openDialog(!1)};b.prototype.closeDialog=function(){CssModal.closeDialog()};
b.prototype.getDialogId=function(){return this.controls.Container.prop("id")};b.prototype.setupOkButtonClickHandler=function(){var a=this;this.controls.OkButton.off("click").on("click",function(c){f.WebComponents.personProfileSiteInstance.showConfirmEsafetyChanges(e.privacyChangedDialogContentManagerInstance.getSelectedProfileNames(),e.privacyChangedDialogContentManagerInstance.areGroupConversationsIncludedChecked(),e.privacyChangedDialogContentManagerInstance.selectedActionType())?(a.startJob(),
a.closeDialog(),c.preventDefault(),(new Function(a.params.submitFormMethod))()):c.preventDefault()})};b.prototype.startJob=function(){var a={selectedAction:e.privacyChangedDialogContentManagerInstance.selectedActionType(),selectedProfileIds:e.privacyChangedDialogContentManagerInstance.getSelectedProfilesIds(),currentProfileId:e.privacyChangedDialogContentManagerInstance.getCurrentProfileId(),areGroupConversationsIncluded:e.privacyChangedDialogContentManagerInstance.areGroupConversationsIncludedChecked()};
CCL.CommonFunctions.safeAjaxPost({url:this.settings.StartPrivacyChangedJob,data:a,dataType:"html"})};return b}();e.PrivacyChangedDialogManager=d})(e.PersonProfile||(e.PersonProfile={}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){this.context=d;this.selectedItemsCount=function(){return e.projectManagerInstance.context.Controls.PerformOnAllCheckbox.is(":checked")?e.projectManagerInstance.context.Settings.ProjectsVirtualCount:e.projectManagerInstance.context.Controls.TableItem.find("tr.selected").length};this.hideArchiveFilter=function(a){var c=$("."+e.projectManagerInstance.context.Settings.ArchiveDateCssClass).parent();$("#"+e.projectManagerInstance.context.Controls.StatusClientId+
" input[type = 'radio']").first().attr("id")===a.target.id?c.hide():c.show()};this.clickOnAction=function(a){if($(a.currentTarget).is("[disabled=disabled]"))return!1;var c=e.projectManagerInstance.selectedItemsCount();return 0!==c&&confirm(CCL.CommonFunctions.formatString(a.data.text,c))};this.context=d;e.projectManagerInstance=this;$("."+e.projectManagerInstance.context.Settings.ArchiveDateCssClass).children().addClass(e.projectManagerInstance.context.Settings.InlineCssClass);$("#"+e.projectManagerInstance.context.Controls.StatusClientId+
" input[type = 'radio']").first().is(":checked")&&$("."+e.projectManagerInstance.context.Settings.ArchiveDateCssClass).parent().hide();$("#"+e.projectManagerInstance.context.Controls.StatusClientId+" input[type = 'radio']").click(this.hideArchiveFilter);e.projectManagerInstance.context.Controls.DeleteAction.on("click",null,{text:e.projectManagerInstance.context.LanguageTerms.DeleteConfirmText},this.clickOnAction);d=0;for(var b=e.projectManagerInstance.context.Controls.HeaderClientIds;d<b.length;d++){var a=
document.getElementById(b[d]);a&&1===a.childNodes.length&&(a.className="")}}}();e.ProjectManager=f})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.context=b;e.finalAssessmentInstance=this}d.prototype.toggleView=function(b,a){$(b).closest(this.context.Controls.ItemRootCssSelector).find("li[data-id='"+a+"'").toggle()};d.prototype.alertAjaxError=function(b){CCL.CommonFunctions.alertAjaxError(b,null,null)};d.prototype.updateViewScore=function(b){var a=b.val();a==this.context.Settings.NotAssessmentStringPattern&&(a=this.context.Settings.NotAssessmentReplaceValue);$(b).closest(this.context.Controls.ItemRootCssSelector).find(this.context.Controls.ScoreCssSelector).text(a)};
d.prototype.assessPerson=function(b,a,c,g,h){b={personId:b,assessmentId:c,assessmentItemId:a.getValue(),courseId:g,gradeBookItemId:h};CCL.CommonFunctions.safeAjaxPost({url:this.context.WebMethods.AssessWithScaleUrl,data:b}).fail(this.alertAjaxError).done(this.updateViewScore(a))};return d}();e.FinalAssessment=f})(f.AssessmentRecord||(f.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){e.termAssessmentOverviewInstance=this;this.context=a}b.prototype.init=function(){var a=this;$("#"+this.context.Controls.CompleteCourseButtonId).click(function(){return a.completeSelectedCourses()});$("#"+this.context.Controls.RevertCourseButtonId).click(function(){return a.revertSelectedCourses()})};b.prototype.getSelectedCourses=function(){for(var a=[],c=0,b=$("#"+this.context.Controls.GridId).find("tbody > tr.selected").toArray();c<
b.length;c++){var h=$("span["+this.context.Settings.DataSerializedInfoAttribute+"]",b[c]).first();h=$.parseJSON(h.attr(this.context.Settings.DataSerializedInfoAttribute));a.push(h)}return a};b.prototype.getRevertConfirmationMessage=function(a){var c="";switch(a.length){case 0:break;case 1:c=this.context.Settings.RevertConfirmOneCourseMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title);break;case 2:c=this.context.Settings.RevertConfirmTwoCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,
a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title);break;case 3:c=this.context.Settings.RevertConfirmThreeCoursesMessagePattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,a[1].Title).replace(this.context.Settings.CourseCPattern,a[2].Title);break;default:c=this.context.Settings.RevertConfirmFourOrMoreCoursesMessagesPattern.replace(this.context.Settings.CourseAPattern,a[0].Title).replace(this.context.Settings.CourseBPattern,
a[1].Title).replace(this.context.Settings.NumberOfCoursesPattern,(a.length-2).toString())}return c};b.prototype.checkSelectionExists=function(a){return 0==a.length?(jAlert(this.context.Settings.PleaseMakeSelectionMessage),!1):!0};b.prototype.completeSelectedCourses=function(){var a=this,c=this.getSelectedCourses();this.checkSelectionExists(c)&&jConfirm(this.context.Settings.CompleteConfirmMessage,this.context.Settings.ConfirmDialogTitle,function(c){c&&a.context.Scripts.PostbackComplete()})};b.prototype.revertSelectedCourses=
function(){var a=this,c=this.getSelectedCourses();this.checkSelectionExists(c)&&(c=this.getRevertConfirmationMessage(c),jConfirm(c,this.context.Settings.ConfirmDialogTitle,function(c){c&&a.context.Scripts.PostbackRevert()}))};return b}();e.TermAssessmentOverview=d})(e.Headteacher||(e.Headteacher={}))})(f.Assessment||(f.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.settings=b;this.crumbs=window.parent.document.getElementById("crumbs");this.textItemBuilder=new e.BreadcrumbTextItemBuilder(b.CssClasses);this.linkItemBuilder=new e.BreadcrumbLinkItemBuilder(b.CssClasses,b.KpiSettings)}d.prototype.buildBreadcrumbs=function(b){var a=this;window.parent!==window&&this.crumbs&&(Array.prototype.slice.call(this.crumbs.querySelectorAll("li:not(:first-child)")).forEach(function(a){a.parentNode.removeChild(a)}),
b.forEach(function(c,g){a.crumbs.appendChild((g===b.length-1?a.textItemBuilder:a.linkItemBuilder).buildItem(c))}))};return d}();e.BreadcrumbBuilder=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.cssClasses=b}d.prototype.buildListItem=function(b){var a=document.createElement("li");a.appendChild(this.getSeparator());a.appendChild(b);return a};d.prototype.getSeparator=function(){var b=document.createElement("span");b.innerText="/";b.className=this.cssClasses.Separator;return b};return d}();e.BreadcrumbItemBuilderBase=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function b(a,c){d.call(this,a);this.kpiSettings=c}__extends(b,d);b.prototype.buildItem=function(a){var c=this,b=document.createElement("a");b.innerText=a.Text;b.setAttribute("title",a.Title&&a.Title.length?a.Title:a.Text);b.setAttribute("href",a.Href);b.setAttribute("target",a.Target);b.onclick=function(){return c.measureKpi()};a=document.createElement("span");a.appendChild(b);return this.buildListItem(a)};b.prototype.measureKpi=function(){fetch(this.kpiSettings.Url,
{credentials:"same-origin",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({measureSection:this.kpiSettings.MeasureSection,measurement:this.kpiSettings.Measurement,measureContext:this.kpiSettings.MeasureContext})})};return b}(e.BreadcrumbItemBuilderBase);e.BreadcrumbLinkItemBuilder=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function b(a){d.call(this,a)}__extends(b,d);b.prototype.buildItem=function(a){var c=document.createElement("span");c.className=this.cssClasses.SelectedCrumb;c.innerText=a.Text;return this.buildListItem(c)};return b}(e.BreadcrumbItemBuilderBase);e.BreadcrumbTextItemBuilder=f})(f.Breadcrumbs||(f.Breadcrumbs={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.AddResourceMenu||(f.AddResourceMenu={});f=f.ElementExternalSourceType||(f.ElementExternalSourceType={});f[f.Library=0]="Library";f[f.Course=1]="Course";f[f.CreateNew=2]="CreateNew";f[f.Computer=3]="Computer"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Administration||(f.Administration={});f=f.PersonProfile||(f.PersonProfile={});f=f.PrivacyChangedDialogActionType||(f.PrivacyChangedDialogActionType={});f[f.MakeReadOnly=0]="MakeReadOnly";f[f.LeaveOpen=1]="LeaveOpen"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.Other=0]="Other";d[d.Resource=1]="Resource";d[d.Child=2]="Child"})(e.CalendarTypes||(e.CalendarTypes={}));(function(d){d[d.Month=0]="Month";d[d.Week=1]="Week";d[d.Day=2]="Day";d[d.List=3]="List"})(e.CalendarView||(e.CalendarView={}));(function(d){d[d.ReportError=0]="ReportError";d[d.PerformUpdate=1]="PerformUpdate";d[d.AskConfirmation=2]="AskConfirmation"})(e.EventCheckDecision||(e.EventCheckDecision={}));(function(d){d[d.Unspecified=0]="Unspecified";
d[d.RecurringEventInSingleMode=1]="RecurringEventInSingleMode";d[d.RecurringEventInUpcomingMode=2]="RecurringEventInUpcomingMode"})(e.EventScopeMode||(e.EventScopeMode={}));(function(d){d[d.CheckOnly=0]="CheckOnly";d[d.CheckOrUpdate=1]="CheckOrUpdate";d[d.UpdateOnly=2]="UpdateOnly"})(e.EventScopeOperation||(e.EventScopeOperation={}));(function(d){d[d.Course=1]="Course";d[d.Person=2]="Person";d[d.Project=3]="Project";d[d.All=4]="All"})(e.EventType||(e.EventType={}));(function(d){d[d.None=0]="None";
d[d.Default=1]="Default";d[d.CourseApproval=2]="CourseApproval";d[d.BookingsAvailability=4]="BookingsAvailability"})(e.EventValidationScope||(e.EventValidationScope={}))})(e.CalendarControllerModels||(e.CalendarControllerModels={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.Available=1]="Available";d[d.PartlyBooked=2]="PartlyBooked";d[d.Booked=3]="Booked"})(e.BookableResourceStatuses||(e.BookableResourceStatuses={}));(function(d){d[d.Monday=1]="Monday";d[d.Tuesday=2]="Tuesday";d[d.Wednesday=4]="Wednesday";d[d.Thursday=8]="Thursday";d[d.Friday=16]="Friday";d[d.Saturday=32]="Saturday";d[d.Sunday=64]="Sunday"})(e.WeekDays||(e.WeekDays={}))})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));(function(f){f=f.CheckboxStateMachine||(f.CheckboxStateMachine={});f=f.State||(f.State={});f[f.Empty=0]="Empty";f[f.Saved=1]="Saved";f[f.AttachedByUser=2]="AttachedByUser";f[f.DetachedByUser=3]="DetachedByUser"})(ItslearningWeb||(ItslearningWeb={}));(function(f){f=f.Controls||(f.Controls={});f=f.DatePeriod||(f.DatePeriod={});f[f.Day=0]="Day";f[f.Week=1]="Week"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.CopyMoveElementDialog||(f.CopyMoveElementDialog={});f=f.CopyMoveElementDialogMode||(f.CopyMoveElementDialogMode={});f[f.Copy=0]="Copy";f[f.Move=1]="Move"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementLinkDialog||(f.ElementLinkDialog={});f=f.ContentElementType||(f.ContentElementType={});f[f.All=0]="All";f[f.Resources=1]="Resources";f[f.Activities=2]="Activities";f[f.LearningObjectives=3]="LearningObjectives";f[f.Homework=4]="Homework";f[f.Files=5]="Files"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementParticipantPicker||(f.ElementParticipantPicker={});f=f.ItemType||(f.ItemType={});f[f.Participant=0]="Participant";f[f.Group=1]="Group"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.NextStep=0]="NextStep";d[d.NoNewSteps=-1]="NoNewSteps";d[d.Finish=-2]="Finish"})(e.TriggerResult||(e.TriggerResult={}));(function(d){d[d.Score=1]="Score";d[d.StatusViewed=2]="StatusViewed";d[d.StatusSubmitted=3]="StatusSubmitted";d[d.StatusCompleted=4]="StatusCompleted"})(e.TriggerCondition||(e.TriggerCondition={}));(function(d){d[d.LinearTransitionWithSingleElement=0]="LinearTransitionWithSingleElement";d[d.LinearTransitionWithMultipleElements=
1]="LinearTransitionWithMultipleElements";d[d.BranchingWithSingleElement=2]="BranchingWithSingleElement"})(e.StepType||(e.StepType={}));(function(d){d[d.StudentView=0]="StudentView";d[d.TeacherView=1]="TeacherView";d[d.TeacherEdit=2]="TeacherEdit"})(e.LearningPathStepViewMode||(e.LearningPathStepViewMode={}))})(e.Builder||(e.Builder={}))})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d[d.First="First"]="First";d[d.Last="Last"]="Last";d[d.Best="Best"]="Best"})(e.WhichAttemptCounts||(e.WhichAttemptCounts={}));(function(d){d[d.Never="Never"]="Never";d[d.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";d[d.AfterDeadline="AfterDeadline"]="AfterDeadline";d[d.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";d[d.WhenTeacherDecides="WhenTeacherDecides"]="WhenTeacherDecides"})(e.WhenToShowResult||(e.WhenToShowResult={}));
(function(d){d[d.Never="Never"]="Never";d[d.AfterEachAttempt="AfterEachAttempt"]="AfterEachAttempt";d[d.AfterAllAttempts="AfterAllAttempts"]="AfterAllAttempts";d[d.WithResults="WithResults"]="WithResults";d[d.AfterDeadline="AfterDeadline"]="AfterDeadline"})(e.WhenToShowQuestionListAndAnswer||(e.WhenToShowQuestionListAndAnswer={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LearningToolElement||(f.LearningToolElement={});f=f.Settings||(f.Settings={});f=f.SettingType||(f.SettingType={});f[f.ActivationControl=1]="ActivationControl";f[f.Results=2]="Results";f[f.SubmissionStatusForStudent=3]="SubmissionStatusForStudent";f[f.CollaborationSelector=4]="CollaborationSelector";f[f.Deadline=5]="Deadline";f[f.Homework=6]="Homework";f[f.LearningObjectiveList=7]="LearningObjectiveList";f[f.AssessmentScale=8]="AssessmentScale";f[f.Attempts=9]="Attempts";f[f.ResultsAndFeedback=
10]="ResultsAndFeedback";f[f.SubmissionStatusForTeacher=11]="SubmissionStatusForTeacher";f[f.GroupSubmission=12]="GroupSubmission";f[f.AnonymousSubmission=13]="AnonymousSubmission";f[f.PlagiarismControl=14]="PlagiarismControl";f[f.Mandatory=15]="Mandatory";f[f.PeerAssessment=16]="PeerAssessment";f[f.TestMode=17]="TestMode";f[f.WorkloadSetting=18]="WorkloadSetting"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){e[e.ShowCurrent=0]="ShowCurrent";e[e.ShowScheduled=1]="ShowScheduled";e[e.ShowExpired=2]="ShowExpired"})(e.BulletinsDisplayMode||(e.BulletinsDisplayMode={}));(function(e){e[e.Success=0]="Success";e[e.LightBulletinNotFound=1]="LightBulletinNotFound"})(e.GenericResponseCode||(e.GenericResponseCode={}));(function(e){e[e.Edit=0]="Edit";e[e.SetCommentsAvailability=1]="SetCommentsAvailability";e[e.ScheduleBulletin=2]="ScheduleBulletin";e[e.Delete=3]="Delete";e[e.ToggleSubscription=
4]="ToggleSubscription";e[e.ImmersiveReader=5]="ImmersiveReader"})(e.LightBulletinDropDownMenuActionType||(e.LightBulletinDropDownMenuActionType={}));(function(e){e[e.UnsubscribedManually=0]="UnsubscribedManually";e[e.Subscribed=1]="Subscribed";e[e.WasNotSubscribed=2]="WasNotSubscribed"})(e.PersonSubscriptionStatus||(e.PersonSubscriptionStatus={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Planner||(f.Planner={});f=f.ClientColumnType||(f.ClientColumnType={});f[f.RichText=0]="RichText";f[f.TopicTitle=1]="TopicTitle";f[f.TopicDescription=2]="TopicDescription";f[f.PlanDescription=3]="PlanDescription";f[f.PlanTitle=4]="PlanTitle";f[f.ClassHours=5]="ClassHours"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Planner||(f.Planner={});f=f.Dialogs||(f.Dialogs={});f=f.CopyDialogOverwriteAssessmentCriteriaState||(f.CopyDialogOverwriteAssessmentCriteriaState={});f[f.Show=0]="Show";f[f.Hide=1]="Hide";f[f.Disable=2]="Disable"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=e.CalendarControllerModels.EventValidationScope,b=function(){function a(a){var c=this;this.utility=a;this.currentChangesScope=d.None;this.changesDebouncer=new CCL.CallbackDebouncer(function(){return c.callChangesHandler()});this.setupStartEndDateTimeHandlers();this.setupRecurringHandlers()}a.prototype.setChangesHandler=function(a){this.changesHandler=a};a.prototype.callChangesHandler=function(){var a=this.currentChangesScope;this.currentChangesScope=d.None;
this.changesHandler(a)};a.prototype.setupStartEndDateTimeHandlers=function(){var a=this;this.utility.controls.startDateInput.add(this.utility.controls.startTimeInput).change(function(){a.onChanged(d.Default|a.getCourseApprovalScopeIfNeeded()|a.getBookingsAvailabilityScopeIfNeeded())});this.utility.controls.endDateInput.add(this.utility.controls.endTimeInput).change(function(){a.onChanged(d.Default|a.getBookingsAvailabilityScopeIfNeeded())})};a.prototype.setupRecurringHandlers=function(){var a=this;
this.utility.controls.recurringCheckbox.add(this.utility.controls.recurrenceEndDateInput).change(function(){a.onChanged(d.Default|a.getBookingsAvailabilityScopeIfNeeded())});this.utility.controls.repeatWeekCountSelect.add(this.utility.controls.repeatWeekDaysList).change(function(){return a.onChanged(a.getBookingsAvailabilityScopeIfNeeded())})};a.prototype.onChanged=function(a){this.changesHandler&&(this.currentChangesScope|=a,this.currentChangesScope!==d.None&&this.changesDebouncer.invokeCallback(void 0,
f.Utility.timeoutForValidationAfterDateShiftedMilliseconds))};a.prototype.getCourseApprovalScopeIfNeeded=function(){return this.utility.settings.AvailableFeatures.IsCalendarApprovalEnabled?d.CourseApproval:0};a.prototype.getBookingsAvailabilityScopeIfNeeded=function(){return this.utility.hasAnyBookingsSelected()?d.BookingsAvailability:0};return a}();f.ChangesAdapter=b})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Empty=0]="Empty";a[a.Single=1]="Single";a[a.Multiple=2]="Multiple"})(d||(d={}));var b=function(){function a(a){this.container=a.controls.FeedbackContainer;this.cssClasses=a.settings.CssClasses}a.prototype.addErrorMessage=function(a){switch(this.detectFeedbackType()){case d.Empty:this.createSingleError(a);break;case d.Single:var b=this.findSingleError(),c=b.text();c!==a&&b.replaceWith(this.createMultiErrorList([c,a]));break;case d.Multiple:0===
this.filterMultiErrors(a,this.findMultiErrors()).length&&this.findFeedbackError().find("ol").append($("<li>").text(a));break;default:throw Error("Unknown feedback type");}};a.prototype.removeErrorMessages=function(){this.findFeedbackError().remove()};a.prototype.createSingleError=function(a){this.createFeedbackError().append($("<div>").addClass(this.cssClasses.FeedbackText).text(a))};a.prototype.createMultiErrorList=function(a){for(var b=$("<ol>").addClass(this.cssClasses.NoBullet+" "+this.cssClasses.Margin0+
" "+this.cssClasses.Padding0),c=0;c<a.length;c++)b.append($("<li>").text(a[c]));return b};a.prototype.createFeedbackError=function(){return $("<div>").addClass(this.cssClasses.Feedback+" "+this.cssClasses.FeedbackError+" "+this.cssClasses.ClearFloat).append($("<i>").addClass(this.cssClasses.ImageContainer+" "+this.cssClasses.ExclamationCircle)).prependTo(this.container)};a.prototype.detectFeedbackType=function(){var a=this.findFeedbackError(),b=d.Empty;0<a.length&&(0<a.find("."+this.cssClasses.FeedbackText).length?
b=d.Single:0<a.find("ol").length&&(b=d.Multiple));return b};a.prototype.findFeedbackError=function(){return this.container.find("."+this.cssClasses.Feedback+"."+this.cssClasses.FeedbackError)};a.prototype.findSingleError=function(){return this.findFeedbackError().find("."+this.cssClasses.FeedbackText)};a.prototype.findMultiErrors=function(){return this.findFeedbackError().find("ol > li")};a.prototype.filterMultiErrors=function(a,b){return b.filter(function(b,c){return $(c).text()===a})};return a}();
e.FeedbackBuilder=b})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function b(a,b){this.utility=a;this.ajaxClient=b;this.setEventHandlersForBookings();this.updateBookingsAvailability();this.toggleBookingSection()}b.prototype.onDeleteBookingClick=function(a,b){b.IsNotAvailable?this.deleteBookingWithConfirmation(a,b):this.deleteBooking(a,b.BookableResourceId)};b.prototype.checkBookingsAvailability=function(a,b){var c=this;if(this.utility.controls.BookingsHolder.has("."+this.utility.settings.CssClasses.Statuses.Unknown).length)a();
else{var h=this.utility.getEventDateValidationInputModel(e.CalendarControllerModels.EventValidationScope.BookingsAvailability);0===h.SelectedBookingIds.length?a():this.ajaxClient.validateDateRelatedContent(h).done(this.createBookingsAvailabilityValidatedBeforeSubmitConfirmationHandler(h,a,b)).fail(function(){c.setBookingsAvailabilityUnknown();b()})}};b.prototype.setEventHandlersForBookings=function(){var a=this,b=function(){var b;a.utility.controls.allDateAndTimePickers.each(function(a,c){$(c).val()||
(b=!0)});return b};this.utility.controls.allDateAndTimePickers.blur(function(){b()&&a.setBookingsAvailabilityUnknown()});this.utility.controls.OpenBookDialogButton.click(function(){window[a.utility.settings.ClientInstanceNames.ResourceBookerDialog].openDialog()});$(this.utility.controls.AddBookingsButton).click(function(){a.bookingDialogAfterOkClick()});$(this.utility.controls.CancelBookingDialogButton).click(function(){CssModal.closeDialog()})};b.prototype.handleBookingsAvailabilityValidated=function(a){var b=
this;this.utility.controls.BookingsHolder.find("span."+this.utility.settings.CssClasses.TooltipLink).remove();if(a&&a.BookingAvailabilityMessageTooltipTemplates.length){var g=function(a){var c=h.utility.controls.BookingsHolder.find(CCL.CommonFunctions.getDataSelector(h.utility.settings.DataAttributes.BookingForEvent)).filter(function(c,g){return(c=$(g).data(b.utility.settings.DataAttributes.BookingForEvent))&&c.BookableResourceId===a.BookableResourceId});c.find("span."+h.utility.settings.CssClasses.StatusColor).removeClass().addClass(h.utility.settings.CssClasses.StatusColor).addClass(h.getStatusCssClass(a.Status)).prop("title",
h.getStatusToolTip(a.Status,c.hasClass(h.utility.settings.CssClasses.BookingItemReserved)));if(a.MessageTooltipTemplate&&h.utility.settings.InitToolTipFunctionName&&h.utility.settings.ToolTipAddDatasourceItemMethod){var g=$("<span/>").text(h.utility.settings.Terms.IsNotAvailableForAllDays),d=a.BookableResourceId.toString();c.append(g);window[h.utility.settings.ToolTipAddDatasourceItemMethod](d,"",CCL.CommonFunctions.formatString(a.MessageTooltipTemplate,c.find("span."+h.utility.settings.CssClasses.StatusText).html()));
window[h.utility.settings.InitToolTipFunctionName](g,d)}},h=this,d=0;for(a=a.BookingAvailabilityMessageTooltipTemplates;d<a.length;d++)g(a[d])}else this.setBookingsAvailabilityUnknown()};b.prototype.createBookingsAvailabilityValidatedBeforeSubmitConfirmationHandler=function(a,b,g){var c=this;return function(h){if(h&&h.EventBookingAvailabilityResponse)if(h=h.EventBookingAvailabilityResponse,h.Result)b();else{var d=h.Text;a&&a.IsRecurring&&(d+="<br />"+h.ResourceDetails);c.utility.openConfirmSubmitDialog(d,
function(a){return a?b():g()})}}};b.prototype.bookingDialogAfterOkClick=function(){var a=JSON.parse(this.utility.controls.EventBookingsBookedIdsHidden.val());this.utility.controls.EventBookingsReservedIdsHidden.val(JSON.stringify(window[this.utility.settings.ClientInstanceNames.ResourceBookerGrid].getSelectedIds().map(Number).filter(function(b){return-1===a.indexOf(b)})));this.toggleBookingSection();CssModal.closeDialog();this.refreshReservedBookingList()};b.prototype.updateBookingsAvailability=function(){var a=
this,b=this.utility.getEventDateValidationInputModel(e.CalendarControllerModels.EventValidationScope.BookingsAvailability);0<b.SelectedBookingIds.length&&this.ajaxClient.validateDateRelatedContent(b).done(function(b){b&&b.EventBookingAvailabilityResponse&&a.handleBookingsAvailabilityValidated(b.EventBookingAvailabilityResponse)})};b.prototype.getStatusCssClass=function(a){switch(a){case f.BookableResourceStatuses.Available:return this.utility.settings.CssClasses.Statuses.Available;case f.BookableResourceStatuses.PartlyBooked:return this.utility.settings.CssClasses.Statuses.PartlyBooked;
case f.BookableResourceStatuses.Booked:return this.utility.settings.CssClasses.Statuses.Booked;default:return this.utility.settings.CssClasses.Statuses.Unknown}};b.prototype.getStatusToolTip=function(a,b){var c=this.utility.settings.Terms.Tooltips;switch(a){case f.BookableResourceStatuses.Available:return b?c.ReservedButNotBooked:c.ResourceIsBookedByYou;case f.BookableResourceStatuses.PartlyBooked:return this.utility.settings.IsRecurring?c.ResourceIsNotAvailableForAllDays:c.ResourceIsAlreadyBookedForAPartOfEventTime;
case f.BookableResourceStatuses.Booked:return c.ResourceIsAlreadyBookedByOtherPerson;default:return""}};b.prototype.refreshReservedBookingList=function(){var a=this;this.ajaxClient.getBookingMarkups({reservedBookingIds:JSON.parse(this.utility.controls.EventBookingsReservedIdsHidden.val()),clientInstanceName:this.utility.settings.ClientInstanceNames.Page}).done(function(b){a.utility.controls.BookingsHolder.find("> span."+a.utility.settings.CssClasses.BookingItemReserved).remove();a.utility.controls.BookingsHolder.append(b.markups);
a.updateBookingsAvailability()})};b.prototype.toggleBookingSection=function(){this.utility.controls.BookingsPanel.toggle(0<JSON.parse(this.utility.controls.EventBookingsBookedIdsHidden.val()).length||0<JSON.parse(this.utility.controls.EventBookingsReservedIdsHidden.val()).length)};b.prototype.deleteBookingWithConfirmation=function(a,b){var c=this;CCL.CommonFunctions.jAjaxConfirm(CCL.CommonFunctions.formatString(this.utility.settings.Terms.DeleteBookingConfirmationTextTemplate,CCL.CommonFunctions.htmlEncode(b.NameForConfirmation)),
CCL.CommonFunctions.formatString(this.utility.settings.Terms.RemoveTooltipTemplate,b.NameForConfirmation),this.utility.settings.Terms.Ok,this.utility.settings.Terms.CancelButton,function(g){g&&c.deleteBooking(a,b.BookableResourceId)})};b.prototype.deleteBooking=function(a,b){this.removeBookingIdFromHiddenField(this.utility.controls.EventBookingsBookedIdsHidden,b);this.removeBookingIdFromHiddenField(this.utility.controls.EventBookingsReservedIdsHidden,b);a.parent().remove();this.toggleBookingSection()};
b.prototype.removeBookingIdFromHiddenField=function(a,b){if(a.val()){var c=JSON.parse(a.val());-1!==c.indexOf(b)&&(c.splice(c.indexOf(b),1),a.val(JSON.stringify(c)))}};b.prototype.setBookingsAvailabilityUnknown=function(){this.utility.controls.BookingsHolder.find("span."+this.utility.settings.CssClasses.StatusColor).addClass(this.utility.settings.CssClasses.Statuses.Unknown).prop("title","")};return b}();f.BookingWorker=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.fullCalendarWrapper=a;this.timeFormats=b;this.getIsoDateTime=function(a){return c.formatDate(a,c.timeFormats.LocalIsoFormat)};this.getFormattedDate=function(a,b){return c.formatDate(a,b)}}b.prototype.getEventFormattedDates=function(a,b){var c=a.getDate()!==b.getDate()||a.getMonth()!==b.getMonth()?this.timeFormats.twoDaysFormat:this.timeFormats.timeRangeFormat;return this.formatDates(a,b,c)};b.prototype.getEventFormattedDateAndTime=
function(a,b){var c=a.getDate()!==b.getDate()||a.getMonth()!==b.getMonth()?this.timeFormats.twoDaysFormat:this.timeFormats.DateAndTimeRangeFormat;return this.formatDates(a,b,c)};b.prototype.getShortDateTime=function(a){return this.formatDate(a,this.timeFormats.ShortDateAndTimeFormat)};b.prototype.getShortDate=function(a){return this.formatDate(a,this.timeFormats.shortDatePattern)};b.prototype.formatDate=function(a,b){return this.fullCalendarWrapper.formatDate(a,b)};b.prototype.formatDates=function(a,
b,g){return this.fullCalendarWrapper.formatDates(a,b,g)};return b}();e.DateFormatter=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a,c,g){var h=this;this.utilityBase=b;this.ajaxClientBase=a;this.datePickerClientInstanceName=c;this.timeSlotPickerClientInstanceName=g;$(function(){return h.getNextEventDatePicker().onDateSelectedFunction=function(a){return h.getNextEventTimeSlotPicker().updateFilteredTimeForDate(a.dateText,a.dateFilterId)}})}Object.defineProperty(d.prototype,"hasNextEvent",{get:function(){return 0<this.getNextEventId()},enumerable:!0,configurable:!0});d.prototype.getNextEventId=
function(){return parseInt(this.getNextEventTimeSlotPicker().getSelectedTimeSlotId(),10)||0};d.prototype.getNextEventDatePicker=function(){return window[this.datePickerClientInstanceName]};d.prototype.getNextEventTimeSlotPicker=function(){return window[this.timeSlotPickerClientInstanceName]};return d}();e.NextEventDateWorkerBase=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(b){function a(a,g){var c=this;b.call(this,a,g,a.settings.ClientInstanceNames.NextEventPicker,a.settings.ClientInstanceNames.NextEventTimeSlotPicker);this.utility=a;this.ajaxClient=g;$(function(){c.getNextEventDatePicker().getAvailableDatesFunction=function(a){return c.getAvailableDates(a)};c.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=function(a){return c.getAvailableTimeSlotsForDate(a)}})}__extends(a,b);a.prototype.setDefaultDate=
function(a){this.getNextEventDatePicker().setDefaultDate(a)};a.prototype.getAvailableDates=function(a){this.ajaxClient.getDatesOfEventsToBePickedAsNextEventForEditEventPage({courseId:this.utility.settings.LocationId,eventId:this.utility.settings.SingleActivityId,startDate:a.startDate,endDate:a.endDate,eventStopDateAsUserInputString:this.utility.controls.endDateInput.val(),eventStopTimeAsUserInputString:this.utility.controls.endTimeInput.val()}).done(function(b){return a.allowedDates=b})};a.prototype.getAvailableTimeSlotsForDate=
function(a){this.ajaxClient.getTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage({courseId:this.utility.settings.LocationId,eventId:this.utility.settings.SingleActivityId,date:a.date,eventStopDateAsUserInputString:this.utility.controls.endDateInput.val(),eventStopTimeAsUserInputString:this.utility.controls.endTimeInput.val()}).done(function(b){return a.availableTimeSlots=b})};return a}(e.NextEventDateWorkerBase);f.NextEventDateWorker=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b,h,e,f,k){this.utility=a;this.addEventElementLinkManager=new d.AddEventElementLinkManager(a,b,h,e,{onUploadFromComputer:k.onUploadFromComputer});this.editEventElementLinkManager=new d.EditEventElementLinkManager(a,b,h,f,k);this.initEventHandlers()}a.prototype.initEventHandlers=function(){$(document).on("click","."+this.utility.settings.cssClasses.AddResourceMenuLink,function(a){d.ElementLinkManagerDialogBase.currentManager.onAddResourceMenuItemLinkClick(a)})};return a}();
d.ElementLinkManagerFactory=b})(e.ElementLink||(e.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(a){function b(b,c,d){a.call(this,b,c,{inlineEditContainer:b.settings.cssClasses.Title},{isNotEditableTooltip:""});this.ajaxClient=d}__extends(b,a);b.prototype.buildMarkup=function(b,c,d,e){a.prototype.buildCommonMarkup.call(this,b,c,c.editable&&(d||0<c.EventTitle.length),this.utility.settings.cssClasses.TitleLabel,this.utility.settings.terms.Title,this.getEditorBinding(c,b),d,null,!1,!0,!1,e)};b.prototype.getTextContainerWatermark=
function(a){return this.utility.settings.terms.Title};b.prototype.getCachedText=function(a){return a.EventTitle};b.prototype.getCachedPlainText=function(a){return a.EventTitle};b.prototype.isPlainText=function(a){return!0};b.prototype.sendTextAjax=function(a,b,c){return this.ajaxClient.editEventTitle({EventId:a.activityId,Text:c,HasResources:this.checkEventHasAttachedResources(a,b)})};return b}(d.MarkupBuilderBase);d.TitleMarkupBuilder=b})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||
(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b,g){var c=this;this.getFullCalendar=a;this.getCalendar=b;this.eventSourceNames=g;this.handleChildrenCalendarsChange=function(){c.refetchSourceByName(c.eventSourceNames.childrenCalendars)};this.handleOtherCalendarsChange=function(){c.refetchSourceByName(c.eventSourceNames.otherCalendars)};this.handleResourcesCalendarsChange=function(){c.refetchSourceByName(c.eventSourceNames.resourceCalendars)}}b.prototype.addEventForSource=function(a,
b){this.getFullCalendar().fullCalendar("renderEventForSource",a,b)};b.prototype.addEventForSourceByName=function(a,b){b in this.getCalendar().eventSources&&(b=this.getCalendar().eventSources[b],this.addEventForSource(a,b));this.refetchSourceByName(this.eventSourceNames.otherCalendars);this.refetchSourceByName(this.eventSourceNames.childrenCalendars)};b.prototype.changeView=function(a){this.getFullCalendar().fullCalendar("changeView",a)};b.prototype.getDate=function(){return this.getFullCalendar().fullCalendar("getDate")};
b.prototype.getFirstDay=function(){return this.getFullCalendar().fullCalendar("option","firstDay")};b.prototype.getView=function(){return this.getFullCalendar().fullCalendar("getView")};b.prototype.getViewName=function(){return this.getView().name};b.prototype.refetchAll=function(){this.getFullCalendar().fullCalendar("refetchEvents")};b.prototype.refetchEvents=function(a,b){this.handleOtherCalendarsChange();this.handleChildrenCalendarsChange();a=this.getFullCalendar().fullCalendar("clientEvents",
a);0<a.length&&this.getCalendar().refetchEvents(a,b)};b.prototype.refetchSourceByName=function(a){a in this.getCalendar().eventSources&&(a=this.getCalendar().eventSources[a],this.getFullCalendar().fullCalendar("refetchSource",a))};b.prototype.removeEvent=function(a){this.getFullCalendar().fullCalendar("removeEvents",a)};b.prototype.removeEvents=function(a){this.getFullCalendar().fullCalendar("removeEvents",a)};b.prototype.render=function(){this.getFullCalendar().fullCalendar("render")};b.prototype.select=
function(a,b,g){this.getFullCalendar().fullCalendar("select",a,b,g)};b.prototype.unselect=function(){this.getFullCalendar().fullCalendar("unselect")};b.prototype.formatDate=function(a,b){return this.getFullCalendar().fullCalendar("formatDate",a,b)};b.prototype.formatDates=function(a,b,g){return this.getFullCalendar().fullCalendar("formatDates",a,b,g)};return b}();e.FullCalendarWrapper=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){this.utility=a}b.prototype.buildBookingsIcon=function(a,b){var c=document.createElement("span");c.classList.add(this.utility.settings.cssClasses.FcEventInlineIcon);c.title=CCL.CommonFunctions.formatString(this.utility.settings.terms.bookingsFormat,b);c.innerHTML=this.utility.settings.InlineIcons.Bookings;a.appendChild(c)};b.prototype.buildHideButtonIcon=function(a,b,g){var c=document.createElement("button");c.type="button";c.setAttribute("aria-label",
this.utility.settings.terms.Hide);c.onclick=g;c.appendChild(this.createImageNode(this.utility.settings.urls.informationFeedbackCloseImage,b,this.utility.settings.terms.Hide));a.appendChild(c)};b.prototype.buildAttendanceEventButton=function(a,b,g,h,d,e){void 0===d&&(d="");void 0===e&&(e=!1);var c=document.createElement("button");c.type="button";c.disabled=b;c.classList.add(this.utility.settings.cssClasses.EventInlineButton);c.title=g;c.setAttribute("aria-label",g);c.innerHTML=this.utility.settings.InlineIcons.RegisterAttendance;
d&&0<d.length&&(g=document.createElement("span"),g.classList.add(this.utility.settings.cssClasses.EventAttendanceButtonText),g.appendChild(document.createTextNode(d)),c.insertBefore(g,c.firstChild));!b&&h&&c.addEventListener("click",h);e?(b=document.createElement("span"),b.classList.add(this.utility.settings.cssClasses.FcEventInlineButton),b.appendChild(c),a.appendChild(b)):a.appendChild(c)};b.prototype.buildColorIcon=function(a){void 0===a&&(a="");var b=document.createElement("span");a&&b.classList.add(a);
b.classList.add(this.utility.settings.cssClasses.EventItemColor);return b};b.prototype.replaceColorIcon=function(a,b){a.className=this.utility.settings.cssClasses.EventItemColor+" "+b};b.prototype.buildDeleteEventButton=function(a){var b=document.createElement("button");b.type="button";b.classList.add(a?this.utility.settings.cssClasses.MarginRight10:this.utility.settings.cssClasses.MarginRight15);b.title=this.utility.settings.terms.deleteEventTooltip;b.setAttribute("aria-label",this.utility.settings.terms.deleteEventTooltip);
b.innerHTML=this.utility.settings.InlineIcons.Trashcan;a&&b.setAttribute("data-eventdetails-delete","");return b};b.prototype.buildCopyIcon=function(a){a.innerHTML=this.utility.settings.InlineIcons.Copy;a.title=this.utility.settings.terms.CopyEvent;a.setAttribute("aria-label",this.utility.settings.terms.CopyEvent);return a};b.prototype.buildEditEventIcon=function(a,b,g,h){var c=document.createElement("a");c.innerHTML=this.utility.settings.InlineIcons.Edit;c.classList.add(b);c.setAttribute("href",
g);c.title=this.utility.settings.terms.editEventTooltip;c.setAttribute("aria-label",this.utility.settings.terms.editEventTooltip);a.appendChild(c);h&&c.addEventListener("click",h)};b.prototype.buildGroupIcon=function(a,b,g){var c=document.createElement("span");c.classList.add(this.utility.settings.cssClasses.FcEventInlineIcon);c.innerHTML=this.utility.settings.InlineIcons.Users;c.setAttribute("alt",this.utility.settings.terms.group);c.title=b?this.utility.settings.terms.group:this.utility.settings.terms.group+
": ("+g+")";a.appendChild(c);b&&(b=document.createElement("span"),b.classList.add(this.utility.settings.cssClasses.ColorGrey),b.classList.add(this.utility.settings.cssClasses.EventItemIconText),b.textContent=g,a.appendChild(b))};b.prototype.buildHomeworkIcon=function(a){var b=document.createElement("span");b.classList.add(this.utility.settings.cssClasses.FcEventInlineIcon);b.title=this.utility.settings.terms.homeworkIconToolTip;b.innerHTML=this.utility.settings.InlineIcons.Homework;a.appendChild(b)};
b.prototype.buildLockIcon=function(a,b,g){var c=document.createElement("span");c.classList.add(this.utility.settings.cssClasses.LockIcon);c.innerHTML=this.utility.settings.InlineIcons.Lock;b?(b=document.createElement("span"),b.textContent=g,g=document.createElement("div"),g.classList.add(this.utility.settings.cssClasses.LockInformationContainer),g.appendChild(c),g.appendChild(b),a.insertBefore(g,a.firstChild)):a.insertBefore(c,a.firstChild)};b.prototype.buildPlannerButtonIcon=function(a,b,g){var c=
document.createElement("button");c.type="button";c.title=b;c.classList.add(this.utility.settings.cssClasses.EventInlineButton);c.addEventListener("click",g);c.innerHTML=this.utility.settings.InlineIcons.Plans;b=document.createElement("span");b.classList.add(this.utility.settings.cssClasses.FcEventInlineButton);b.appendChild(c);a.appendChild(b)};b.prototype.buildRecurringIcon=function(a){var b=this.createImageNode(this.utility.settings.urls.recurringImageUrl,this.utility.settings.constants.IconSize,
this.utility.settings.terms.recurringTooltip);b.classList.add(this.utility.settings.cssClasses.VerticalAlignMiddle);b.classList.add(this.utility.settings.cssClasses.MarginLeft5);a.appendChild(b)};b.prototype.createImageNode=function(a,b,g){var c=document.createElement("img");c.src=a;c.width=b;c.height=b;c.alt="";c.title=g;return c};return b}();e.IconBuilder=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b,h,e,f,k,n,p,r,u){this.utility=a;this.dateFormatter=b;this.showInformationFeedbackForContextDialog=h;this.toggleEventSettings=e;this.extraDescriptionMarkupBuilder=f;this.nextEventMarkupBuilder=new d.NextEventMarkupBuilder(this.utility,this.dateFormatter);this.addEventDialogNextEventDateWorker=new d.AddEventDialogNextEventDateWorker(this.utility,k,n,r);this.editEventDialogNextEventDateWorker=new d.EditEventDialogNextEventDateWorker(this.utility,
k,u)}a.prototype.initNextEventForAddDialog=function(){var a=this;this.setOnChangeDatePickerEvent(this.utility.controls.NextEvent.AddEventDatePickerContainer,this.addEventDialogNextEventDateWorker);this.utility.controls.NextEvent.AddEventDatePickerButton.one("click",function(){$(a.addEventDialogNextEventDateWorker.getNextEventDatePicker()).on(a.utility.settings.constants.NextEventDateSetEventName,function(){a.utility.controls.addEventCalendarsDropdown.is(":disabled")||a.toggleEventSettings(!0)});$(a.addEventDialogNextEventDateWorker.getNextEventDatePicker()).on(a.utility.settings.constants.NextEventDateClearedEventName,
function(){a.utility.controls.addEventCalendarsDropdown.is(":disabled")&&a.toggleEventSettings(!1)})})};a.prototype.buildContainerForEditEvent=function(a,b,h){var c=this,g=a.editable&&!h,d=a.showExtraDescription&&(0<a.NextEventId||g);(a.showExtraDescription&&(a.extraDescription||g)||d)&&this.extraDescriptionMarkupBuilder.buildMarkup(b,a,!h,function(){d&&(c.nextEventMarkupBuilder.buildMarkup(b,g,a),g&&c.initializeNextEventHandlers(a))})};a.prototype.isEditDialogEditMode=function(){return this.editEventDialogNextEventDateWorker.isInEditMode()};
a.prototype.initializeNextEventHandlers=function(a){this.editEventDialogNextEventDateWorker.nextEventQueryArgs={nextEvent:{eventId:a.NextEventId,eventStart:a.NextEventStart},courseId:a.courseId,eventId:a.activityId,eventStopDateTimeAsIsoString:JSON.stringify(this.dateFormatter.getIsoDateTime(a.end))};var b=this.utility.controls.NextEvent.EditEventDatePickerContainer.find("."+this.utility.settings.cssClasses.DatePickerInput),c=this.editEventDialogNextEventDateWorker.getNextEventDatePicker();this.utility.controls.NextEvent.EditEventDatePickerContainer.find(".ui-datepicker-trigger").remove();
b.removeClass("hasDatepicker");c.initialize();this.editEventDialogNextEventDateWorker.getNextEventTimeSlotPicker().initialize();0<a.NextEventId&&this.editEventDialogNextEventDateWorker.setDateTimePickerValues();this.setOnChangeDatePickerEvent(this.utility.controls.NextEvent.EditEventDatePickerContainer,this.editEventDialogNextEventDateWorker);if(a.recurring)this.utility.controls.NextEvent.EditEventDatePickerButton.on("click",this.showInformationFeedbackForContextDialog)};a.prototype.setOnChangeDatePickerEvent=
function(a,b){var c=this;a.on("change","input, select",function(){return c.updateDateTimeLabel(b)})};a.prototype.updateDateTimeLabel=function(a){var b=a.getNextEventTimeSlotPicker().getSelectedTimeSlot();a.getDatePickerButton().find("."+this.utility.settings.cssClasses.NextEventButtonText).text(b?this.dateFormatter.getEventFormattedDateAndTime(CCL.SerializableDateTimeConverter.toDateWithSeconds(b.EventStartLocal),CCL.SerializableDateTimeConverter.toDateWithSeconds(b.EventStopLocal)):this.utility.settings.terms.PickDate)};
return a}();d.NextEventManager=b})(e.NextEvent||(e.NextEvent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a,c){var g=this;this.utility=b;this.container=a;this.inputValidatorParameters=c;this.modernInput=new CCL.ModernInput({EditorTextarea:this.utility.cssClassesBase.ModernInputTextEditor,TextIsValid:this.utility.cssClassesBase.ModernInputTextIsValid},{TextValidationErrorMessage:this.utility.dataAttributeNames.InputValidationMessage});var h=a.find("textarea, input").first();if(h.length){var e=new CCL.CallbackDebouncer(function(){return h.val(d.cleanUpLineBreaks(h.val()))});
h.on("input",function(){return g.validateOnInput(h)}).on("paste",function(){return e.invokeCallback(void 0,50)})}}d.cleanUpInputValue=function(b){return b?d.cleanUpLineBreaks(b).replace(/\s{2,}/g," ").trim():""};d.prototype.createValidationMessageContainer=function(){$("<span>").addClass(this.inputValidatorParameters.errorMessageClass).attr("data-"+this.utility.dataAttributeNames.InputValidationMessage,"").appendTo(this.container)};d.prototype.resetValidation=function(){this.validate(!0)};d.cleanUpLineBreaks=
function(b){return b.replace(/\r?\n/g,"")};d.prototype.validateOnInput=function(b){b=this.inputValidatorParameters.inputValidationFunction(d.cleanUpInputValue(b.val()));this.validate(b)};d.prototype.validate=function(b){this.modernInput.toggleTextError(this.container.parent(),this.inputValidatorParameters.errorMessageText,!b);if(this.inputValidatorParameters.onValidateFunction)this.inputValidatorParameters.onValidateFunction(b)};return d}();e.InputValidator=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));var UploadStatus;(function(f){f[f.Awaiting=0]="Awaiting";f[f.InProgress=1]="InProgress";f[f.Succeeded=2]="Succeeded";f[f.SucceededWithErrors=3]="SucceededWithErrors";f[f.Failed=4]="Failed"})(UploadStatus||(UploadStatus={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.settings=b;this.handleSubmitButtonBehaviour=function(b){a.lockSubmitButton(b===UploadStatus.InProgress)};this.isUploaderDirty=function(){var b=window[a.settings.ClientIds.UploaderControl];return!!b&&0<b.uploadedItems.uploadMetadataArray.length+b.uploadedItems.fileInCloudMetadataArray.length};window[b.ClientInstanceName]=this;this.$form=$("#"+this.settings.ClientIds.PageForm);this.$submitButton=$("#"+this.settings.ClientIds.SubmitButton);
this.$cancelButton=$("#"+this.settings.ClientIds.CancelButton);this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.$form,this.settings.Terms.BeforeUnloadWarningMessage,{cancelButtonId:this.settings.ClientIds.CancelButton,callback:this.isUploaderDirty});this.lockSubmitButton(!1)}d.prototype.lockSubmitButton=function(b){this.$submitButton.toggleHyperlink(!b)};return d}();e.EditPortfolioItemControl=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.input=b;this.serialize=a}Object.defineProperty(d.prototype,"dateValue",{get:function(){return this.date},set:function(b){this.date=b;this.input.val(this.serialize(b))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"stringValue",{get:function(){return this.input.val()},enumerable:!0,configurable:!0});return d}();e.DateInputWrapper=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(a){function b(b,c,d){a.call(this,b,c,{inlineEditContainer:b.settings.cssClasses.Description},{isNotEditableTooltip:b.settings.terms.eventDescriptionNotEditableTooltip});this.ajaxClient=d}__extends(b,a);b.prototype.buildMarkup=function(b,c,d,e){void 0===e&&(e=null);a.prototype.buildCommonMarkup.call(this,b,c,c.editable||!!e||c.PreviousEvent.ExtraDescription&&0<c.PreviousEvent.ExtraDescription.length&&0<c.description.length,this.utility.settings.cssClasses.DescriptionLabel,
this.utility.settings.terms.DescriptionLabel,this.getEditorBinding(c,b),d,e,!0)};b.prototype.getTextContainerWatermark=function(a){return 0===a.courseId?this.utility.settings.terms.otherEventDescriptionWatermark:this.utility.settings.customerSettings.enableFrenchCalendarLayout?this.utility.settings.terms.courseEventPastDescriptionWatermark:this.utility.settings.terms.courseEventDescriptionWatermark};b.prototype.getCachedText=function(a){return a.description};b.prototype.getCachedPlainText=function(a){return a.descriptionPlainText};
b.prototype.isPlainText=function(a){return a.isPlainTextInDescription};b.prototype.sendTextAjax=function(a,b,c){return this.ajaxClient.editEventDescription({EventId:a.activityId,Text:c,HasResources:this.checkEventHasAttachedResources(a,b)})};return b}(d.MarkupBuilderBase);d.DescriptionMarkupBuilder=b})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(a){function b(b,c,d){a.call(this,b,c,{inlineEditContainer:b.settings.cssClasses.DescriptionExtra},{isNotEditableTooltip:b.settings.terms.eventExtraDescriptionNotEditableTooltip});this.ajaxClient=d}__extends(b,a);b.prototype.buildMarkup=function(b,c,d,e){a.prototype.buildCommonMarkup.call(this,b,c,c.editable||0<c.NextEventId||0<c.extraDescription.length,this.utility.settings.cssClasses.DescriptionExtraHeader,this.utility.settings.terms.extraDescriptionLabel,
this.getEditorBinding(c,b),d,e,!0)};b.prototype.buildPreviousExtraDescriptionMarkup=function(a,b,c,d){var g=document.createElement("div");g.classList.add(this.utility.settings.cssClasses.PreviousEventContainer);g.classList.add(this.utility.settings.cssClasses.UserInput);if(b){this.buildSectionTitle(a,this.utility.settings.cssClasses.PreviousEventExtraDescriptionLabel,this.utility.settings.terms.PreviousEventExtraDescriptionLabel);var h=document.createElement("div");h.classList.add(this.utility.settings.cssClasses.PreviousEventExtraDescription);
h.innerHTML=b;g.appendChild(h)}b=document.createElement("div");b.classList.add(this.utility.settings.cssClasses.PreviousEventDateLabel);d?(d=document.createElement("p"),d.innerText=c,c=document.createElement("p"),c.innerText=this.utility.settings.terms.CannotPreviewOrEditPreviousEvent,b.appendChild(d),b.appendChild(c)):b.innerText=c;g.appendChild(b);a[0].appendChild(g)};b.prototype.buildOpenPreviousEventButton=function(a,b,c){var g=document.createElement("button");g.type="button";g.classList.add(this.utility.settings.cssClasses.Button);
g.classList.add(this.utility.settings.cssClasses.PreviousEventEditButton);g.innerText=b;g.addEventListener("click",c);a.appendChild(g)};b.prototype.getTextContainerWatermark=function(a){return this.utility.settings.terms.courseEventFutureDescriptionWatermark};b.prototype.getCachedText=function(a){return a.extraDescription};b.prototype.getCachedPlainText=function(a){return a.extraDescriptionPlainText};b.prototype.isPlainText=function(a){return a.isPlainTextInExtraDescription};b.prototype.sendTextAjax=
function(a,b,c){return this.ajaxClient.editEventExtraDescription({EventId:a.activityId,Text:c,HasResources:this.checkEventHasAttachedResources(a,b)})};return b}(d.MarkupBuilderBase);d.ExtraDescriptionMarkupBuilder=b})(e.EventTextContent||(e.EventTextContent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.Calendar||(f.Calendar={});f=f.Schedule||(f.Schedule={});f=f.EventDetailsType||(f.EventDetailsType={});f[f.ListView=1]="ListView";f[f.ContextDialog=2]="ContextDialog"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){this.utility=a;this.combinedClasses={expandableSection:this.utility.settings.cssClasses.ExpandableContainer+" "+this.utility.settings.cssClasses.ExpandableSection,expandableHeaderArrowCollapsed:this.utility.settings.cssClasses.Icon+" "+this.utility.settings.cssClasses.IconArrowForward+" "+this.utility.settings.cssClasses.IconColorDefault,expandableHeaderArrowExpanded:this.utility.settings.cssClasses.Icon+" "+this.utility.settings.cssClasses.IconArrowDown+
" "+this.utility.settings.cssClasses.IconColorDefault}}b.prototype.buildExpandableContainer=function(a,b,g,h,d){var c=this;h=(void 0===h?{}:h).isExpanded;h=void 0===h?!1:h;b=$("<section>").addClass(this.combinedClasses.expandableSection).append($("<div>").addClass(this.utility.settings.cssClasses.ExpandableContainerHeader).append($("<i>").addClass(h?this.combinedClasses.expandableHeaderArrowExpanded:this.combinedClasses.expandableHeaderArrowCollapsed)).append($("<span>").append(b))).append($("<div>").addClass(this.utility.settings.cssClasses.ExpandableContainerContent).append(g));
a.append(b);return new ExpandableContainer(b,{isExpanded:h,onToggleCallback:function(a,b){b.find(c.utility.selectors.expandableContainerHeaderIcon).toggleClass(c.utility.settings.cssClasses.IconArrowForward,!a).toggleClass(c.utility.settings.cssClasses.IconArrowDown,a);d&&d()}})};return b}();e.ExpanderBuilder=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.tooltip=a;this.controls=b;this.topTooltipSettings={My:"center bottom",At:"center top-10",Arrow:"top"};this.rightTooltipSettings={My:"left center",At:"right+10 center",Arrow:"right"};this.openTooltip=function(){return c.tooltip.openTooltip(c.controls.HoverTarget,c.isTooltipTopOriented?c.topTooltipSettings:c.rightTooltipSettings)}}Object.defineProperty(b.prototype,"isTooltipTopOriented",{get:function(){return!0},
enumerable:!0,configurable:!0});b.prototype.closeTooltip=function(){this.tooltip.closeTooltip()};return b}();e.TooltipToggler=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(b){function a(){var a=this;b.apply(this,arguments);this.beginOpenTooltip=function(){a.clearTimeouts();a.openTimeout=setTimeout(a.openTooltip,200)};this.beginCloseTooltip=function(){a.clearTimeouts();a.closeTimeout=setTimeout(function(){return a.closeTooltip()},1E3)}}__extends(a,b);a.prototype.beginListeningTooltipEvents=function(){this.clearTimeouts();this.controls.HoverTarget.on("mouseover",this.beginOpenTooltip);this.controls.HoverTarget.on("mouseleave",
this.beginCloseTooltip)};a.prototype.endListeningTooltipEvents=function(){this.clearTimeouts();this.controls.HoverTarget.off("mouseover",this.beginOpenTooltip);this.controls.HoverTarget.off("mouseleave",this.beginCloseTooltip)};a.prototype.clearTimeouts=function(){clearTimeout(this.openTimeout);clearTimeout(this.closeTimeout)};return a}(e.TooltipToggler);e.TooltipTogglerForMouseDevice=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(b){function a(){var a=this;b.apply(this,arguments);this.toggleTooltipMobile=function(b){$.contains(a.controls.HoverTarget.get(0),b.target)?a.openTooltip():a.closeTooltip()};this.onDeviceOrientationChanged=function(){return a.closeTooltip()}}__extends(a,b);Object.defineProperty(a.prototype,"toggleEventName",{get:function(){return CCL.CommonFunctions.isIosDevice()?"touchend":"click"},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"isTooltipTopOriented",{get:function(){return window.innerHeight>window.innerWidth},enumerable:!0,configurable:!0});a.prototype.beginListeningTooltipEvents=function(){$(document).on(this.toggleEventName,this.toggleTooltipMobile);$(window).on("orientationchange",this.onDeviceOrientationChanged)};a.prototype.endListeningTooltipEvents=function(){$(document).off(this.toggleEventName,this.toggleTooltipMobile);$(window).off("orientationchange",this.onDeviceOrientationChanged)};return a}(e.TooltipToggler);
e.TooltipTogglerForTouchDevice=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.controls=a;this.toggleControl=function(){c.tooltipToggler.closeTooltip();c.isRecurringChecked?(c.controls.HoverTarget.show(),c.tooltipToggler.beginListeningTooltipEvents()):(c.controls.HoverTarget.hide(),c.tooltipToggler.endListeningTooltipEvents())};b=new CCL.CustomTooltip("CalendarEditEventAddElementButtonDisabledTooltip",{contentContainer:this.controls.Content,zIndex:1},b.CustomTooltipCssClasses);this.tooltipToggler=
CCL.CommonFunctions.isMobileDevice()?new e.TooltipTogglerForTouchDevice(b,a):new e.TooltipTogglerForMouseDevice(b,a);this.controls.Content.show();this.toggleControl();this.controls.RecurringCheckbox.change(this.toggleControl)}Object.defineProperty(b.prototype,"isRecurringChecked",{get:function(){return this.controls.RecurringCheckbox.is(":checked")},enumerable:!0,configurable:!0});return b}();e.AddElementButtonDisabledTooltip=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b,a,c,g,h,d,e){this.dataAttributeNames=b;this.cssClassesBase=a;this.terms=c;this.clientInstanceNamesBase=g;this.postMessageNames=h;this.controlsBase=d;this.constants=e;this.dataAttributes=this.initDataAttributesCommon();this.selectors=this.initSelectorsCommon()}d.prototype.initSelectorsCommon=function(){return{addElementButton:"."+this.cssClassesBase.AddElementButton,elementExternalSourceComputer:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementExternalSource,f.AddResourceMenu.ElementExternalSourceType.Computer),
elementListContainer:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainer),elementListContainerHomework:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListContainerHomework),elementListCount:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListCount),elementListItem:CCL.CommonFunctions.getDataSelector(this.dataAttributeNames.ElementListItem)}};d.prototype.initDataAttributesCommon=function(){return{elementListContainer:"data-"+this.dataAttributeNames.ElementListContainer,
elementListContainerHomework:"data-"+this.dataAttributeNames.ElementListContainerHomework,elementListCount:"data-"+this.dataAttributeNames.ElementListCount,elementListItem:"data-"+this.dataAttributeNames.ElementListItem}};d.prototype.getElementForEventData=function(b){return b.data(this.dataAttributeNames.ElementListItem)};d.prototype.getElementExternalSourceType=function(b){return b.data(this.dataAttributeNames.ElementExternalSource)};d.prototype.getContentElementType=function(b){return b.data(this.dataAttributeNames.ContentElementType)};
d.prototype.getAddResourceMenuParameters=function(b){return b.data(e.CalendarClientConstants.dataAttributeNames.addResourceMenuParameters)};d.prototype.getElementId=function(b){return this.getElementForEventData(b).ElementId};d.prototype.getElementByElementId=function(b){return $("["+this.dataAttributes.elementListItem+'*=\'"ElementId":'+b+",']")};d.prototype.getAddedElementsCount=function(b){return b.find(this.selectors.elementListItem).length};d.prototype.toggleElementActivation=function(b){this.getElementByElementId(b).find("."+
this.cssClassesBase.ElementListTitle).toggleClass(this.cssClassesBase.ElementItemInactive)};d.prototype.toggleCalendarDropdown=function(b){var a=b.enabled?"":this.terms.CannotChangeCalendarBecauseOfNextEventTooltip;b.calendarDropdown.prop("disabled",!b.enabled);b.calendarDropdown.prop("title",a)};return d}();e.CalendarUtilityBase=k})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=e.CalendarControllerModels.EventValidationScope,b=function(a){function b(b,c){a.call(this,b.DataAttributes,b.CssClasses,b.Terms,b.ClientInstanceNames,b.PostMessageNames,c,b.CalendarClientConstants);this.settings=b;this.controls=c}__extends(b,a);b.prototype.getEventDateValidationInputModel=function(a){var b=this,c=this.getEventSettingsRecurring(),g=this.parseJsonIntList(this.controls.EventBookingsBookedIdsHidden.val()),e=this.parseJsonIntList(this.controls.EventBookingsReservedIdsHidden.val()),
f=this.settings.SingleActivityId,k=0;this.getWeekDayCheckboxes().each(function(a,c){a=$(c);a.is(":checked")&&(c=CCL.CommonFunctions.getDataSelector(b.settings.DataAttributes.WeekDayEnumValue),a=a.closest(c),k+=parseInt(a.data(b.settings.DataAttributes.WeekDayEnumValue),10))});var r=(a&d.BookingsAvailability)===d.BookingsAvailability;return{ValidationScope:a,StartDate:this.controls.startDateInput.val(),StartTime:this.controls.startTimeInput.val(),StopDate:this.controls.endDateInput.val(),StopTime:this.controls.endTimeInput.val(),
CourseId:this.settings.LocationId,RecurrenceEndDate:c.RecurrenceEndDate,IsRecurring:c.IsRecurring,IsSingle:!c.IsRecurring,WasIsSingle:this.settings.WasIsSingle,RepeatWeekCount:this.controls.repeatWeekCountSelect.val()||"0",WeekDaysEnumValue:k,SelectedBookingIds:""+$.merge(g,e),HidePartlyBookedBookingsForRecurringEvent:r&&0!==f,EventId:f}};b.prototype.getEventSettingsRecurring=function(){return{StartDate:this.controls.startDateInput.val(),RecurrenceEndDate:0<this.controls.recurrenceEndDateInput.length?
this.controls.recurrenceEndDateInput.val():"",IsRecurring:this.controls.recurringCheckbox.is(":checked")}};b.prototype.getWeekDayCheckboxes=function(){this.weekDayCheckboxes||(this.weekDayCheckboxes=this.controls.repeatWeekDaysList.find("input:checkbox"));return this.weekDayCheckboxes};b.prototype.isBookingsHandlingNeeded=function(){return this.settings.EnableBookings||this.hasAnyBookingsSelected()};b.prototype.hasAnyBookingsSelected=function(){return 0<this.parseJsonIntList(this.controls.EventBookingsBookedIdsHidden.val()).length||
0<this.parseJsonIntList(this.controls.EventBookingsReservedIdsHidden.val()).length};b.prototype.openConfirmSubmitDialog=function(a,b){CCL.CommonFunctions.jAjaxConfirm(a,this.settings.Terms.ConfirmationDialogTitle,this.settings.Terms.Ok,this.settings.Terms.CancelButton,b)};b.prototype.parseJsonIntList=function(a){return JSON.parse(a||"[]")};b.timeoutForDatesIntervalShiftingMilliseconds=200;b.timeoutForValidationAfterDateShiftedMilliseconds=b.timeoutForDatesIntervalShiftingMilliseconds+100;return b}(e.CalendarUtilityBase);
f.Utility=b})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.utilityBase=b;this.toggleSectionByItemCount=function(b){var c=b.getElementsByClassName(a.utilityBase.cssClassesBase.ElementList).item(0);b.style.display=c&&c.hasChildNodes()?"":"none"}}d.prototype.getFakeElement=function(){return $("#"+this.utilityBase.constants.FakeElementItemId)};d.prototype.getCurrentFakeElementTitle=function(){return this.getFakeElement().find("."+this.utilityBase.cssClassesBase.ElementListTitle).text()};
d.prototype.hasFakeElement=function(){return this.getFakeElement().is(":visible")};d.prototype.removeElement=function(b,a){var c=this;void 0===a&&(a=void 0);var g=b.closest(this.elementListSelector);b.slideUp(e.CalendarClientConstants.animationSpeedMilliseconds,function(){b.remove();c.afterRemoveElement(g,a)})};d.prototype.buildFakeElementMarkup=function(b){var a=document.createElement("li");a.id=this.utilityBase.constants.FakeElementItemId;a.setAttribute(this.utilityBase.dataAttributes.elementListItem,
"");var c=this.utilityBase.controlsBase.LoadingWheel;c.style.display="";var g=document.createElement("div");g.classList.add(this.utilityBase.cssClassesBase.ElementListItemContainer);var h=document.createElement("span");h.classList.add(this.utilityBase.cssClassesBase.ElementListTitle);h.classList.add(this.utilityBase.cssClassesBase.FontItalic);h.textContent=CCL.CommonFunctions.htmlEncode(b);g.appendChild(c);g.appendChild(h);a.appendChild(g);return a};d.prototype.buildElementListSectionMarkup=function(){return'<ul class="'+
this.utilityBase.cssClassesBase.ElementList+" "+this.utilityBase.cssClassesBase.GenericList+'" />'};d.prototype.afterRemoveElement=function(b,a){0===this.utilityBase.getAddedElementsCount(b)&&b.slideUp();a&&a()};return d}();e.ElementListMarkupBuilderBase=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(b){function a(a){b.call(this,a);this.utility=a;this.elementListSelector=this.utility.selectors.elementListContainer}__extends(a,b);a.prototype.buildElementListMarkup=function(a){0<a.ResourceCount&&this.utility.controls.ElementListSection.get(0).insertAdjacentHTML("beforeEnd",a.Resources);this.utility.settings.IsAddingHomeworkElementsEnabled&&0<a.HomeworkCount&&this.utility.controls.HomeworkElementListSection.get(0).insertAdjacentHTML("beforeEnd",
a.Homework)};a.prototype.addFakeItemIntoElementSection=function(a){a=this.buildFakeElementMarkup(a);var b=this.utility.controls.ElementListSection.get(0),c=b.getElementsByClassName(this.utility.cssClassesBase.ElementList);c.length||(b.insertAdjacentHTML("beforeEnd",this.buildElementListSectionMarkup()),c=b.getElementsByClassName(this.utility.cssClassesBase.ElementList));c[0].insertAdjacentHTML("beforeEnd",a.outerHTML);"none"===b.style.display&&(b.style.display="")};a.prototype.removeFakeItemFromElementSection=
function(){this.getFakeElement().remove();this.toggleSectionByItemCount(this.utility.controls.ElementListSection.get(0))};a.prototype.toggleAddResourceButtonAndSections=function(a){this.toggleAddButton(a);this.toggleSectionByItemCount(this.utility.controls.ElementListSection.get(0));this.utility.settings.IsAddingHomeworkElementsEnabled&&this.toggleSectionByItemCount(this.utility.controls.HomeworkElementListSection.get(0))};a.prototype.afterRemoveElement=function(a,g){var c=this;b.prototype.afterRemoveElement.call(this,
a,function(){c.toggleAddButton();g&&g()})};a.prototype.toggleAddButton=function(a){void 0===a&&(a=void 0);a=a||this.utility.getAddedElementsCount($(document));$(this.utility.selectors.addElementButton).toggle(a<this.utility.constants.MaxCountOfAddedElements)};return a}(e.ElementListMarkupBuilderBase);f.ElementListMarkupBuilder=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a,c,g){void 0===g&&(g=3);this.targetContainer=b;this.dotContainerCssClass=a;this.dotsCssClass=c;this.dotsCount=g;a=$("<div>").addClass(this.dotContainerCssClass);for(c=0;c<g;c++)a.append($("<div>").addClass(this.dotsCssClass));b.append(a)}d.prototype.removeDotContainer=function(){this.targetContainer.find("."+this.dotContainerCssClass).remove()};return d}();e.CalendarBouncingDots=f})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb=
{}));(function(f){f=f.Calendar||(f.Calendar={});f=f.CalendarClientConstants||(f.CalendarClientConstants={});f.animationSpeedMilliseconds=500;f.dataAttributeNames={addResourceMenuParameters:"add-resource-menu-parameters"};f.alternativeChoiceDialogOffsetY=-7;f.uploadingFileTimeoutMilliseconds=400})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(a){function b(b,c,d){a.call(this,b);this.utility=b;this.expanderBuilder=c;this.callbackOnSectionToggle=d;this.enableElementLinkManagement=!0;this.elementListSelector=this.utility.selectors.expandableContainer}__extends(b,a);b.prototype.renderAddButtonWithElementSections=function(a,b,c){this.enableElementLinkManagement=b.enableElementLinkManagement&&c!==f.EventDetailsType.ListView;c=a.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);
0===c.length&&(c=this.generateElementListAppendTarget(),a.append(c));this.enableElementLinkManagement&&!a.find("#calendar-add-menu").length&&c.before($('<div id="calendar-add-menu" data-course-id="'+b.courseId+'">').addClass(this.utility.settings.cssClasses.MarginTop10).addClass(this.utility.settings.cssClasses.AddElementButton));this.renderElementList(c,b.elementListMarkups)};b.prototype.generateElementListAppendTarget=function(){return $("<div>").addClass(this.utility.settings.cssClasses.SelectedElementListAppendTarget)};
b.prototype.generateAttachedElementsHidden=function(){return $("<input>").attr(this.utility.selectors.addEventDialogAttachedElementsHidden,"").prop("type","hidden").prop("value","[]")};b.prototype.addFakeItemIntoElementSection=function(a,b){a=this.buildFakeElementMarkup(a);b=this.utility.getElementListAppendTarget(b);var c=b.find(this.utility.selectors.elementListContainer),g=c.find("."+this.utility.cssClassesBase.ElementList);g.length?(g.append(a),a=this.utility.getExpandableContainer(c),a.is(":visible")||
a.show(),this.updateHeaderCounter(a)):(c=document.createElement("ul"),c.classList.add(this.utility.settings.cssClasses.ElementList),c.classList.add(this.utility.settings.cssClasses.GenericList),c.innerHTML=a.outerHTML,this.buildResourceListMarkup(b,{Homework:"",HomeworkCount:0,Resources:c.outerHTML,ResourceCount:1}))};b.prototype.removeFakeItemFromElementSection=function(){var a=this,b=this.getFakeElement(),c=b.closest("."+this.utility.cssClassesBase.ElementList);b.remove();if(c.length){var d=this.utility.getExpandableContainer(c);
setTimeout(function(){a.updateHeaderCounter(d);a.toggleSectionByItemCount(d.get(0))},e.CalendarClientConstants.uploadingFileTimeoutMilliseconds)}};b.prototype.renderElementList=function(a,b){b&&(this.utility.settings.customerSettings.enableHomework&&this.buildHomeworkListMarkup(a,b),this.buildResourceListMarkup(a,b),this.toggleAddElementButton(a.closest("."+this.utility.settings.cssClasses.ContextDialogContent)))};b.prototype.rebuildElementListMarkup=function(a,b){a=a.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);
a.find(this.utility.selectors.expandableContainer).remove();this.renderElementList(a,b);this.updateHeaderCounter(this.utility.getExpandableContainer(a.find(this.utility.selectors.elementListContainer)))};b.prototype.buildAddResourceButton=function(a){return $("<button type='button'>").addClass(this.utility.settings.cssClasses.AddElementButton).data(e.CalendarClientConstants.dataAttributeNames.addResourceMenuParameters,a).append($(this.utility.settings.InlineIcons.AddElement)).append(document.createTextNode(" ")).append($("<span>").text(this.utility.settings.terms.AddResourceDialogTitle))};
b.prototype.buildHeader=function(a,b){return $("<span>").text(a).append(" (").append($("<span>").attr(this.utility.dataAttributes.elementListCount,"").text(b)).append(")")};b.prototype.afterRemoveElement=function(b,c){var g=this;a.prototype.afterRemoveElement.call(this,b,function(){g.toggleAddElementButton(b.closest("."+g.utility.settings.cssClasses.ContextDialogContent));g.updateHeaderCounter(b);c&&c()})};b.prototype.buildHomeworkListMarkup=function(a,b){this.buildElementListMarkup(a,this.utility.settings.terms.HomeworkResourcesSectionTitle,
this.utility.dataAttributes.elementListContainerHomework,b.Homework,b.HomeworkCount)};b.prototype.buildResourceListMarkup=function(a,b){this.buildElementListMarkup(a,this.utility.settings.terms.ResourcesSectionTitle,this.utility.dataAttributes.elementListContainer,b.Resources,b.ResourceCount)};b.prototype.buildElementListMarkup=function(a,b,c,d,e){null!=d&&0<d.length&&(c=$("<div>").attr(c,"").append(d),this.enableElementLinkManagement||c.find("."+this.utility.settings.cssClasses.ElementListItemRemove).remove(),
this.expanderBuilder.buildExpandableContainer(a,this.buildHeader(b,e),c,{isExpanded:!0},this.callbackOnSectionToggle))};b.prototype.updateHeaderCounter=function(a){a.find(this.utility.selectors.elementListCount).text(this.utility.getAddedElementsCount(a))};b.prototype.toggleAddElementButton=function(a){var b=this.utility.getManuallyAddedElementsCount(a);a.find(this.utility.selectors.addElementButton).toggle(b<this.utility.constants.MaxCountOfAddedElements)};return b}(e.ElementListMarkupBuilderBase);
d.ElementListMarkupBuilder=b})(f.ElementLink||(f.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b,h,d,e,f,k){var c=this;this.container=a;this.utility=b;this.callbacks=h;this.binding=d;this.isAlwaysPlainText=e;this.isMultiline=f;this.inputValidationFunction=k;this.onEditFunction=function(a,b){a.actualText=a.actualText.replace(/[^\S\n]{2,}/g," ").trim();if(c.inputValidationFunction&&!c.inputValidationFunction(a.actualText))a.stopOnEdit=!0,a.isUpdateSuccess=!1,b(a);else{var g=c.isMultiline?CCL.CommonFunctions.replaceLineBreaksWithPTags(CCL.CommonFunctions.htmlEncode(a.actualText)):
a.actualText;c.callbacks.onTextSaved();c.binding.sendTextAjax(g).fail(function(){return a.isUpdateSuccess=!1}).always(function(){return b(a)})}};this.onChangeModeFunction=function(a){[c.cssClasses.ScheduleDialogSubheader,c.cssClasses.ShowMoreOptionsLink,c.cssClasses.ExpandableContainerHeader,c.cssClasses.ExpandableContainerContent].forEach(function(b){b=$("."+b);if(CCL.CommonFunctions.isIe()||CCL.CommonFunctions.isEdge())b=b.parent();b.css("pointer-events",a.isEditMode||c.callbacks.checkIfAnythingElseIsInEditMode()?
"none":"")});if(a.isEditMode)c.initEditMode();else{c.container.removeClass(c.cssClasses.TextContainerFocused);if(c.callbacks.onEditFinished)c.callbacks.onEditFinished();a.actualText?c.initViewModeWithChangedText():a.isNewTextSaved||c.textContainer.hasClass(c.cssClasses.TextContainerWatermark)?c.initViewModeWithWatermark():c.initViewModeWithInitialText()}};this.cssClasses=this.utility.settings.cssClasses;this.editorOptions={autoResize:!0,autoResizeAdditionalHeight:0,multiline:!0,editFieldCssClass:this.cssClasses.Width100Percent+
" "+this.cssClasses.ResizeNone+" "+this.cssClasses.UserInput,watermark:this.binding.watermarkText,watermarkCssClass:this.cssClasses.TextContainerWatermark,preventLineBreaksInMultilineMode:!f}}a.prototype.makeTextContentInlineEditable=function(){this.textContainer=this.container.find("."+this.cssClasses.UserInput);this.editorInstance=new ClientInlineEditor(this.textContainer,void 0,this.createHidden(),this.editorOptions,this.onEditFunction,this.onChangeModeFunction,void 0);this.textContainer.click()};
a.prototype.createHidden=function(){return $("<input type='hidden'>").val(this.binding.cachedPlainText).appendTo(this.container)};a.prototype.initEditMode=function(){this.callbacks.onEditStarted(this.binding.event);this.editorInstance.hideWatermark();this.container.addClass(this.cssClasses.TextContainerFocused)};a.prototype.initViewModeWithChangedText=function(){this.textContainer.removeClass(this.cssClasses.TextContainerWatermark);var a=this.isMultiline?CCL.CommonFunctions.replaceBrTagsWithPTags(this.textContainer.html()):
this.isAlwaysPlainText?this.textContainer.text():this.textContainer.html();this.setText(a);this.binding.cachedText=a};a.prototype.initViewModeWithWatermark=function(){this.textContainer.hasClass(this.cssClasses.TextContainerWatermark)||this.textContainer.addClass(this.cssClasses.TextContainerWatermark);this.textContainer.text(this.binding.watermarkText)};a.prototype.initViewModeWithInitialText=function(){this.setText(this.binding.cachedText)};a.prototype.setText=function(a){this.isAlwaysPlainText?
this.textContainer.text(a):this.textContainer.html(a)};return a}();d.InlineEditContent=b})(e.InlineEdit||(e.InlineEdit={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(a){function b(b,c,d,e){var g=this;a.call(this,b,c,d,e);this.utility=b;this.ajaxClient=c;this.setFocusOutEvent=function(){var a=g.getDatePickerContainer();a.on("focusout",function(){return setTimeout(function(){if((!g.getNextEventDatePicker().isPickerVisible()||g.getNextEventDatePicker().isPickerClosing())&&0===$(document.activeElement).closest(a).length)g.onFocusOut()})})}}__extends(b,a);b.prototype.setDatePickerButtonClick=function(){var a=
this;this.getDatePickerButton().one("click",this.setFocusOutEvent).click(function(){a.getNextEventDatePicker().setDefaultDate(a.getDefaultDate());a.toggleDatePicker(!0);a.getNextEventDatePicker().focus()})};b.prototype.getAvailableDates=function(a,b,c,d){this.ajaxClient.getDatesOfEventsToBePickedAsNextEventForSchedulePage({courseId:b,eventId:c,startDate:a.startDate,endDate:a.endDate,eventStopDateTimeAsIsoString:d}).done(function(b){return a.allowedDates=b})};b.prototype.getAvailableTimeSlotsForDate=
function(a,b,c,d){this.ajaxClient.getTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage({courseId:b,eventId:c,date:a.date,eventStopDateTimeAsIsoString:d}).done(function(b){return a.availableTimeSlots=b})};b.prototype.resetDatePicker=function(){this.toggleDatePicker(!1);var a=this.getNextEventDatePicker();a.clearDateAndTime(!1);a.setDefaultDate(null)};b.prototype.isInEditMode=function(){return this.isEditMode};b.prototype.toggleDatePicker=function(a){this.getDatePickerContainer()[0].style.display=
a?"inline-flex":"none";this.getDatePickerButton()[0].style.display=a?"none":"inline-flex";this.isEditMode=a};b.prototype.onFocusOut=function(){this.toggleDatePicker(!1)};return b}(e.NextEventDateWorkerBase);d.AddEditEventDialogNextEventDateWorker=b})(f.NextEvent||(f.NextEvent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(a){function b(b,c,d,e){var g=this;a.call(this,b,c,b.settings.ClientInstanceNames.AddEventNextEventPicker,b.settings.ClientInstanceNames.AddEventNextEventTimeSlotPicker);this.utility=b;this.locationParser=d;this.addEventEndDateHiddenFieldWrapper=e;this.setDatePickerButtonClick();$(function(){g.getNextEventDatePicker().getAvailableDatesFunction=function(a){return g.getAvailableDates(a,g.getCourseId(),0,g.getEventStopDateTimeAsIsoString())};
g.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=function(a){return g.getAvailableTimeSlotsForDate(a,g.getCourseId(),0,g.getEventStopDateTimeAsIsoString())}})}__extends(b,a);b.prototype.resetDatePicker=function(){a.prototype.resetDatePicker.call(this);this.getDatePickerButton().find("span").text(this.utility.settings.terms.PickDate)};b.prototype.getDatePickerButton=function(){return this.utility.controls.NextEvent.AddEventDatePickerButton};b.prototype.getDatePickerContainer=function(){return this.utility.controls.NextEvent.AddEventDatePickerContainer};
b.prototype.getDefaultDate=function(){return new Date(this.utility.controls.addEventEndDateHiddenField.val())};b.prototype.getCourseId=function(){return this.locationParser.parseCourseId(this.utility.controls.addEventCalendarsDropdown.val())};b.prototype.getEventStopDateTimeAsIsoString=function(){return JSON.stringify(this.addEventEndDateHiddenFieldWrapper.stringValue)};return b}(d.AddEditEventDialogNextEventDateWorker);d.AddEventDialogNextEventDateWorker=b})(e.NextEvent||(e.NextEvent={}))})(e.Schedule||
(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(a){function b(b,c,d){var g=this;a.call(this,b,c,b.settings.ClientInstanceNames.EditEventNextEventPicker,b.settings.ClientInstanceNames.EditEventNextEventTimeSlotPicker);this.onNextEventSaved=d;$(function(){g.getNextEventDatePicker().getAvailableDatesFunction=function(a){return g.getAvailableDates(a,g.queryArgs.courseId,g.queryArgs.eventId,g.queryArgs.eventStopDateTimeAsIsoString)};g.getNextEventTimeSlotPicker().getAvailableTimeSlotsForDateFunction=
function(a){return g.getAvailableTimeSlotsForDate(a,g.queryArgs.courseId,g.queryArgs.eventId,g.queryArgs.eventStopDateTimeAsIsoString)}})}__extends(b,a);Object.defineProperty(b.prototype,"nextEventQueryArgs",{set:function(a){this.resetDatePicker();this.setDatePickerButtonClick();this.queryArgs=a;0<a.nextEvent.eventId&&this.setDateTimePickerValues()},enumerable:!0,configurable:!0});b.prototype.setDateTimePickerValues=function(){var a=this.getNextEventDatePicker();a.setDate(CCL.SerializableDateTimeConverter.toDateWithSeconds(this.queryArgs.nextEvent.eventStart));
var b=this.getNextEventTimeSlotPicker();b.updateFilteredTimeForDate(a.getDateAsString(),a.selectedFilterId);b.setSelectedTimeSlot(this.queryArgs.nextEvent.eventId);b.toggle(!0)};b.prototype.getDatePickerButton=function(){return this.utility.controls.NextEvent.EditEventDatePickerButton};b.prototype.getDatePickerContainer=function(){return this.utility.controls.NextEvent.EditEventDatePickerContainer};b.prototype.getDefaultDate=function(){return new Date(JSON.parse(this.queryArgs.eventStopDateTimeAsIsoString))};
b.prototype.onFocusOut=function(){a.prototype.onFocusOut.call(this);this.getNextEventId()!==this.queryArgs.nextEvent.eventId&&this.saveNextEvent()};b.prototype.saveNextEvent=function(){var a=this,b=this.getNextEventId();this.ajaxClient.editNextEventId({EventId:this.queryArgs.eventId,NextEventId:b}).done(function(){a.queryArgs.nextEvent.eventId=b;if(a.onNextEventSaved)a.onNextEventSaved(b)})};return b}(d.AddEditEventDialogNextEventDateWorker);d.EditEventDialogNextEventDateWorker=b})(e.NextEvent||(e.NextEvent=
{}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b){this.utility=a;this.dateFormatter=b}a.prototype.buildMarkup=function(a,b,h){h=0<h.NextEventId?this.dateFormatter.getEventFormattedDateAndTime(CCL.SerializableDateTimeConverter.toDateWithSeconds(h.NextEventStart),CCL.SerializableDateTimeConverter.toDateWithSeconds(h.NextEventStop)):void 0;b?(this.utility.controls.NextEvent.EditEventDatePickerButton.find("span").text(h||this.utility.settings.terms.PickDate),this.utility.controls.NextEvent.EditEventDatePickerButton.appendTo(a),
this.utility.controls.NextEvent.EditEventDatePickerContainer.appendTo(a)):h&&$("<div>").addClass(this.utility.settings.cssClasses.NextEventDateLabel).text(h).appendTo(a)};return a}();d.NextEventMarkupBuilder=b})(e.NextEvent||(e.NextEvent={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){return function(e,d,b){var a=this;void 0===b&&(b=function(){});this.checkSessionUrl=e;this.anErrorOccurredTerm=d;this.onBeforeRedirect=b;this.handleAjaxError=function(b){var c=function(){a.onBeforeRedirect();window.top.location.href=a.checkSessionUrl},h=function(){b.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(CCL.CommonFunctions.htmlDecode(a.anErrorOccurredTerm))};b.status===CCL.CommonConstants.httpStatusCodes.badRequest||b.status===CCL.CommonConstants.httpStatusCodes.unauthorized||
b.status===CCL.CommonConstants.httpStatusCodes.methodNotAllowed?$.ajax({type:"GET",url:a.checkSessionUrl}).done(function(a){return(a?c:h)()}).fail(c):h()}}}();f.CommonAjaxClient=e})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.clientInstanceName=b;this.settings=a;window[b]=this;this.modalDialogClientInstanceName=a.ModalDialogClientInstanceName;this.modalDialog=window[a.ModalDialogClientInstanceName]}d.prototype.openDialog=function(b,a,c,g){void 0===c&&(c=!1);void 0===g&&(g=!0);a=this.createIFrameUrl(b,a,c,g);this.modalDialog.setIframeUrl(a,!1);this.modalDialog.setTitle(b===e.CopyMoveElementDialogMode.Copy?this.settings.Terms.CopyTo:this.settings.Terms.MoveTo);
this.modalDialog.openDialog(!1)};d.prototype.closeDialog=function(){CssModal.closeDialog()};d.prototype.getContentMaxHeight=function(){return this.modalDialog.getInnerContentMaxHeight()};d.prototype.resizeDialog=function(){this.modalDialog.adjustWindowSize()};d.prototype.copyMoveOperationInProgress=function(b){var a=this;this.modalDialog.toggleDialogCloseButton(!b);this.modalDialog.getIframe().load(function(){a.modalDialog.toggleDialogCloseButton(!0)})};d.prototype.copyMoveOperationCompleted=function(b){window.dispatchEvent(new CustomEvent(this.settings.CopyMoveOperationCompletedEventName,
{detail:b}))};d.prototype.createIFrameUrl=function(b,a,c,g){b=this.settings.IframePageUrl+"?"+this.settings.RequestItems.Mode+"="+b+"&"+this.settings.RequestItems.ElementIds+"="+(Array.isArray(a)?encodeURIComponent(a.join(",")):a);c&&(b=b+"&"+this.settings.RequestItems.HideLocationDropdown+"="+c);g||(b=b+"&"+this.settings.RequestItems.ShowFeedback+"="+g);return b};return d}();e.CopyMoveElementDialog=f})(f.CopyMoveElementDialog||(f.CopyMoveElementDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.clientInstanceName=b;this.settings=a;window[b]=this;$(function(){c.$copyMoveButton=$("#"+c.settings.ClientIds.CopyMoveButton);c.$copyWithTreeLinksButton=$("#"+c.settings.ClientIds.CopyWithTreeLinksButton);c.$cancelButton=$("#"+c.settings.ClientIds.CancelButton);c.$courseAndProjectsDropDownList=$("#"+c.settings.ClientIds.CourseAndProjectDropDownList);c.$includeAnswersCheckBox=$("#"+c.settings.ClientIds.IncludeAnswersCheckBox);
c.$includeAnswersCheckBoxHidden=$("#"+c.settings.ClientIds.IncludeAnswersCheckBoxHiddenField);c.$overwriteAssessmentCriteriaCheckBox=$("#"+c.settings.ClientIds.OverwriteAssessmentCriteriaCheckBox);c.$overwriteAssessmentCriteriaCheckBoxHidden=$("#"+c.settings.ClientIds.OverwriteAssessmentCriteriaCheckBoxHiddenField);c.$treeMenu=$("#"+c.settings.ClientIds.TreeMenu);c.$viewPort=$("#"+c.settings.ClientIds.ViewPort);c.$lastSelected=$("."+c.settings.CssClasses.NodeClicked);c.treeLinksFeedback=window[c.settings.TreeLinksWarning.TreeLinksFeedbackName];
c.treeLinksWarning=c.settings.TreeLinksWarning;c.terms=c.settings.Terms;c.mode=c.settings.Mode;c.contentContainer=document.getElementById(c.settings.ClientIds.ContentContainer);c.windowParent=window.parent;c.$viewPort[0]&&(c.contentHeightWithoutTreeMenu=c.contentContainer.scrollHeight-c.$viewPort[0].clientHeight);c.copyMovePostbackClientFunction=new Function(c.settings.ClientFunctions.CopyMovePostback);c.copyWithTreeLinksPostbackClientFunction=new Function(c.settings.ClientFunctions.CopyWithTreeLinksPostback);
c.currentlyInProgress=!1;c.$copyMoveButton.prop("disabled",!0).removeAttr("onclick").click(function(){c.inProgress();c.copyMovePostbackClientFunction()});c.$copyWithTreeLinksButton.prop("disabled",!0).removeAttr("onclick").click(function(){c.inProgress();c.copyWithTreeLinksPostbackClientFunction()});c.treeLinksWarning.ShowTreeLinksWarning&&(c.updateTreeLinksFeedbackAndButtons(c.treeLinksWarning.TreeLinksWarningMessage),c.$includeAnswersCheckBox.length&&c.$includeAnswersCheckBox.removeAttr("onclick").click(function(){c.updateTreeLinksWarningClientFunction()}));
c.settings.ReloadFolder&&("function"===typeof window.top.reloadFolder&&window.top.reloadFolder(),c.notifyAboutProgress(!1));c.attachTreeMenuListeners()})}d.prototype.updateTreeLinksFeedbackAndButtons=function(b){b&&b.HasTreeLinks?(this.treeLinksFeedback.showMessage(CCL.FeedbackType.Warning,b.TreeLinksWarningMessage),this.$copyWithTreeLinksButton.show(),this.$copyMoveButton.prop("value",this.mode===e.CopyMoveElementDialogMode.Copy?this.terms.CopySelectedResourceOnly:this.terms.Move)):(this.treeLinksFeedback.hide(),
this.$copyWithTreeLinksButton.hide(),this.$copyMoveButton.prop("value",this.mode===e.CopyMoveElementDialogMode.Copy?this.terms.Copy:this.terms.Move))};d.prototype.updateTreeLinksWarningClientFunction=function(){var b=this;$.ajax({url:this.treeLinksWarning.GetTreeLinksWarningMessageUrl.replace(/includeAnswers=((true)|(false))/ig,"includeAnswers="+this.$includeAnswersCheckBox.is(":checked")),dataType:"json"}).done(function(a){b.updateTreeLinksFeedbackAndButtons(a)})};d.prototype.closeDialog=function(){this.windowParent.closeCopyOrMoveElementsDialog?
this.windowParent.closeCopyOrMoveElementsDialog():window.parent[this.settings.DialogClientInstanceName]&&window.parent[this.settings.DialogClientInstanceName].closeDialog()};d.prototype.attachTreeMenuListeners=function(){var b=this;this.$treeMenu.on("loaded.jstree",function(){$("."+b.settings.CssClasses.Tree).show();b.notifyAboutResizeRequired()});var a=this;this.$treeMenu.on("select_node.jstree",function(c,g){c=$("#"+b.settings.ClientIds.SelectedTreeNode);g=$(g.rslt.obj);if(g.hasClass(a.settings.CssClasses.TreeMenuTogglableNode))return c.val(""),
b.$copyMoveButton.prop("disabled",!0),b.$copyWithTreeLinksButton.prop("disabled",!0),!1;!1===b.currentlyInProgress&&(b.$copyMoveButton.prop("disabled",!1),b.$copyWithTreeLinksButton.prop("disabled",!1));c.val($(g).prop("id"));a.isScrolledIntoView(g)||$("html, body, div").scrollTop(g.offset().top+a.$viewPort.scrollTop()-$(g).height());g.focus();b.$lastSelected&&b.$lastSelected.removeClass(a.settings.CssClasses.NodeSelected);b.$lastSelected=g;b.$lastSelected&&a.$lastSelected.addClass(a.settings.CssClasses.NodeSelected);
return!0});this.$treeMenu.on("open_node.jstree",function(c,g){b.notifyAboutResizeRequired();c=$(g.rslt.obj);if(c.hasClass(a.settings.CssClasses.TreeMenuTogglableNode))a.$treeMenu.jstree("deselect_node",c),a.$treeMenu.jstree("open_node",c),a.$lastSelected&&a.$lastSelected.addClass(a.settings.CssClasses.NodeClicked);else return!0});this.$treeMenu.on("close_node.jstree",function(c,g){b.notifyAboutResizeRequired();c=$(g.rslt.obj);if(c.hasClass(a.settings.CssClasses.TreeMenuTogglableNode)||a.settings.CssClasses.Folder)a.$treeMenu.jstree("deselect_node",
c),a.$treeMenu.jstree("close_node",c),a.$lastSelected&&b.$lastSelected.addClass(a.settings.CssClasses.NodeClicked);else return!0})};d.prototype.isScrolledIntoView=function(b){var a=this.$viewPort.scrollTop(),c=a+this.$viewPort.height(),g=b.offset().top+a;b=g+b.height();return b>=a&&g<=c&&b<=c&&g>=a};d.prototype.inProgress=function(){this.currentlyInProgress=!0;this.$copyMoveButton.prop("disabled",!0).prop("value","").addClass(this.settings.CssClasses.InProgress);this.$copyWithTreeLinksButton.prop("disabled",
!0).prop("value","").addClass(this.settings.CssClasses.InProgress);this.$cancelButton.prop("disabled",!0);this.$courseAndProjectsDropDownList.prop("disabled",!0);this.$includeAnswersCheckBox.length&&(this.$includeAnswersCheckBoxHidden.val(this.$includeAnswersCheckBox.is(":checked").toString()),this.$includeAnswersCheckBox.prop("disabled",!0));this.$overwriteAssessmentCriteriaCheckBox.length&&(this.$overwriteAssessmentCriteriaCheckBoxHidden.val(this.$overwriteAssessmentCriteriaCheckBox.is(":checked").toString()),
this.$overwriteAssessmentCriteriaCheckBox.prop("disabled",!0));this.notifyAboutProgress(!0)};d.prototype.notifyAboutProgress=function(b){this.windowParent.copyMoveOperationInProgress?this.windowParent.copyMoveOperationInProgress(b):window.parent[this.settings.DialogClientInstanceName]&&window.parent[this.settings.DialogClientInstanceName].copyMoveOperationInProgress&&window.parent[this.settings.DialogClientInstanceName].copyMoveOperationInProgress(b)};d.prototype.notifyAboutResizeRequired=function(){if(this.windowParent.getContentMaxHeight){var b=
this.windowParent.getContentMaxHeight();this.$viewPort.css("max-height",b-this.contentHeightWithoutTreeMenu)}else window.parent[this.settings.DialogClientInstanceName]&&window.parent[this.settings.DialogClientInstanceName].getContentMaxHeight&&(b=window.parent[this.settings.DialogClientInstanceName].getContentMaxHeight(),this.$viewPort.css("max-height",b-this.contentHeightWithoutTreeMenu));this.windowParent.resizeDialog?this.windowParent.resizeDialog():window.parent[this.settings.DialogClientInstanceName]&&
window.parent[this.settings.DialogClientInstanceName].resizeDialog&&window.parent[this.settings.DialogClientInstanceName].resizeDialog()};return d}();e.CopyMoveElementDialogPage=f})(f.CopyMoveElementDialog||(f.CopyMoveElementDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.settings=b;$("table button[id*='_Delete_']").click(function(b){return a.onDeleteGroup(b)});b=$("#"+b.DeleteButtonClientId);this.deletePostBackReference=b.attr("href").replace("javascript:","");b.click(function(b){return a.onDeleteSelectedGroups(b)})}d.prototype.isAnyGroupSelected=function(){var b=$("[id^='"+this.settings.TableClientId+"_Select']:checked");return 0<b.length?1===b.length&&-1<b[0].id.toLowerCase().indexOf("selectall")?
!1:!0:!1};d.prototype.onDeleteGroup=function(b){var a=this,c=$(b.currentTarget);b=[];b.push(this.getGroupId(c));this.checkBeforeDelete(b,function(){return a.deleteGroup(c)})};d.prototype.onDeleteSelectedGroups=function(b){var a=this;if(!this.isAnyGroupSelected())return alert(this.settings.Terms.SelectGroups),!1;this.checkBeforeDelete(GroupsTableGetSelectedValues(),function(){(new Function(a.deletePostBackReference))()});return!1};d.prototype.checkBeforeDelete=function(b,a){var c=this,g=1===b.length?
this.settings.Terms.DeleteGroupQuestion:this.settings.Terms.DeleteGroupsQuestion;this.checkRelatedCalendarEvents(b).done(function(b){if(b){b=new CCL.ConfirmButtonMetaData(c.settings.Terms.Delete,CCL.CommonCssClasses.Buttons.Red,"Delete");var h=new CCL.ConfirmButtonMetaData(c.settings.Terms.Cancel,"","Cancel");CCL.CommonFunctions.jAjaxMultiButtonConfirm("",c.settings.Terms.GroupHasConnectedEventsWarning,[b,h],function(b){"Delete"===b.customId&&a()})}else confirm(g)&&a()})};d.prototype.deleteGroup=
function(b){__doPostBack(b.data("event-target"),"")};d.prototype.getGroupId=function(b){b=b.attr("id");return Number(b.substr(b.lastIndexOf("_")+1))};d.prototype.checkRelatedCalendarEvents=function(b){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.ApiRoutes.CheckRelatedCalendarEvents,data:b})};return d}();e.Groups=f})(f.Courses||(f.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a){var c=this;this.settings=a;$("#"+this.settings.Controls.SmsDeactivate).on("click",function(){confirm(c.settings.Terms.AreYouSureDeactivateSms)&&c.updateServiceStatus(b.sms,!1,function(){$("."+c.settings.CssClasses.Services+" [data-service='"+b.sms+"']").attr("data-is-active","false");c.showInformationFeedback(c.settings.Terms.SmsSuccessfullyDeactivated);c.updateCheckboxesStates(b.sms)})});$("#"+this.settings.Controls.EmailDeactivate).on("click",
function(){confirm(c.settings.Terms.AreYouSureDeactivateEmail)&&c.updateServiceStatus(b.email,!1,function(){$("."+c.settings.CssClasses.Services+" [data-service='"+b.email+"']").attr("data-is-active","false");c.showInformationFeedback(c.settings.Terms.EmailSuccessfullyDeactivated);c.updateCheckboxesStates(b.email)})});$("#"+this.settings.Controls.EmailActivate).on("click",function(){confirm(c.settings.Terms.AreYouSureActivateEmail)&&c.updateServiceStatus(b.email,!0,function(){$("."+c.settings.CssClasses.Services+
" [data-service='"+b.email+"']").attr("data-is-active","true");c.showInformationFeedback(c.settings.Terms.EmailSuccessfullyActivated);c.updateCheckboxesStates(b.email)})});$("#"+this.settings.Controls.SubscriptionsSave).on("click",function(){var a=[];$("."+c.settings.CssClasses.SubscriptionsCheckbox).each(function(b,c){a.push({Service:$(c).attr("data-service"),Subscription:$(c).attr("data-subscription"),IsChecked:$(c).find("input").prop("checked")})});var b=0;$("."+c.settings.CssClasses.ServicesSmsMax).is(":visible")&&
(b=$("."+c.settings.CssClasses.ServicesSmsMax+":visible input").val());var g={};g[c.settings.AntiForgeryHeaderName]=c.settings.AntiForgeryHeaderValue;CCL.CommonFunctions.safeAjaxPost({url:c.settings.SubscriptionsUrl,data:{model:a,maximumMessagesPerDay:b},headers:g}).done(function(){c.showInformationFeedback(c.settings.Terms.InformationSaved)}).fail(function(){return c.showInformationFeedback(c.settings.Terms.ErrorFeedback)})})}a.prototype.updateServiceStatus=function(a,b,h){var c=this,g={};g[this.settings.AntiForgeryHeaderName]=
this.settings.AntiForgeryHeaderValue;CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceStatusUrl,data:{service:a,isActive:b},headers:g}).done(h).fail(function(){return c.showInformationFeedback(c.settings.Terms.ErrorFeedback)})};a.prototype.updateCheckboxesStates=function(a){var b=$("."+this.settings.CssClasses.Services+" [data-service='"+a+"']").attr("data-is-active");a=$("."+this.settings.CssClasses.SubscriptionsCheckbox+"[data-service='"+a+"'] input");"false"===b&&a.attr("disabled","disabled");
"true"===b&&a.removeAttr("disabled")};a.prototype.showInformationFeedback=function(a){CCL.InformationFeedback.showFeedback($("#"+this.settings.Controls.MainContainer),a)};return a}();e.Alerts=d;var b=function(){function a(){}a.email="email";a.sms="sms";return a}()})(e.Settings||(e.Settings={}))})(f.Person||(f.Person={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.lastTreeLinkIdToNavigate=void 0;this.settings=b;$(function(){c.$informationFeedbackContainer=$("#"+a);c.settings.IsTreeLinksEnabledInExtensions&&(CCL.CustomTreeLinkNavigationManager.registerCustomHandler(function(a){c.handleTreeLinkNavigationEvent(a)}),CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.askIfCustomTreeLinkNavigationRequired,function(){c.hideInformationFeedback(!1)}))})}
d.prototype.handleTreeLinkNavigationEvent=function(b){var a=this;this.lastTreeLinkIdToNavigate=b.linkId;if(!b.linkId||0>=b.sourceId)this.showInformationFeedback(b.context===CCL.TreeLinkContext.library?this.settings.Terms.TreeLinkIsInLibrary:this.settings.Terms.ErrorOccurred);else{var c=this.settings.TreeLinksGetInfoForCustomNavigation.replace("{id}",b.linkId).replace("{sourceElementId}",b.sourceId.toString());$.get(c).done(function(c){if(a.lastTreeLinkIdToNavigate===b.linkId)if(c.HasError)a.showInformationFeedback(c.ErrorDescription);
else{var g=a.settings.KpiSettings;CCL.CommonFunctions.measureKpi(g.url,g.section,g.clickOnTreeLinkMeasurement,g.context).always(function(){"_blank"===b.target?window.open(c.TargetElementContentUrl,"_blank"):window.top.location.assign(c.TargetElementUrl)})}}).fail(function(){a.lastTreeLinkIdToNavigate===b.linkId&&a.showInformationFeedback(a.settings.Terms.ErrorOccurred)})}};d.prototype.showInformationFeedback=function(b){CCL.InformationFeedback.showFeedback(this.$informationFeedbackContainer,b)};d.prototype.hideInformationFeedback=
function(b){void 0===b&&(b=!0);CCL.InformationFeedback.hideFeedback(this.$informationFeedbackContainer,b)};return d}();e.GenericTreeLinkNavigationHandler=f})(f.TreeLink||(f.TreeLink={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.onWorkloadEnableChanged=function(a){$("#"+c.settings.Controls.WorkloadEnableCheckbox).is(":checked")?c.$workloadEstimationSection.show():(c.$workloadEstimationHoursTextBox.val("0"),c.$workloadEstimationMinutesDropDown.val("00"),c.$workloadEstimationSection.hide())};window[a]=this;this.settings=b;$(function(){c.$workloadEstimationSection=$("#"+c.settings.Controls.WorkloadEstimationSection);c.$workloadEstimationHoursTextBox=
$("#"+c.settings.Controls.WorkloadEstimationHoursTextBox);c.$workloadEstimationHoursInputError=$("#"+c.settings.Controls.WorkloadEstimationHoursInputError);c.$workloadEstimationMinutesDropDown=$("#"+c.settings.Controls.WorkloadEstimationMinutesDropdown);c.$workloadEnableCheckbox=$("#"+c.settings.Controls.WorkloadEnableCheckbox);c.$workloadEnableCheckbox.on("click",function(a){return c.onWorkloadEnableChanged(a)});$("#"+c.settings.Controls.WorkloadEnableCheckbox).is(":checked")||c.$workloadEstimationSection.hide();
c.$workloadEstimationSection.on("change keyup",function(){$(document).trigger(c.settings.Events.WorkloadChangedClient)})})}b.prototype.onChange=function(a){this.onChangeHandler=a};b.prototype.isValid=function(){var a=$.isNumeric(this.$workloadEstimationHoursTextBox.val()),b=60*this.$workloadEstimationHoursTextBox.val()+1*this.$workloadEstimationMinutesDropDown.val();if(!a||0>b||599940<b)return this.$workloadEstimationHoursInputError.show(),this.$workloadEstimationHoursTextBox.addClass("itsl-workload-estimationhourseditbox-error"),
!1;this.$workloadEstimationHoursInputError.hide();this.$workloadEstimationHoursTextBox.removeClass("itsl-workload-estimationhourseditbox-error");return!0};b.prototype.getWorkloadEnabled=function(){return $("#"+this.settings.Controls.WorkloadEnableCheckbox).is(":checked")?!0:(this.$workloadEstimationHoursTextBox.val("0"),this.$workloadEstimationMinutesDropDown.val("00"),!1)};b.prototype.getWorkloadEstimation=function(){var a=60*this.$workloadEstimationHoursTextBox.val()+1*this.$workloadEstimationMinutesDropDown.val();
return 0>a||599940<a?-1:a};return b}();e.WorkloadSetting=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b){this.controls=a;this.settings=b;this.eventPreview=new e.Agenda.AgendaEventPreview(b.ClientInstanceNames.EventDialog,a.EventDialog,b.WebMethods.GetEventDetails,b.WebMethods.DeleteEvent,b.WidgetSettings,b.Terms);this.utility=new e.Agenda.AgendaUtility(b.DataAttributes,null);this.setupEventItemClick();this.setupOpenStartUpEvent()}a.prototype.setupOpenStartUpEvent=function(){var a=this;if(null!=this.settings.StartupEvent&&
($(window).load(function(){a.eventPreview.open(a.settings.StartupEvent.Id,a.settings.StartupEvent.Title,a.settings.StartupEvent.Category,a.settings.StartupEvent.Url,a.settings.StartupEvent.ColorSchema,a.settings.StartupEvent.UrlTarget,a.settings.StartupEvent.EditUrl,a.settings.StartupEvent.EditRecurringUrl)}),window.parent&&window.parent.document&&window.parent.history)){var b=CCL.CommonFunctions.setQueryStringParameter(window.parent.location.href,this.settings.StartupEvent.EventParameterName,"");
window.parent.history.replaceState({},window.parent.document.title,b)}};a.prototype.setupEventItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventTimeRangeLink),function(b){b=$(b.currentTarget);b.getIfHyperLinkEnabled()&&a.eventPreview.open(a.utility.getEventId(b),a.utility.getEventTitle(b),a.utility.getEventCategory(b),a.utility.getEventUrl(b),a.utility.getEventColorSchema(b),a.utility.getEventUrlTarget(b),a.utility.getEditEventUrl(b),
a.utility.getEditRecurringEventUrl(b))});this.controls.Container.on("click","."+this.settings.CssClasses.KeepAttendanceButton,function(b){$(b.currentTarget).prop("disabled")||(b=$(b.currentTarget).closest(CCL.CommonFunctions.getDataSelector(a.settings.DataAttributes.EventId)).data(a.settings.DataAttributes.EventId),a.openKeepAttendanceDialog(b));return!1})};a.prototype.clearEventDialogContent=function(){this.eventPreview.resetDialog()};a.prototype.openKeepAttendanceDialog=function(a){var b=this;a=
new CustomEvent(this.settings.EventNames.OpenKeepAttendanceDialog,{detail:{eventId:a}});document.dispatchEvent(a);var c=function(a){document.removeEventListener(b.settings.EventNames.CloseKeepAttendanceDialog,c);if(a.detail&&a.detail.eventId&&a.detail.saved){var g=b.settings.Terms.FeedbackMessage.replace("{0}",a.detail.eventDate+" "+a.detail.eventTime).replace("{1}",CCL.CommonFunctions.htmlEncode(a.detail.courseName));CCL.InformationFeedback.showFeedback(b.controls.Container,g);var h=(g=0<a.detail.presentCount||
0<a.detail.absentCount)?CCL.CommonFunctions.formatString(b.settings.Terms.AttendanceHasBeenKeptWithStatistics,a.detail.presentCount,a.detail.absentCount)+" "+b.settings.Terms.EditAttendance:b.settings.Terms.RegisterAttendance;b.getKeepAttendanceButton(a.detail.eventId).prop("title",h).prop("aria-label",h);b.getAttendanceStatisticsLabel(a.detail.eventId).toggle(g).text(g?a.detail.presentCount+"/"+a.detail.absentCount:"")}};document.addEventListener(this.settings.EventNames.CloseKeepAttendanceDialog,
c)};a.prototype.getKeepAttendanceButton=function(a){return this.getEventContainer(a).find("."+this.settings.CssClasses.KeepAttendanceButton)};a.prototype.getAttendanceStatisticsLabel=function(a){return this.getEventContainer(a).find("."+this.settings.CssClasses.AttendanceStatisticsLabel)};a.prototype.getEventContainer=function(a){return this.controls.Container.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventId,a))};return a}();d.EventsContentBlock=b})(e.Events||(e.Events=
{}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b,h,d,e,f){this.controlsModel=b;this.url=h;this.deleteUrl=d;this.widgetSettings=e;this.terms=f;this.courseIconKey="Course";this.eventDialog=window[a];this.initializeButtons()}a.prototype.resetDialog=function(){this.resetNav();this.resetHeaderIcons();this.controlsModel.Content.empty();this.controlsModel.Footer.AttendanceSection.show();this.controlsModel.Footer.AttendanceSection.empty();this.controlsModel.AjaxLoading.hide();
this.controlsModel.Footer.ButtonsContainer.hide();this.controlsModel.Header.DeleteEventButton.show();this.controlsModel.Header.EditEventLink.show();this.controlsModel.Footer.ShowMore.show()};a.prototype.showConfirmation=function(a,b){this.resetHeaderIcons();var c=$("<span>").addClass(this.controlsModel.ContentHeaderTitleCssClass).text(a);c=$("<div>").addClass(this.controlsModel.ContentHeaderCssClass).append(c);b=$("<div>").text(b);this.controlsModel.Content.empty().append(c,b);this.controlsModel.Header.DeleteEventButton.hide();
this.controlsModel.Header.EditEventLink.hide();this.controlsModel.Header.HeaderTitle.text(a);this.controlsModel.Header.HeaderColorSchema.hide();this.controlsModel.Footer.AttendanceSection.hide();this.controlsModel.Footer.ShowMore.hide();this.controlsModel.Footer.ButtonsContainer.show();this.controlsModel.AjaxLoading.hide();this.eventDialog.adjustWindowSize()};a.prototype.resetHeaderIcons=function(){var a=this,b=this.controlsModel.Header.HeaderColorSchema.data("schema");b&&this.controlsModel.Header.HeaderColorSchema.removeClass(b);
Object.keys(this.controlsModel.Header.Icons).forEach(function(b){a.controlsModel.Header.Icons[b].Instance.hide();b!==a.courseIconKey&&a.controlsModel.Header.Icons[b].Instance.parent().hide()})};a.prototype.resetNav=function(){this.setNav("#")};a.prototype.setNav=function(a,b){void 0===b&&(b="_top");this.controlsModel.Footer.ShowMore.prop("href",a);this.controlsModel.Footer.ShowMore.prop("target",b)};a.prototype.resetEditLink=function(){this.setEditLink("#","")};a.prototype.setEditLink=function(a,
b){this.controlsModel.Header.EditEventLink.prop("href",a)};a.prototype.SetTitle=function(a,b,h){b in this.controlsModel.Header.Icons&&(h=h.replace("itsl-dot",""),this.controlsModel.Header.HeaderColorSchema.addClass(h).data("schema",h),this.controlsModel.Header.Icons[b].Instance.show(),b!==this.courseIconKey&&this.controlsModel.Header.Icons[b].Instance.parent().show());this.controlsModel.Header.HeaderTitle.html(a)};a.prototype.open=function(a,b,h,d,e,f,k,p){this.resetDialog();this.SetTitle(b,h,e);
this.setNav(d,f);this.eventDialog.openDialog(!1);this.loadEvent(this.createGetEventAjaxRequest(a));this.setEditLink(k,p);this.currentEventId=a};a.prototype.loadEvent=function(a){var b=this;this.currentLoadingSession&&this.currentLoadingSession.abort&&this.currentLoadingSession.abort();this.controlsModel.Content.empty();this.controlsModel.AjaxLoading.show();this.currentLoadingSession=a();this.currentLoadingSession.done(function(a){b.controlsModel.Content.html(a.Content);b.controlsModel.Footer.AttendanceSection.html(a.AttendanceOverview);
b.eventDialog.adjustWindowSize()}).always(function(){b.controlsModel.AjaxLoading.hide();b.currentLoadingSession=void 0})};a.prototype.createGetEventAjaxRequest=function(a){var b=this;return function(){return CCL.CommonFunctions.safeAjaxPost({url:b.url.replace("{eventId}",a),data:{widgetSettings:b.widgetSettings}})}};a.prototype.initializeButtons=function(){var a=this;this.controlsModel.Header.EditEventLink.click(function(a){CssModal.closeDialog()});this.controlsModel.Header.DeleteEventButton.click(function(b){b=
a.controlsModel.Content.find("."+a.controlsModel.EventTitleCssClass).text();a.showConfirmation(CCL.CommonFunctions.formatString(a.terms.DeleteEventConfirmationHeader,b),a.terms.DeleteEventConfirmationText)});this.controlsModel.Footer.DeleteEventButton.click(function(){CCL.CommonFunctions.safeAjaxPost({url:a.deleteUrl,data:{ActivityId:a.currentEventId,IsSingle:!0}}).done(function(){CssModal.closeDialog();window.location.reload()})});this.controlsModel.Footer.CancelButton.click(function(){CssModal.closeDialog()})};
return a}();d.AgendaEventPreview=b})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.clientInstanceName=b;this.settings=a;window[b]=this;this.modalDialogClientInstanceName=a.ModalDialogClientInstanceName;this.modalDialog=window[a.ModalDialogClientInstanceName];this.modalDialog.setCustomScripts({afterOpenDialog:this.fixSidePanelExpansion.bind(this)})}d.prototype.openDialog=function(b){this.deferred=jQuery.Deferred();document.querySelector("#"+this.settings.DialogContentId).innerHTML=b;b=document.querySelector("#"+this.settings.ModalDialogClientInstanceName).querySelectorAll("button");
for(var a=0;a<b.length;a++)b[a].addEventListener("click",this.closeDialog.bind(this));this.modalDialog.openDialog(!1);return this.deferred.promise()};d.prototype.closeDialog=function(b){CssModal.closeDialog();"ok"===b.target.value?this.deferred.resolve(!0):this.deferred.resolve(!1)};d.prototype.fixSidePanelExpansion=function(){setTimeout(function(){return CCL.CommonFunctions.makePostMessageCall(window,{messageName:CCL.CommonWindowMessages.MessageNames.collapseExtensionIframe})},500)};return d}();
e.LearningObjectiveRemovalDialog=f})(f.LearningObjectiveRemovalDialog||(f.LearningObjectiveRemovalDialog={}))})(ItslearningWeb||(ItslearningWeb={}));(function(f){(function(e){var f=function(){function d(){}d.handle=function(b,a,c){switch(b.Code){case e.GenericResponseCode.Success:a(b.ResponseData);break;default:b.ErrorMessage&&alert(b.ErrorMessage),c&&c(b)}};return d}();e.GenericResponseHandler=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LightBulletin||(f.LightBulletin={});f=f.PendingProcessStatus||(f.PendingProcessStatus={});f[f.InProgress=0]="InProgress";f[f.Failed=1]="Failed";f[f.Aborted=2]="Aborted"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){this.processes=new Map;this.lastProcessId=0}d.prototype.createProcess=function(b){var a=this.lastProcessId+1;b={processId:a,pendingStatus:e.PendingProcessStatus.InProgress,ajaxRequest:b};this.lastProcessId=a;this.processes.set(a,b);return b};d.prototype.getProcessById=function(b){return this.processes.get(b)};d.prototype.setProcessFailed=function(b){b.pendingStatus=e.PendingProcessStatus.Failed;this.clearProcessAjaxRequest(b)};d.prototype.clearProcessAjaxRequest=
function(b){b.ajaxRequest=void 0};d.prototype.cancelProcess=function(b){b=this.processes.get(b);b.pendingStatus===e.PendingProcessStatus.InProgress&&(b.pendingStatus=e.PendingProcessStatus.Aborted,b.ajaxRequest&&(b.ajaxRequest.abort(),this.clearProcessAjaxRequest(b)))};d.prototype.removeProcessById=function(b){this.processes.delete(b)};return d}();e.PendingEmbedProcessManager=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.settings=b;e.supervisorOverviewInstance=this}d.prototype.findSupervisor=function(b,a){return CCL.CommonFunctions.safeAjax({type:"GET",url:e.supervisorOverviewInstance.settings.FindSupervisorsServiceUrl+"?search="+b.term+"&supervisorType="+e.supervisorOverviewInstance.settings.SupervisorType+"&organisationId="+e.supervisorOverviewInstance.settings.OrganizationId,dataType:"json",success:function(b){a($.map(b,function(a){return{label:a.Name,
value:a.Name,id:a.PersonId,organization:a.Organization}}))}})};d.prototype.personSearchRenderItem=function(b,a){return $("<li>").append($("<button>").attr("type","button").text(a.label).addClass(e.supervisorOverviewInstance.settings.CssClasses.ButtonPerson).append($("<div>").addClass(e.supervisorOverviewInstance.settings.CssClasses.ButtonPersonHierarchy).text(a.organization))).appendTo(b)};d.prototype.selectedSupervisorChanged=function(b,a){location.href=e.supervisorOverviewInstance.settings.FilterUrl+
"&"+$.param({SearchText:a.item.value,SearchValue:a.item.id})};return d}();e.SupervisorOverview=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b){this.context=b;e.personProfileSiteInstance=this;this.enableTwoFactorCheckboxOnlyForAdmins()}d.prototype.checkEsafetyChanged=function(){if(e.personProfileSiteInstance.context.Settings.IsInstantMessageSystemEnabled&&e.personProfileSiteInstance.context.Settings.IsEditMode){this.rolesUnchecked=[];CCL.CommonFunctions.checkAndAddRole(e.personProfileSiteInstance.context.Settings.EsafetyStaffChecked,e.personProfileSiteInstance.context.Controls.StaffCheckboxClientId,
e.personProfileSiteInstance.context.LanguageTerms.Staff,this.rolesUnchecked);CCL.CommonFunctions.checkAndAddRole(e.personProfileSiteInstance.context.Settings.EsafetyStudentChecked,e.personProfileSiteInstance.context.Controls.StudentCheckboxClientId,e.personProfileSiteInstance.context.LanguageTerms.Student,this.rolesUnchecked);CCL.CommonFunctions.checkAndAddRole(e.personProfileSiteInstance.context.Settings.EsafetyGuestChecked,e.personProfileSiteInstance.context.Controls.GuestCheckboxClientId,e.personProfileSiteInstance.context.LanguageTerms.Guest,
this.rolesUnchecked);var b=f.Administration.PersonProfile.privacyChangedDialogManagerInstance;return b&&0<this.rolesUnchecked.length?(b.openDialog({submitFormMethod:this.context.Settings.SumbitFormMethodString},{personProfileId:e.personProfileSiteInstance.context.Settings.ProfileId,rolesUnchecked:this.rolesUnchecked}),!1):!0}};d.prototype.showConfirmEsafetyChanges=function(b,a,c){var g=e.personProfileSiteInstance.context.Settings.ProfileName,h="";$("#"+e.personProfileSiteInstance.context.Controls.InitiateCommunicationCheckBoxClientId).is(":checked")&&
(h="\n"+e.personProfileSiteInstance.context.LanguageTerms.AdditionEsafetyText);var d="";switch(this.rolesUnchecked.length){case 1:d=CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.UncheckedOneEsafetyRoleText,g,this.rolesUnchecked[0]);break;case 2:d=CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.UncheckedTwoEsafetyRolesText,g,this.rolesUnchecked[0],this.rolesUnchecked[1]);break;case 3:d=CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.UncheckedThreeEsafetyRolesText,
g)}var l="";c===f.Administration.PersonProfile.PrivacyChangedDialogActionType.MakeReadOnly&&(l=a?CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.MarkCurrentConversationsIncludingGroupAsReadOnlyText,g,b.join(", ")):CCL.CommonFunctions.formatString(e.personProfileSiteInstance.context.LanguageTerms.MarkCurrentConversationsAsReadOnlyText,g,b.join(", ")),l=l+"\n"+e.personProfileSiteInstance.context.LanguageTerms.ClosingCouldTakeSomeTime);return confirm(d+" "+l+" "+h)};
d.prototype.onHierarchyRoleChange=function(){this.enableTwoFactorCheckboxOnlyForAdmins()};d.prototype.enableTwoFactorCheckboxOnlyForAdmins=function(){var b=document.getElementById(this.context.Controls.TwoFactorCheckboxClientId),a=document.getElementById(this.context.Controls.HierarchyRoleDropDownClientId);b&&a&&(this.context.Settings.IsProfileOfSystemAdmin||a.value!==this.context.Settings.HierarchyRoleAdministratorValue?(this.context.Settings.IsProfileOfSystemAdmin||(b.checked=!1),b.disabled=!0):
b.disabled=!1)};return d}();e.PersonProfileSite=k})(f.WebComponents||(f.WebComponents={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.onAssessmentChanged=function(a){var b=c.$assessmentItemDropDown.find("option:selected").val(),g=b===c.settings.Constants.UseScoreItemValue;c.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(c.settings.EventNames.ToggleCriteriaWeightVisibility,{show:b!==c.settings.Constants.DoNotUseAssessmentItemValue});0===c.$assessmentItemDropDown.length&&(g=c.settings.Permissions.IsScoreUsed);c.$maxScoreFloatingSection.toggle(g);
c.onMaxScoreStateChanged();c.settings.Permissions.UseGradeBook&&c.toggleTermAndCategoryPanel();if(void 0!==c.onChangeHandler&&void 0!==a)c.onChangeHandler(a)};window[b]=this;this.settings=a;$(function(){c.$addToGradeBookCheck=$("#"+c.settings.Controls.AddToGradeBookCheckbox);c.$assessmentItemDropDown=$("#"+c.settings.Controls.AssessmentItemDropDown);c.$maxScoreFloatingSection=$("#"+c.settings.Controls.MaxScoreFloatingSection);c.$assessmentSection=$("#"+c.settings.Controls.AssessmentSection);c.$maxScoreTextBox=
$("#"+c.settings.Controls.MaxScoreTextBox);c.$addToGradeBookCheckWithLabel=c.$addToGradeBookCheck.add(c.$addToGradeBookCheck.next());c.$categoryDropDown=$("#"+c.settings.Controls.CategoryDropDown);c.$termDropDown=$("#"+c.settings.Controls.TermDropDown);c.onAssessmentChanged(void 0);c.$assessmentItemDropDown.change(c.onAssessmentChanged);c.$maxScoreTextBox&&(c.$maxScoreTextBox.on("blur input",function(){return c.onMaxScoreStateChanged()}),c.$maxScoreTextBox.keydown(function(a){-1!==$.inArray(a.which,
[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter,CCL.CommonConstants.keyCodes.decimalPoint,CCL.CommonConstants.keyCodes.comma,CCL.CommonConstants.keyCodes.period])||a.which===CCL.CommonConstants.keyCodes.keyA&&(a.ctrlKey||a.metaKey)||a.which>=CCL.CommonConstants.keyCodes.end&&a.which<=CCL.CommonConstants.keyCodes.arrowDown||(a.shiftKey||a.which<CCL.CommonConstants.keyCodes.key0||
a.which>CCL.CommonConstants.keyCodes.key9)&&(a.which<CCL.CommonConstants.keyCodes.numpad0||a.which>CCL.CommonConstants.keyCodes.numpad9)&&a.preventDefault()}));c.settings.Permissions.UseGradeBook&&c.toggleTermAndCategoryPanel()})}d.prototype.canUseAutoMaxScore=function(){return this.settings.Permissions.CanUseAutoMaxScore};d.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue};d.prototype.isValid=
function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};d.prototype.validateScore=function(b){if(""===b)return!1;b=parseFloat(b.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(b)||b<this.settings.MaxScoreMinValue||b>this.settings.MaxScoreMaxValue?!1:!0};d.prototype.onChange=function(b){this.onChangeHandler=b};d.prototype.onMaxScoreStateChanged=
function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&$(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient)};d.prototype.getState=function(){var b={};b.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val());b.IsScore=b.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,10);b.MaxScore=parseInt(this.$maxScoreTextBox.val());b.AddToGradeBook=this.$addToGradeBookCheck.is(":checked");this.$categoryDropDown&&(b.CategoryId=
parseInt(this.$categoryDropDown.val()));this.$termDropDown&&(b.TermId=parseInt(this.$termDropDown.val()));return b};d.prototype.toggleTermAndCategoryPanel=function(){var b=this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue;b&&this.$addToGradeBookCheck.is(":visible")||(this.$addToGradeBookCheckWithLabel.toggle(b),this.$addToGradeBookCheck.prop("checked",b),eval(this.settings.ToggleTermAndCategoryPanelClientFunctionName+"("+b+")"))};return d}();
e.AssessmentScaleControl=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a,c,g){var h=this;this.$elementTitleLabel=b;this.settings=a;this.elementId=c;this.parentFolderId=g;window[d.clientInstanceName]=this;new ClientInlineEditor(this.$elementTitleLabel,void 0,void 0,{clickToEditToolTip:this.settings.Terms.ClickToEditToolTip,clickToSaveToolTip:this.settings.Terms.ClickToSaveToolTip,submitOnEnter:!0,editFieldCssClass:this.settings.CssClasses.EditFieldCssClass,editFieldAutoWidth:!1,editFieldDisplayInline:!0,highlightOnSave:!0,
highlightOnFocus:!0,renderRightLinkWithIcon:!0,maxLength:this.settings.MaxLength,rightLinkViewModeCssClass:this.settings.CssClasses.RightLinkViewModeCssClass,rightLinkEditModeCssClass:this.settings.CssClasses.RightLinkEditModeCssClass},function(a,b){return h.onEditFunction(a,b)},function(a){return h.onChangeModeFunction(a)},void 0)}d.getInstance=function(){return window[d.clientInstanceName]};d.getText=function(){return d.getInstance().$elementTitleLabel.text()};d.prototype.onEditFunction=function(b,
a){var c=this;b.actualText&&$.trim(b.actualText)?CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.UpdateTitleWebMethod.replace("{elementId}",this.elementId.toString()),data:{title:b.actualText}}).done(function(g){b.actualText=g;a(b);$(c).trigger("change",g)}).fail(function(){b.isUpdateSuccess=!1;b.stopOnEdit=!0}):(b.isUpdateSuccess=!1,b.stopOnEdit=!0,a(b),CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.EmptyTitleErrorMessage,this.settings.Terms.ErrorOccured,this.settings.Terms.Ok,
!1))};d.prototype.onChangeModeFunction=function(b){if(!b.isEditMode&&b.isNewTextSaved&&window!=top){var a=top;a.reloadFolder&&a.reloadFolder("item"+this.parentFolderId,"item"+this.elementId,!0);top.SelectCurrentLocation(b.actualText,window.currentPathFromHome,this.elementId)}};d.clientInstanceName="ElementTitleEditorClientInstance";return d}();e.ElementTitleEditor=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b,g){this.utility=a;this.inputSelector=b;this.errorSelector=g;this.input=this.utility.controls.Dialog.find(b);this.error=this.utility.controls.Dialog.find(g);this.instance=this.utility.getClientInstance(this.input.prop("id"))}Object.defineProperty(b.prototype,"date",{get:function(){return this.instance.getDate()},set:function(a){this.instance.setDate(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateAsQueryStringParameter",
{get:function(){return this.instance.getDateAsQueryStringParameter()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isDateValid",{get:function(){return this.instance.isDateValid()},enumerable:!0,configurable:!0});b.prototype.showError=function(a){void 0===a&&(a=void 0);this.input.addClass(this.utility.settings.CssClasses.DatePickerErrorState);a&&this.error.show().text(a)};b.prototype.hideError=function(){this.input.removeClass(this.utility.settings.CssClasses.DatePickerErrorState);
this.error.hide()};return b}();e.DatePickerWrapper=d})(e.PrintSettingsDialog||(e.PrintSettingsDialog={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.controls=a;this.settings=b;this.dataSelectors={courseTitleContainer:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.CourseTitleContainer),courseDropdown:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.CourseDropdown),dateFrom:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateFrom),dateTo:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateTo),dateFromError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateFromError),
dateToError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateToError),dateRangeError:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.DateRangeError),okButton:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.OkButton)}}Object.defineProperty(b.prototype,"dialog",{get:function(){return this.getClientInstance(this.controls.Dialog.prop("id"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"datePickerFrom",{get:function(){return new e.DatePickerWrapper(this,
this.dataSelectors.dateFrom,this.dataSelectors.dateFromError)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"datePickerTo",{get:function(){return new e.DatePickerWrapper(this,this.dataSelectors.dateTo,this.dataSelectors.dateToError)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateRangeError",{get:function(){return this.controls.Dialog.find(this.dataSelectors.dateRangeError)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"okButton",{get:function(){return this.controls.Dialog.find(this.dataSelectors.okButton)},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"courseTitleContainer",{get:function(){return this.controls.Dialog.find(this.dataSelectors.courseTitleContainer)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"courseDropdown",{get:function(){return this.controls.Dialog.find(this.dataSelectors.courseDropdown)},enumerable:!0,configurable:!0});b.prototype.getClientInstance=function(a){return window[a]};return b}();e.CalendarPrintUtility=d})(e.PrintSettingsDialog||
(e.PrintSettingsDialog={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=f.Controls.MultipleCourseSearchSelector.MultipleCourseSearchSelector,b=function(){function a(a,b){var c=this;this.controls=a;this.maxUrlLengthChars=2E3;this.okButtonClickHandler=function(a){if(c.isInputValid())c.updatePrintUrl(),CssModal.closeDialog();else return a.preventDefault(),!1};this.updatePrintUrl=function(){c.utility.settings.IsPossibleToChooseCourse&&(c.currentCourseId=Number(c.utility.courseDropdown.val()));c.utility.settings.EnableMultipleCourseSelection&&
c.multipleCourseSelector.updateSelectedCourses();var a=c.utility.settings.EnableMultipleCourseSelection?c.multipleCourseSelector.selectedCourses.map(function(a){return a.CourseId}):[c.currentCourseId],b=c.makeCalendarPrintUrl({CourseIds:a.join(","),EventId:0,StartDate:c.utility.datePickerFrom.dateAsQueryStringParameter,EndDate:c.utility.datePickerTo.dateAsQueryStringParameter,IsPrintFromAdminPage:!c.utility.settings.IsPossibleToChooseCourse});c.isUrlValid(b,a.length)?c.utility.okButton.prop("href",
b):c.utility.settings.EnableMultipleCourseSelection&&c.multipleCourseSelector.setMaxItems(a.length-1)};this.utility=new e.CalendarPrintUtility(a,b);e.manager=this;b.EnableMultipleCourseSelection?(b.MultipleCourseSelectorSettings.OnItemAddCallback=this.updatePrintUrl,b.MultipleCourseSelectorSettings.OnItemRemoveCallback=this.updatePrintUrl,this.multipleCourseSelector=new d(a.MultipleCourseSelectorControls,b.MultipleCourseSelectorSettings)):this.utility.okButton.click(this.okButtonClickHandler)}a.prototype.openPrintSettingsDialog=
function(a,b,h){this.hideErrors();this.currentCourseId=a;this.utility.datePickerFrom.date=CCL.SerializableDateTimeConverter.toDate(this.utility.settings.DefaultDateFrom);this.utility.datePickerTo.date=CCL.SerializableDateTimeConverter.toDate(this.utility.settings.DefaultDateTo);this.utility.courseTitleContainer.html(b);h&&this.utility.settings.EnableMultipleCourseSelection?(this.multipleCourseSelector.setCoursesToSelectFrom(h),this.multipleCourseSelector.openDialog([h.filter(function(b){return b.CourseId===
a})[0]],this.okButtonClickHandler,!1)):this.utility.dialog.openDialog(!1)};a.prototype.makeCalendarPrintUrl=function(a){return this.utility.settings.Urls.GetCalendarPrintoutMarkup+"?"+$.param(a)};a.prototype.isInputValid=function(){this.hideErrors();var a=!0;this.utility.datePickerFrom.isDateValid||(this.utility.datePickerFrom.showError(this.utility.settings.Terms.InvalidDateFrom),a=!1);this.utility.datePickerTo.isDateValid||(this.utility.datePickerTo.showError(this.utility.settings.Terms.InvalidDateTo),
a=!1);a&&this.utility.datePickerFrom.date>this.utility.datePickerTo.date&&(this.utility.datePickerFrom.showError(),this.utility.datePickerTo.showError(),this.utility.dateRangeError.show().text(this.utility.settings.Terms.InvalidDateRange),a=!1);this.utility.settings.EnableMultipleCourseSelection&&!this.multipleCourseSelector.selectedCourses.length&&(this.multipleCourseSelector.toggleError(!0),this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display="",this.controls.MultipleCourseSelectorControls.ErrorLabel.textContent=
this.utility.settings.Terms.SelectAtLeastOneCourse,a=!1);return a};a.prototype.isUrlValid=function(a,b){if(!this.utility.settings.EnableMultipleCourseSelection)return!0;if(a.length>this.maxUrlLengthChars)return this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display="",this.controls.MultipleCourseSelectorControls.ErrorLabel.textContent=CCL.CommonFunctions.formatString(this.utility.settings.Terms.YouCanSelectOnlyXCourses,b-1),!1;this.multipleCourseSelector.toggleError(!1);this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display=
"none";return!0};a.prototype.hideErrors=function(){this.utility.datePickerFrom.hideError();this.utility.datePickerTo.hideError();this.utility.dateRangeError.hide();this.utility.settings.EnableMultipleCourseSelection&&(this.multipleCourseSelector.toggleError(!1),this.controls.MultipleCourseSelectorControls.ErrorLabel.style.display="none")};return a}();e.DialogManager=b})(e.PrintSettingsDialog||(e.PrintSettingsDialog={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function b(a,b){d.call(this,a.CheckSession,b);this.urls=a}__extends(b,d);b.prototype.getElementListMarkupByIds=function(a){return $.ajax({type:"POST",url:this.urls.GetElementListByIds,data:JSON.stringify(a),dataType:"html",contentType:"application/json; charset=utf-8"})};return b}(f.CommonAjaxClient);e.ElementPickerAjaxClient=k})(f.CustomActivityElementPicker||(f.CustomActivityElementPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var b=this;this.cssClasses=d;$("."+this.cssClasses.SelectedElementList).on("mouseenter","li",function(a){a=$(a.currentTarget).find("."+b.cssClasses.ElementTitle).get(0);var c=$(a).closest("a"),g=a.offsetWidth;CCL.CommonFunctions.isChrome()&&!CCL.CommonFunctions.isEdge()||g++;c.prop("title",g<a.scrollWidth?a.textContent.trim():"")})}}();e.CustomActivityOverview=f})(f.CustomActivityOverview||(f.CustomActivityOverview={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b){this.webMethods=a;this.widgetSettings=b}a.prototype.createGetAgendaDayListContainerAjaxRequest=function(a,b,h){var c=this;return function(){return CCL.CommonFunctions.safeAjaxPost({url:c.webMethods.GetAgendaDayListContainer,data:{fromDateTime:a,toDateTime:b,datePeriod:h,widgetSettings:c.widgetSettings}})}};a.prototype.createHideTaskAjaxRequest=function(a,b,h,d){var c=this;return function(){return CCL.CommonFunctions.safeAjax({type:"DELETE",url:c.webMethods.HideTask.replace("{taskId}",
a),data:{fromDateTime:b,toDateTime:h,datePeriod:d,widgetSettings:c.widgetSettings}})}};return a}();d.AgendaAjaxClient=b})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b){this.attributesModel=a;this.controls=b}a.prototype.getEventDescription=function(a){return a.data(this.attributesModel.EventDescription)};a.prototype.getEventColorSchema=function(a){return a.data(this.attributesModel.EventColorSchema)};a.prototype.getEventUrl=function(a){return a.data(this.attributesModel.EventUrl)};a.prototype.getEditEventUrl=function(a){return a.data(this.attributesModel.EditEventUrl)};a.prototype.getEditRecurringEventUrl=
function(a){return a.data(this.attributesModel.EditRecurringEventUrl)};a.prototype.getEventUrlTarget=function(a){return a.data(this.attributesModel.EventUrlTarget)};a.prototype.getEventId=function(a){return a.data(this.attributesModel.EventId)};a.prototype.getEventTitle=function(a){return a.data(this.attributesModel.EventTitle)};a.prototype.getEventCategory=function(a){return a.data(this.attributesModel.EventCategory)};a.prototype.getTaskHideId=function(a){return a.data(this.attributesModel.TaskHideId)};
a.prototype.getExpectedDatePeriod=function(a){if(a===this.controls.WeekViewLink.get(0))return f.Controls.DatePeriod.Week;if(a===this.controls.DayViewLink.get(0))return f.Controls.DatePeriod.Day;throw Error("Unexpected control: "+a);};return a}();d.AgendaUtility=b})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.settings=b;window[a]=this;this.$allowEveryoneCheckbox=$("."+b.AllowEveryoneCheckboxCss).find("input:checkbox");this.$disableCommentsCheckbox=$("."+b.DisableCommentsCheckboxCss).find("input:checkbox");this.editBulletinSettingsDialog=window[this.settings.EditBulletinsSettingsDialogClientId]}b.prototype.showEditBulletinSettings=function(){var a=this;this.editBulletinSettingsDialog.show().then(function(b){b===CCL.ConfirmDialogResult.Confirm?
(b={AllowEveryoneSetting:a.$allowEveryoneCheckbox.is(":checked")},a.$disableCommentsCheckbox&&a.$disableCommentsCheckbox.length&&(b.DisableCommentsSetting=a.$disableCommentsCheckbox.is(":checked")),$.ajax({type:"POST",url:a.settings.UpdateCourseBulletinSettingsUrl,contentType:"application/json; charset=utf-8",data:JSON.stringify({courseId:a.settings.CourseId,settings:b})}).fail(function(){jAlert(a.settings.ErrorMessage)}).done(function(){window.location.reload()})):(a.$allowEveryoneCheckbox.prop("checked",
a.settings.AllowAllUsersPostBulletinsCourseSetting),a.$disableCommentsCheckbox&&a.$disableCommentsCheckbox.length&&a.$disableCommentsCheckbox.prop("checked",a.settings.DisableLightBulletinCommentsCourseSetting))});$("#"+this.settings.EditBulletinsSettingsDialogClientId).find(":focusable").first().focus()};return b}();e.Bulletins=d})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.settings=b;this.startPositionDataAttribute="start-position";window[d.clientInstanceName]=this;this.initDragAndDrop()}d.prototype.initDragAndDrop=function(){var b=this,a=$("."+this.settings.Css.Container);a.sortable({axis:"y",scroll:!0,scrollSensitivity:50,scrollSpeed:10,handle:"",cursor:"move",dropOnEmpty:!0,items:$("."+this.settings.Css.ElementContainer)});a.on("sortstart",function(a,g){g.item.data(b.startPositionDataAttribute,g.item.index())}).on("sortreceive",
function(a,b){}).on("sortstop",function(a,g){a=g.item.data(b.startPositionDataAttribute);var c=g.item.index();if(a!==c){c=$(g.item);g=b.getElementIdFromElementContainer(c);var d=c.nextAll("."+b.settings.Css.ElementContainer).eq(0);a=!1;0===d.length&&(d=c.prevAll("."+b.settings.Css.ElementContainer).eq(0),a=!0);c=b.getElementIdFromElementContainer(d);b.dragAndDropElement(g,c,a)}})};d.prototype.getElementIdFromElementContainer=function(b){return parseInt(b.data(this.settings.ElementIdDataAttribute),
10)};d.prototype.dragAndDropElement=function(b,a,c){var g=this;$.ajax({url:this.settings.DragAndDropElementUrl,type:"PUT",dataType:"JSON",contentType:"application/json",data:JSON.stringify({folderId:this.settings.FolderId,dragElementId:b,dropElementId:a,insertAfterTargetElement:c})}).done(function(a){a?(a=top,a.reloadFolder&&a.reloadFolder("item"+g.settings.FolderId)):g.showError()}).fail(function(){return g.showError()})};d.prototype.showError=function(){CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.SomethingWentWrong,
this.settings.Terms.ErrorOccurred,this.settings.Terms.Ok,!0)};d.clientInstanceName="OrganizeFolderClientInstanceName";return d}();e.OrganizeFolder=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function b(a,b,g,h,d,e){var c=this;this.$itemSelector=a;this.$filterMenu=b;this.idDataAttribute=g;this.selectAllItemId=h;this.optionCheckboxPrefix=d;this.languageTerms=e;this.handleItemSelection=function(a){var b=a.closest("[data-"+c.idDataAttribute+"]").data(c.idDataAttribute),g=a.is(":checked");a=b===c.selectAllItemId;var h=c.$filterMenu.find("[data-"+c.idDataAttribute+"]");if(a)h.each(function(a,b){a=$(b).data(c.idDataAttribute);c.getOptionCheckBox(a).prop("checked",
g)});else{c.getOptionCheckBox(b).prop("checked",g);var d=null,e=!0;h.each(function(a,b){a=$(b).data(c.idDataAttribute);return a!==c.selectAllItemId&&(a=c.getOptionCheckBox(a).is(":checked"),null==d&&(d=a),a!==d)?e=!1:!0});c.toggleAllOptionCheckBox(e,!1,d)}c.setDefaultItemText()};this.hasItems=function(){return 0<c.$filterMenu.find("[data-"+c.idDataAttribute+"]").length};this.getSelectedItems=function(){var a=[];c.$filterMenu.find("[data-"+c.idDataAttribute+"]").each(function(b,g){b=$(g).data(c.idDataAttribute);
c.getOptionCheckBox(b).is(":checked")&&b!==c.selectAllItemId&&a.push(b)});return a};this.areAllItemsSelected=function(){return null!=c.allOptionCheckBox?c.allOptionCheckBox.is(":checked"):!1};this.areNoneItemsSelected=function(){return 0===c.getSelectedItems().length};this.setDefaultItemText=function(){if(c.areAllItemsSelected())var a=c.languageTerms.All+" "+c.languageTerms.Items.toLowerCase();else c.areNoneItemsSelected()?a=c.languageTerms.SelectItem:(a=c.getSelectedItems(),a=1<a.length?c.getSelectedItems().length+
" "+c.languageTerms.Items.toLowerCase():c.$filterMenu.find("[data-"+c.idDataAttribute+'="'+a[0]+'"]').find("label").text());c.$itemSelector.text(CCL.CommonFunctions.htmlEncode(a))};this.getOptionCheckBox=function(a){return $("#"+c.optionCheckboxPrefix+a)};this.toggleAllOptionCheckBox=function(a,b,g){a?b||c.allOptionCheckBox.prop("checked",g):c.allOptionCheckBox.prop("checked",!1)};this.setDefaultItemText()}Object.defineProperty(b.prototype,"allOptionCheckBox",{get:function(){return this.getOptionCheckBox(this.selectAllItemId)},
enumerable:!0,configurable:!0});return b}(),d=function(){function b(a,c,g){var h=this;this.settings=c;this.controls=g;this.selectedItemIds=[];this.onItemClickHandler=function(a){h.itemMultiSelectorManager.handleItemSelection($(a.target));h.selectedItemIds=h.itemMultiSelectorManager.areAllItemsSelected()||h.itemMultiSelectorManager.areNoneItemsSelected()?[]:h.itemMultiSelectorManager.getSelectedItems();h.controls.ItemMultiSelector.trigger(b.itemMultiSelectorOnChangeEventName,h)};this.initPerfectScrollbar=
function(){h.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});var a=new CCL.CallbackDebouncer(function(){h.controls.MenuContainer.perfectScrollbar("update")});$(window).on("resize",function(){a.invokeCallback(null,100)})};window[a]=this;this.itemMultiSelectorManager=new f(this.controls.ItemMultiSelector,this.controls.MenuContainer,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.OptionCheckboxPrefix,this.settings.LanguageTerms);this.initPerfectScrollbar();
this.controls.ItemMultiSelector.parent().on("focusin",function(){h.controls.ItemMultiSelector.addClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.parent().on("focusout",function(){h.controls.ItemMultiSelector.removeClass(h.settings.CssClasses.MenuIsActive)});this.controls.ItemMultiSelector.on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&h.controls.ItemMultiSelector.trigger("click")});this.controls.MenuContainer.on("change",this.onItemClickHandler)}Object.defineProperty(b.prototype,
"hasItems",{get:function(){return this.itemMultiSelectorManager.hasItems()},enumerable:!0,configurable:!0});b.itemMultiSelectorOnChangeEventName="itemMultiSelector:onchange";return b}();e.ItemMultiSelector=d})(f.ItemMultiSelector||(f.ItemMultiSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var b=this;this.settings=d;this.onItemClickHandler=function(a){b.$checkbox.prop("checked",!b.$checkbox.is(":checked")).change();a.stopPropagation()};this.$checkbox=$("#"+this.settings.OptionCheckboxClientId);d=$("#"+d.ClientId);d.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);d.on("keyup",function(a){if(a.which===CCL.CommonConstants.keyCodes.enter)b.onItemClickHandler(a)})}}();e.Item=f})(f.ItemMultiSelector||
(f.ItemMultiSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){return function(){this.registerSafeImgBinding=function(){ko.bindingHandlers.safeImg={init:function(e,d){var b=ko.utils.unwrapObservable(d());d=ko.utils.unwrapObservable(b.src);b=ko.utils.unwrapObservable(b.fallback);$(e).prop("src",d||b)},update:function(e,d){var b=ko.utils.unwrapObservable(d());d=ko.utils.unwrapObservable(b.src);b=ko.utils.unwrapObservable(b.fallback);$(e).prop("src",d||b)}}};this.registerPerfectScrollBarBinding=function(){ko.bindingHandlers.perfectlyScrollable=
{init:function(e,d,b,a,c){d=ko.unwrap(d())||{minScrollbarLength:10};var g=$(e);g.perfectScrollbar(d);var h=new CCL.CallbackDebouncer(function(){g.perfectScrollbar("update")}),f=function(){h.invokeCallback(null,100)};$(window).on("resize",f);ko.utils.domNodeDisposal.addDisposeCallback(e,function(){g.perfectScrollbar("destroy");$(window).off("resize",f)})}}}}}();f.KnockoutCustomBindingsManager=e})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.clientFunctions={};window[b]=this;this.settings=a;this.terms=a.Terms;this.cssClasses=a.CssClasses;this.clientFunctions.DeleteCurrentPostback=new Function(a.ClientFunctions.DeleteCurrentPostback);this.clientFunctions.DeleteSelectedPostback=new Function(a.ClientFunctions.DeleteSelectedPostback);this.clientFunctions.PublishAllPostback=new Function(a.ClientFunctions.PublishAllPostback);this.clientFunctions.UnpublishAllPostback=new Function(a.ClientFunctions.UnpublishAllPostback);
this.clientFunctions.UnpublishCurrentPostback=new Function(a.ClientFunctions.UnpublishCurrentPostback);this.clientFunctions.UnpublishSelectedPostback=new Function(a.ClientFunctions.UnpublishSelectedPostback);this.grid=window[a.Controls.GridClientInstanceName]}d.prototype.publishAll=function(){var b=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.PublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(a){a&&b.clientFunctions.PublishAllPostback()})};d.prototype.unpublishAll=
function(){var b=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.UnpublishAllConfirmation,this.terms.PleaseConfirm,this.terms.Yes,this.terms.No,function(a){a&&b.clientFunctions.UnpublishAllPostback()})};d.prototype.deleteCurrentLearningObjective=function(){this.deleteConfirmation(this.settings.IsCurrentSubjectPublished,this.clientFunctions.DeleteCurrentPostback,this.clientFunctions.UnpublishCurrentPostback)};d.prototype.deleteSelectedLearningObjectives=function(){var b=this.grid.getSelectedValues();
if(0===b.length)CCL.CommonFunctions.jAlertAjaxError(this.terms.PleaseMakeSelection,this.terms.Alert,this.terms.Ok,!1);else{for(var a=!1,c=0;c<b.length;c++)if(0<this.grid.getRow(b[c]).find("."+this.cssClasses.Published).length){a=!0;break}this.deleteConfirmation(a,this.clientFunctions.DeleteSelectedPostback,this.clientFunctions.UnpublishSelectedPostback)}};d.prototype.deleteConfirmation=function(b,a,c){var g=this;CCL.CommonFunctions.jAjaxConfirm(this.terms.FirstDeleteConfirmation,this.terms.PleaseConfirm,
this.terms.Ok,this.terms.Cancel,function(h){h&&(b?g.deleteConfirmationFromPublishedSubject(a,c):a())})};d.prototype.deleteConfirmationFromPublishedSubject=function(b,a){var c=[];c.push(new CCL.ConfirmButtonMetaData(this.terms.Unpublish,"","confirm_unpublish"));c.push(new CCL.ConfirmButtonMetaData(this.terms.Delete,this.cssClasses.DeleteButton,"confirm_delete"));c.push(new CCL.ConfirmButtonMetaData(this.terms.Cancel,"","confirm_cancel"));CCL.CommonFunctions.jAjaxMultiButtonConfirm("<p>"+this.terms.DeleteConfirmationFromPublishedSubjectBody+
"</p><p>"+this.terms.DeleteConfirmationFromPublishedSubjectFooter+"</p>",this.terms.AreYouSure,c,function(c){c&&c.customId&&"confirm_cancel"!==c.customId&&("confirm_delete"===c.customId?b():"confirm_unpublish"===c.customId&&a())})};return d}();e.LearningObjectiveOverview=f})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.convertElementIdsToElementStateMapping=function(b,a){var c=new Map;b.forEach(function(b){c.set(b,a)});return c};return d}();e.LearningObjectiveRepositoryHelper=f})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){return function(d){var b=this;this.settings=d;this.openDialog=function(){var a=[];JSON.parse(b.$subjectHiddenField.val()).forEach(function(b){a.push(b.Id)});var c={elementStates:e.LearningObjectiveRepositoryHelper.convertElementIdsToElementStateMapping(a,f.CheckboxStateMachine.State.AttachedByUser),disabledElementIds:[],showAll:!0,header:b.settings.HeaderText,elementType:f.ElementLinkDialog.ContentElementType.LearningObjectives,allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None,
allowEmptySubmit:!0,afterOkClickCallback:function(a){var c=[];a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.Empty&&c.push(b)});b.updateUiWithNewElements(c)}};b.elementLinkDialogManagerInstance.openDialog(c,{countryCode:b.settings.CountryCode})};this.createTagItInput=function(){CCL.TagItInput.createTagItInput(b.$aliasesContainer,{isReadonly:!1,placeholderText:b.settings.AliasesPlaceholderText,tagitLimit:255})};this.updateSubjectsInUi=function(){var a=JSON.parse(b.$subjectHiddenField.val());
b.$subjectContainer.html("");a.forEach(function(a){var c=$("<div/>").addClass(b.settings.CssClasses.LearningObjectiveContainerCssClass),h=$("<img/>").addClass(b.settings.CssClasses.LearningObjectiveIconCssClass),d=$("<span/>").addClass(b.settings.CssClasses.LearningObjectiveTitleCssClass).text(a.Title),e=$("<span> &times; </span>").addClass(b.settings.CssClasses.LearningObjectiveDeleteCssClass).on("click",function(){b.removeSubject(a.Id)});c.append(h).append(" ").append(d).append(" ").append(e);b.$subjectContainer.append(c).append($("<br/>"))})};
this.removeSubject=function(a){var c=-1,g=JSON.parse(b.$subjectHiddenField.val());g.forEach(function(b,g){b.Id===a&&(c=g)});-1!==c&&(g.splice(c,1),b.$subjectHiddenField.val(JSON.stringify(g)),b.updateSubjectsInUi())};this.updateUiWithNewElements=function(a){$.ajax({type:"GET",url:b.settings.GetLearningObjectiveNamesUrl,data:{learningObjectiveIds:a.join(",")},dataType:"jsonp"}).done(function(a){b.$subjectHiddenField.val(JSON.stringify(a));b.updateSubjectsInUi()}).fail(function(a,b,h){CCL.CommonFunctions.alertAjaxError(a,
b,h)})};this.elementLinkDialogManagerInstance=f.ElementLinkDialog.elementLinkDialogManagerInstance;this.$subjectContainer=$("#"+d.ClientIds.SubjectLabelContainerClientId);this.$subjectHiddenField=$("#"+d.ClientIds.SubjectLabelHiddenFieldClientId);this.$aliasesContainer=$("#"+d.ClientIds.AliasesContainerClientId);this.createTagItInput();CCL.CommonFunctions.preventSubmitOnEnter($("#"+d.ClientIds.LabelTextboxClientId));$("#"+d.ClientIds.AddSubjectsButtonClientId).on("click",function(){b.openDialog();
return!1})}}();e.LearningObjectiveSubjectLabelsManager=k})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function a(b){var c=this;this.settings=b;this.signalRRetryConnection=0;window[a.clientInstanceName]=this;$(function(){c.jQueryAny=jQuery;c.jQueryAny.connection.hub.url=c.settings.Endpoint;var a=c.jQueryAny.connection.learningPathHub;"undefined"!==typeof a&&null!==a&&void 0!==a&&(a.client.activityCompleted=function(a,b){c.triggerStudentProgressEvent(d.ActivityCompleted,a,b)},a.client.resourceViewed=function(a,b){c.triggerStudentProgressEvent(d.ResourceViewed,
a,b)},a.client.teachersActionNeeded=function(a){c.triggerStudentProgressEvent(d.TeachersActionNeeded,a,0)},a.client.finishIsReached=function(a){c.triggerStudentProgressEvent(d.FinishIsReached,a,0)},a.client.anotherTryNeeded=function(a){c.triggerStudentProgressEvent(d.AnotherTryNeeded,a,0)});c.startSignalRHub();c.jQueryAny.connection.hub.connectionSlow(function(){return console.log("We are currently experiencing difficulties with the connection.")});c.jQueryAny.connection.hub.reconnecting(function(){c.setSignalROnlineStatus(!1);
console.log("SignalR reconnecting.")});c.jQueryAny.connection.hub.disconnected(function(){c.setSignalROnlineStatus(!1);console.log("SignalR disconnected.");c.reconnectToSignalRHub(!0)});c.jQueryAny.connection.hub.reconnected(function(){c.setSignalROnlineStatus(!0);console.log("SignalR reconnected.");c.reconnectToSignalRHub(!1)})})}a.prototype.triggerStudentProgressEvent=function(c,g,h){$(window).trigger(a.studentProgressChangedEvent,new b(c,g,h))};a.prototype.setSignalROnlineStatus=function(a){$(window).trigger("SignalRConnectionStatus",
a)};a.prototype.startSignalRHub=function(){var a=this;this.jQueryAny.connection.hub.start().done(function(){var b="";localStorage.getItem("learningpath-channelid")&&(b=localStorage.getItem("learningpath-channelid"));5>=b.length&&(b="");$.ajax({url:a.settings.CommunicationChannelEndPoint,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({channelId:a.jQueryAny.connection.hub.id,unregister:b})}).done(function(){a.setSignalROnlineStatus(!0);a.reconnectToSignalRHub(!1);console.log("SignalR connection registered. ChannelId: "+
a.jQueryAny.connection.hub.id)});localStorage.setItem("learningpath-channelid",a.jQueryAny.connection.hub.id)}).fail(function(b){a.setSignalROnlineStatus(!1);a.reconnectToSignalRHub(!0);console.log("Error starting SignalR connection: "+b)})};a.prototype.reconnectToSignalRHub=function(a){var b=this;a?this.signalRRetryConnection<=this.settings.RetryConnectionMax&&(this.signalRRetryConnection+=1,window.clearInterval(this.signalRRetryInterval),this.signalRRetryInterval=window.setInterval(function(){return b.startSignalRHub()},
3E3)):(window.clearInterval(this.signalRRetryInterval),this.signalRRetryConnection=0)};a.clientInstanceName="LearningPathSignalRListenerClientInstanceName";a.studentProgressChangedEvent="LearningPathSignalRListener:studentProgressChanged";return a}();e.LearningPathSignalRListener=f;(function(a){a[a.NoProgress=0]="NoProgress";a[a.ResourceViewed=1]="ResourceViewed";a[a.ActivityCompleted=2]="ActivityCompleted";a[a.TeachersActionNeeded=3]="TeachersActionNeeded";a[a.FinishIsReached=4]="FinishIsReached";
a[a.AnotherTryNeeded=5]="AnotherTryNeeded"})(e.StudentProgressType||(e.StudentProgressType={}));var d=e.StudentProgressType,b=function(){return function(a,b,g){this.studentProgressType=a;this.learningPathId=b;this.unlockedElementId=g}}();e.StudentProgressEventData=b})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.settings=b;window[d.clientInstanceName]=this;$(function(){a.$elementListContainer=$("#"+a.settings.Controls.ElementListContainerId);a.$frame=$("#"+a.settings.Controls.Frame);a.$loadingIndicator=$("#"+a.settings.Controls.LoadingIndicator);a.$feedback=$("#"+a.settings.Controls.Feedback);a.$elementListContainer.on("click","."+a.settings.Css.ElementTitle,function(b){b=$(b.currentTarget).closest("."+a.settings.Css.ElementContainer);
b=parseInt(b.data(a.settings.DataAttributes.ElementId),10);a.setCurrentElement(b);return!1});a.setCurrentElement(a.settings.ElementIdToSelect);IframeResizer.reportSetIframeDefaultHeight()})}d.getInstance=function(){return window[d.clientInstanceName]};d.reloadElementList=function(b){d.getInstance().reloadElementList(b)};d.prototype.setCurrentElement=function(b){if(!b||b!==this.currentElementId){var a=!1;if(0<b){var c=this.$elementListContainer.find("."+this.settings.Css.ElementContainer+"[data-element-id="+
b+"]");0===c.length&&(c=this.$elementListContainer.find("."+this.settings.Css.ElementContainer).first(),a=!0)}else c=this.$elementListContainer.find("."+this.settings.Css.ElementContainer).first(),a=!0;var g=c.find("."+this.settings.Css.ElementTitle).prop("href");$("."+this.settings.Css.ElementContainer).removeClass(this.settings.Css.SelectedElement);c.addClass(this.settings.Css.SelectedElement);this.$elementListContainer.scrollTop(c.offset().top-this.$elementListContainer.offset().top+this.$elementListContainer.scrollTop());
this.setFrameUrl(g);this.currentElementId=a?0:b}};d.prototype.setFrameUrl=function(b){b?(this.$frame.prop("src",b),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};d.prototype.getElementLinkTitle=function(b){return this.$elementListContainer.find(""+CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementId,b)).find("."+this.settings.Css.ElementTitle)};d.prototype.reloadElementList=function(b){var a=this;$.get(this.settings.Urls.StudentViewElementList+
"&selectedElementId="+this.currentElementId).done(function(c){a.$elementListContainer.html(c);CCL.InformationFeedback.showFeedbackWithextraButton(a.$feedback,a.getFeedbackMessage(b.studentProgressType),0<b.unlockedElementId?a.settings.Terms.Continue:a.settings.Terms.Ok,function(){0<b.unlockedElementId&&a.setCurrentElement(b.unlockedElementId);CCL.InformationFeedback.hideFeedback(a.$feedback)})})};d.prototype.getFeedbackMessage=function(b){switch(b){case e.StudentProgressType.ActivityCompleted:return this.settings.Terms.NewStepAvailable;
case e.StudentProgressType.ResourceViewed:return this.settings.Terms.TakeGoodLookAtThisResource;case e.StudentProgressType.FinishIsReached:return this.settings.Terms.ThatWasIt;case e.StudentProgressType.TeachersActionNeeded:return this.settings.Terms.YouCanContinueAfterTeacherReviewed;case e.StudentProgressType.AnotherTryNeeded:return this.settings.Terms.PleaseGiveItAnotherTry;default:return""}};d.clientInstanceName="StudentViewLearningPathInstance";return d}();e.TakeLearningPathDialogContent=f})(f.LearningPath||
(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b){var a=this;this.convertId="confirm_convert_to_folder";this.deleteId="confirm_delete";this.cancelId="confirm_cancel";window[d.clientInstanceName]=this;this.settings=b;$(function(){$("."+a.settings.Css.DeleteLink).click(function(){$.ajax({url:a.settings.Urls.GetConfirmationModelForElementsDeleting,data:{elementIds:a.settings.LearningPathId},dataType:"json"}).done(function(b){var c=[],g=0===$("."+a.settings.Css.StepElementTitle).length,d=g?a.settings.Terms.EmptyLearningPathDeleteConfirmation:
a.settings.Terms.LearningPathDeleteConfirmation;c.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Delete,a.settings.Css.RedButton,a.deleteId));g||c.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.MakeNormalFolder,a.settings.Css.ConfirmConvertButton,a.convertId));c.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Cancel,"",a.cancelId));b&&b.HasTreeLinks&&(d=b.TreeLinksDeleteConfirmationMessage+" "+d);a.showDeleteConvertConfirmDialog(d,c)})});$("."+a.settings.Css.ConvertToFolderLink).click(function(){var b=
[];b.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Ok,a.settings.Css.BlueButton,a.convertId));b.push(new CCL.ConfirmButtonMetaData(a.settings.Terms.Cancel,"",a.cancelId));a.showDeleteConvertConfirmDialog(a.settings.Terms.AreYouSure,b)});var b=new f.Controls.ElementTitleEditor($("."+a.settings.Css.TitleLabel),a.settings.TitleEditorSettings,a.settings.LearningPathId,a.settings.ParentFolderId);if(a.settings.PopupScripts&&(a.settings.PopupScripts.AddElement&&a.executeScript(a.settings.PopupScripts.AddElement),
a.settings.PopupScripts.UpdateElement))$(b).on("change",function(){return a.executeScript(a.settings.PopupScripts.UpdateElement)})})}d.prototype.showDeleteConvertConfirmDialog=function(b,a){var c=this;CCL.CommonFunctions.jAjaxMultiButtonConfirm("",b,a,function(a){if(a&&a.customId)switch(a.customId){case c.deleteId:c.deleteLearningPath();break;case c.convertId:c.convertLearningPathToFolder()}})};d.prototype.showError=function(b,a){void 0===a&&(a=!1);CCL.CommonFunctions.jAlertAjaxError(b,this.settings.Terms.ErrorOccured,
this.settings.Terms.Ok,a)};d.prototype.convertLearningPathToFolder=function(){var b=this;$.ajax({url:this.settings.Urls.ConvertToFolder.Action,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({LearningPathId:this.settings.LearningPathId})}).done(function(a){a.Success?b.settings.UseSimpleMenu?window.top.location.href=b.settings.Urls.ConvertToFolder.RedirectAfterSucceed:window.location.href=b.settings.Urls.ConvertToFolder.RedirectAfterSucceed:b.showError(a.ErrorMessage)}).fail(function(){return b.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};
d.prototype.deleteLearningPath=function(){var b=this;$.ajax({url:this.settings.Urls.Delete.Action,type:"DELETE",dataType:"json",contentType:"application/json",data:JSON.stringify({LearningPathId:this.settings.LearningPathId})}).done(function(a){a.Success?window.location.href=b.settings.Urls.Delete.RedirectAfterSucceed:b.showError(a.ErrorMessage)}).fail(function(){return b.showError(b.settings.Terms.LearningPathGeneralErrorMessage)})};d.prototype.executeScript=function(b){(new Function(b))()};d.clientInstanceName=
"LearningPathCommonEditActionsInstance";return d}();e.LearningPathCommonEditActions=k})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;window[d.clientInstanceName]=this;this.settings=b;$(function(){$("#"+a.settings.Controls.OpenDialogLink).click(function(b){b=$(b.currentTarget).prop("href");a.dialog.openDialog(b);return!1});a.dialog=CCL.FullScreenDialog.getInstance();$(a.dialog).on(CCL.FullScreenDialog.onCloseEvent,function(){clearTimeout(a.timer);window.location.href=a.settings.Urls.ViewLearningPath});$(window).on(e.LearningPathSignalRListener.studentProgressChangedEvent,
function(b,g){a.settings.LearningPathId===g.learningPathId&&(a.timer=setTimeout(function(){return a.reloadElementList(g)},a.getTimeout(g)))})})}d.prototype.reloadElementList=function(b){this.dialog.isOpened()?e.TakeLearningPathDialogContent.reloadElementList(b):window.location.href=this.settings.Urls.ViewLearningPath};d.prototype.getTimeout=function(b){return b.studentProgressType===e.StudentProgressType.ResourceViewed?this.settings.Timeouts.ResourceCompletedInMs:b.studentProgressType===e.StudentProgressType.FinishIsReached?
this.settings.Timeouts.FinishIsReachedInMs:this.settings.Timeouts.ActivityCompletedInMs};d.clientInstanceName="TakeLearningPathDialogLauncherInstance";return d}();e.TakeLearningPathDialogLauncher=f})(f.LearningPath||(f.LearningPath={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,c){var g=this;this.dataUrl=b;this.model=c;this.page=0;this.run=function(b){b&&(g.page=b);g.model.lettersLoading(!0);b={supervisorType:g.model.settings.SupervisorType,termId:g.model.termId(),hierarchyIds:g.model.hierarchyIds(),paging:{pageIndex:g.page,pageSize:a.pageSize},sorting:{sort:g.model.sorting.term,sortDescending:g.model.sorting.descending},search:g.model.lettersSearch()};b=CCL.CommonFunctions.safeAjaxPost({url:g.dataUrl,data:b,dataType:"json"});
b.done(function(a){g.model.addLetters(a);g.page++;g.model.lettersLoading(!1)});return b}}a.pageSize=50;return a}(),d=function(){return function(){this.term="FullName";this.descending=!1}}(),b=function(){function a(a,b){var c=this;this.settings=a;this.controls=b;this.addLetters=function(a){[].push.apply(c.allLetters(),a);c.allLetters.valueHasMutated();c.lettersLoading(!1);c.lettersCount(c.allLetters().length);c.areAllLettersRetreived(!a||0===a.length||a.length<k.pageSize)};this.showCard=function(a){return c.showStudentProfile(a)};
this.showLetters=function(a){return c.showStudentProfile(a,"letters")};this.setSorting=function(a,b){a=$(b.currentTarget).data(c.settings.DataAttributes.SortValue);c.allLetters([]);c.lettersLoading(!0);c.lettersCount(0);a===c.sorting.term?c.sorting.descending=!c.sorting.descending:(c.sorting.term=a,c.sorting.descending=!0);c.fetcher.page=0;c.fetcher.run()};this.showMoreLetters=function(a){$(a.currentTarget).blur();c.fetchNextLettersPage()};this.getParentLettersOverview=function(a){return 0<a.parentLettersTotalNumber?
a.lettersOpenedByParentsTotalNumber+"/"+a.parentLettersTotalNumber:"-"};this.getStudentLettersOverview=function(a){return 0<a.studentLettersTotalNumber?a.lettersOpenedByStudentTotalNumber+"/"+a.studentLettersTotalNumber:"-"};this.fetchData=function(){c.allLetters([]);c.lettersCount(c.allLetters().length);c.lettersLoading(!0);c.fetcher.page=0;null!=c.fetchDataPromise&&c.fetchDataPromise.readyState!==c.fetchDataPromise.DONE&&c.fetchDataPromise.abort();c.fetchDataCallbackDebouncer.invokeCallback({},
200)};this.onSearchChangeHandler=function(a){var b=$(a.currentTarget).val();b=(a.which===CCL.CommonConstants.keyCodes.del||a.which===CCL.CommonConstants.keyCodes.backspace)&&b&&""===$.trim(b);if(a.which===CCL.CommonConstants.keyCodes.enter||b)c.lettersSearch($(a.currentTarget).val()),c.fetchData(),c.$searchFilter.val(c.lettersSearch()),a.stopPropagation();CCL.CommonFunctions.isMobileDevice()&&a.which===CCL.CommonConstants.keyCodes.enter&&$(a.currentTarget).blur();0===$(a.currentTarget).val().length?
c.$searchFilterClear.hide():c.$searchFilterClear.show()};this.onSearchClearHandler=function(){c.lettersSearch("");c.$searchFilter.val(c.lettersSearch());c.$searchFilterClear.hide();c.fetchData()};this.fetchNextLettersPage=function(){c.areAllLettersRetreived()||(null!=c.lettersScrollingPromise&&c.lettersScrollingPromise.readyState!==c.lettersScrollingPromise.DONE&&c.lettersScrollingPromise.abort(),c.lettersScrollingTimeout&&clearTimeout(c.lettersScrollingTimeout),c.lettersScrollingTimeout=setTimeout(function(){c.allLetters.valueHasMutated();
c.lettersScrollingPromise=c.fetcher.run()},50))};this.onFetchLettersHandler=function(a){a=$(a.target).scrollTop();if(a>c.lettersLastScrollTop){var b=$("."+c.settings.CssClasses.StudentsList).children("li");b=b.eq(b.length-k.pageSize/2);CCL.CommonFunctions.isOnScreen(b,.5,.5)&&c.fetchNextLettersPage()}c.lettersLastScrollTop=a};this.showStudentProfile=function(a,b){document.showProfileCard?b?document.showProfileCard(a.personId,b):document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,
"","resizable,scrollbars,height=500,width=750")};this.configTermFilter=function(){c.controls.TermFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,c.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,b){c.measureLettersOverviewPageFilterUsageKpi();c.termId(b.selectedItemId);c.fetchData()};this.configHierarchyFilter=function(){c.controls.HierarchyFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,c.onHierarchyFilterItemClickHandler)};
this.onHierarchyFilterItemClickHandler=function(a,b){c.measureLettersOverviewPageFilterUsageKpi();c.hierarchyIds(b.selectedItemIds);c.fetchData()};this.measureLettersOverviewPageFilterUsageKpi=function(){CCL.CommonFunctions.measureKpi(c.settings.WebMethods.MeasureKpi,c.settings.SupervisorKpiSection,c.settings.LettersOverviewPageFilterUsageKpiMeasurement,c.settings.RegularKpiContext)};this.fetchDataCallbackDebouncer=new CCL.CallbackDebouncer(function(){c.fetchDataPromise=c.fetcher.run()});this.allLetters=
ko.observableArray([]);this.lettersInitiated=ko.observable(!1);this.lettersLoading=ko.observable(!0);this.letters=ko.pureComputed(function(){return c.allLetters()});this.lettersCount=ko.observable(0);this.areAllLettersRetreived=ko.observable(!1);this.lettersSearch=ko.observable("");this.$searchFilter.keyup(this.onSearchChangeHandler);this.$searchFilterClear.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onSearchClearHandler);this.sorting=new d;this.lettersLastScrollTop=$(window).scrollTop();
$(window).on("scroll touchmove",this.onFetchLettersHandler);this.configTermFilter();this.configHierarchyFilter();this.termId=ko.observable(null);this.hierarchyIds=ko.observableArray([]);this.isSearchOrFilteringApplied=ko.pureComputed(function(){return 0<c.lettersSearch().length||null!=c.termId()||0<c.hierarchyIds().length})}Object.defineProperty(a.prototype,"$searchFilter",{get:function(){return $("."+this.settings.CssClasses.SearchFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$searchFilterClear",{get:function(){return $("."+this.settings.CssClasses.SearchFilterClear)},enumerable:!0,configurable:!0});return a}();e.LettersOverviewViewModel=b;var a=function(){function a(a,c){var g=this;this.settings=a;this.controls=c;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).hasClass("c-supervisor-letters__inner")&&a.stopPropagation()};(new f.KnockoutCustomBindingsManager).registerSafeImgBinding();this.model=new b(a,c);ko.applyBindings(this.model,$("."+this.settings.CssClasses.Container)[0]);
this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){g.$container.off("click",g.preventFromDropDownMenuFromClosing)});this.model.fetcher=new k(this.settings.WebMethods.GetSupervisorLettersOverviews,this.model);this.model.fetcher.run().done(function(){g.model.lettersInitiated(!0)})}Object.defineProperty(a.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});
return a}();e.SupervisorLetters=a})(f.Letter||(f.Letter={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.settings=b;this.$mainContainer=$("#"+this.settings.Controls.MainContainer);this.$courseGroupSelectorLink=$("#"+this.settings.Controls.GroupSelectorLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.settingManager=e.Settings.Manager.getInstance();$(function(){$("#"+c.settings.Controls.DropDownMenuContainer).find("."+c.settings.MenuItemCssClass).click(function(a){a=
$(a.currentTarget).data("groupid");CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.CreateCollaborationBasedOnCourseGroup.replace("{elementId}",c.settings.ElementId.toString()),data:{groupId:a}}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})});c.$submitIndividuallyLink.on("click",function(){CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.UseIndividualSubmission.replace("{elementId}",c.settings.ElementId.toString())}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})})})}
a.prototype.processResponse=function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();d.CourseGroups=b})(f.Collaboration||(f.Collaboration={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function b(a,b,g){d.call(this,b,g,function(){});this.actionUrlsBase=a}__extends(b,d);b.prototype.getElementListMarkupForEventIds=function(a,b,g,h,d,e){void 0===d&&(d="");void 0===e&&(e=!1);return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrlsBase.GetElementListMarkupForEventIds,data:{eventId:a,startDateTime:b,courseId:g,elementIds:h,fakeElementTitle:d,showConnectedDate:e},dataType:"json"})};b.prototype.createNewFileElementForEvent=function(a,b,g,
h){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrlsBase.CreateNewFileElementForEvent,data:{CourseId:a,EventId:b,FileName:g.name,FileId:g.id,SignedFileId:g.signature,ShouldFileBeAttachedToEventImmediately:h}})};return b}(f.CommonAjaxClient);e.AjaxClientBase=k})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(b){function a(a){b.call(this,a,"","");this.actionUrls=a}__extends(a,b);a.prototype.validateDateRelatedContent=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.ValidateDateRelatedContent,data:a})};a.prototype.checkRecurringEventPeriodDuration=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.CheckRecurringEventPeriodDuration,async:!1,data:a})};a.prototype.getDatesOfEventsToBePickedAsNextEventForEditEventPage=
function(a){return $.ajax({type:"GET",url:this.actionUrls.GetDatesOfEventsToBePickedAsNextEventForEditEventPage,async:!1,data:a,dataType:"json"})};a.prototype.getTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetTimeSlotsOfEventsToBePickedAsNextEventForEditEventPage,async:!1,data:a,dataType:"json"})};a.prototype.getBookingMarkups=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.GetBookingMarkups,data:a,dataType:"json"})};
return a}(e.AjaxClientBase);f.AjaxClient=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(b){function a(a,g){b.call(this,g,g.checkSession,a.settings.terms.errorMessage);this.actionUrls=g}__extends(a,b);a.prototype.getAddResourceMenu=function(a){return $.ajax({type:"GET",url:this.actionUrls.getAddResourceMenu,data:a})};a.prototype.updateEventElements=function(a){return $.ajax({type:"PUT",url:this.actionUrls.updateEventElements,data:JSON.stringify(a),contentType:"application/json"})};a.prototype.removeElement=function(a){return $.ajax({type:"DELETE",
url:this.actionUrls.removeElement,data:JSON.stringify(a),contentType:"application/json"})};a.prototype.createEventWithLocation=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.createEventWithLocation,data:a,dataType:"json"})};a.prototype.editEventTitle=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditEventTitle,data:a,dataType:"json"})};a.prototype.editEventDescription=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.editEventDescriptionUrl,
data:a,dataType:"json"})};a.prototype.editEventExtraDescription=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditEventExtraDescription,data:a,dataType:"json"})};a.prototype.editNextEventId=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.actionUrls.EditNextEventId,data:a,dataType:"json"})};a.prototype.eventScope=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.eventScopeUrl,data:a,dataType:"json"})};a.prototype.getPreferences=
function(a){return $.ajax({type:"GET",url:this.actionUrls.GetPersonSettingsByPrefix,data:{settingNamePrefix:a}})};a.prototype.deleteEvent=function(a,b){return CCL.CommonFunctions.safeAjaxPost({url:a.deleteEventUrl,data:{ActivityId:a.activityId,IsSingle:b}})};a.prototype.getDatesOfEventsToBePickedAsNextEventForSchedulePage=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetDatesOfEventsToBePickedAsNextEventForSchedulePage,async:!1,data:a,dataType:"json"})};a.prototype.getTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage=
function(a){return $.ajax({type:"GET",url:this.actionUrls.GetTimeSlotsOfEventsToBePickedAsNextEventForSchedulePage,async:!1,data:a,dataType:"json"})};a.prototype.checkIfAnyOfMyEventsFiltered=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.checkIfAnyOfMyEventsFiltered,data:a,dataType:"json"})};a.prototype.getCourseApprovalDates=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetCourseApprovalDates,async:!1,data:a,dataType:"json"})};a.prototype.checkRecurringEventGroupsMembership=
function(a){return $.ajax({type:"GET",url:this.actionUrls.CheckRecurringEventGroupsMembership,async:!1,data:a,dataType:"json"})};a.prototype.getEvent=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetEvent,async:!1,data:a,dataType:"json"})};a.prototype.removeCalendar=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.removeCalendar,data:a})};a.prototype.changeCalendarView=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.changeCalendarView,data:a})};
a.prototype.getGroupsForDropdown=function(a){return $.ajax({type:"GET",url:this.actionUrls.getGroupsForDropdown,data:a})};a.prototype.getRecurringEventDetails=function(a){return $.ajax({type:"GET",url:this.actionUrls.GetRecurringEventDetails,data:a,async:!1})};a.prototype.saveFilterPreferences=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.saveCalendarFiltersPreferences,data:a})};a.prototype.addCalendar=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.addCalendar,
dataType:"html",data:a})};a.prototype.toggleCalendar=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.actionUrls.toggleCalendar,data:a})};return a}(e.AjaxClientBase);f.AjaxClient=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(b){function a(a,g){b.call(this,a.dataAttributes,a.cssClasses,a.terms,a.ClientInstanceNames,a.PostMessageNames,g,a.constants);this.settings=a;this.controls=g;this.initSelectors();this.initDataAttributes()}__extends(a,b);a.prototype.getExpandableContainer=function(a){return a.closest(this.selectors.expandableContainer)};a.prototype.getManuallyAddedElementsCount=function(a){return a.find("li["+this.dataAttributes.elementListItem+"*='\"AddedManually\":true']").length};
a.prototype.formatSectionNameWithCounter=function(a,b){return a+" ("+b+")"};a.prototype.getElementListAppendTarget=function(a){return a.find("."+this.settings.cssClasses.SelectedElementListAppendTarget)};a.prototype.initSelectors=function(){this.selectors.addEventDialogAttachedElementsHidden="data-"+this.settings.dataAttributes.AddEventDialogAttachedElementsHidden;this.selectors.contextDialogHeaderH2="."+this.settings.cssClasses.ContextDialogHeader+" > h2";this.selectors.expandableContainerHeaderIcon=
"."+this.settings.cssClasses.ExpandableContainerHeader+" > ."+this.settings.cssClasses.Icon;this.selectors.expandableContainer="."+this.settings.cssClasses.ExpandableContainer};a.prototype.initDataAttributes=function(){this.dataAttributes.addEventDialogAttachedElementsHidden=CCL.CommonFunctions.getDataSelector(this.settings.dataAttributes.AddEventDialogAttachedElementsHidden)};return a}(e.CalendarUtilityBase);f.Utility=d})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f;(function(b){b[b.NotLoaded=0]="NotLoaded";b[b.Loading=1]="Loading";b[b.Loaded=2]="Loaded"})(f||(f={}));var d=function(){function b(a,b,g,h){function c(a){var b=a.position().left+a.width()/2;a=a.position().top+10;r.openDialogAt(b,a,!1)}var d=this,e=f.NotLoaded,k=$("<div class='ccl-context-dialog-content-container'></div>").hide();a.after(k);var p=null,r=new ContextDialog(k,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,width:420,marginTop:b.height(),marginLeft:-210,
scrollToLastWindowOnClose:!1,cssClass:h}),u=r.closeDialog;r.setCloseFunction(function(a){u(a)});window.addEventListener("orientationchange",function(a){return r.closeDialog(a)});k.click(function(){return r.closeDialog()});b.click(function(a){if(r.isOpened())r.closeDialog();else{var b=$(a.target),h=d.getParams(b);e!==f.Loaded||d.paramsAreEqual(p,h)||(e=f.NotLoaded,k.empty());e===f.Loaded?c($(a.currentTarget)):e===f.NotLoaded&&(e=f.Loading,$.get(g,d.formatUrlParams(h),function(b){b&&(k.append(b),c($(a.currentTarget)));
e=f.Loaded;p=h}).fail(function(){return e=f.NotLoaded}))}})}b.prototype.getParams=function(a){throw Error("Abstract method should be overriden");};b.prototype.paramsAreEqual=function(a,b){throw Error("Abstract method should be overriden");};b.prototype.formatUrlParams=function(a){throw Error("Abstract method should be overriden");};return b}();e.BaseDetailedInfo=d})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function b(a,b){var c=$(".tablelisting"),h=$(".tablelisting > table > tbody > tr > td > a");d.call(this,c,h,a,b)}__extends(b,d);b.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").children("td").eq(1).children().html();return{Period:b,CustomerId:a}};b.prototype.paramsAreEqual=function(a,b){return null==a?!1:a.Period===b.Period&&a.CustomerId===b.CustomerId};b.prototype.formatUrlParams=function(a){return{periodid:a.Period,customerId:a.CustomerId}};
return b}(e.BaseDetailedInfo);e.ListOnlineSitesDetailedInfo=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function b(a,b,g){var c=$(".tabsframe > div");d.call(this,c,a,b,g)}__extends(b,d);b.prototype.getParams=function(a){var b=a.data("period");a=a.closest("tr").data("c-c");return{Period:b,CountryCode:a}};b.prototype.paramsAreEqual=function(a,b){return null==a?!1:a.Period===b.Period&&a.CountryCode===b.CountryCode};b.prototype.formatUrlParams=function(a){return{periodid:a.Period,countrycode:a.CountryCode}};return b}(e.BaseDetailedInfo);e.ListOnlineSummaryDetailedInfo=
f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.isUploaderDirty=function(){var a=c.getNewUploaderInstance();return!!a&&0<a.uploadedItems.uploadMetadataArray.length+a.uploadedItems.fileInCloudMetadataArray.length+a.uploadedItems.folderMetadataArray.length};this.isFormDirty=function(){return c.isUploaderDirty()||!c.customScripts.isDescriptionEmpty()||c.$titleInput.val()&&0<c.$titleInput.val().length||0<c.$criteriaWeightsHidden.val().length};this.handleConfirmDialogAndSaveButtonBehaviour=
function(a){switch(a){case UploadStatus.InProgress:c.lockSaveButton(!0);break;case UploadStatus.SucceededWithErrors:case UploadStatus.Succeeded:case UploadStatus.Awaiting:case UploadStatus.Failed:c.lockSaveButton(!1)}c.updateSaveButtonState()};var g=this;window[b.ClientInstanceName]=this;this.settings=b;this.customScripts=a;this.timer=0;this.selectedLoIds=this.settings.LearningObjectiveIds;this.$criteriaWeightsHidden=$("#"+this.settings.ClientIds.CriteriaWeightsHidden);this.$manageRubricPopupTriggerLink=
$("#"+this.settings.ClientIds.ManageRubricPopupTriggerLink);this.$criteriaWeightsHidden.val(JSON.stringify(this.settings.CriteriaWeights));this.$document=$(document);a="."+this.settings.Css.SaveButton;this.$saveButton=$(a);this.buttonLoadingIndicator=new CCL.ButtonLoadingIndicator(a,this.settings.Css.ButtonInProgress,null,100);this.$titleInput=$("#"+this.settings.ClientIds.Title);this.isTitleValid=this.validateTitle();this.isDescriptionToolbarExpanded=b.IsDescriptionToolbarExpanded;this.formCheckBeforeUnload=
new CCL.FormCheckBeforeUnload($("#"+this.settings.ClientIds.Form),this.settings.Terms.BeforeUnloadWarningMessage,{$cancelButtons:this.$saveButton,callback:this.isFormDirty});this.settings.SubmitButtonLocked&&this.$saveButton.toggleHyperlink(!1);g.isSettingsValid=!0;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,function(a){a.extendedData.updateSettings||(g.selectedLoIds=a.extendedData.loIds,g.$criteriaWeightsHidden.val(a.extendedData.criteriaWeights),
$(document).trigger(c.settings.EventNames.RubricChanged,{loIds:c.selectedLoIds,criteriaWeights:a.extendedData.criteriaWeights}))});this.$manageRubricPopupTriggerLink.click(function(){g.initManageManageRubricPopup();window[g.settings.ClientIds.RubricPopup].openDialog();return!1});this.$titleInput.on("blur",function(){g.onTitleChangeHandler()});this.$titleInput.on("input",function(a){g.onInputChangeHandler(a,g.onTitleChangeHandler)});this.$document.on(this.settings.EventNames.ValidStateChanged,function(a,
b){g.isSettingsValid=b;g.updateSaveButtonState()});this.$document.on(this.settings.EventNames.LearningObjectivesChanged,function(a,b){b.isSyncContext||(g.selectedLoIds=b.ids,$(document).trigger(c.settings.EventNames.UpdateMaxScore,{loIds:g.selectedLoIds,criteriaWeights:g.$criteriaWeightsHidden.val()}))});this.$document.on(this.settings.EventNames.ToggleCriteriaWeightsVisibility,function(a,b){c.settings.ShowCriteriaWeights=b.show});if(!g.settings.IsDescriptionReadOnly)if("undefined"!==typeof CKEDITOR)CKEDITOR.on("instanceReady",
function(){var a=g.customScripts.getDescriptionEditorInput();a.on("blur",function(){c.onDescriptionChangeHandler()});a.on("change",function(a){c.onInputChangeHandler(a,c.onDescriptionChangeHandler)});a.on("contentDom",function(){a.document.on("keyup",function(a){c.onInputChangeHandler(a,c.onDescriptionChangeHandler)})});if(g.isDescriptionToolbarExpanded){var b=a.getCommand(g.settings.DescriptionToolbarExpandedCommandName),d=b.editorFocus;b.editorFocus=!1;a.execCommand(g.settings.DescriptionToolbarExpandedCommandName);
b.editorFocus=d}a.on(g.settings.EventNames.DescriptionToolbarExpanded,function(a){g.isDescriptionToolbarExpanded=a.data.expanded;g.toggleDescriptionToolbar()});c.onDescriptionChangeHandler()});else this.onDescriptionChange($(this.customScripts.getDescriptionEditorInput()));this.updateSaveButtonState();this.$document.on(b.EventNames.PreviewDialogOpened,function(){CCL.CommonFunctions.makePostMessageCall(window,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.hideSettings,
{ForceReload:!1}))});this.$document.on(b.EventNames.PreviewDialogClosed,function(){CCL.CommonFunctions.makePostMessageCall(window,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.showSettings))});this.buttonLoadingIndicator.disableLoadingIndicator=!this.$saveButton.getIfHyperLinkEnabled();$("button."+this.settings.Css.CancelButton).on("click",function(){window.close()})}d.prototype.closeManageRubricDialog=function(){var b=$("#"+this.settings.ClientIds.RubricPopup).find("iframe").get(0).contentWindow;
CCL.CommonFunctions.makePostMessageCall(b,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.submitIframe))};d.prototype.collectContent=function(){var b={};b.Title=this.$titleInput.val();b.Description=this.customScripts.isDescriptionEmpty()?"":this.customScripts.getDescription();var a=this.getNewUploaderInstance();a&&(b.SerializedUploadResults=JSON.stringify(a.uploadedItems));b.SerializedCriteriaWeights=this.$criteriaWeightsHidden.val();return b};d.prototype.lockSaveButton=
function(b){this.settings.SubmitButtonLocked=b};d.prototype.validateTitle=function(){if(0<this.$titleInput.length){var b=this.$titleInput.val();return b&&0<b.length}return!0};d.prototype.validateUploads=function(){return this.settings.IsUploadRequired?this.isUploaderDirty():!0};d.prototype.onDescriptionChange=function(b){var a=this;b.on("blur",function(){a.onDescriptionChangeHandler()});b.on("input",function(b){a.onInputChangeHandler(b,a.onDescriptionChangeHandler)})};d.prototype.onTitleChangeHandler=
function(){var b=this.getSettingsEditor();null!=b&&b.stateChanged();this.isTitleValid=this.validateTitle();this.updateSaveButtonState()};d.prototype.getSettingsEditor=function(){null==this.settingsEditor&&(this.settingsEditor=window[this.settings.ClientIds.EditSettingsViewInstanceName]);return this.settingsEditor};d.prototype.typeWatch=function(b,a){clearTimeout(this.timer);this.timer=setTimeout(b.bind(this),a)};d.prototype.onInputChangeHandler=function(b,a){b=b.which;b>=CCL.CommonConstants.keyCodes.arrowLeft&&
b<=CCL.CommonConstants.keyCodes.arrowDown||this.typeWatch(a,500)};d.prototype.onDescriptionChangeHandler=function(){var b=this.getSettingsEditor();null!=b&&b.stateChanged();this.updateSaveButtonState()};d.prototype.initManageManageRubricPopup=function(){var b=this.settings.ManageRubricDialogUrl,a=this.getParameterByName(b,"Ids");b=a?b.replace(a[0],a[0][0]+"Ids="+encodeURIComponent(this.selectedLoIds.join(","))):b+(-1===b.indexOf("?")?"?":"&")+"Ids="+encodeURIComponent(this.selectedLoIds.join(","));
if(a=this.$criteriaWeightsHidden.val()){var c=this.getParameterByName(b,"CriteriaWeights");b=c?b.replace(c[0],c[0][0]+"CriteriaWeights="+encodeURIComponent(a)):b+(-1===b.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(a)}a=this.settings.ShowCriteriaWeights?"1":"0";b=(c=this.getParameterByName(b,"ShowCriteriaWeights"))?b.replace(c[0],c[0][0]+"ShowCriteriaWeights="+a):b+(-1===b.indexOf("?")?"?":"&")+"ShowCriteriaWeights="+a;window[this.settings.ClientIds.RubricPopup].setIframeUrl(b)};d.prototype.getParameterByName=
function(b,a){return RegExp("[?&]"+a+"=([^&]*)").exec(b)};d.prototype.updateSaveButtonState=function(){this.settings.SubmitButtonLocked?this.$saveButton.toggleHyperlink(!1):this.$saveButton.toggleHyperlink(this.isSettingsValid&&this.isTitleValid&&this.validateUploads());this.buttonLoadingIndicator.disableLoadingIndicator=!this.$saveButton.getIfHyperLinkEnabled()};d.prototype.toggleDescriptionToolbar=function(){CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPersonSetting,data:{key:this.settings.PersonSettingIsDescriptionToolbarExpandedKey,
value:this.isDescriptionToolbarExpanded?"true":"false"}})};d.prototype.getNewUploaderInstance=function(){var b=window.document.getElementById(this.settings.ClientIds.UploadAreaClientId);return b?b[this.settings.ClientIds.UploaderControlClientInstanceName]:void 0};return d}();e.AddLearningToolElement=f})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.prototype.validateAndTransferElementStateAfterClick=function(b,a){this.validateElementState(b,a);return this.transferElementState(a)};d.prototype.transferElementStateAfterSave=function(b){return b===e.State.AttachedByUser?e.State.Saved:b===e.State.DetachedByUser?e.State.Empty:b};d.prototype.isElementChecked=function(b){return b===e.State.AttachedByUser||b===e.State.Saved};d.prototype.validateElementState=function(b,a){if(!(b&&!this.isElementChecked(a)||
!b&&this.isElementChecked(a)))throw Error("Incorrect element state occurred IsChecked "+b+" StateBeforeCheck "+a);};d.prototype.transferElementState=function(b){switch(b){case e.State.DetachedByUser:return e.State.Saved;case e.State.Empty:return e.State.AttachedByUser;case e.State.AttachedByUser:return e.State.Empty;case e.State.Saved:return e.State.DetachedByUser;default:throw Error("Unknown State "+b);}};return d}();e.Machine=f})(f.CheckboxStateMachine||(f.CheckboxStateMachine={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.peerAndSelfAssessmentStateChanged=function(a){c.togglePeerAssessment();$(document).trigger(c.settings.Triggers.StateChanged,[c.activated,c.selfAssessmentActivated])};this.deadlineChanged=function(a){c.enabled=!(c.hasDeadlinePassed||c.groupActivityEnabled)};this.groupActivityStateChanged=function(a,b){c.groupActivityEnabled=b;c.groupActivityEnabled&&(c.activated=!1,c.selfAssessmentActivated=!1);c.enabled=!(c.hasDeadlinePassed||
c.groupActivityEnabled);c.selfAssessmentEnabled=!c.groupActivityEnabled};window[a]=this;this.settings=b;$(function(){c.$peerAssessmentDropDownContainer=$("#"+c.settings.Controls.PeersCountDropDownContainer);c.$peerAssessmentDropDown=$("#"+c.settings.Controls.PeersCountDropDown);c.$container=$("#"+c.settings.Controls.Container);c.$checkbox=$("#"+c.settings.Controls.Checkbox);c.$selfAssessmentCheckbox=$("#"+c.settings.Controls.SelfAssessmentCheckbox);c.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(c.$checkbox);
c.$customTooltipForSelfAssessmentCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(c.$selfAssessmentCheckbox);c.deadline=window[c.settings.ClientInstanceNames.Deadline];c.groupActivityEnabled=c.settings.GroupActivityEnabled;c.enabled=c.settings.Enabled;c.selfAssessmentEnabled=!c.settings.GroupActivityEnabled;c.$peerAssessmentDropDown.val(c.settings.PeersCount.toString());c.togglePeerAssessment();if(!c.settings.Enabled||!c.settings.HasDeadlinePassed)if($(c.deadline).change(c.deadlineChanged),
c.$checkbox.change(c.peerAndSelfAssessmentStateChanged),c.settings.Events.GroupActivityStateChanged)$(document).off(c.settings.Events.GroupActivityStateChanged).on(c.settings.Events.GroupActivityStateChanged,c.groupActivityStateChanged);c.$selfAssessmentCheckbox.change(c.peerAndSelfAssessmentStateChanged)})}Object.defineProperty(b.prototype,"activated",{get:function(){return this.$checkbox.is(":checked")},set:function(a){this.$checkbox.toggle(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"selfAssessmentActivated",{get:function(){return this.$selfAssessmentCheckbox.is(":checked")},set:function(a){this.$selfAssessmentCheckbox.toggle(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"enabled",{set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$checkbox.prop("disabled",!a);this.customTooltipForCheckbox.setToolTipHtml(a?"":this.tooltip);this.customTooltipForCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"selfAssessmentEnabled",{set:function(a){this.$selfAssessmentCheckbox.prop("disabled",!a);this.$customTooltipForSelfAssessmentCheckbox.setToolTipHtml(a?"":this.settings.Terms.SelfAssessmentDisabledWarning);this.$customTooltipForSelfAssessmentCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"peersToAssessCount",{get:function(){return this.$peerAssessmentDropDown.val()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hasDeadline",{get:function(){var a=
this.deadline.getState().DateTime;return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hasDeadlinePassed",{get:function(){return this.hasDeadline?this.deadline.getDateTime()<new Date:!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"tooltip",{get:function(){var a="";this.hasDeadlinePassed?a=this.settings.Terms.DeadlineHasPassedWarning:this.hasDeadline||(a=this.settings.Terms.DeadlineIsEmptyWarning);this.groupActivityEnabled&&(""!==
a&&(a+=" "),a+=this.settings.Terms.PeerAssessmentDisabledWarning);return a},enumerable:!0,configurable:!0});b.prototype.togglePeerAssessment=function(){this.$peerAssessmentDropDownContainer.toggle(this.$checkbox.is(":checked"));this.$peerAssessmentDropDownContainer.prop("disabled",!this.$checkbox.is(":enabled"));this.$peerAssessmentDropDown.prop("disabled",!this.$checkbox.is(":enabled"))};return b}();e.PeerAssessment=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a){var b=this;this.viewModel=a;this.onJQueryReady=function(){b._$controlElement=$("#"+b.viewModel.ContainerId);b._$whenToShowResultElement=$("."+b.viewModel.WhenToShowResultSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerElement=$("."+b.viewModel.WhenToShowQuestionListAndAnswerSelector,b._$controlElement);b._$whenToShowQuestionListAndAnswerContainer=$("#"+b.viewModel.WhenToShowQuestionListAndAnswerContainer,b._$controlElement);
b._$revealCorrectAnswerContainer=$("#"+b.viewModel.RevealCorrectAnswerContainer,b._$controlElement);b._$maxAttemptsAllowedElement=$(""+b.viewModel.MaxAttemptsAllowedSelector)};this._$revealCorrectAnswerElement=$("#"+a.RevealCorrectAnswerClientId);this._deadlinePicker=window[a.DeadlineInstanceName];$(this.onJQueryReady)}Object.defineProperty(a.prototype,"$controlElement",{get:function(){return this._$controlElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowResultElement",
{get:function(){return this._$whenToShowResultElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowResultAllOptionElements",{get:function(){return $("option",this.$whenToShowResultElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerElement",{get:function(){return this._$whenToShowQuestionListAndAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAllOptionElements",
{get:function(){return $("option",this.$whenToShowQuestionListAndAnswerElement)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"revealCorrectAnswerElement",{get:function(){return this._$revealCorrectAnswerElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerContainer",{get:function(){return this._$whenToShowQuestionListAndAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$revealCorrectAnswerContainer",
{get:function(){return this._$revealCorrectAnswerContainer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$maxAttemptsAllowedElement",{get:function(){return this._$maxAttemptsAllowedElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"deadlinePicker",{get:function(){return this._deadlinePicker},enumerable:!0,configurable:!0});a.prototype.appendOptionToWhenToShowResultElement=function(a,b){this.$whenToShowResultElement.append($("<option></option>").prop("value",
a.toString()).text(b))};a.prototype.appendOptionToWhenToShowQuestionListAndAnswerElement=function(a,b){this.$whenToShowQuestionListAndAnswerElement.append($("<option></option>").prop("value",a.toString()).text(b))};Object.defineProperty(a.prototype,"$whenToShowResultAfterDeadlineOptionItem",{get:function(){return this.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterDeadline)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem",
{get:function(){return this.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterDeadline)},enumerable:!0,configurable:!0});a.prototype.setTextToWhenToShowResultOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowResultElement).text(b)};a.prototype.setTextToWhenToShowQuestionListAndAnswerOption=function(a,b){$("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement).text(b)};a.prototype.$getWhenToShowResultOptionItem=function(a){return $("option[value="+
a.toString()+"]",this.$whenToShowResultElement)};a.prototype.$getWhenToShowQuestionListAndAnswerOptionItem=function(a){return $("option[value="+a.toString()+"]",this.$whenToShowQuestionListAndAnswerElement)};return a}();d.ControlsProvider=b})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(){this.handlers=[]}a.prototype.on=function(a){this.handlers.push(a)};a.prototype.trigger=function(a){this.handlers.slice(0).forEach(function(b){return b(a)})};return a}();d.EventHandler=b;var a=function(){return function(a,b){this.previous=a;this.current=b}}();d.MaxAttemptsEventData=a;var c=function(){function c(c,g){var d=this;this.viewModel=c;this.controlsProvider=g;this.deadlineChanged=function(a){d.onDeadlineChangedHandler.trigger(d.hasDeadline)};
this.attemptsChanged=function(b){d.onAttemptsChangedHandler.trigger(new a(d.previousMaxAttemptsAllowed,d.maxAttemptsAllowed));d.previousMaxAttemptsAllowed=d.maxAttemptsAllowed};this.onJQueryReady=function(){d.previousMaxAttemptsAllowed=d.maxAttemptsAllowed;$(d.controlsProvider.deadlinePicker).change(d.deadlineChanged);d.controlsProvider.$maxAttemptsAllowedElement.change(d.attemptsChanged)};this.onDeadlineChangedHandler=new b;this.onAttemptsChangedHandler=new b;$(this.onJQueryReady)}Object.defineProperty(c.prototype,
"onDeadlineChanged",{get:function(){return this.onDeadlineChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"onAttemptsChanged",{get:function(){return this.onAttemptsChangedHandler},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.controlsProvider.$maxAttemptsAllowedElement.val())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasDeadline",{get:function(){var a=this.controlsProvider.deadlinePicker.getState().DateTime;
return void 0!==a&&""!==a&&null!=a},enumerable:!0,configurable:!0});c.prototype.hasMaxAttemptsChangedToMultiple=function(a,b){return 1===a&&(1<b||b===this.viewModel.UnlimitedAttemptsValue)};c.prototype.hasMaxAttemptsChangedToSingle=function(a,b){return 1===b&&(1<a||a===this.viewModel.UnlimitedAttemptsValue)};return c}();d.ExternalDependenciesController=c})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b,d){var c=this;this.viewModel=a;this.controlsProvider=b;this.externalDependenciesController=d;this.removeAfterDeadline=function(){var a=c.whenToShowResult;c.controlsProvider.$whenToShowResultAfterDeadlineOptionItem.remove();a===e.WhenToShowResult.AfterDeadline&&c.controlsProvider.$whenToShowResultElement.val(c.defaultWhenToShowResult).change()};this.addAfterDeadline=function(){if(void 0===c.controlsProvider.$whenToShowResultAfterDeadlineOptionItem[0]){var a=
e.WhenToShowResult.AfterDeadline;c.controlsProvider.appendOptionToWhenToShowResultElement(a,c.getWhenToShowResultOptionText(a))}};this.deadlineChanged=function(a){a?c.addAfterDeadline():c.removeAfterDeadline()};this.replaceEachAttemptWithTheAttempt=function(){c.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){c.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=e.WhenToShowResult.AfterEachAttempt;a=a?c.getWhenToShowResultOptionAlternativeText(b):c.getWhenToShowResultOptionText(b);
c.controlsProvider.setTextToWhenToShowResultOption(b,a)};this.removeAfterAllAttempts=function(a){c.controlsProvider.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterAllAttempts).remove();a===e.WhenToShowResult.AfterAllAttempts&&c.controlsProvider.$whenToShowResultElement.val(c.defaultWhenToShowResult).change()};this.attachDefaultList=function(){c.controlsProvider.$whenToShowResultAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(c.getWhenToShowResultOptionText(a))});if(void 0===c.controlsProvider.$getWhenToShowResultOptionItem(e.WhenToShowResult.AfterAllAttempts)[0]&&
c.shouldHaveAfterAllAttemptsOption){var a=e.WhenToShowResult.AfterAllAttempts;c.controlsProvider.appendOptionToWhenToShowResultElement(a,c.getWhenToShowResultOptionText(a))}c.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowResultElementValue=function(a,b,g){c.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,b)?g===e.WhenToShowResult.AfterAllAttempts&&c.controlsProvider.$whenToShowResultElement.val(e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]).change():c.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,
b)&&(a=e.WhenToShowResult[e.WhenToShowResult.AfterAllAttempts],b===c.viewModel.UnlimitedAttemptsValue&&(a=e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]),g===e.WhenToShowResult.AfterEachAttempt&&c.controlsProvider.$whenToShowResultElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:c.replaceEachAttemptWithTheAttempt();c.removeAfterAllAttempts(c.whenToShowResult);break;case c.viewModel.UnlimitedAttemptsValue:c.replaceTheAttemptWithEachAttempt();c.removeAfterAllAttempts(c.whenToShowResult);
break;default:c.attachDefaultList()}c.adjustWhenToShowResultElementValue(a.previous,a.current,c.whenToShowResult)};this.onJQueryReady=function(){c.buildWhenToShowResultList()};d.onDeadlineChanged.on(this.deadlineChanged);d.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowResult",{get:function(){return e.WhenToShowResult[e.WhenToShowResult.AfterEachAttempt]},enumerable:!0,configurable:!0});a.prototype.getWhenToShowResultOptionText=
function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowResultOptionAlternativeText=function(a){return this.viewModel.WhenToShowResultsOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.buildWhenToShowResultList=function(){var a=this;this.controlsProvider.$whenToShowResultElement.empty();$.each(this.viewModel.WhenToShowResultsOptions,function(b,c){c.Value===e.WhenToShowResult.AfterEachAttempt?
1===a.externalDependenciesController.maxAttemptsAllowed?a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.AlternativeText):a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text):c.Value===e.WhenToShowResult.AfterDeadline?a.externalDependenciesController.hasDeadline&&a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text):c.Value===e.WhenToShowResult.AfterAllAttempts?a.shouldHaveAfterAllAttemptsOption&&a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,
c.Text):a.controlsProvider.appendOptionToWhenToShowResultElement(c.Value,c.Text)});this.controlsProvider.$whenToShowResultElement.val(this.viewModel.ResultsAndFeedbackState.WhenToShowResult.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,"whenToShowResult",{get:function(){var a=this.controlsProvider.$whenToShowResultElement.val();return e.WhenToShowResult[a]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"whenToShowResultsChanged",{get:function(){return this.whenToShowResult!==this.viewModel.ResultsAndFeedbackState.WhenToShowResult},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return 1!==this.externalDependenciesController.maxAttemptsAllowed&&this.externalDependenciesController.maxAttemptsAllowed!==this.viewModel.UnlimitedAttemptsValue&&this.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides&&this.whenToShowResult!==e.WhenToShowResult.AfterDeadline},
enumerable:!0,configurable:!0});return a}();d.WhenToShowResultsController=b})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b,a){var c=this;this.controls=b;this.settings=a;this.ajaxParams={};this.afterOkClickCallback=function(a){if(a){c.currentElementStates=f.MapUtils.makeCopy(a);c.saveElementStates();var b=[];a.forEach(function(a,g){c.checkboxStateMachine.isElementChecked(a)&&b.push(g)});c.updateElementListMarkup(b)}};this.currentElementStates=new Map;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.loadElementStates();this.ajaxParams={locationId:this.settings.CourseId,
locationType:f.AddResourceMenu.ElementExternalSourceType.Course};this.ajaxClient=new e.ElementPickerAjaxClient(this.settings.Urls,this.settings.Terms.AnErrorOccurred);this.controls.AddButton.click(function(){var a={elementStates:f.MapUtils.makeCopy(c.currentElementStates),elementType:f.ElementLinkDialog.ContentElementType.Files,showAll:!0,allowFolderSelection:!1,header:c.settings.Terms.DialogTitle,afterOkClickCallback:c.afterOkClickCallback,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None,
relatedEntityId:c.settings.CustomActivityId};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,c.ajaxParams)});b=$(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.SelectedElementListAppendTarget));b.on("click","."+this.settings.CssClasses.DetachElement,function(a){a=$(a.target).closest("li");var b=a.data(c.settings.DataAttributes.ElementId),g=a.closest("."+c.settings.CssClasses.SelectedElementList),d=a.next().find("a").first();0===d.length&&(d=c.controls.AddButton);
a.remove();0===g.children("li").length&&g.remove();d.focus();c.detachElementFromMap(b)});b.on("mouseenter","."+this.settings.CssClasses.SelectedElementList+" > li",function(a){a=$(a.currentTarget).find("."+c.settings.CssClasses.ElementTitle).get(0);var b=$(a).closest("a"),g=a.offsetWidth;CCL.CommonFunctions.isChrome()&&!CCL.CommonFunctions.isEdge()||g++;b.prop("title",g<a.scrollWidth?a.textContent.trim():"")})}d.prototype.loadElementStates=function(){this.currentElementStates=f.MapUtils.jsonStringToMap(this.controls.PickerResultHidden.val(),
f.MapUtils.numberKeyConverter)};d.prototype.saveElementStates=function(){this.controls.PickerResultHidden.val(f.MapUtils.mapToJsonString(this.currentElementStates))};d.prototype.updateElementListMarkup=function(b){var a=$(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.SelectedElementListAppendTarget));a.empty();this.ajaxClient.getElementListMarkupByIds({CourseId:this.settings.CourseId,ElementIds:b}).done(function(b){return a.append($(b))})};d.prototype.detachElementFromMap=function(b){var a=
this.currentElementStates.get(b);a=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,a);this.currentElementStates.set(b,a);this.saveElementStates()};return d}();e.PickerManager=k})(f.CustomActivityElementPicker||(f.CustomActivityElementPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b,d,f){var c=this;this.viewModel=a;this.controlsProvider=b;this.whenToShowResultsController=d;this.externalDependenciesController=f;this.removeAfterDeadline=function(){c.removeAfterDeadlineSetNewValue(c.defaultWhenToShowQuestionListAndAnswer)};this.addAfterDeadline=function(){if(c.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides){if(void 0===c.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem[0]){var a=
e.WhenToShowQuestionListAndAnswer.AfterDeadline;c.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,c.getWhenToShowQuestionListAndAnswerOptionText(a))}}else c.removeAfterDeadlineSetNewValue(c.neverWhenToShowQuestionListAndAnswer)};this.deadlineChanged=function(a){a?c.addAfterDeadline():c.removeAfterDeadline()};this.whenToShowResultChanged=function(a){a=c.whenToShowResultsController.whenToShowResult;a===e.WhenToShowResult.Never&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer.Never.toString()).change();
c.buildWhenToShowQuestionListAndAnswerList(c.whenToShowQuestionListAndAnswer);c.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(a!==e.WhenToShowResult.Never);c.deadlineChanged(c.externalDependenciesController.hasDeadline)};this.whenToShowQuestionListAndAnswerChanged=function(a){a=c.whenToShowQuestionListAndAnswer;a===e.WhenToShowQuestionListAndAnswer.Never&&c.controlsProvider.revealCorrectAnswerElement.toggle(!1);c.controlsProvider.$revealCorrectAnswerContainer.toggle(a!==e.WhenToShowQuestionListAndAnswer.Never)};
this.replaceEachAttemptWithTheAttempt=function(){c.replaceAttempt(!0)};this.replaceTheAttemptWithEachAttempt=function(){c.replaceAttempt(!1)};this.replaceAttempt=function(a){var b=e.WhenToShowQuestionListAndAnswer.AfterEachAttempt;a=a?c.getWhenToShowQuestionListAndAnswerOptionAlternativeText(b):c.getWhenToShowQuestionListAndAnswerOptionText(b);c.controlsProvider.setTextToWhenToShowQuestionListAndAnswerOption(b,a)};this.removeAfterAllAttempts=function(a){c.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterAllAttempts).remove();
a===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(c.defaultWhenToShowQuestionListAndAnswer).change()};this.attachDefaultList=function(){c.controlsProvider.$whenToShowQuestionListAndAnswerAllOptionElements.each(function(a,b){a=$(b).val();$(b).text(c.getWhenToShowQuestionListAndAnswerOptionText(a))});if(void 0===c.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(e.WhenToShowQuestionListAndAnswer.AfterAllAttempts)[0]&&
c.shouldHaveAfterAllAttemptsOption){var a=e.WhenToShowQuestionListAndAnswer.AfterAllAttempts;c.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(a,c.getWhenToShowQuestionListAndAnswerOptionText(a))}c.whenToShowResultsController.whenToShowResult===e.WhenToShowResult.WhenTeacherDecides&&c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);c.replaceTheAttemptWithEachAttempt()};this.adjustWhenToShowQuestionListAndAnswerElementValue=function(a,b,g){c.externalDependenciesController.hasMaxAttemptsChangedToSingle(a,
b)?g===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]).change():c.externalDependenciesController.hasMaxAttemptsChangedToMultiple(a,b)&&(a=e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterAllAttempts],b===c.viewModel.UnlimitedAttemptsValue&&(a=e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]),
g===e.WhenToShowQuestionListAndAnswer.AfterEachAttempt&&c.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change())};this.attemptsChanged=function(a){switch(a.current){case 1:c.replaceEachAttemptWithTheAttempt();c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);break;case c.viewModel.UnlimitedAttemptsValue:c.replaceTheAttemptWithEachAttempt();c.removeAfterAllAttempts(c.whenToShowQuestionListAndAnswer);break;default:c.attachDefaultList()}c.adjustWhenToShowQuestionListAndAnswerElementValue(a.previous,
a.current,c.whenToShowQuestionListAndAnswer)};this.onJQueryReady=function(){c.buildWhenToShowQuestionListAndAnswerList(c.viewModel.ResultsAndFeedbackState.WhenToShowQuestionListAndAnswer);c.controlsProvider.$whenToShowResultElement.change(c.whenToShowResultChanged);c.controlsProvider.$whenToShowQuestionListAndAnswerElement.change(c.whenToShowQuestionListAndAnswerChanged);c.controlsProvider.$whenToShowQuestionListAndAnswerContainer.toggle(c.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.Never)};
f.onDeadlineChanged.on(this.deadlineChanged);f.onAttemptsChanged.on(this.attemptsChanged);$(this.onJQueryReady)}Object.defineProperty(a.prototype,"defaultWhenToShowQuestionListAndAnswer",{get:function(){return e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.AfterEachAttempt]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"neverWhenToShowQuestionListAndAnswer",{get:function(){return e.WhenToShowQuestionListAndAnswer[e.WhenToShowQuestionListAndAnswer.Never]},
enumerable:!0,configurable:!0});a.prototype.getWhenToShowQuestionListAndAnswerOptionText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].Text};a.prototype.getWhenToShowQuestionListAndAnswerOptionAlternativeText=function(a){return this.viewModel.WhenToShowQuestionListAndAnswerOptions.filter(function(b){return b.Value===a})[0].AlternativeText};a.prototype.removeAfterDeadlineSetNewValue=function(a){var b=this.whenToShowQuestionListAndAnswer;
this.controlsProvider.$whenToShowQuestionListAndAnswerAfterDeadlineOptionItem.remove();b===e.WhenToShowQuestionListAndAnswer.AfterDeadline&&this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a).change()};Object.defineProperty(a.prototype,"shouldHaveAfterAllAttemptsOption",{get:function(){return this.whenToShowResultsController.shouldHaveAfterAllAttemptsOption},enumerable:!0,configurable:!0});a.prototype.buildWhenToShowQuestionListAndAnswerList=function(a){var b=this;this.controlsProvider.$whenToShowQuestionListAndAnswerElement.empty();
$.each(this.viewModel.WhenToShowQuestionListAndAnswerOptions,function(a,c){c.Value===e.WhenToShowQuestionListAndAnswer.AfterEachAttempt?b.whenToShowResultsController.whenToShowResult!==e.WhenToShowResult.WhenTeacherDecides&&(1===b.externalDependenciesController.maxAttemptsAllowed?b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.AlternativeText):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text)):c.Value===e.WhenToShowQuestionListAndAnswer.AfterAllAttempts?
b.shouldHaveAfterAllAttemptsOption&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text):c.Value===e.WhenToShowQuestionListAndAnswer.WithResults?b.whenToShowResultsController.whenToShowResult===e.WhenToShowResult.WhenTeacherDecides&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text):c.Value===e.WhenToShowQuestionListAndAnswer.AfterDeadline?b.externalDependenciesController.hasDeadline&&b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,
c.Text):b.controlsProvider.appendOptionToWhenToShowQuestionListAndAnswerElement(c.Value,c.Text)});void 0!==this.controlsProvider.$getWhenToShowQuestionListAndAnswerOptionItem(a)[0]?this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(a.toString()).change():this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val(e.WhenToShowQuestionListAndAnswer.Never.toString()).change();this.deadlineChanged(this.externalDependenciesController.hasDeadline)};Object.defineProperty(a.prototype,
"whenToShowQuestionListAndAnswer",{get:function(){var a=this.controlsProvider.$whenToShowQuestionListAndAnswerElement.val();return e.WhenToShowQuestionListAndAnswer[a]},enumerable:!0,configurable:!0});return a}();d.WhenToShowQuestionListAndAnswerController=b})(e.ResultsAndFeedbackInternals||(e.ResultsAndFeedbackInternals={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.AssessmentScaleState=d;d=function(){function b(a,b){var c=this;this.onAssessmentChanged=function(a){var b=c.$assessmentItemDropDown.find("option:selected").val(),g=b===c.settings.Constants.UseScoreItemValue;c.settings.EventNames.ToggleCriteriaWeightVisibility&&$(document).trigger(c.settings.EventNames.ToggleCriteriaWeightVisibility,{show:b!==c.settings.Constants.DoNotUseAssessmentItemValue});0===c.$assessmentItemDropDown.length&&
(g=c.settings.Permissions.IsScoreUsed);c.$maxScoreFloatingSection.toggle(g);c.onMaxScoreStateChanged();c.settings.Permissions.UseGradeBook&&c.toggleTermAndCategoryPanel();if(void 0!==c.onChangeHandler&&void 0!==a)c.onChangeHandler(a)};window[a]=this;this.settings=b;$(function(){c.$assessmentItemDropDown=$("#"+c.settings.Controls.AssessmentItemDropDown);c.$maxScoreFloatingSection=$("#"+c.settings.Controls.MaxScoreFloatingSection);c.$maxScoreTextBox=$("#"+c.settings.Controls.MaxScoreTextBox);c.$assessmentRecordContainer=
$("#"+c.settings.Controls.AssessmentRecordContainer);c.$termAndCategoryContainer=$("#"+c.settings.Controls.TermAndCategoryContainer);c.$categoryDropDown=$("#"+c.settings.Controls.CategoryDropDown);c.$termDropDown=$("#"+c.settings.Controls.TermDropDown);c.$addToGradeBookCheckbox=$("#"+c.settings.Controls.AddToGradeBookCheckbox);if(c.settings.Permissions.UseGradeBook)c.$addToGradeBookCheckbox.on("change",function(a){return c.toggleTermAndCategoryContainer(a)});c.$assessmentItemDropDown.on("change",
function(a){return c.onAssessmentChanged(a)});if(c.$maxScoreTextBox)c.$maxScoreTextBox.on("blur input",function(){return c.onMaxScoreStateChanged()}).on("keydown",function(a){return c.onMaxScoreKeyDown(a)})})}b.prototype.onChange=function(a){this.onChangeHandler=a};b.prototype.getState=function(){var a={};a.AssessmentScaleId=parseInt(this.$assessmentItemDropDown.find("option:selected").val(),10);a.IsScore=a.AssessmentScaleId===parseInt(this.settings.Constants.UseScoreItemValue,10);a.MaxScore=parseInt(this.$maxScoreTextBox.val(),
10);this.settings.Permissions.UseGradeBook&&(a.AddToGradeBook=this.$addToGradeBookCheckbox.is(":checked"));this.$categoryDropDown&&(a.CategoryId=parseInt(this.$categoryDropDown.val(),10));this.$termDropDown&&(a.TermId=parseInt(this.$termDropDown.val(),10));return a};b.prototype.useAssessment=function(){return this.$assessmentItemDropDown.find("option:selected").val()!==this.settings.Constants.DoNotUseAssessmentItemValue};b.prototype.canUseAutoMaxScore=function(){return this.settings.Permissions.CanUseAutoMaxScore};
b.prototype.isValid=function(){return this.$assessmentItemDropDown.find("option:selected").val()===this.settings.Constants.UseScoreItemValue&&this.$maxScoreTextBox?this.validateScore(this.$maxScoreTextBox.val()):!0};b.prototype.updateMaxScore=function(a,b,g){var c=this;a&&0!==a.length?CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetCriteriaWeightTotal,data:{elementId:this.settings.ElementId,courseId:this.settings.CourseId,learningObjectiveIds:a,changedCriteriaWeights:b}}).done(function(a){c.calculateMaxScore(0<
a.criteriaWeightTotal,a.criteriaWeightTotal);g&&g()}):this.calculateMaxScore(!1,0)};b.prototype.onMaxScoreStateChanged=function(){this.settings.EventNames.MandatoryFieldsStateChangedClient&&$(document).trigger(this.settings.EventNames.MandatoryFieldsStateChangedClient)};b.prototype.calculateMaxScore=function(a,b){a?(this.$maxScoreTextBox.val((b*this.settings.NumberOfAchievementLevels).toString()),this.$maxScoreTextBox.attr("readonly","readonly"),CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$maxScoreTextBox,
this.settings.AutoMaxScoreToolTip)):(this.$maxScoreTextBox.removeAttr("readonly"),CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$maxScoreTextBox,""))};b.prototype.validateScore=function(a){if(""===a)return!1;a=parseFloat(a.replace(this.settings.NumberDecimalSeparator,"."));return isNaN(a)||a<this.settings.MaxScoreMinValue||a>this.settings.MaxScoreMaxValue?!1:!0};b.prototype.toggleTermAndCategoryPanel=function(){var a=this.$assessmentItemDropDown.find("option:selected").val()!==
this.settings.Constants.DoNotUseAssessmentItemValue;a&&this.$assessmentRecordContainer.is(":visible")||(this.$assessmentRecordContainer.toggle(a),this.$addToGradeBookCheckbox.prop("checked",a).change())};b.prototype.toggleTermAndCategoryContainer=function(a){a=$(a.target).is(":checked");this.$termAndCategoryContainer.toggle(a)};b.prototype.onMaxScoreKeyDown=function(a){CCL.CommonFunctions.preventInputIncorrectCharacters(a,[CCL.CommonConstants.keyCodes.del,CCL.CommonConstants.keyCodes.backspace,CCL.CommonConstants.keyCodes.tab,
CCL.CommonConstants.keyCodes.escape,CCL.CommonConstants.keyCodes.enter])};return b}();e.AssessmentScale=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.GroupActivityState=d;d=function(){function b(a,b){var c=this;this.peerAndSelfAssessmentStateChanged=function(a,b,g){c.peerAssessmentEnabled=b;c.selfAssessmentEnabled=g;c.enabled=c.canEdit()};this.groupActivityCheckboxChanged=function(a){c.toggleGroupActivity();$(document).trigger(c.settings.Triggers.StateChanged,c.enabled)};window[a]=this;this.settings=b;$(function(){c.peerAssessmentEnabled=c.settings.PeerAssessmentEnabled;
c.selfAssessmentEnabled=c.settings.SelfAssessmentEnabled;c.$checkBox=$("#"+c.settings.Controls.CheckboxId);c.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(c.$checkBox);c.$dropDown=$("#"+c.settings.Controls.DropDownId);c.$container=$("#"+c.settings.Controls.Container);c.enabled=c.canEdit();c.toggleGroupActivity();c.$checkBox.change(c.groupActivityCheckboxChanged);if(c.settings.Events.PeerAndSelfAssessmentStateChanged)$(document).off(c.settings.Events.PeerAndSelfAssessmentStateChanged).on(c.settings.Events.PeerAndSelfAssessmentStateChanged,
c.peerAndSelfAssessmentStateChanged)})}Object.defineProperty(b.prototype,"enabled",{get:function(){return this.$checkBox.is(":checked")&&this.canEdit()},set:function(a){this.$container.toggleClass(this.settings.CssClasses.Disabled,!a);this.$checkBox.prop("disabled",!a);this.customTooltipForCheckbox.setToolTipHtml(a?"":this.tooltip);this.customTooltipForCheckbox.enableToolTip(!a)},enumerable:!0,configurable:!0});b.prototype.getState=function(){var a={};a.isGroupActivity=this.$checkBox.is(":checked");
a.groupType=this.$dropDown.val();return a};Object.defineProperty(b.prototype,"tooltip",{get:function(){return this.settings.AtLeastOneAnswerExistsForElement?this.settings.Terms.AnswersExistWarning:this.settings.IsLearningPathSubElement?this.settings.Terms.IsLearningPathSubElementWarning:this.peerAssessmentEnabled||this.selfAssessmentEnabled?this.settings.Terms.GroupActivityDisabledWarning:""},enumerable:!0,configurable:!0});b.prototype.toggleGroupActivity=function(){this.$dropDown.toggle(this.enabled)};
b.prototype.canEdit=function(){return!this.settings.AtLeastOneAnswerExistsForElement&&!this.settings.IsLearningPathSubElement&&!this.peerAssessmentEnabled&&!this.selfAssessmentEnabled};return b}();e.GroupActivity=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.settings=b;window[a]=this;$(function(){c.settings.VisibilitySettings.Activation&&(c.activationControl=window[c.settings.ClientInstanceNames.ActivationControl]);c.settings.VisibilitySettings.WorkloadSetting&&(c.workloadSettingControl=window[c.settings.ClientInstanceNames.WorkloadSettingControl]);c.settingsManager=e.Manager.getInstance();c.$saveSettingsButton=$("."+c.settings.CssClasses.SaveSettingsButton);c.attemptsControl=
c.settings.VisibilitySettings.Attempts?window[c.settings.ClientInstanceNames.AttemptsControl]:null;c.resultsAndFeedbackControl=c.settings.VisibilitySettings.ResultsAndFeedback?window[c.settings.ClientInstanceNames.ResultsAndFeedbackControl]:null;c.settings.VisibilitySettings.AnonymousSubmission&&(c.$anonymousCheckBox=$("#"+c.settings.Controls.AnonymousSubmissionCheckBox));c.settings.VisibilitySettings.PlagiarismControl&&(c.$plagiarismCheckBox=$("#"+c.settings.Controls.PlagiarismCheckBox));c.settings.VisibilitySettings.Mandatory&&
(c.$notMandatoryCheckBox=$("#"+c.settings.Controls.NotMandatoryCheckBox));c.settings.VisibilitySettings.Results&&(c.$resultsCheckBox=$("#"+c.settings.Controls.ResultsCheckBox));c.settings.VisibilitySettings.Deadline&&(c.deadlinePicker=window[c.settings.ClientInstanceNames.Deadline]);c.settings.VisibilitySettings.Homework&&(c.$homeworkCheckBox=$("#"+c.settings.Controls.HomeworkCheckBox));c.settings.VisibilitySettings.PeerAssessment&&(c.peerAssessment=window[c.settings.ClientInstanceNames.PeerAssessment]);
c.settings.VisibilitySettings.GroupSubmission&&(c.groupActivitySelector=window[c.settings.ClientInstanceNames.GroupActivitySelector]);c.settings.VisibilitySettings.AssessmentScale&&(c.assessmentScaleSelector=window[c.settings.ClientInstanceNames.AssessmentScaleControl]);c.settings.VisibilitySettings.TestMode&&(c.$testModeCheckBox=$("#"+c.settings.Controls.TestModeCheckBox));c.settings.VisibilitySettings.DescriptionOnSidebar&&(c.$descriptionInput=$("#"+c.settings.Controls.DescriptionTextArea));c.initLearningObjectivesListControl();
c.initSubmissionStatusControl()});$(document).on(this.settings.EventNames.MandatoryFieldsStateChanged,function(){c.settings.EventNames.ValidStateChanged&&$(document).trigger(c.settings.EventNames.ValidStateChanged,c.validateMandatoryFields())});if(this.settings.CanUseRubric)if(this.settings.IsAddMode)$(document).on(this.settings.EventNames.RubricChanged,function(a,b){c.learningObjectiveList.syncLearningObjectives(b.loIds);c.updateMaxScore(b.loIds,b.criteriaWeights)}),$(document).on(this.settings.EventNames.UpdateMaxScore,
function(a,b){c.updateMaxScore(b.loIds,b.criteriaWeights)});else $(document).on(this.settings.EventNames.LearningObjectiveChanged,function(a,b){c.updateMaxScore(b.ids);c.settingsManager.setRefreshIframeAfterSave()});$(document).on(this.settings.EventNames.MandatoryFieldsStateChanged+" "+this.settings.EventNames.ElementActivationChangedEventName+" "+this.settings.EventNames.DeadlineStateChanged+" "+this.settings.EventNames.WorkloadChanged,function(){c.settings.EventNames.ValidStateChanged&&$(document).trigger(c.settings.EventNames.ValidStateChanged,
c.validateMandatoryFields()&&c.validateElementActivation())});this.settings.VisibilitySettings.Deadline&&this.settings.IsDeadlineRequired&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment&&($(document).on(this.settings.EventNames.ElementActivationChangedEventName,function(){c.deadlinePicker.mandatory(c.activationControl.isActive()||c.activationControl.hasTimeSpan())}),this.deadlinePicker.mandatory(this.activationControl.isActive()||this.activationControl.hasTimeSpan()),this.stateChanged())}
b.prototype.validateMandatoryFields=function(){var a=!0;this.settings.VisibilitySettings.AssessmentScale&&(a=this.assessmentScaleSelector.isValid());var b=!0;this.settings.VisibilitySettings.WorkloadSetting&&(b=this.workloadSettingControl.isValid());return a&&b};b.prototype.validateElementActivation=function(){return this.settings.IsDeadlineRequired&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment?this.settings.VisibilitySettings.Deadline&&this.settings.LearningToolId==this.settings.LearningToolIds.Assignment?
this.activationControl.isActive()||this.activationControl.hasTimeSpan()?this.deadlinePicker.isSet():!0:!1:!0};b.prototype.stateChanged=function(){this.settings.EventNames.ValidStateChanged&&$(document).trigger(this.settings.EventNames.ValidStateChanged,this.validateMandatoryFields()&&this.validateElementActivation())};b.prototype.hideFeedback=function(){this.settings.VisibilitySettings.Deadline&&this.deadlinePicker.mandatory(!1)};b.prototype.updateMaxScore=function(a,b){var c=this;void 0===b&&(b=
"");this.assessmentScaleSelector.canUseAutoMaxScore()&&this.assessmentScaleSelector.updateMaxScore(a,b,function(){$(document).trigger(c.settings.EventNames.ValidStateChanged,c.validateMandatoryFields())})};b.prototype.initLearningObjectivesListControl=function(){this.learningObjectiveList||(this.learningObjectiveList=window[this.settings.ClientInstanceNames.LearningObjectiveList])};b.prototype.initSubmissionStatusControl=function(){this.settings.VisibilitySettings.SubmissionStatusForTeacher&&(this.$submissionStatus=
$("#"+this.settings.Controls.SubmissionStatusControl),this.$submissionStatus.val()||(this.settingsManager.showFeedbackErrorMessage(this.settings.Terms.NoSubmissionStatusesFound),this.$saveSettingsButton.toggleHyperlink(!1)))};b.prototype.collectSettings=function(){var a={};if(this.settings.VisibilitySettings.Deadline){var b=this.deadlinePicker.getState();a.Deadline=b.DateTime;a.CloseAfterDeadline=b.CloseAfterDeadline}this.settings.VisibilitySettings.Homework&&(a.Homework=this.$homeworkCheckBox.is(":checked"));
this.settings.VisibilitySettings.AssessmentScale&&(b=this.assessmentScaleSelector.getState(),a.AssessmentScaleId=b.AssessmentScaleId,a.UseScore=b.IsScore,a.MaxScore=b.IsScore?b.MaxScore:0,a.IsAddToAssessmentRecord=b.AddToGradeBook,a.TermId=b.TermId,a.CategoryId=b.CategoryId);this.settings.VisibilitySettings.PeerAssessment&&(this.peerAssessment.activated&&0<this.peerAssessment.peersToAssessCount&&(a.PeersToAssessCount=this.peerAssessment.peersToAssessCount),a.IsSelfAssessmentActivated=this.peerAssessment.selfAssessmentActivated);
this.settings.VisibilitySettings.TestMode&&(a.TestMode=this.$testModeCheckBox.is(":checked"));this.settings.VisibilitySettings.Attempts&&(a.AttemptsState=this.attemptsControl.getState());this.settings.VisibilitySettings.ResultsAndFeedback&&(a.ResultsAndFeedbackState=this.resultsAndFeedbackControl.getState());this.settings.VisibilitySettings.SubmissionStatusForTeacher&&(a.SubmissionStatusId=parseInt(this.$submissionStatus.val(),10));this.settings.VisibilitySettings.GroupSubmission&&(b=this.groupActivitySelector.getState(),
a.IsGroupActivity=b.isGroupActivity,a.SubmissionGroupType=b.groupType);this.settings.VisibilitySettings.AnonymousSubmission&&(a.IsAnonymous=this.$anonymousCheckBox.is(":checked"));this.settings.VisibilitySettings.PlagiarismControl&&(a.IsCheckPlagiarism=this.$plagiarismCheckBox.is(":checked"));this.settings.VisibilitySettings.Mandatory&&(a.IsNotMandatory=this.$notMandatoryCheckBox.is(":checked"));this.activationControl&&(b=this.activationControl.getActivationTimeSpanState(),a.Active=b.isActive,a.UseActivationTimespan=
b.useActivationTimeSpan,a.UseActivationTimespan&&(a.ActivationTimespanFrom=b.fromState.dateAsString,a.ActivationTimespanTo=b.toState.dateAsString));this.settings.VisibilitySettings.LearningObjectiveListDialog&&(a.LearningObjectivesIds=this.learningObjectiveList.getLearningObjectiveIds());this.settings.VisibilitySettings.Results&&(a.IsAssessmentVisible=this.$resultsCheckBox.is(":checked"));this.settings.VisibilitySettings.WorkloadSetting&&(a.Workload=this.workloadSettingControl.getWorkloadEnabled(),
a.WorkloadEstimation=this.workloadSettingControl.getWorkloadEstimation());this.settings.VisibilitySettings.DescriptionOnSidebar&&(a.DescriptionOnSidebar=this.$descriptionInput.val());return a};b.prototype.validateControls=function(){return this.activationControl?this.activationControl.validateControl():!0};return b}();e.Edit=d})(e.Settings||(e.Settings={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(a){a[a.Hidden=0]="Hidden";a[a.Summary=1]="Summary";a[a.Read=2]="Read";a[a.OverlayEdit=3]="OverlayEdit"})(e.LearningToolElementSettingsView||(e.LearningToolElementSettingsView={}));var d=e.LearningToolElementSettingsView;(function(){return function(){}})();var b=function(){function a(b){var c=this;this.viewAttributesMap={};window[a.clientInstanceName]=this;this.settings=b;$(function(){c.$body=$("body");c.$mainContainer=$("#"+c.settings.Controls.MainContainer);
c.$contentFrameContainer=$("#"+c.settings.Controls.ContentFrame);c.$settingsControlContainer=$("#"+c.settings.Controls.SettingsControl);c.$editSettingsContainer=$("#"+c.settings.Controls.EditSettingsContainer);c.$readSettingsContainer=$("#"+c.settings.Controls.ReadSettingsContainer);c.$background=$("#"+c.settings.Controls.Background);c.settings.IsAddMode||(c.iframe=c.$contentFrameContainer.get(0).contentWindow);c.viewAttributesMap=(a={},a[d.Hidden]={isDirty:!0,cssClass:c.settings.CssClasses.Views.Hidden},
a[d.Summary]={$container:c.$readSettingsContainer,isDirty:!1,cssClass:c.settings.CssClasses.Views.Summary,loadViewUrl:c.settings.Urls.ReadSettings,afterLoadFunction:c.afterLoadSummarySettings},a[d.Read]={$container:c.$readSettingsContainer,isDirty:!0,cssClass:c.settings.CssClasses.Views.OverlayRead,loadViewUrl:c.settings.Urls.ReadSettings,afterLoadFunction:c.afterLoadReadSettings},a[d.OverlayEdit]={$container:c.$editSettingsContainer,isDirty:!0,cssClass:c.settings.CssClasses.Views.OverlayEdit,loadViewUrl:c.settings.Urls.EditSettings,
afterLoadFunction:c.afterLoadEditSettings},a);c.attachEventListeners();c.editFocusTracker=new CCL.FocusTracker(c.$settingsControlContainer);c.switchView(c.settings.IsAddMode?d.OverlayEdit:c.settings.CollapsedSettingView?d.Summary:d.Read,c.settings.CollapsedSettingView);var a})}a.getInstance=function(){return window[a.clientInstanceName]};a.prototype.afterLoadSummarySettings=function(){this.stopTrackingFocus();this.$readSettingsContainer.find("."+this.settings.CssClasses.SectionHeaderIconLink).attr("tabindex",
0)};a.prototype.afterLoadReadSettings=function(){this.stopTrackingFocus();this.setFocusAndHighlight();this.$readSettingsContainer.find("."+this.settings.CssClasses.SectionHeaderIconLink).removeAttr("tabindex")};a.prototype.refreshExtensionFrame=function(){this.iframe&&CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.studentWasAssessed))};a.prototype.notifyExtensionSettingsUpdated=function(a){this.iframe&&(a?CCL.CommonFunctions.makePostMessageCallWithData(this.iframe,
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged),a):CCL.CommonFunctions.makePostMessageCall(this.iframe,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionSettingsChanged)))};a.prototype.refreshTreeMenu=function(){var a=top;a&&a.reloadFolder&&!this.settings.IsLearningPathSubElement&&a.reloadFolder()};a.prototype.refreshPageFunctionsMenu=function(a){window[this.settings.ClientInstanceNames.ViewLearningToolElementPage].changePageFunctionsState(a)};
a.prototype.showFeedbackErrorMessage=function(a,b){void 0===b&&(b=!1);CCL.ErrorFeedback.showFeedback(this.$settingsControlContainer,a,null,b)};a.prototype.hideFeedback=function(){var a=this.getSettingsEditor();null!=a&&a.hideFeedback();CCL.ErrorFeedback.hideFeedback(this.$settingsControlContainer)};a.prototype.getSettingsEditor=function(){null==this.settingsEditor&&(this.settingsEditor=window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName]);return this.settingsEditor};a.prototype.setRefreshIframeAfterSave=
function(){this.settings.NeedRefreshIframeAfterSave=!0};a.prototype.attachEventListeners=function(){var a=this,b=$(window);CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.extensionContentChanged,function(b){b.expandRead?a.switchView(d.Read,!0):a.switchView(a.currentView,!0)});CCL.CommonFunctions.attachPostMessageEventListener(b,[CCL.CommonWindowMessages.MessageNames.hideSettings,CCL.CommonWindowMessages.MessageNames.enableFullScreen],function(){a.switchView(d.Hidden)});
CCL.CommonFunctions.attachPostMessageEventListener(b,[CCL.CommonWindowMessages.MessageNames.showSettings,CCL.CommonWindowMessages.MessageNames.disableFullScreen],function(b){a.currentView===d.Hidden&&a.switchView(a.previousView,!b||b.ForceReload)});CCL.CommonFunctions.attachPostMessageEventListener(b,CCL.CommonWindowMessages.MessageNames.reloadParentIframe,function(){window.location.reload(!0)});this.$body.on("click","."+this.settings.CssClasses.ChangeOptionsLink,function(){a.switchView(d.OverlayEdit,
!0);return!1}).on("click","."+this.settings.CssClasses.SaveSettingsButton,function(){a.$saveSettingsButton||(a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton));a.$saveSettingsButton.getIfHyperLinkEnabled()&&a.save();return!1}).on("click","."+this.settings.CssClasses.SettingsDialogExpandButton,function(){a.isMobileView()||(a.switchView(d.Read),CCL.CommonFunctions.safeAjaxPost({url:a.settings.Urls.CollapsedSettings}))}).on("click","."+this.settings.CssClasses.Views.Summary+" ."+
this.settings.CssClasses.SectionHeaderIconLink,function(b){a.onSummaryIconClick($(b.currentTarget))}).on("keypress","."+this.settings.CssClasses.Views.Summary+" ."+this.settings.CssClasses.SectionHeaderIconLink,function(b){if(b.which===CCL.CommonConstants.keyCodes.enter)a.onSummaryIconClick($(b.currentTarget))}).on("click","."+this.settings.CssClasses.ShowMoreOptionsLink,function(){a.toggleMobileOptions(!a.isMobileOptionsExpanded())}).on("keydown",function(b){switch(b.which){case CCL.CommonConstants.keyCodes.escape:a.currentView!==
d.Read&&a.currentView!==d.OverlayEdit||a.cancelButtonClick()}});if(!this.settings.IsAddMode)this.$body.on("click","."+this.settings.CssClasses.CancelEditSettingsButton,function(){return a.cancelButtonClick()}).on("click","."+this.settings.CssClasses.SettingsDialogCollapseButton,function(){a.switchView(d.Summary);CCL.CommonFunctions.safeAjaxPost({url:a.settings.Urls.CollapsedSettings})});this.$background.click(function(){a.hideFeedback();a.cancelButtonClick()});if(this.settings.IsDeadlineRequired)$(document).on(this.settings.ValidStateChanged,
function(b,c){a.$saveSettingsButton||(a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton));a.$saveSettingsButton.toggleHyperlink(c)})};a.prototype.onSummaryIconClick=function(a){this.isMobileView()||(a=parseInt(a.closest("."+this.settings.CssClasses.SettingSection).data(this.settings.LearningToolElementSettingTypeDataAttribute),10),this.switchToExpandedView(a))};a.prototype.afterLoadEditSettings=function(){var a=this;if(this.settings.IsDeadlineRequired&&!this.settings.IsAddMode)$(document).on(this.settings.ValidStateChanged,
function(b,c){a.$saveSettingsButton=$("."+a.settings.CssClasses.SaveSettingsButton);a.$saveSettingsButton.toggleHyperlink(c)});else this.$saveSettingsButton=$("."+this.settings.CssClasses.SaveSettingsButton);this.$cancelEdittingSettingsButton=$("."+this.settings.CssClasses.CancelEditSettingsButton);this.stopTrackingFocus();this.settings.IsAddMode||this.editFocusTracker.startTrackFocus();this.setFocusAndHighlight();new CCL.ButtonLoadingIndicator("."+this.settings.CssClasses.SettingsWrapper+" ."+this.settings.CssClasses.SaveSettingsButton,
this.settings.CssClasses.ButtonInProgress,null,100)};a.prototype.setFocusAndHighlight=function(){var a=this;setTimeout(function(){var b=a.viewAttributesMap[a.currentView].$container.find("."+a.settings.CssClasses.SettingSection);b.removeClass(a.settings.CssClasses.SettingsSectionHighlight);b=a.getSectionToHighlight(b);a.controlToHighlight=0;if(b){b.addClass(a.settings.CssClasses.SettingsSectionHighlight);var c=a.getFirstElementToFocusInContainer(b)}else a.settings.IsAddMode||(c=a.getFirstElementToFocusInContainer(a.getViewContainer(a.currentView)));
a.scrollToElementIfNeed(b).done(function(){c&&!c.prop("disabled")&&c.focus()})},1)};a.prototype.getFirstElementToFocusInContainer=function(a){return a.find("input, a, select").first()};a.prototype.getSectionToHighlight=function(a){var b=this,c=void 0;$.each(a,function(a,g){a=$(g);return b.controlToHighlight===parseInt(a.data(b.settings.LearningToolElementSettingTypeDataAttribute),10)?(c=a,!1):!0});return c};a.prototype.hideAllViews=function(){this.$editSettingsContainer.hide();this.$readSettingsContainer.hide()};
a.prototype.showOverlayDialogIfNeeds=function(a){this.$background.toggle(a===d.OverlayEdit)};a.prototype.switchView=function(a,b){var c=this;void 0===b&&(b=!1);if(a!==this.currentView||b){this.toggleToolTipForCurrentView(!1);var g=this.viewAttributesMap[a];b&&(g.isDirty=!0);g.isDirty&&g.loadViewUrl?$.get(g.loadViewUrl).done(function(b){g.$container.html(b);c.refreshViewUi(a,g);c.toggleToolTipForCurrentView(!0)}).fail(function(){c.alertError()}):(this.refreshViewUi(a,g),this.toggleToolTipForCurrentView(!0))}};
a.prototype.toggleToolTipForCurrentView=function(a){this.currentView===d.Summary&&CCL.UnobtrusiveCustomTooltipManager.enableTooltipOnTarget($("."+this.settings.CssClasses.SettingSection),a)};a.prototype.switchToExpandedView=function(a){this.controlToHighlight=isNaN(a)?0:a;this.switchView(this.settings.CanEdit?d.OverlayEdit:d.Read,this.settings.CanEdit)};a.prototype.alertError=function(a){void 0===a&&(a="");CCL.CommonFunctions.jAlertAjaxError(a?a:this.settings.Terms.SomethingWentWrong,this.settings.Terms.ErrorOccured,
this.settings.Terms.Ok,!1)};a.prototype.refreshViewUi=function(a,b){this.$mainContainer.removeClass().addClass(b.cssClass);this.previousView=this.currentView;this.currentView=a;this.hideAllViews();this.showOverlayDialogIfNeeds(a);(this.afterLoadFunction=b.afterLoadFunction)&&this.afterLoadFunction();this.toggleMobileOptions(this.isMobileOptionsExpanded());b.isDirty=!1;b.$container.show();a=0<this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.ShowOnlyIfMobileOptionsExpanded).length;
this.getShowMoreLinkForCurrentView().toggle(a)};a.prototype.enableSaveCancelButtons=function(a){this.$cancelEdittingSettingsButton.toggleHyperlink(a);this.$saveSettingsButton.toggleHyperlink(a);this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].lockSaveButton(!a)};a.prototype.enableSaveCancelButtonsAndToggleSpinner=function(a){this.enableSaveCancelButtons(a);a&&$(this.$saveSettingsButton).trigger(CCL.ButtonLoadingIndicator.eventRemoveLoadingIndicator)};
a.prototype.cancelButtonClick=function(){this.settings.IsAddMode||(this.hideFeedback(),this.switchView(this.getViewToSwitchBack()));return!1};a.prototype.isMobileView=function(){return $(window).width()<=CCL.CommonConstants.mediaScreenSizes.iPadPortraitMode};a.prototype.getViewToSwitchBack=function(){switch(this.currentView){case d.Read:return d.Summary;case d.OverlayEdit:return this.isMobileView()?d.Read:this.previousView;default:throw"Unsupported view transition";}};a.prototype.save=function(a){var b=
this;void 0===a&&(a=!1);this.hideFeedback();this.enableSaveCancelButtonsAndToggleSpinner(!1);var c=this.collectContentAndSettings(a);window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName].validateControls()?CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.SaveSettings,data:c}).done(function(a){a.Success?b.settings.IsAddMode&&a.ClientScriptToCompleteSaving?eval(a.ClientScriptToCompleteSaving):a.ClientScriptToCompleteSavingExtended?(a=eval(a.ClientScriptToCompleteSavingExtended),
$.when(a).then(function(a){!0===a?b.save(a):b.enableSaveCancelButtonsAndToggleSpinner(!0)})):a.PageUrlToRedirect?window.location.replace(a.PageUrlToRedirect):(b.switchView(b.getViewToSwitchBack(),!0),(b.settings.NeedRefreshIframeAfterSave||a.RefreshExtensionIframe)&&b.refreshExtensionFrame(),b.settings.SettingsUpdateNotification&&b.notifyExtensionSettingsUpdated(c.Settings.NotificationData),b.refreshTreeMenu(),b.refreshPageFunctionsMenu(a.EnableElementActivationPageFeatures)):(b.showFeedbackErrorMessage(a.Errors.join("<br />"),
!0),b.enableSaveCancelButtonsAndToggleSpinner(!0))}).fail(function(){b.alertError();b.enableSaveCancelButtonsAndToggleSpinner(!0)}):(this.enableSaveCancelButtonsAndToggleSpinner(!0),this.showFeedbackErrorMessage(this.settings.Terms.YourInputIsInvalid,!0),this.scrollToElementIfNeed($("."+this.settings.CssClasses.InvalidInput+":first")))};a.prototype.collectContentAndSettings=function(a){var b=window[this.settings.ClientInstanceNames.EditSettingsViewInstanceName],c={};c.ElementId=this.settings.ElementId;
c.IsAddMode=this.settings.IsAddMode;c.Settings=b.collectSettings();c.Settings.IsLearningObjectivesRemovalConfirmed=a;this.settings.ClientInstanceNames.ContentHolderClientInstanceName&&(c.Content=window[this.settings.ClientInstanceNames.ContentHolderClientInstanceName].collectContent());return c};a.prototype.toggleMobileOptions=function(a){var b=a?this.settings.Terms.ShowLess:this.settings.Terms.ShowMore;this.getShowMoreLinkForCurrentView().children("span").text(b);this.getViewContainer(this.currentView).toggleClass(this.settings.CssClasses.ExpandMobileOptions,
a)};a.prototype.isMobileOptionsExpanded=function(){return this.getViewContainer(this.currentView).hasClass(this.settings.CssClasses.ExpandMobileOptions)};a.prototype.getShowMoreLinkForCurrentView=function(){return this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.ShowMoreOptionsLink)};a.prototype.getViewContainer=function(a){return this.viewAttributesMap[a].$container};a.prototype.stopTrackingFocus=function(){this.editFocusTracker.stopTrackFocus()};a.prototype.scrollToElementIfNeed=
function(a){if(!a)return $.when();if(this.settings.IsAddMode)return CCL.CommonFunctions.isElementFullyShownInWindow(a)||window.scrollTo(a.offset().top,0),$.when();var b=this.getViewContainer(this.currentView).find("."+this.settings.CssClasses.OverlayDialogInnerContainer);return CCL.CommonFunctions.isElementFullyShownInContainer(a,b)?$.when():b.animate({scrollTop:a.offset().top},500).promise()};a.prototype.refreshReadView=function(){this.switchView(this.currentView,!0)};a.clientInstanceName="LearningToolElementSettingsManager";
return a}();e.Manager=b})(e.Settings||(e.Settings={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){}}();e.ManageLearnerDefinedGroupState=f;f=function(){function d(b,a){var c=this;this.renderItem=function(a,b){return $("<li>").append(b.metadata?'<a>\n                            <img alt="" class="'+c.settings.CssClasses.AutoCompleteItem.Image+'" src="'+b.metadata.ImageUrl+'" />\n                            <span class="'+c.settings.CssClasses.AutoCompleteItem.Info+'">\n                                <span>'+b.label+"</span>\n                                "+
(""!==b.metadata.Organization?'<span class="'+c.settings.CssClasses.AutoCompleteItem.Organization+'">'+b.metadata.Organization+"</span>":"")+"\n                            </span>\n                       </a>":'<span class="'+c.settings.CssClasses.AutoCompleteItem.NoMatches+'">'+c.settings.Terms.NoMatches+"</span>").addClass(c.settings.CssClasses.AutoCompleteItem.Item).appendTo(a)};this.participantsAutocomplete=function(a,b){c.participantsAutocompleteRequest&&c.participantsAutocompleteRequest.abort&&
c.participantsAutocompleteRequest.abort();var g=c.getAddedPersonIds();c.participantsAutocompleteRequest=$.getJSON(c.settings.WebMethods.FindParticipants.replace("{elementId}",c.settings.ElementId.toString()).replace("{collaborationId}",c.settings.CollaborationId.toString()),{courseId:c.settings.CourseId,search:a.term}).done(function(a){a=a.filter(function(a){return 0===g.filter(function(b){return b===a.PersonId}).length});a.length?b($.map(a,function(a){return{label:a.Name,value:a.Name,metadata:a}})):
b([{value:b.term}])}).always(function(){c.participantsAutocompleteRequest=void 0})};this.onRemoveClick=function(a){$(a.target).closest("."+c.settings.CssClasses.GroupList.UserContainer).remove()};window[b]=this;this.settings=a;this.$membersContainer=$("#"+this.settings.Controls.MembersContainerId);this.$groupContentContainer=$("#"+this.settings.Controls.GroupContentContainerClientId);$(function(){c.addPerson(c.settings.CurrentPerson,!0);c.settings.GroupMembers&&c.settings.GroupMembers.length&&c.settings.GroupMembers.forEach(function(a){c.addPerson(a,
!1)})});$(document).on(this.settings.Events.OnSelectUser,function(a,b){b&&(a={},a.Name=b.Name,a.ImageUrl=b.ImageUrl,a.PersonId=b.PersonId,c.addPerson(a,!1))})}d.prototype.addPerson=function(b,a){this.$membersContainer.append(this.getPersonHtml(b,a))};d.prototype.getPersonHtml=function(b,a){var c=$('<div class="'+this.settings.CssClasses.GroupList.UserContainer+'"></div>'),g=$('<div class="'+this.settings.CssClasses.GroupList.ImageContainer+'"><img alt="" src="'+b.ImageUrl+'" class="'+this.settings.CssClasses.GroupList.Image+
'" /></div>'),d=$('<div class="'+this.settings.CssClasses.GroupList.NameContainer+'"><span>'+b.Name+"</span></div>");c.data("meta",b).append(g).append(d);b=$('<div class="'+this.settings.CssClasses.GroupList.RemoveLinkContainer+'"></div>');a||(a=$('<a href="#">&times;</a>'),a.click(this.onRemoveClick),b.append(a));c.append(b);return c};d.prototype.getAddedPersonInfos=function(){return $.makeArray(this.$membersContainer.find("div."+this.settings.CssClasses.GroupList.UserContainer).map(function(b,a){return $(a).data("meta")}))};
d.prototype.getAddedPersonIds=function(){return this.getAddedPersonInfos().map(function(b){return b.PersonId})};d.prototype.getState=function(){return{personIds:this.getAddedPersonIds()}};return d}();e.ManageLearnerDefinedGroup=f})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
var BaseMetadata=function(){return function(f,e,k){this.name=f;this.sourceType=e;this.mimeType=k}}(),LocalFileInputHandle=function(){function f(e){this.fileInput=e}f.prototype.get=function(){return this.fileInput};return f}(),LocalFileHandle=function(){function f(e){this.file=e}f.prototype.get=function(){return this.file};return f}(),ExternalSourceFileHandle=function(){function f(e,f,d,b){this.url=e;this.id=f;this.canBeCopied=d;this.canBeShared=b}f.prototype.get=function(){return objectState.isNullOrUndefined(this.id)?
this.url:{url:this.url,id:this.id,canBeCopied:null==this.canBeCopied?!0:this.canBeCopied,canBeShared:null==this.canBeShared?!0:this.canBeShared}};return f}(),SourceType;(function(f){f[f.Dropbox=1]="Dropbox";f[f.Google=2]="Google";f[f.OneDriveForBusiness=3]="OneDriveForBusiness";f[f.Local=4]="Local";f[f.OneDrivePersonal=5]="OneDrivePersonal";f[f.WebDav=6]="WebDav";f[f.Ziggeo=7]="Ziggeo"})(SourceType||(SourceType={}));
(function(f){f.isOneDrive=function(e){return e===f.OneDrivePersonal||e===f.OneDriveForBusiness};f.isCloud=function(e){return e===f.Dropbox||e===f.Google||f.isOneDrive(e)||e===f.WebDav||e===f.Ziggeo}})(SourceType||(SourceType={}));
var FileInOneDriveHandle=function(){function f(e){this.postMessageFile=e}f.prototype.get=function(){return objectState.isNullOrUndefined(this.postMessageFile.id)?this.postMessageFile.url:{url:this.postMessageFile.url,viewUrl:this.postMessageFile.viewUrl,downloadUrl:this.postMessageFile.downloadUrl,id:this.postMessageFile.id,canBeCopied:null==this.postMessageFile.canBeCopied?!0:this.postMessageFile.canBeCopied,canBeShared:null==this.postMessageFile.canBeShared?!0:this.postMessageFile.canBeShared}};
return f}(),PickerFileResult=function(){function f(e,f,d,b,a,c){this.fileHandle=e;this.name=f;this.size=d;this.sourceType=b;this.relativePath=a;this.mimeType=c}f.prototype.getFileHandle=function(){return this.fileHandle.get()};f.createExternalSourcePickerFileResult=function(e,k,d,b,a,c,g,h){return new f(new ExternalSourceFileHandle(e,c,g,h),k,d,b,null,a)};f.createLocalPickerFileResultWithInput=function(e,k){return new f(new LocalFileInputHandle(e),k,null,SourceType.Local)};f.createLocalPickerFileResult=
function(e){return new f(new LocalFileHandle(e),e.name,e.size,SourceType.Local,null,e.type)};f.createFolderPickerFileResultWithRelativePath=function(e,k){return new f(new LocalFileHandle(e),e.name,e.size,SourceType.Local,k,e.type)};f.createPickerFileResultWithFileName=function(e){return new f(new LocalFileHandle(null),e,0,SourceType.Local,null,null)};f.createOneDrivePickerFileResult=function(e){return new f(new FileInOneDriveHandle(e),e.name,e.size,e.sourceType,null,e.mimeType)};return f}(),UploadMetadata=
function(f){function e(e,d,b,a,c,g,h,m,l){f.call(this,d,b,g);this.id=e;this.name=d;this.sourceType=b;this.signature=a;this.signedFileRepoId=c;this.mimeType=g;this.isTemplate=h;this.customId=m;this.originalFileId=l}__extends(e,f);e.updateName=function(e,d){e.name=d};e.setTemplate=function(e,d){e.isTemplate=d};e.create=function(f,d){var b=f.name,a=f.sourceType,c=f.mimeType,g=null,h=null,m=null,l=null;f=f.getFileHandle().id;d&&(d.fileGuid&&(g=d.fileGuid),d.signedGuid&&(h=d.signedGuid),d.signedFileRepoId&&
(m=d.signedFileRepoId),d.mimeType&&(c=d.mimeType),d.customId&&(l=d.customId));return new e(g,b,a,h,m,c,!1,l,f)};return e}(BaseMetadata);
(function(f){(function(e){var k=f.CheckboxStateMachine.State,d=function(){function b(a,b,g,d,e,l,k,n){var c=this;void 0===n&&(n=void 0);this.courseId=a;this.eventId=b;this.utilityBase=g;this.markupBuilderBase=d;this.callbacks=e;this.addResourceDialogTitle=l;this.ajaxClientBase=k;this.mainContainer=n;this.fileUploadInProgress=this.shouldFileBeAttachedToEventImmediately=!1;this.onAddResourceMenuItemLinkClick=function(a){switch(parseInt($(a.currentTarget).data(c.utilityBase.dataAttributeNames.ElementExternalSource),
10)){case f.AddResourceMenu.ElementExternalSourceType.Course:c.addFromCourse();break;case f.AddResourceMenu.ElementExternalSourceType.Library:c.addFromLibrary();break;case f.AddResourceMenu.ElementExternalSourceType.Computer:c.fileUploadInProgress||c.addFromComputer()}};this.afterOkClickCallback=function(a){a&&(a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.DetachedByUser||c.currentElementStates.set(b,a)}),a=c.getElementIdsToAttach(),c.saveElementStates(),
c.callbacks.afterAttachElements&&0<a.length&&c.callbacks.afterAttachElements(a))};this.currentElementStates=new Map;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;CCL.CommonFunctions.attachPostMessageEventListener($(window),this.utilityBase.postMessageNames.SendElementIdToCourseFeature,function(a){c.attachElement(a.elementId)})}b.prototype.attachElement=function(a){this.currentElementStates.set(a,k.AttachedByUser);this.saveElementStates();this.callbacks.afterAttachElements&&this.callbacks.afterAttachElements(this.getElementIdsToAttach())};
b.prototype.removeElement=function(a){var b=this.utilityBase.getElementId(a);this.updateElementState(b);this.markupBuilderBase.removeElement(a,this.callbacks.afterDetachElements)};b.prototype.removeElementById=function(a){this.updateElementState(a);this.markupBuilderBase.removeElement(this.utilityBase.getElementByElementId(a),this.callbacks.afterDetachElements)};b.prototype.toggleElementActivation=function(a){this.utilityBase.toggleElementActivation(a)};b.prototype.addFakeItemToElementSection=function(a){this.markupBuilderBase.addFakeItemIntoElementSection(a,
this.mainContainer)};b.prototype.removeFakeItemFromElementSection=function(){this.markupBuilderBase.removeFakeItemFromElementSection()};b.prototype.onFileSelectedImpl=function(a){var b=this;this.toggleAddFromComputerOption(!1);setTimeout(function(){b.fileUploadInProgress&&b.addFakeItemToElementSection(a[0].name)},e.CalendarClientConstants.uploadingFileTimeoutMilliseconds)};b.prototype.onFileUploadSuccessImpl=function(a){var b=this;this.fileUploadInProgress&&(this.addFileRequest=this.ajaxClientBase.createNewFileElementForEvent(this.courseId,
this.eventId,a,this.shouldFileBeAttachedToEventImmediately),this.addFileRequest.done(function(a){b.removeFakeItemFromElementSection();b.toggleAddFromComputerOption(!0);if(a.Success&&(b.attachElement(a.ElementId),b.callbacks.onElementListChanged))b.callbacks.onElementListChanged();b.addFileRequest=void 0}))};b.prototype.onFileUploadFailedImpl=function(a,b){this.cleanRequestsAndOptions();CCL.CommonFunctions.jAjaxConfirm(b,this.utilityBase.terms.FailedFileUploadChoiceDialogTitle,this.utilityBase.terms.FailedFileUploadChoiceDialogUploadNewFile,
this.utilityBase.terms.FailedFileUploadChoiceDialogCancel,function(a){a&&$("#"+Components.ComponentName.localPicker).click()});this.markupBuilderBase.removeFakeItemFromElementSection();if(this.callbacks.onErrorMessageShown)this.callbacks.onErrorMessageShown()};b.prototype.cleanRequestsAndOptions=function(){this.addFileRequest&&(this.addFileRequest.abort(),this.addFileRequest=void 0);this.toggleAddFromComputerOption(!0)};b.prototype.addFromCourse=function(){var a={elementStates:f.MapUtils.makeCopy(this.currentElementStates),
elementType:f.ElementLinkDialog.ContentElementType.All,header:this.addResourceDialogTitle,afterOkClickCallback:this.afterOkClickCallback,showAll:!1,allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.CalendarEvent,relatedEntityId:this.eventId,maxCountOfAddedElements:this.utilityBase.constants.MaxCountOfAddedElements};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,this.ajaxParams)};b.prototype.addFromLibrary=function(){window[this.utilityBase.clientInstanceNamesBase.LibraryBrowserDialog].browseLibrary({CourseId:this.courseId})};
b.prototype.addFromComputer=function(){$("#"+Components.ComponentName.localPicker).click()};b.prototype.getElementIdsToAttach=function(){var a=this,b=[];this.currentElementStates.forEach(function(c,d){a.checkboxStateMachine.isElementChecked(c)&&b.push(d)});return b};b.prototype.updateElementState=function(a){var b=this.currentElementStates.get(a);b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,b);this.currentElementStates.set(a,b);this.saveElementStates()};b.prototype.toggleAddFromComputerOption=
function(a){this.fileUploadInProgress=!a;if(this.callbacks.onUploadFromComputer)this.callbacks.onUploadFromComputer(this.fileUploadInProgress)};return b}();e.AddEditEventElementLinkManagerBase=d})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){var d=function(b){function a(c,g,d,e,l,k,n){b.call(this,c,g,d,e,l,d.settings.Terms.AddResourceDialogTitle,k);this.utility=d;this.markupBuilder=e;if(!l.afterAttachElements)throw Error("Argument afterAttachElements is undefined!");this.loadElementStates();this.ajaxParams={locationId:c,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};a.instance=window[n]=this}__extends(a,b);a.onFileUploadSuccess=function(b){a.instance.onFileUploadSuccessImpl(b)};
a.onFileUploadFailed=function(b,g){a.instance.onFileUploadFailedImpl(b,g)};a.onFileSelected=function(b){a.instance.onFileSelectedImpl(b)};a.prototype.cleanAndRemoveElementStates=function(){var a=this,b=[];this.currentElementStates.forEach(function(c,g){a.checkboxStateMachine.isElementChecked(c)&&b.push(g)});for(var d=0;d<b.length;d++)this.removeElementById(b[d]);this.saveElementStates()};a.prototype.loadElementStates=function(){var a=this.utility.controls.elementIdsWithStatesHidden.val();0<this.utility.controls.elementIdsWithStatesHidden.length&&
a&&(this.currentElementStates=f.MapUtils.jsonStringToMap(a,f.MapUtils.numberKeyConverter))};a.prototype.saveElementStates=function(){this.utility.controls.elementIdsWithStatesHidden.val(f.MapUtils.mapToJsonString(this.currentElementStates)).trigger("change")};return a}(e.AddEditEventElementLinkManagerBase);k.ElementLinkManager=d})(e.EditEvent||(e.EditEvent={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(a){function b(b,c,d,e,f,k){var g=this;a.call(this,b,void 0,c,d,e,c.settings.terms.AddResourceDialogTitle,f,k.mainContainer);this.utility=c;this.markupBuilder=d;this.ajaxClient=f;this.dialog=k;this.setToggleElementInDialog=function(a){a.setToggleElement($("#popup_overlay, #popup_container"))};this.callbacks.onErrorMessageShown=function(){return g.setToggleElementInDialog(k)}}__extends(b,a);b.cleanRequestsAndOptions=function(){var a=
window.document.getElementById(b.currentManager.utility.settings.ClientInstanceNames.UploadArea);a&&(a[b.currentManager.utility.settings.ClientInstanceNames.UploadControl].clearFileListAndLastRequest(),b.currentManager.cleanRequestsAndOptions())};b.prototype.getElementIdsHidden=function(){return $(this.utility.dataAttributes.addEventDialogAttachedElementsHidden)};b.prototype.emptyElementIdsHidden=function(){this.getElementIdsHidden().prop("value","[]")};return b}(e.AddEditEventElementLinkManagerBase);
d.ElementLinkManagerDialogBase=b})(f.ElementLink||(f.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=f.CheckboxStateMachine.State,a=function(a){function c(b,c,g,d,f){var h=this;a.call(this,void 0,b,g,f,c,d);this.refreshElementList=function(a){h.ajaxClient.getElementListMarkupForEventIds(0,h.utility.controls.addEventStartDateHiddenField.value,h.getCurrentCourseId(),a,h.markupBuilder.getCurrentFakeElementTitle()).done(function(a){h.markupBuilder.rebuildElementListMarkup(h.mainContainer,a);h.mainContainer.find("."+h.utility.settings.cssClasses.ElementList).on("click",
"."+h.utility.settings.cssClasses.ElementListItemRemove,function(a){h.removeElement($(a.target).closest(h.utility.selectors.elementListItem))})})};this.eventTypeParser=new e.EventTypeParser(b);this.callbacks.afterAttachElements=this.refreshElementList}__extends(c,a);c.prototype.setParameters=function(a,b){this.ajaxParams={locationId:a,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};this.courseId=a;this.elementListHidden=b;this.loadElementStates()};c.prototype.generateElementSections=
function(a,b){var c=this.mainContainer.find("."+this.utility.settings.cssClasses.ContextDialogContent),g=this.mainContainer.find("."+this.utility.settings.cssClasses.SelectedElementListAppendTarget);0<g.length?(g.empty(),this.emptyElementIdsHidden(),c.find("."+this.utility.settings.cssClasses.AddElementButton).remove()):b&&(g=this.markupBuilder.generateElementListAppendTarget(),c.append(g).append(this.markupBuilder.generateAttachedElementsHidden()));b&&(this.markupBuilder.renderAddButtonWithElementSections(c,
{courseId:a,enableElementLinkManagement:!0,elementListMarkups:{Resources:void 0,ResourceCount:0,Homework:void 0,HomeworkCount:0}},e.EventDetailsType.ContextDialog),this.setParameters(a,this.getElementIdsHidden()))};c.prototype.loadElementStates=function(){var a=this;this.currentElementStates=new Map;var c=this.elementListHidden.val();0<this.elementListHidden.length&&c&&JSON.parse(c).forEach(function(c){a.currentElementStates.set(c,b.AttachedByUser)})};c.prototype.saveElementStates=function(){var a=
[];this.currentElementStates.forEach(function(c,g){c===b.AttachedByUser&&a.push(g)});this.elementListHidden.val(JSON.stringify(a))};c.prototype.setCalendarEventElementLinkManager=function(){d.ElementLinkManagerDialogBase.currentManager=window[this.utility.settings.constants.CalendarEventElementLinkManager]=this};c.prototype.getCurrentCourseId=function(){return this.eventTypeParser.parseCourseId(this.utility.controls.addEventCalendarsDropdown.val())};return c}(d.ElementLinkManagerDialogBase);d.AddEventElementLinkManager=
a})(e.ElementLink||(e.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=f.CheckboxStateMachine.State,a=function(a){function c(b,c,g,d,e){a.call(this,void 0,b,g,e,c,d);this.dialogCallbacks=e;this.isElementDeletionConfirmationShown=!1;this.shouldFileBeAttachedToEventImmediately=!0}__extends(c,a);c.prototype.setCalendarEventElementLinkManager=function(){d.ElementLinkManagerDialogBase.currentManager=window[this.utility.settings.constants.CalendarEventElementLinkManager]=this};c.prototype.setParameters=function(a){this.currentEvent=
a;this.ajaxParams={locationId:this.currentEvent.courseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};this.courseId=this.currentEvent.courseId;this.loadElementStates();this.eventId=a.activityId};c.prototype.onRemoveElementClick=function(a,c,g){var d=this,e=a.closest(this.utility.selectors.elementListItem);a=e.find("."+this.utility.settings.cssClasses.ElementListTitle).text();c=CCL.CommonFunctions.formatString(this.utility.settings.terms.removeElementConfirmation,a);0<g.length&&
(c+="\n"+g);this.isElementDeletionConfirmationShown=!0;CCL.CommonFunctions.jAjaxConfirm(c,CCL.CommonFunctions.formatString(this.utility.settings.terms.RemoveTooltipTemplate,a),this.utility.settings.terms.alertOkButtonCaption,this.utility.settings.terms.AlertCancelButtonCaption,function(a){d.isElementDeletionConfirmationShown=!1;if(a){d.dialogCallbacks.dialogPositionRecalculation();var c=d.utility.getElementForEventData(e);d.ajaxClient.removeElement({EventId:c.EventId,ElementId:c.ElementId}).done(function(){d.currentElementStates.set(c.ElementId,
b.DetachedByUser);d.onRemoveElementsComplete(e)})}})};c.prototype.getIfElementDeletionConfirmationIsShown=function(){return this.isElementDeletionConfirmationShown};c.prototype.saveElementStates=function(){var a=this,b=[],c=[];this.currentElementStates.forEach(function(a,g){switch(a){case f.CheckboxStateMachine.State.AttachedByUser:b.push(g);break;case f.CheckboxStateMachine.State.DetachedByUser:c.push(g)}});(0<b.length||0<c.length)&&this.ajaxClient.updateEventElements({EventId:this.currentEvent.activityId,
ElementIdsToAdd:b,ElementIdsToRemove:c,FakeElementTitle:this.markupBuilder.getCurrentFakeElementTitle()}).done(function(b){a.onUpdateEventElementsComplete(b)})};c.prototype.loadElementStates=function(){var a=this;this.currentElementStates=new Map;var b=[];this.currentDialogContainer||(this.currentDialogContainer=this.mainContainer);this.currentDialogContainer.find("."+this.utility.settings.cssClasses.ElementList).find(this.utility.selectors.elementListItem).each(function(c,g){c=a.utility.getElementForEventData($(g));
c.AddedManually&&a.currentElementStates.set(c.ElementId,f.CheckboxStateMachine.State.Saved);c.CanBeRemoved||b.push(c.ElementId)});return b};c.prototype.addFromCourse=function(){var a=this.loadElementStates();a={elementStates:f.MapUtils.makeCopy(this.currentElementStates),disabledElementIds:a,afterOkClickCallback:this.afterOkClickCallback,maxCountOfAddedElements:this.utility.constants.MaxCountOfAddedElements,elementType:f.ElementLinkDialog.ContentElementType.All,showAll:!0,header:this.utility.settings.terms.AddResourceDialogTitle,
allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.CalendarEvent};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(a,this.ajaxParams)};c.prototype.onUpdateEventElementsComplete=function(a){a&&this.markupBuilder.rebuildElementListMarkup(this.currentDialogContainer,a);this.dialogCallbacks.onElementListChanged()};c.prototype.onRemoveElementsComplete=function(a){this.markupBuilder.removeElement(a,this.dialogCallbacks.dialogPositionRecalculation);this.dialogCallbacks.onElementListChanged()};
return c}(d.ElementLinkManagerDialogBase);d.EditEventElementLinkManager=a})(e.ElementLink||(e.ElementLink={}))})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.settings=b;this.$saveButton=$("#"+this.settings.Controls.GroupDialogOkButton);this.$cancelButton=$("#"+this.settings.Controls.GroupDialogCancelButton);this.$learnerDefinedGroupLink=$("#"+this.settings.Controls.GroupLink);this.$submitIndividuallyLink=$("#"+this.settings.Controls.SubmitIndividuallyLink);this.$withdrawLink=$("#"+this.settings.Controls.WithdrawLink);this.manageGroupDialog=
window[this.settings.Controls.ManageGroupDialog];this.settingManager=e.Settings.Manager.getInstance();$(function(){c.manageGroupDialog.setCustomScripts({afterOpenDialog:function(){setTimeout(function(){$("."+c.settings.Css.ExpandedExtensionIframe).addClass(c.settings.Css.ExpandedExtensionIframeStackedUnderSettings)},100)},beforeCloseDialog:function(){$("."+c.settings.Css.ExpandedExtensionIframe).removeClass(c.settings.Css.ExpandedExtensionIframeStackedUnderSettings)}});c.$submitIndividuallyLink.on("click",
function(){CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.UseIndividualSubmission.replace("{elementId}",c.settings.ElementId.toString())}).done(function(a){return c.processResponse(a)}).fail(function(){return c.settingManager.alertError()})});c.$learnerDefinedGroupLink.on("click",function(){c.manageGroupDialog.openDialog(!1)});c.$withdrawLink.on("click",function(){c.settings.IsIndividualSubmission?c.withdrawFromGroup():CCL.CommonFunctions.jAjaxConfirm(c.settings.Terms.WithdrawConfirmation,
c.settings.Terms.ConfirmTitle,c.settings.Terms.Yes,c.settings.Terms.No,function(a){a&&c.withdrawFromGroup()})});c.$saveButton.on("click",function(){c.saveGroup()&&CssModal.closeDialog()});c.$cancelButton.on("click",function(){CssModal.closeDialog()})})}a.prototype.saveGroup=function(){var a=this;this.$saveButton.toggleHyperlink(!1);var b=$("#"+this.settings.Controls.ManageGroupDialog).find("iframe").get(0).contentWindow[this.settings.ManageGroupDialogInstanceName].getState();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.CreateCollaborationBasedOnLearnerDefinedGroup.replace("{elementId}",
this.settings.ElementId.toString()),data:{personIds:b.personIds}}).done(function(b){return a.processResponse(b)}).fail(function(){return a.settingManager.alertError()});return!0};a.prototype.withdrawFromGroup=function(){var a=this;CCL.CommonFunctions.safeAjax({type:"DELETE",url:this.settings.WebMethods.WithdrawFromLearnerDefinedGroup.replace("{elementId}",this.settings.ElementId.toString())}).done(function(b){return a.processResponse(b)}).fail(function(){return a.settingManager.alertError()})};a.prototype.processResponse=
function(a){a.Success?window.location.href=window.location.href.split("#")[0]:this.settingManager.alertError(a.Message)};return a}();d.LearnerDefinedGroups=b})(f.Collaboration||(f.Collaboration={}))})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function a(a,b,d,e,f){this._isActive=a;this._useTimeSpan=b;this._timeZoneOffsetInSeconds=d;this._incorrectFormatTerm=e;this._dateShouldBeSetTerm=f}Object.defineProperty(a.prototype,"isActive",{get:function(){return this._isActive},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"useActivationTimeSpan",{get:function(){return this._useTimeSpan},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromDateTime",{get:function(){return this.fromState.date},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toDateTime",{get:function(){return this.toState.date},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isValid",{get:function(){if(!this.useActivationTimeSpan)return!0;var a=this.validationErrors;return 0===a.fromValidationError.length&&0===a.toValidationError.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fromNow",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&
void 0==this.fromDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"toInfinity",{get:function(){return!this.useActivationTimeSpan||this.useActivationTimeSpan&&void 0==this.toDateTime},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"validationErrors",{get:function(){var a={fromValidationError:"",toValidationError:""};if(!this.useActivationTimeSpan)return a;this.fromState.isValid||(a.fromValidationError=this._incorrectFormatTerm);this.toState.isValid||(a.toValidationError=
this._incorrectFormatTerm);if(0<a.fromValidationError.length||0<a.toValidationError.length)return a;!this.toInfinity&&this.fromNow&&(a.fromValidationError=this._dateShouldBeSetTerm);return a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isActiveAccordingToTimeSpan",{get:function(){if(!this.useActivationTimeSpan)return this.isActive;var a=CCL.DateFunctions.getItslNow(this._timeZoneOffsetInSeconds);return this.fromNow&&this.toInfinity?!0:this.fromNow?this.isFirstLessThanSecond(a,
this.toDateTime):this.toInfinity?this.isFirstLessThanSecond(this.fromDateTime,a):this.isFirstLessThanSecond(this.fromDateTime,a)&&this.isFirstLessThanSecond(a,this.toDateTime)},enumerable:!0,configurable:!0});a.prototype.isFirstLessThanSecond=function(a,b){if(a&&b)return a<b};return a}();e.ActivationTimeSpanState=d;var b=function(){function a(a,b){var c=this;window[a]=this;this.settings=b;this.isElementActiveNow=this.settings.IsActive;this.useTimespan=this.settings.UseActivationTimespan;$(function(){c.fillJQueryElements();
c.fromDateTimePickerInstance=window[c.settings.ClientInstances.FromDateTimePickerClientInstanceName];c.toDateTimePickerInstance=window[c.settings.ClientInstances.ToDateTimePickerClientInstanceName];c.$activationLink.add(c.$activationLabel).click(function(){c.useTimespan&&(c.useTimespan=!1);c.isElementActiveNow=!c.isElementActiveNow;c.updateControlState();CCL.UnobtrusiveCustomTooltipManager.closeTooltip()});c.$toggleTimespanLink.click(function(){c.useTimespan=!c.useTimespan;c.updateControlState()});
c.updateControlState();$(c.fromDateTimePickerInstance).add($(c.toDateTimePickerInstance)).change(function(){return c.updateControlState()})})}a.prototype.getActivationTimeSpanState=function(){var a=new d(this.isElementActiveNow,this.useTimespan,this.settings.TimeZoneOffsetInSeconds,this.settings.Terms.DateMustBeOnTheFormatX,this.settings.Terms.PleaseEnterDate);a.useActivationTimeSpan&&(a.fromState=this.fromDateTimePickerInstance.getDateTimePickerState(),a.toState=this.toDateTimePickerInstance.getDateTimePickerState());
return a};a.prototype.hasTimeSpan=function(){if(!this.useTimespan)return!1;var a=this.getActivationTimeSpanState();return a.fromState.isValid&&!a.fromState.isEmpty};a.prototype.isActive=function(){return this.isElementActiveNow};a.prototype.validateControl=function(){var a=this.getActivationTimeSpanState(),b=a.validationErrors,d={isInvalid:b.toValidationError&&0<b.toValidationError.length,errorMessage:b.toValidationError,highlightInput:!0};this.fromDateTimePickerInstance.toggleValidationError({isInvalid:b.fromValidationError&&
0<b.fromValidationError.length,errorMessage:b.fromValidationError,highlightInput:!0});this.toDateTimePickerInstance.toggleValidationError(d);return a.isValid};a.prototype.isStringNullOrEmpty=function(a){return!a||0===a.length};a.prototype.fillJQueryElements=function(){this.$textAndIconContainer=$("#"+this.settings.Controls.TextAndIconContainer);this.$activationLink=$("#"+this.settings.Controls.ActivationLink);this.$activationImage=this.$activationLink.find("img");this.$activationLabel=$("#"+this.settings.Controls.ActivationLabel);
this.$toggleTimespanLink=$("#"+this.settings.Controls.ToggleTimespanLink);this.$timespanContainer=$("#"+this.settings.Controls.TimespanContainer);this.$fromDateInput=$("#"+this.settings.Controls.FromDateInput);this.$fromHoursDropDown=$("#"+this.settings.Controls.FromHoursDropDown);this.$fromMinutesDropDown=$("#"+this.settings.Controls.FromMinutesDropDown);this.$toDateInput=$("#"+this.settings.Controls.ToDateInput);this.$toHoursDropDown=$("#"+this.settings.Controls.ToHoursDropDown);this.$toMinutesDropDown=
$("#"+this.settings.Controls.ToMinutesDropDown)};a.prototype.updateControlState=function(){var a=this.getActivationTimeSpanState();a.useActivationTimeSpan&&(a=a.isActiveAccordingToTimeSpan,void 0!=a&&(this.isElementActiveNow=a));this.$timespanContainer.toggle(this.useTimespan);this.$toggleTimespanLink.toggleClass(this.settings.Css.AddLink,!this.useTimespan).toggleClass(this.settings.Css.RemoveLink,this.useTimespan);this.$toggleTimespanLink.find("span").text(this.useTimespan?this.settings.Terms.RemoveScheduledVisibility:
this.settings.Terms.AddScheduledVisibility);this.$activationLabel.html(this.isElementActiveNow?this.settings.Terms.ResourceIsVisible:this.settings.Terms.ResourceIsNotVisible);this.$activationImage.attr("src",this.isElementActiveNow?this.settings.Images.Active:this.settings.Images.Inactive);a=this.isElementActiveNow?this.settings.Tooltips.ClickToMakeInvisible:this.settings.Tooltips.ClickToMakeVisible;CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$activationLink,a);CCL.UnobtrusiveCustomTooltipManager.setTooltipContentOnTarget(this.$activationLabel,
a);this.settings.Events.ElementActivationChangedEventName&&$(document).trigger(this.settings.Events.ElementActivationChangedEventName)};return a}();e.Activation=b})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;window[b]=this;this.settings=a;this.$toggle=$("#"+a.Controls.CompletedToggle);this.$simpleStatusSelector=$("#"+a.Controls.SimpleStatusSelector);if(0<this.$toggle.length||0<this.$simpleStatusSelector.length){this.$score=$("#"+a.Controls.Score);this.$assessment=$("#"+a.Controls.Assessment);var g=$("#"+a.Controls.CompletedToggleLabel),d=$("#"+a.Controls.AssessmentLabel+", #"+a.Controls.ScoreLabel);this.$toggle.on(a.ToggleStateChangedEventName,
function(b,c){b=window[c.toggleInstanceId];b.isChecked()?g.html(a.Terms.CompletedToggleOn):g.html(a.Terms.CompletedToggleOff);d.toggleClass(a.CssClasses.MandatoryMark,b.isChecked())});this.settings.IsAssessmentMandatoryForCompletedStatus&&(this.$score.add(this.$simpleStatusSelector).change(function(){d.toggleClass(a.CssClasses.MandatoryMark,c.isAsessmentMissingForCompleted())}),this.$assessment.on("autocompletechange",function(){d.toggleClass(a.CssClasses.MandatoryMark,c.isAsessmentMissingForCompleted())}))}this.rubricToggleChangeValue=
a.RubricToggleChangeValue;this.$criteriaAssessmentToggle=$("#"+this.settings.Controls.CriteriaAssessment);this.$rubricCriteriaList=$("#"+this.settings.Controls.RubricCriteriaList);this.$criteriaAssessmentToggle.change(function(){return c.toggleCriteriaAssessmentList()})}d.prototype.toggleCriteriaAssessmentList=function(){var b=this.$criteriaAssessmentToggle.val()===this.rubricToggleChangeValue;this.$rubricCriteriaList.toggleClass(this.settings.CssClasses.Hidden,!b)};d.prototype.isAsessmentMissingForCompleted=
function(){return(this.$toggle.is(":checked")||this.$simpleStatusSelector.val()===this.settings.SimpleStatusSelectorCompletedValue)&&(this.$assessment.val()===this.settings.NotAssessedValue||""===this.$score.val())};d.prototype.validateAssessmentForCompleted=function(b,a){a.IsValid=!this.isAsessmentMissingForCompleted()};return d}();e.ActivityMultipleAssessment=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.synchronize(b)}Object.defineProperty(d.prototype,"currentClientTime",{get:function(){return(new Date).getTime()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"clientDeltaTime",{get:function(){return this.currentClientTime-this.clientFixedTime},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentServerTime",{get:function(){return new Date(this.serverFixedTime+this.clientDeltaTime)},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"currentServerTimeWithoutSeconds",{get:function(){var b=this.currentServerTime;b.setSeconds(0);b.setMilliseconds(0);return b},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSynchronizeNeeded",{get:function(){return 3E5<this.clientDeltaTime},enumerable:!0,configurable:!0});d.prototype.synchronize=function(b){this.serverFixedTime=b.getTime();this.clientFixedTime=this.currentClientTime};return d}();e.DateTimeSynchronizer=f})(f.Controls||
(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.endDate=new Date;window[b]=this;this.settings=a;this.datePeriod=this.settings.DatePeriod;this.startDate=$.datepicker.parseDate(this.settings.DateFormat,this.settings.StartDate);this.setEndDate();this.weekNumber=this.settings.WeekNumber;this.dayNames=this.settings.DayNames;$(function(){c.$prevButton=$("#"+c.settings.ClientIds.PrevButton);c.$nextButton=$("#"+c.settings.ClientIds.NextButton);c.$dateShortLabel=$("#"+c.settings.ClientIds.DateShortLabel);
c.$datePrefixLabel=$("#"+c.settings.ClientIds.DatePrefixLabel);c.$prevButton.click(function(){return c.goToPreviousPeriod()});c.$nextButton.click(function(){return c.goToNextPeriod()});c.triggerPeriodChangedEvent()})}d.prototype.toggleNavigationButtons=function(b){this.$prevButton.toggleHyperlink(b);this.$nextButton.toggleHyperlink(b)};d.prototype.changeDatePeriod=function(b){this.startDate=$.datepicker.parseDate(this.settings.DateFormat,b);this.setEndDate();this.setWeekNumber();this.updateTitleLabel();
this.triggerPeriodChangedEvent()};d.prototype.toggleWeekDayMode=function(b,a){this.datePeriod=b;switch(this.datePeriod){case e.DatePeriod.Day:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousDay);this.$nextButton.prop("title",this.settings.Terms.GoToTheNextDay);break;case e.DatePeriod.Week:this.$prevButton.prop("title",this.settings.Terms.GoToThePreviousWeek),this.$nextButton.prop("title",this.settings.Terms.GoToTheNextWeek)}this.changeDatePeriod(a)};d.prototype.goToPreviousPeriod=
function(){this.$prevButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(-this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent(),this.$prevButton.removeAttr("disabled"),this.$prevButton.focus())};d.prototype.goToNextPeriod=function(){this.$nextButton.getIfHyperLinkEnabled()&&(this.setNewPeriodDates(this.getNumberOfDaysInPeriod()),this.updateTitleLabel(),this.triggerPeriodChangedEvent(),this.$nextButton.removeAttr("disabled"),this.$nextButton.focus())};d.prototype.setNewPeriodDates=
function(b){this.startDate&&(this.setStartDate(b),this.setEndDate(),this.setWeekNumber())};d.prototype.setStartDate=function(b){this.startDate=this.addDays(this.startDate,b);this.startDate.setHours(0);this.startDate.setMinutes(0)};d.prototype.setEndDate=function(){this.endDate=this.addDays(this.startDate,this.getNumberOfDaysInPeriod()-1);this.endDate.setHours(23);this.endDate.setMinutes(59)};d.prototype.setWeekNumber=function(){this.weekNumber=$.datepicker.iso8601Week(this.startDate)};d.prototype.triggerPeriodChangedEvent=
function(){$(this).trigger(d.periodChangedEventName,{startDate:this.getStartDate(),endDate:this.getEndDate()})};d.prototype.addDays=function(b,a){b=new Date(b.valueOf());b.setDate(b.getDate()+a);return b};d.prototype.updateTitleLabel=function(){var b=this.settings.ShowWeekNumber?String.format(this.settings.Terms.WeekNumberTemplate,this.weekNumber.toString()):"",a=$.datepicker.formatDate(this.settings.DateFormat,this.startDate),c=$.datepicker.formatDate(this.settings.DateFormat,this.endDate);this.$datePrefixLabel.toggle(this.datePeriod===
e.DatePeriod.Day||this.settings.ShowWeekNumber);switch(this.datePeriod){case e.DatePeriod.Day:this.$datePrefixLabel.text(this.dayNames[this.startDate.getDay()]);this.$dateShortLabel.text(a);break;case e.DatePeriod.Week:this.$datePrefixLabel.text(b);this.$dateShortLabel.text(a+" - "+c);break;default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};d.prototype.getNumberOfDaysInPeriod=function(){switch(this.datePeriod){case e.DatePeriod.Day:return 1;case e.DatePeriod.Week:return 7;
default:throw Error("Incorrect date period occurred: "+this.datePeriod+".");}};d.prototype.getDateTimeAsString=function(b){return b?$.datepicker.formatDate(this.settings.DateFormat,b)+" "+e.DateTimePicker.getNumberAsTwoCharString(b.getHours())+":"+e.DateTimePicker.getNumberAsTwoCharString(b.getMinutes()):""};d.prototype.getStartDate=function(){return this.getDateTimeAsString(this.startDate)};d.prototype.getEndDate=function(){return this.getDateTimeAsString(this.endDate)};d.periodChangedEventName=
"datePeriodSelector:periodChanged";return d}();e.DatePeriodSelector=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function b(a,b,g,e){d.call(this,a,b,g,e)}__extends(b,d);b.prototype.getParams=function(a){var b=a.attr("data-date");a=a.parent().parent().attr("data-kpi-m-id");return{Date:b,MeasurementId:a}};b.prototype.paramsAreEqual=function(a,b){return null==a?!1:a.Date===b.Date&&a.MeasurementId===b.MeasurementId};b.prototype.formatUrlParams=function(a){return{date:a.Date,measurementid:a.MeasurementId}};return b}(e.BaseDetailedInfo);e.FeatureAdoptionDetailedInfo=f})(f.Controls||
(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;window[b]=this;this.settings=a;$(function(){c.$dataHidden=$("#"+c.settings.Controls.DataHidden);c.$listContainer=$("#"+c.settings.Controls.ListContainer);c.$orderChangedHidden=$("#"+c.settings.Controls.OrderChangedHidden);c.$listContainer.on("click","."+c.settings.Css.RemoveLink,function(a){a=$(a.currentTarget).closest("li");a=parseInt(a.data("id"),10);c.deleteElement(a)})})}d.prototype.getElementIds=function(){var b=this.$dataHidden.val();
return b?JSON.parse(b):[]};d.prototype.updateOrder=function(b){for(var a=[],c=0;c<b.length;c++){var g=b[c];g&&g.length&&(g=parseInt(g),isNaN(g)||a.push(g))}0<a.length&&this.$dataHidden.val(JSON.stringify(a));this.$orderChangedHidden.val("true")};d.prototype.addElement=function(b){var a=this;return $.getJSON(this.settings.WebMethods.GetElement.replace("{elementId}",b.toString())).done(function(b){a.addElementItem(b.ElementId,b.Title,b.IsActive,b.IconUrl)})};d.prototype.addElements=function(b){var a=
this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetElements.replace("{courseId}",this.settings.CourseId.toString()),data:{elementIds:b},dataType:"json"}).done(function(b){$.each(b,function(b,c){a.addElementItem(c.ElementId,c.Title,c.IsActive,c.IconUrl)})})};d.prototype.addElementItem=function(b,a,c,g){var d=JSON.parse(this.$dataHidden.val());if(-1===$.inArray(b,d)){var e=this.settings.Terms.RemoveTooltip.replace("{0}",a);c=c?"":this.settings.Css.Inactive;this.$listContainer.append($("<li></li>").attr("data-id",
b).append($("<span></span>").attr("class",this.settings.Css.ListItem).append($("<span></span>").attr("class",this.settings.Css.AssignmentIcon).append($("<img>").attr("src",g)).append($("<span></span>").attr("class",c).text(a)).append("&nbsp;")).append($("<span></span>").attr("class",this.settings.Css.RemoveLink).attr("title",e).text(this.settings.DeleteChar))));d.push(b);this.$dataHidden.val(JSON.stringify(d));this.$orderChangedHidden.val("true")}else b=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",
b)+" span:first-child span:first-child span"),b.text(a),b.toggleClass(this.settings.Css.Inactive,!c)};d.prototype.deleteElement=function(b){var a=JSON.parse(this.$dataHidden.val()),c=a.indexOf(b);-1<c&&(a.splice(c,1),this.$dataHidden.val(JSON.stringify(a)));(b=this.$listContainer.find(CCL.CommonFunctions.getDataSelector("id",b)))&&b.remove()};d.prototype.deleteElements=function(b){var a=this;$.each(b,function(b,g){a.deleteElement(g)})};return d}();e.ElementList=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.viewModel=b;window[a]=this;this.controlsProvider=new e.ResultsAndFeedbackInternals.ControlsProvider(b);this.externalDependenciesController=new e.ResultsAndFeedbackInternals.ExternalDependenciesController(b,this.controlsProvider);this.whenToShowResultsController=new e.ResultsAndFeedbackInternals.WhenToShowResultsController(b,this.controlsProvider,this.externalDependenciesController);this.whenToShowQuestionListAndAnswerController=new e.ResultsAndFeedbackInternals.WhenToShowQuestionListAndAnswerController(b,
this.controlsProvider,this.whenToShowResultsController,this.externalDependenciesController);$(function(){c.controlsProvider.$revealCorrectAnswerContainer.toggle(c.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer!==e.WhenToShowQuestionListAndAnswer.Never)})}Object.defineProperty(b.prototype,"revealCorrectAnswer",{get:function(){return this.controlsProvider.revealCorrectAnswerElement.is(":checked")},enumerable:!0,configurable:!0});b.prototype.getState=function(){return{WhenToShowResult:this.whenToShowResultsController.whenToShowResult,
WhenToShowQuestionListAndAnswer:this.whenToShowQuestionListAndAnswerController.whenToShowQuestionListAndAnswer,RevealCorrectAnswer:this.revealCorrectAnswer,WhenToShowResultsChanged:this.whenToShowResultsController.whenToShowResultsChanged}};return b}();e.ResultsAndFeedback=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){var c=this;this.viewModel=b;this.attemptsChanged=function(a){c.whichAttemptCountsContainer.toggle(1!==c.maxAttemptsAllowed)};window[a]=this;$(function(){c.controlElement=$("#"+b.ContainerId);c.maxAttemptsAllowedElement=$("."+b.MaxAttemptsAllowedSelector,c.controlElement);c.whichAttemptCountsElement=$("."+b.WhichAttemptCountsSelector,c.controlElement);c.whichAttemptCountsContainer=$("#"+b.WhichAttemptCountsContainer,c.controlElement);
c.maxAttemptsAllowedElement.change(c.attemptsChanged).change()})}Object.defineProperty(b.prototype,"maxAttemptsAllowed",{get:function(){return parseInt(this.maxAttemptsAllowedElement.val(),10)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"whichAttemptCounts",{get:function(){var a=this.whichAttemptCountsElement.val();return e.WhichAttemptCounts[a]},enumerable:!0,configurable:!0});b.prototype.getState=function(){return{MaxAttemptsAllowed:this.maxAttemptsAllowed,WhichAttemptCounts:this.whichAttemptCounts,
WhichAttemptCountsChanged:this.whichAttemptCounts!==this.viewModel.AttemptsState.WhichAttemptCounts}};return b}();e.Attempts=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){}}();e.DateWithAdditionalInfo=f;var d=function(){function b(a,b,g,d){this._dateFormat=a;if(0>g||24<=g||0>d||60<=d)this._isValid=!1;else if(b&&b.length){this._isEmpty=!1;try{this._date=$.datepicker.parseDate(this._dateFormat,b),this._date.setHours(g),this._date.setMinutes(d),this._isValid=!0}catch(m){this._isValid=!1}}else this._isValid=this._isEmpty=!0}Object.defineProperty(b.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"isEmpty",{get:function(){return this._isEmpty},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"date",{get:function(){return this._date},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateAsString",{get:function(){return this.isEmpty||!this.isValid?"":$.datepicker.formatDate(this._dateFormat,this._date)+" "+b.getNumberAsTwoCharString(this._date.getHours())+":"+b.getNumberAsTwoCharString(this._date.getMinutes())},
enumerable:!0,configurable:!0});b.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};return b}();e.DateTimePickerState=d;f=function(){function b(a,b){var c=this;this.getDatesToHighlight=function(a,b){return[]};window[a]=this;this.settings=b;this.$datePickerInput=$("#"+this.settings.Controls.DateInputId);this.$hoursDropDown=$("#"+this.settings.Controls.HoursDropDownId);this.$minutesDropDown=$("#"+this.settings.Controls.MinutesDropDownId);this.$validationMessage=$("#"+
this.settings.Controls.ValidationMessageId);this.$textDescription=$("#"+this.settings.Controls.TextDescriptionId);var d={showOn:"focus",buttonImage:"",buttonImageOnly:!1,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0};d.dateFormat=this.settings.DatePickerOptions.DateFormat;d.firstDay=this.settings.DatePickerOptions.FirstDayOfWeek;d.monthNames=this.settings.DatePickerOptions.MonthNames;d.monthNamesShort=this.settings.DatePickerOptions.MonthNamesShort;d.dayNames=this.settings.DatePickerOptions.DayNames;
d.dayNamesShort=this.settings.DatePickerOptions.AbbreviatedDayNames;d.dayNamesMin=this.settings.DatePickerOptions.AbbreviatedDayNames;d.closeText=this.settings.DatePickerOptions.CloseText;d.prevText=this.settings.DatePickerOptions.PrevText;d.nextText=this.settings.DatePickerOptions.NextText;d.currentText=this.settings.DatePickerOptions.CurrentText;d.showWeek=this.settings.DatePickerOptions.ShowWeek;d.weekHeader=this.settings.DatePickerOptions.WeekHeader;d.onChangeMonthYear=function(a,b,g){c.updateDatesToHighLight(a,
b)};d.beforeShowDay=function(a){var b=!0;c.settings.EnableSelectingDatesInThePast||(b=new Date,b=a>=new Date(b.getFullYear(),b.getMonth(),b.getDate()));c.minDate&&(b=a>=c.minDateAtTheBeginningOfDay);if(!c.datesToHighlight||0===c.datesToHighlight.length)return[b];b=[b,""];for(var g=0;g<c.datesToHighlight.length;g++)if(c.areDatesEqual(a,c.datesToHighlight[g].Date)){b[1]=c.datesToHighlight[g].CssClass;break}return b};d.beforeShow=function(a,b){CCL.DatePickerAccessibilityAdapter.setCurrentDatePicker(c);
a=$(a).datepicker("getDate");null==a&&(a=new Date);c.updateDatesToHighLight(a.getFullYear(),a.getMonth()+1)};d.onSelect=function(a){if(c.datesToHighlight&&0!==c.datesToHighlight.length&&(a=$.datepicker.parseDate(d.dateFormat,a))){for(var b=0,g=0,e=0;e<c.datesToHighlight.length;e++)if(c.areDatesEqual(c.datesToHighlight[e].Date,a)){b=c.datesToHighlight[e].Date.getHours();g=c.datesToHighlight[e].Date.getMinutes();break}0!==b||0!==g?c.setTime(b,g):c.setTime(c.settings.DefaultHours,c.settings.DefaultMinutes)}c.updateTimePickerState();
c.updateDependentPicker();c.settings.EnableAutoSelectCurrentTimeForCurrentDate&&c.dateTimeSync&&c.isDateInputTextValid()&&(a=c.dateTimeSync.currentServerTime,c.areDatesEqual(c.getDateTime(),a)&&c.setTimePickerStateToCurrentTime(a));$(c).trigger("change",c.getDateTime())};d.onClose=function(){if(CCL.CommonFunctions.isIe()){var a=c.$datePickerInput.datepicker("option","showOn");c.$datePickerInput.datepicker("option","showOn","button");setTimeout(function(){c.$datePickerInput.focus();setTimeout(function(){c.$datePickerInput.datepicker("option",
"showOn",a)})})}else c.$datePickerInput.focus()};this.$datePickerInput.on("click",function(a){return c.$datePickerInput.focus()});if(this.$datePickerInput&&(this.$datePickerInput.datepicker(d),""===this.$datePickerInput.val()&&this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes),this.$datePickerInput.change(function(){c.updateTimePickerState();$(c).trigger("change",c.getDateTime())}),this.settings.EnableTriggerDateInputBlurEvent))this.$datePickerInput.add(this.$hoursDropDown).add(this.$minutesDropDown).on("blur",
function(){return $(c).trigger("blur",c.getDateTime())});this.$hoursDropDown.add(this.$minutesDropDown).change(function(){$(c).trigger("change",c.getDateTime());c.toggleValidationError({isInvalid:!1})});this.updateTimePickerState()}Object.defineProperty(b.prototype,"dependentPicker",{set:function(a){this.dependentPickerInstance=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dateTimeSynchronizer",{set:function(a){this.dateTimeSync=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"minDate",{get:function(){return this.minDateValue},set:function(a){this.minDateValue=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"minDateAtTheBeginningOfDay",{get:function(){var a=new Date(this.minDateValue.getTime());a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},enumerable:!0,configurable:!0});b.prototype.areDatesEqual=function(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()};b.prototype.setTime=
function(a,b){1<this.settings.MinutesInterval?(a=this.getTimeOfNextInterval(a,b,this.settings.MinutesInterval),this.setDropDownValue(this.$hoursDropDown,a.hours.toString()),this.setDropDownValue(this.$minutesDropDown,a.minutes.toString())):(this.setDropDownValue(this.$hoursDropDown,a.toString()),this.setDropDownValue(this.$minutesDropDown,b.toString()))};b.prototype.getTimeOfNextInterval=function(a,b,g){return 60-b<g?{hours:a+1,minutes:0}:{hours:a,minutes:Math.ceil(b/g)*g}};b.prototype.setDropDownValue=
function(a,b){if(a){var c=!1;a.find("option").each(function(a,g){return g.getAttribute("value")===b?(c=!0,!1):!0});c&&a.val(b)}};b.prototype.getDateTimePickerState=function(){return new d(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val(),this.getDropDownValue(this.$hoursDropDown),this.getDropDownValue(this.$minutesDropDown))};b.prototype.getStringValue=function(){var a=this.$datePickerInput.val();return a?a+" "+b.getNumberAsTwoCharString(this.getHours())+":"+b.getNumberAsTwoCharString(this.getMinutes()):
""};b.prototype.getDateTimeAsString=function(){var a=this.getDateTime();return a?$.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,a)+" "+b.getNumberAsTwoCharString(a.getHours())+":"+b.getNumberAsTwoCharString(a.getMinutes()):""};Object.defineProperty(b.prototype,"isDateValidOrEmpty",{get:function(){return 0===this.$datePickerInput.val().length||this.isDateInputTextValid()},enumerable:!0,configurable:!0});b.prototype.getDateTime=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,
this.$datePickerInput.val())}catch(c){}if(a)return a.setHours(this.getHours()),a.setMinutes(this.getMinutes()),a};b.prototype.setDateTime=function(a){"undefined"===typeof a?(this.$datePickerInput.val(""),this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes)):(this.$datePickerInput.val($.datepicker.formatDate(this.settings.DatePickerOptions.DateFormat,a)),this.setTime(a.getHours(),a.getMinutes()));this.updateTimePickerState();this.updateDependentPicker()};b.prototype.toggleValidationError=
function(a){a.isInvalid?(a.errorMessage&&0<a.errorMessage.length&&(this.$validationMessage.text(a.errorMessage).show(),this.$textDescription.hide()),a.highlightInput&&(this.$datePickerInput.addClass(this.settings.CssClasses.InvalidInput),this.$hoursDropDown.addClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.addClass(this.settings.CssClasses.InvalidInput))):(this.$validationMessage.empty().hide(),this.$textDescription.show(),this.$datePickerInput.removeClass(this.settings.CssClasses.InvalidInput),
this.$hoursDropDown.removeClass(this.settings.CssClasses.InvalidInput),this.$minutesDropDown.removeClass(this.settings.CssClasses.InvalidInput))};b.prototype.highlightOnAutoCorrectInvalidInput=function(a){var b=this;this.$datePickerInput.addClass(this.settings.CssClasses.InvalidInput);this.$hoursDropDown.addClass(this.settings.CssClasses.InvalidInput);this.$minutesDropDown.addClass(this.settings.CssClasses.InvalidInput);setTimeout(function(){b.$datePickerInput.removeClass(b.settings.CssClasses.InvalidInput);
b.$hoursDropDown.removeClass(b.settings.CssClasses.InvalidInput);b.$minutesDropDown.removeClass(b.settings.CssClasses.InvalidInput)},a)};b.getNumberAsTwoCharString=function(a){a=a.toString();return 1===a.length?"0"+a:a};b.prototype.getHours=function(){return this.getDropDownValue(this.$hoursDropDown)};b.prototype.getMinutes=function(){return this.getDropDownValue(this.$minutesDropDown)};b.prototype.getDropDownValue=function(a){return a?(a=a.val())&&""!==a.toString()?+a:0:0};b.prototype.enable=function(a){this.$datePickerInput.prop("disabled",
!a);this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!a||!this.isDateInputTextValid())};b.prototype.updateDatesToHighLight=function(a,b){this.getDatesToHighlight&&"function"===typeof this.getDatesToHighlight&&(this.datesToHighlight=this.getDatesToHighlight(new Date(a,b-2,25),new Date(a,b,6)))};b.prototype.isDateInputTextValid=function(){var a=void 0;try{a=$.datepicker.parseDate(this.settings.DatePickerOptions.DateFormat,this.$datePickerInput.val())}catch(c){}return void 0!==a&&null!==
a};b.prototype.updateTimePickerState=function(){this.toggleValidationError({isInvalid:!1});this.$hoursDropDown.add(this.$minutesDropDown).prop("disabled",!this.isDateInputTextValid())};b.prototype.setTimePickerStateToCurrentTime=function(a){this.setTime(a.getHours(),a.getMinutes())};b.prototype.updateDependentPicker=function(){this.dependentPickerInstance&&(this.getDateTime()>=this.dateTimeSync.currentServerTime||this.dependentPickerInstance.settings.EnableSelectingDatesInThePast)&&(this.dependentPickerInstance.minDate=
this.getDateTime())};b.prototype.isFocusWithinControl=function(){return this.$datePickerInput.is(":focus")||this.$hoursDropDown.is(":focus")||this.$minutesDropDown.is(":focus")};b.prototype.closePicker=function(){this.$datePickerInput.datepicker("hide")};b.prototype.clearDateAndTime=function(a){this.setTime(this.settings.DefaultHours,this.settings.DefaultMinutes);a||this.$datePickerInput.val("")};b.prototype.getDate=function(){return this.getDateTimePickerState().date};b.prototype.setDate=function(a){this.setDateTime(a)};
return b}();e.DateTimePicker=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.DeadlineState=d;d=function(){function b(a,b){var c=this;this.peerAndSelfAssessmentStateChanged=function(a,b,g){c.emptyDeadlineValidationEnabled=b;c.$closeAfterDeadlineCheckBox.prop("checked",b||c.settings.CloseAfterDeadline).change();c.$closeAfterDeadlineCheckBox.prop("disabled",b);c.customTooltipForCheckbox.setToolTipHtml(b?c.settings.Terms.CloseAfterDeadlineDisabledWarning:"");c.initEmptyDeadlineValidation()};window[a]=
this;this.settings=b;$(function(){c.dateTimePicker=window[c.settings.ClientInstanceNames.DateTimePicker];c.$deadlineSection=$("["+c.settings.SectionDataAttribute+"]");c.$deadlineHeaderText=c.$deadlineSection.find("."+c.settings.HeaderTextClass);c.$closeAfterDeadlineCheckBox=$("#"+c.settings.Controls.CloseAfterDeadlineCheckBox);c.customTooltipForCheckbox=new CCL.ModernCheckbox.CustomTooltipForCheckbox(c.$closeAfterDeadlineCheckBox);if(c.settings.HasDeadlinePassed&&c.settings.PeerAssessmentEnabled)c.enabled=
!1;else{if(c.settings.Events.PeerAndSelfAssessmentStateChanged)$(document).off(c.settings.Events.PeerAndSelfAssessmentStateChanged).on(c.settings.Events.PeerAndSelfAssessmentStateChanged,c.peerAndSelfAssessmentStateChanged);$(c.dateTimePicker).change(function(){c.emptyDeadlineValidationEnabled&&c.dateTimePicker.getDateTimePickerState().isEmpty?c.dateTimePicker.toggleValidationError({isInvalid:!0,errorMessage:b.Terms.SetDeadline,highlightInput:!0}):$(c).trigger("change",c.dateTimePicker.getDateTime())});
c.dateTimePicker&&(c.dateTimePicker.getDatesToHighlight=function(a,b){var g=[];c.settings.WebMethods.GetEventsDateTime&&c.settings.CourseId&&0<c.settings.CourseId&&CCL.CommonFunctions.safeAjax({url:c.settings.WebMethods.GetEventsDateTime,type:"POST",async:!1,data:{startDate:JSON.stringify(a),endDate:JSON.stringify(b),courseId:c.settings.CourseId}}).done(function(a){for(var b=0;b<a.length;b++){var d=a[b],e={};e.Date=c.convertStringToDate(d.Date);e.CssClass=d.CssClass;g.push(e)}});return g},$(c.dateTimePicker).on("change",
function(){c.settings.Events.DeadlineStateChanged&&$(document).trigger(c.settings.Events.DeadlineStateChanged)}))}})}b.prototype.getState=function(){return{CloseAfterDeadline:this.settings.UseCloseAfterDeadline?this.$closeAfterDeadlineCheckBox.is(":checked"):!1,DateTime:this.dateTimePicker.getStringValue()}};b.prototype.isSet=function(){return this.dateTimePicker.getDateTimePickerState().isValid&&!this.dateTimePicker.getDateTimePickerState().isEmpty};b.prototype.getDateTime=function(){return this.dateTimePicker.getDateTime()};
b.prototype.mandatory=function(a){this.$deadlineHeaderText.toggleClass(this.settings.CssClasses.Mandatory,a)};b.prototype.convertStringToDate=function(a){a=a.split(".");return new Date(+a[2],+a[1]-1,+a[0],+a[3],+a[4])};Object.defineProperty(b.prototype,"enabled",{set:function(a){this.$closeAfterDeadlineCheckBox.prop("disabled",!a);this.dateTimePicker.enable(a)},enumerable:!0,configurable:!0});b.prototype.initEmptyDeadlineValidation=function(){this.emptyDeadlineValidationEnabled||this.dateTimePicker.toggleValidationError({isInvalid:!1})};
return b}();e.Deadline=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){d.invalidDateAllowEmpty=function(b,a){return e.ValidatorFactory.checkToggle(function(){return!b.isDateValidOrEmpty},b,a)};d.invalidDateDenyEmpty=function(b,a){return e.ValidatorFactory.checkToggle(function(){return void 0===b.getDateTime()},b,a)};d.invalidDateAllowEmptyNoHighlight=function(b,a,c){return e.ValidatorFactory.checkNoHighlight(b,function(){return!b.isDateValidOrEmpty},a,c)};d.invalidDateDenyEmptyNoHighlight=function(b,a,c){return e.ValidatorFactory.checkNoHighlight(b,
function(){return void 0===b.getDateTime()},a,c)};d.compareDates=function(b,a,c,g){return e.ValidatorFactory.checkToggle(function(){return b(a.getDateTime(),c)},a,g)}})(e.DateTimePickerValidatorFactory||(e.DateTimePickerValidatorFactory={}))})(e.Validation||(e.Validation={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){function b(a,b,g){g&&b.isInvalid&&g();a.toggleValidationError(b);return!b.isInvalid}d.lessThanOrEqual=function(a,b){return a<=b};d.all=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return function(){return 0===a.filter(function(a){return!a()}).length}};d.until=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return function(){return a.every(function(a){return a()})}};d.checkToggle=function(a,c,g){return function(){return b(c,
{isInvalid:a(),errorMessage:g,highlightInput:!0},void 0)}};d.checkNoHighlight=function(a,c,g,d){return function(){return b(a,{isInvalid:c(),errorMessage:g,highlightInput:!1},d)}}})(e.ValidatorFactory||(e.ValidatorFactory={}))})(e.Validation||(e.Validation={}))})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.contentMaxHeight=250;this.settings=b;window[a]=this;this.$mainContainer=$("."+b.ContainerCssClass);this.$showMore=$("#"+b.ShowMoreClientId);this.$showLess=$("#"+b.ShowLessClientId);this.showLess(!0)}b.prototype.showMore=function(){var a=this;this.$showMore.hide();this.expandMainContainer();var b=this.$mainContainer.height();this.$mainContainer.css("height",this.contentMaxHeight).css("overflow","hidden").animate({height:b},
function(){a.expandMainContainer();b>a.contentMaxHeight&&a.$showLess.show()})};b.prototype.showLess=function(a){var b=this;this.$showLess.hide();this.expandMainContainer();this.$mainContainer.height()<=this.contentMaxHeight||this.$mainContainer.css("overflow","hidden").animate({height:this.contentMaxHeight},a?0:400,function(){b.$mainContainer.css("position","relative");b.$showMore.show();b.$mainContainer.find(":tabbable:visible").on("focus",function(a){b.showMoreWhenOutOfView(a)})})};b.prototype.showMoreWhenOutOfView=
function(a){a=$(a.currentTarget).offset().top;var b=this.$mainContainer.offset().top+this.contentMaxHeight-this.$showMore.height();a>b&&(this.showMore(),this.$mainContainer.find(":tabbable:visible").off("focus"))};b.prototype.expandMainContainer=function(){this.$mainContainer.css("height","").css("overflow","").css("position","")};return b}();e.ShowMoreLessLinks=d})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){(function(d){var b=function(){function a(a,b){var c=this;this.controls=a;this.settings=b;this.eventDialog=window[this.settings.ClientInstanceNames.EventDialog];this.currentDatePeriod=this.settings.DatePeriod;this.ajaxClient=new d.AgendaAjaxClient(this.settings.WebMethods,this.settings.WidgetSettings);this.utility=new d.AgendaUtility(this.settings.DataAttributes,this.controls);this.eventPreview=new d.AgendaEventPreview(this.settings.ClientInstanceNames.EventDialog,
a.EventDialog,b.WebMethods.GetEventDetails,b.WebMethods.DeleteEvent,b.WidgetSettings,b.Terms);this.setupEventItemClick();this.setupHideTaskItemClick();this.controls.DayViewLink.add(this.controls.WeekViewLink).click(function(a){return c.changeDatePeriod(c.utility.getExpectedDatePeriod(a.currentTarget))});this.contentBlockExpander=new CCL.ContentBlockExpander(this.controls.Container,{maxHeight:this.settings.ExpanderMaxPixelHeight,collapseHeight:this.settings.ExpanderCollapsePixelHeight,lang:{showLess:this.settings.Terms.ShowLess,
showMore:this.settings.Terms.ShowMore}});$(function(){c.datePeriodSelector=window[c.settings.ClientInstanceNames.DatePeriodSelector];$(c.datePeriodSelector).on(f.Controls.DatePeriodSelector.periodChangedEventName,function(a,b){return c.loadAgenda(c.ajaxClient.createGetAgendaDayListContainerAjaxRequest(b.startDate,b.endDate,c.currentDatePeriod))})})}a.prototype.afterUpdateWidget=function(){this.contentBlockExpander.reRenderShowMoreLink()};a.prototype.clearEventDialogContent=function(){this.eventPreview.resetDialog()};
a.prototype.changeDatePeriod=function(a){this.currentDatePeriod!==a&&(this.currentDatePeriod=a,this.controls.DayViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,this.currentDatePeriod===f.Controls.DatePeriod.Day),this.controls.WeekViewLink.toggleClass(this.settings.CssClasses.TogglerItemActive,this.currentDatePeriod===f.Controls.DatePeriod.Week),this.datePeriodSelector.toggleWeekDayMode(this.currentDatePeriod,this.currentDatePeriod===f.Controls.DatePeriod.Week?this.settings.FirstDayOfTheWeek:
this.settings.Today))};a.prototype.setupEventItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.EventTimeRangeLink),function(b){b=$(b.currentTarget);b.getIfHyperLinkEnabled()&&(b=b.closest("."+a.settings.CssClasses.EventItemContainer),a.eventPreview.open(a.utility.getEventId(b),a.utility.getEventTitle(b),a.utility.getEventCategory(b),a.utility.getEventUrl(b),a.utility.getEventColorSchema(b),a.utility.getEventUrlTarget(b),
a.utility.getEditEventUrl(b),a.utility.getEditRecurringEventUrl(b)))})};a.prototype.setupHideTaskItemClick=function(){var a=this;this.controls.Container.on("click",CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.TaskHideId),function(b){return a.loadAgenda(a.ajaxClient.createHideTaskAjaxRequest(a.utility.getTaskHideId($(b.currentTarget)),a.datePeriodSelector.getStartDate(),a.datePeriodSelector.getEndDate(),a.currentDatePeriod))})};a.prototype.loadAgenda=function(a){var b=this;this.currentLoadingSession&&
this.currentLoadingSession.abort&&this.currentLoadingSession.abort();this.controls.AjaxLoadingWheel.show();this.controls.DayListContainer.empty().hide();this.contentBlockExpander.reRenderShowMoreLink();this.currentLoadingSession=a();this.currentLoadingSession.done(function(a){return b.controls.DayListContainer.append(a.html).show()}).always(function(){b.controls.AjaxLoadingWheel.hide();b.contentBlockExpander.renderShowMoreLinkIfNeed(!1);b.currentLoadingSession=void 0})};return a}();d.AgendaContentBlock=
b})(e.Agenda||(e.Agenda={}))})(e.Widgets||(e.Widgets={}))})(f.Dashboard||(f.Dashboard={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.controls=b;this.settings=a;this.selectors={elementLinkItem:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkItemId),listItemFocusedArea:"."+this.settings.CssClasses.ListItemFocusedArea,elementLinkFolderActionExpand:CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderActionExpand)}}d.prototype.isListItemFocusedArea=function(b){return b.is(this.selectors.listItemFocusedArea)};d.prototype.closestListItemFocusedArea=
function(b){return b.closest(this.selectors.listItemFocusedArea)};d.prototype.closestElementItem=function(b){return b.closest(this.selectors.elementLinkItem)};d.prototype.getElementId=function(b){return b.data(this.settings.DataAttributes.ElementLinkItemId)};d.prototype.getCheckbox=function(b){return $("#"+this.settings.ElementItemPrefix+b)};return d}();e.Utility=f})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.ElementLinkDialog||(f.ElementLinkDialog={});f=f.ElementsPopupOpener||(f.ElementsPopupOpener={});f[f.None=0]="None";f[f.Plan=1]="Plan";f[f.WorkingPortfolioTask=2]="WorkingPortfolioTask";f[f.WorkingPortfolioPersonalizedTask=3]="WorkingPortfolioPersonalizedTask";f[f.CalendarEvent=4]="CalendarEvent";f[f.LearningPath=5]="LearningPath"})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.controls=b;this.settings=a;this.getParticipantCheckBox=function(a){return $("#"+c.settings.ControlIds.DialogPersonItemCheckBoxPrefix+a)};this.getGroupCheckBox=function(a){return $("#"+c.settings.ControlIds.DialogGroupItemCheckBoxPrefix+a)}}d.prototype.getItemId=function(b){return b.data(this.settings.DataAttributes.ItemId)};d.prototype.getItemType=function(b){return b.data(this.settings.DataAttributes.ItemType)};d.prototype.getSelectedItemMarkup=
function(b){return b.data(this.settings.DataAttributes.SelectedItemMarkup)};d.prototype.findLoadMoreItemsPointer=function(b){return b.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LoadMoreItems))};d.prototype.getVirtualCount=function(b){return b.data(this.settings.DataAttributes.VirtualCount)};d.prototype.findListItems=function(b){return b.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};d.prototype.findSelectedItems=function(b){return this.controls.SelectedList.children("undefined"===
typeof b?CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId):CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemType,b))};d.prototype.closestListItem=function(b){return b.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};d.prototype.closestSelectedItem=function(b){return b.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId))};return d}();e.Utility=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker=
{}))})(ItslearningWeb||(ItslearningWeb={}));(function(f){(function(e){var k=function(d){function b(a){d.call(this,a.controls.RadioButtonGroup,[[e.ItemType.Participant,a.controls.ParticipantsRadioButton],[e.ItemType.Group,a.controls.GroupsRadioButton]])}__extends(b,d);return b}(f.OptionRadioButton.OptionRadioButtonManagerBase);e.OptionRadioButtonManager=k})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,b){this.utility=d;this.itemType=b;this.checkboxStateManager=new e.CheckboxStateManager;this.markupBuilder=new e.MarkupBuilder(this.utility,b);switch(b){case e.ItemType.Participant:this.itemList=this.utility.controls.ParticipantList;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoParticipantsFound,noItemsInCourse:this.utility.settings.Terms.NoParticipantsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForParticipants};
this.getCheckbox=this.utility.getParticipantCheckBox;break;case e.ItemType.Group:this.itemList=this.utility.controls.GroupList;this.terms={noItemsMeetSearchCriteria:this.utility.settings.Terms.NoGroupsFound,noItemsInCourse:this.utility.settings.Terms.NoGroupsInCourse,searchPlaceholder:this.utility.settings.Terms.SearchForGroups};this.getCheckbox=this.utility.getGroupCheckBox;break;default:throw Error("Unknown ItemType "+b);}}}();e.DialogItemModeDependentObjects=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.utility=b;this.itemType=a;this.cache=new Map}d.prototype.putMarkupFromSelectedItems=function(){var b=this;this.utility.findSelectedItems(this.itemType).each(function(a,c){return b.cache.set(b.utility.getItemId($(c)),c.outerHTML)})};d.prototype.putMarkupFromToggledItem=function(b){this.cache.set(this.utility.getItemId(b),this.utility.getSelectedItemMarkup(b))};d.prototype.buildMarkup=function(b){var a=this;return b.map(function(b){return a.cache.get(b)}).join("")};
return d}();e.MarkupBuilder=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(){this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.committedStateMap=new Map;this.pendingStateMap=new Map;this.ignoreCheckboxEvents=!1}d.prototype.setInitiallySelectedItemIds=function(b){for(var a=0;a<b.length;a++)this.committedStateMap.set(b[a],f.CheckboxStateMachine.State.Saved)};d.prototype.getSelectedItemIds=function(){var b=this,a=[];this.committedStateMap.forEach(function(c,g){b.isStateChecked(c)&&a.push(g)});return a};d.prototype.isItemPendingChecked=
function(b){return this.isStateChecked(this.pendingStateMap.get(b)||f.CheckboxStateMachine.State.Empty)};d.prototype.initializePendingStateMap=function(){this.pendingStateMap=f.MapUtils.makeCopy(this.committedStateMap)};d.prototype.commitPendingStateMap=function(){this.committedStateMap=f.MapUtils.makeCopy(this.pendingStateMap)};d.prototype.withIgnoreCheckboxEvents=function(b){this.ignoreCheckboxEvents=!0;try{b()}finally{this.ignoreCheckboxEvents=!1}};d.prototype.transferPendingState=function(b){var a=
b.itemId;b=b.isChecked;if(!this.ignoreCheckboxEvents){var c=this.pendingStateMap.get(a)||f.CheckboxStateMachine.State.Empty;b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(b,c);this.pendingStateMap.set(a,b)}};d.prototype.transferCommittedStateToUnchecked=function(b){var a=this.committedStateMap.get(b);a=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,a);this.committedStateMap.set(b,a)};d.prototype.isStateChecked=function(b){return b===f.CheckboxStateMachine.State.Saved||
b===f.CheckboxStateMachine.State.AttachedByUser};return d}();e.CheckboxStateManager=k})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.controls=b;this.settings=a;this.searchTimeoutMilliseconds=1E3;this.pageIndex=0;this.searchDebouncer=new CCL.CallbackDebouncer(function(){return c.search()});this.isSelectedListCollapsed=!0;this.onCheckboxStateChanged=function(a){a=$(a.currentTarget);var b=c.utility.closestListItem(a),g=c.utility.getItemId(b);c.currentObjects.checkboxStateManager.transferPendingState({itemId:g,isChecked:a.is(":checked")});c.currentObjects.markupBuilder.putMarkupFromToggledItem(b)};
this.onClickingListItem=function(a){var b=$(a.currentTarget);0<b.find("label").find($(a.target)).length||c.optionRadioManager.isSelected(e.ItemType.Participant)&&b.children("a").get(0).contains(a.target)||c.toggleOptionCheckBox(c.utility.getItemId(b),function(a){return!a})};this.onWithdrawItem=function(a){a.preventDefault();var b=c.utility.closestSelectedItem($(a.currentTarget));a=c.utility.getItemId(b);var g=c.utility.getItemType(b);b.remove();b=g===e.ItemType.Participant?c.personObjects.checkboxStateManager:
c.groupObjects.checkboxStateManager;c.uncheckCheckbox(a,b);b.transferCommittedStateToUnchecked(a);c.updatePickerResultHidden();c.updateCollapserWhenNumberOfSelectedItemsChanged();c.setSelectedItemSectionVisibility()};this.utility=new e.Utility(b,a);this.modalDialog=window[this.settings.ClientInstanceNames.Dialog];this.personObjects=new e.DialogItemModeDependentObjects(this.utility,e.ItemType.Participant);this.groupObjects=new e.DialogItemModeDependentObjects(this.utility,e.ItemType.Group);this.currentObjects=
this.settings.InitialItemType===e.ItemType.Group?this.groupObjects:this.personObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups();this.optionRadioManager=new e.OptionRadioButtonManager(this.utility);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.setupOkButtonClickHandler();this.controls.ShowMoreSelectedItemsLink.click(function(a){a.preventDefault();c.toggleCollapser()});this.controls.ChangeLink.click(function(a){c.openDialog();c.personObjects.checkboxStateManager.initializePendingStateMap();
c.groupObjects.checkboxStateManager.initializePendingStateMap();c.updateCheckboxes();a.preventDefault()});b=this.controls.ParticipantList.add(this.controls.GroupList);b.on((g={},g.change=this.onCheckboxStateChanged,g),"input:checkbox");b.on("click","li",this.onClickingListItem);this.controls.SelectedList.on("click","."+this.settings.CssClasses.WithdrawLink,this.onWithdrawItem);this.setupLoadMoreOnScroll();this.setupRadioButtonChangeHandler();this.setupSearch();this.personObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedParticipantIds);
this.groupObjects.checkboxStateManager.setInitiallySelectedItemIds(this.settings.InitiallySelectedGroupIds);this.personObjects.markupBuilder.putMarkupFromSelectedItems();this.groupObjects.markupBuilder.putMarkupFromSelectedItems();this.updatePickerResultHidden();this.controls.DialogContent.keypress(function(a){a.which!==CCL.CommonConstants.keyCodes.enter||c.controls.OkButton.is(":focus")||a.preventDefault()});var g}d.prototype.setupLoadMoreOnScroll=function(){var b=this;this.controls.DialogContent.on((this.isIosDevice?
"touchmove":"")+" scroll",function(){var a=b.currentObjects.itemList,c;!b.isLoadingInProgress&&0<b.utility.findLoadMoreItemsPointer(a).length&&CCL.CommonFunctions.isOnScreen((c=b.utility.findListItems(a)).eq(Math.max(0,c.length-3)),.1,.1,b.isIosDevice?window.parent:window)&&b.loadMoreItems()})};d.prototype.setupRadioButtonChangeHandler=function(){var b=this;this.optionRadioManager.addOnChangeHandler(function(){b.switchCurrentObjects();b.search()})};d.prototype.setupSearch=function(){var b=this;this.controls.SearchTextBox.on("input",
function(a){""===b.controls.SearchTextBox.val()?b.search():b.searchDebouncer.invokeCallback(void 0,b.searchTimeoutMilliseconds);a.preventDefault()})};d.prototype.search=function(){this.pageIndex=0;this.loadMoreItems({cleanExistingEntries:!0})};d.prototype.loadMoreItems=function(b){var a=this;b=(void 0===b?{}:b).cleanExistingEntries;var c=this.currentObjects.itemList;this.isLoadingInProgress=!0;if(void 0===b?0:b)c.empty(),this.controls.NoItemsFoundPanel.hide(),this.controls.AjaxLoader.show();this.itemsRequest&&
this.itemsRequest.abort&&this.itemsRequest.abort();this.itemsRequest=this.searchOrLoadMore();this.itemsRequest.done(function(b){a.utility.findLoadMoreItemsPointer(c).remove();c.append(b);var g=a.utility.findLoadMoreItemsPointer(c);b=a.utility.findListItems(c).length;var d=0!==b;g=0<g.length?a.utility.getVirtualCount(g):b;a.controls.PageInfo.toggle(d).text(CCL.CommonFunctions.formatString(a.settings.Terms.ShowingXofYLabelFormat,b,g));c.toggle(d);d||a.controls.NoItemsFoundPanel.text(""===a.controls.SearchTextBox.val()?
a.currentObjects.terms.noItemsInCourse:a.currentObjects.terms.noItemsMeetSearchCriteria);a.controls.NoItemsFoundPanel.toggle(!d);a.pageIndex++;a.updateCheckboxes()}).always(function(){a.itemsRequest=void 0;a.isLoadingInProgress=!1;a.controls.AjaxLoader.hide()})};d.prototype.setupOkButtonClickHandler=function(){var b=this;this.controls.OkButton.click(function(a){b.applySelectedItems();CssModal.closeDialog();a.preventDefault()})};d.prototype.applySelectedItems=function(){this.personObjects.checkboxStateManager.commitPendingStateMap();
this.groupObjects.checkboxStateManager.commitPendingStateMap();this.updatePickerResultHidden();this.controls.SelectedList.empty().append(this.personObjects.markupBuilder.buildMarkup(this.personObjects.checkboxStateManager.getSelectedItemIds())).append(this.groupObjects.markupBuilder.buildMarkup(this.groupObjects.checkboxStateManager.getSelectedItemIds()));this.updateCollapserWhenNumberOfSelectedItemsChanged();this.setSelectedItemSectionVisibility()};d.prototype.updateCollapserWhenNumberOfSelectedItemsChanged=
function(){this.updateToggleSelectedItemsCountLinkText();this.controls.ShowMoreSelectedItemsLinkContainer.toggle(this.utility.findSelectedItems().length>this.settings.NumberOfSelectedItemsToDisplayInCollapsedMode)};d.prototype.toggleCollapser=function(){this.isSelectedListCollapsed=!this.isSelectedListCollapsed;this.controls.SelectedList.toggleClass(this.settings.CssClasses.SelectedListCollapsed,this.isSelectedListCollapsed);this.updateToggleSelectedItemsCountLinkText()};d.prototype.updateToggleSelectedItemsCountLinkText=
function(){this.controls.ShowMoreSelectedItemsLink.text(this.isSelectedListCollapsed?CCL.CommonFunctions.formatString(this.settings.Terms.ShowAllFormat,this.utility.findSelectedItems().length):this.settings.Terms.Hide)};d.prototype.updateCheckboxes=function(){var b=this;this.currentObjects.checkboxStateManager.withIgnoreCheckboxEvents(function(){b.utility.findListItems(b.currentObjects.itemList).each(function(a,c){a=$(c);c=b.utility.getItemId(a);b.toggleOptionCheckBox(c,b.currentObjects.checkboxStateManager.isItemPendingChecked(c));
b.currentObjects.markupBuilder.putMarkupFromToggledItem(a)})})};d.prototype.setSelectedItemSectionVisibility=function(){var b=0<this.utility.findSelectedItems().length;this.controls.SelectedListContainer.toggle(b);this.controls.NoOneIsChosenLabel.toggle(!b)};d.prototype.openDialog=function(){this.controls.SearchTextBox.focus();this.modalDialog.openDialog(!1);this.controls.SearchTextBox.val("");this.search()};d.prototype.searchOrLoadMore=function(){var b={ElementOrParentFolderId:this.settings.ElementOrParentFolderId,
PageIndex:this.pageIndex,Search:this.controls.SearchTextBox.val(),IsGroups:this.optionRadioManager.isSelected(e.ItemType.Group)};return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetParticipantOrGroupListContent,data:b,dataType:"html"})};d.prototype.sortSelectedList=function(){var b=this;this.utility.findSelectedItems().get().sort(function(a,c){var g=b.settings.IsParticipantListSortOrderAscending?c:a,d="data-"+b.settings.DataAttributes.SelectedItemSortExpression;return $(b.settings.IsParticipantListSortOrderAscending?
a:c).attr(d).localeCompare($(g).attr(d))}).forEach(function(a){b.controls.SelectedList.append(a)})};d.prototype.uncheckCheckbox=function(b,a){var c=this;a.withIgnoreCheckboxEvents(function(){c.toggleOptionCheckBox(b,!1)})};d.prototype.updatePickerResultHidden=function(){var b={ParticipantIds:this.personObjects.checkboxStateManager.getSelectedItemIds(),GroupIds:this.groupObjects.checkboxStateManager.getSelectedItemIds()};this.controls.PickerResultHidden.val(JSON.stringify(b))};d.prototype.toggleOptionCheckBox=
function(b,a){if(b=this.currentObjects.getCheckbox(b))a="boolean"===typeof a?a:a(b.is(":checked")),b.is(":checked")!==a&&(b.prop("checked",a),b.trigger("change"))};d.prototype.switchCurrentObjects=function(){this.currentObjects=this.optionRadioManager.isSelected(e.ItemType.Participant)?this.personObjects:this.groupObjects;this.updateUiAfterSwitchBetweenParticipantsAndGroups()};d.prototype.updateUiAfterSwitchBetweenParticipantsAndGroups=function(){this.utility.controls.ParticipantList.toggle(this.currentObjects.itemType===
e.ItemType.Participant);this.utility.controls.GroupList.toggle(this.currentObjects.itemType===e.ItemType.Group);this.utility.controls.SearchTextBox.prop("placeholder",this.currentObjects.terms.searchPlaceholder)};return d}();e.PickerManager=f})(f.ElementParticipantPicker||(f.ElementParticipantPicker={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.settings=b;this.addCourseWindow=$("."+this.settings.CssClasses.Window);this.addCourseForm=this.addCourseWindow.find("form");this.scrollable=this.addCourseForm.find("."+this.settings.CssClasses.ScrollDiv);this.titleInput=$("#"+this.settings.ControlIds.CourseTitle);this.titleError=$("."+this.settings.CssClasses.Title.Error);this.courseIcon=$("."+this.settings.CssClasses.CourseIcon);this.colorPicker=$("#"+this.settings.ControlIds.ColorPicker);
this.colorPickerHover=this.colorPicker.next();this.codeInput=$("."+this.settings.CssClasses.Code);this.buttons=$("."+this.settings.CssClasses.Buttons);this.buttonSubmit=$("#"+this.settings.ControlIds.CreateCourseButton);this.buttonCancel=$("#"+this.settings.ControlIds.CancelButton);this.advancedOptionsToggler=$("."+this.settings.CssClasses.Advanced.Toggler);this.advancedOptionsContent=$("."+this.settings.CssClasses.Advanced.Content);this.advancedOptionsLanguage=this.advancedOptionsToggler.data("lang");
this.advancedOptionsShow=!1;this.advancedOptionsTemplates=$("."+this.settings.CssClasses.Advanced.Templates);this.courseType=$(this.settings.ControlIds.CourseType);this.courseTemplateHolder=$("."+this.settings.CssClasses.Advanced.TemplatesHolder);this.courseTemplateLink=$("."+this.settings.CssClasses.Advanced.TemplateLink);this.courseTemplatesIframe=$("."+this.settings.CssClasses.Advanced.TemplatesIframe);this.radioButtonLabel=$("."+this.settings.CssClasses.RadioButtonLabel);this.modalMask=$("."+
this.settings.CssClasses.ModalMask);this.setupControls();this.setupControlsEvents()}d.prototype.setupControls=function(){this.courseTemplateHolder.hide();this.changeColor();this.scrollable.perfectScrollbar({suppressScrollX:!0});this.titleInput.focus();this.advancedOptionsTemplates.hide()};d.prototype.setupControlsEvents=function(){var b=this;this.courseTemplatesIframe.load(function(){b.advancedOptionsTemplates.is(":visible")?(b.scrollable.scrollTop(1E3).perfectScrollbar("update"),b.courseTemplatesIframe.contents().find("#"+
b.settings.ControlIds.TemplateSearchTextBox).focus()):b.titleInput.focus()});this.advancedOptionsToggler.on("click touch",function(a){b.advancedOptionsShow=!b.advancedOptionsShow;b.advancedOptionsToggler.toggleClass(b.settings.CssClasses.Advanced.TogglerOpen);b.buttons.toggleClass(b.settings.CssClasses.ButtonsShadow);b.advancedOptionsContent.toggle();b.advancedOptionsToggler.text(b.advancedOptionsShow?b.advancedOptionsLanguage.hide:b.advancedOptionsLanguage.show);b.scrollable.animate({scrollTop:b.advancedOptionsShow?
b.advancedOptionsToggler.offset().top:0},250);a.preventDefault();return!1});this.colorPickerHover.change(function(){b.changeColor()});this.courseType.change(function(){var a=b.courseType.get();b.advancedOptionsTemplates.hide();b.courseTemplateHolder.hide();1>=a.length||(a[0].checked?($("."+b.settings.CssClasses.TemplateId).val("null"),$("."+b.settings.CssClasses.TemplateType).val("0"),b.scrollable.perfectScrollbar("update")):(b.courseTemplatesIframe.attr("src",a[1].checked?b.settings.Urls.FindCourseTemplates:
b.settings.Urls.FindPlannerTemplates),b.fecthTemplates(),b.scrollable.scrollTop(1E3).perfectScrollbar("update"),b.courseTemplatesIframe.contents().find("#"+b.settings.ControlIds.TemplateSearchTextBox).focus()),b.buttonSubmit.trigger("buttonSubmitDisable"))});this.titleInput.on("input",function(){var a=0===b.titleInput.val().trim().length;b.titleError.css({display:a?"block":"none"});b.titleError.next().css({"margin-top":a?"0px":"","margin-bottom":a?"0px":""});b.buttonSubmit.trigger("buttonSubmitDisable")});
this.buttonSubmit.on("buttonSubmitDisable",function(){var a=b.isTitleEmpty()||!b.isCourseTypeRegular()&&!b.isTemplateSelected();b.buttonSubmit.prop("disabled",a)});this.buttonCancel.on("keydown",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.tab)return b.titleInput.focus(),a.preventDefault(),!1});this.radioButtonLabel.on("keydown",function(a){if(a.keyCode===CCL.CommonConstants.keyCodes.enter)return $(a.target).click(),a.preventDefault(),!1});this.buttonCancel.on("click touch",function(){b.addCourseWindow.remove();
b.modalMask.remove()});this.modalMask.on("click touch",function(){b.addCourseWindow.remove();b.modalMask.remove()});this.courseTemplateHolder.on("click touch","."+this.settings.CssClasses.Advanced.TemplateLink,function(){b.courseTemplateHolder.hide();b.fecthTemplates()});this.addCourseWindow.on("invalid-form.validate","form",function(){var a=$(this).find('input[type="submit"]');setTimeout(function(){a.removeAttr("disabled")},1)});this.addCourseForm.on("submit",function(a){for(var c={},g=0,d=$(b.addCourseForm).serializeArray();g<
d.length;g++){var e=d[g],f=e.name;c.hasOwnProperty(f)||(c[f]=e.value)}CCL.CommonFunctions.safeAjaxPost({url:b.settings.Urls.CreateCourse,data:c}).done(function(a){window.location.href=a});a.preventDefault()});this.addCourseWindow.on("submit","form",function(a){var b=$(this).find('input[type="submit"]');setTimeout(function(){b.attr("disabled","disabled")},0)})};d.prototype.isTitleEmpty=function(){return 0===this.titleInput.val().trim().length};d.prototype.isCourseTypeRegular=function(){return this.courseType.get()[0].checked};
d.prototype.isTemplateSelected=function(){return 0<$("."+this.settings.CssClasses.TemplateId).val().length};d.prototype.changeColor=function(){this.currentColor&&this.courseIcon.removeClass(this.currentColor);this.currentColor=this.colorPickerHover[0].classList[0];this.courseIcon.addClass(this.currentColor)};d.prototype.fecthTemplates=function(){var b=this;window.parent.selectCourseTemplate=function(a,c){void 0===c&&(c=!1);c=c?b.settings.TemplateFromPlanner:b.settings.TemplateFromCourse;$("."+b.settings.CssClasses.TemplateId).val(a.toString());
$("."+b.settings.CssClasses.TemplateType).val(c.toString());b.advancedOptionsTemplates.hide();b.buttonSubmit.trigger("buttonSubmitDisable");CCL.CommonFunctions.safeAjaxPost({url:b.settings.Urls.SetTemplate,cache:!1,data:{templateId:a,templateType:c}}).done(function(a){b.courseTemplateHolder.html(a);b.courseTemplateHolder.show();b.scrollable.perfectScrollbar("update")});delete window.parent.selectCourseTemplate};this.advancedOptionsTemplates.show()};return d}();e.AddCourse=f})(f.Courses||(f.Courses=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;e.enrolInCoursesInstance=this;this.coursesTableSelector=b.CoursesTableSelector;this.checkboxColumnSelector=b.CheckboxColumnSelector;this.alertMessageText=b.AlertMessageText;$(b.ToolbarSelector+" a").click(function(b){return a.checkBeforeEnrolWithdraw(b)})}d.prototype.isAnyCourseSelected=function(){return 0<$(this.coursesTableSelector+" "+this.checkboxColumnSelector+" input:checked").length};d.prototype.checkBeforeEnrolWithdraw=function(b){if(!this.isAnyCourseSelected())return b.preventDefault(),
jAlert(this.alertMessageText),!1};return d}();e.EnrolInCourses=f})(f.Courses||(f.Courses={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.isTopicSelected=function(){return parseInt(c.topicPickerInstance.getSelectedItem().id,10)>c.settings.NotChosenOptionValue};this.settings=b;this.controls=a;$(function(){c.controls.ShowInPlannerCheckbox.change(function(){var a=c.controls.ShowInPlannerCheckbox.is(":checked");a||(c.topicPickerInstance.closeMenu(),c.planPickerInstance.closeMenu());c.controls.TopicPlanPanel.toggle(a)});c.settings.UseTopics&&(c.planPickerInstance.toggleEnabled(c.isTopicSelected()&&
c.controls.ShowInPlannerCheckbox.is(":enabled")),c.topicPickerInstance.onchange(function(){c.planPickerInstance.toggleEnabled(!1);c.isTopicSelected()||!c.planPickerInstance.hasAnyItems()?(c.topicPickerInstance.toggleEnabled(!1),c.controls.PlanPicker.hide(),c.controls.NoPlansLabel.hide(),c.controls.Loader.show(),$.ajax({type:"GET",url:c.settings.Actions.GetPlansForCourseAndTopic,data:{courseId:c.settings.CourseId,topicId:c.topicPickerInstance.getSelectedItem().id,selectPlanLabel:c.settings.Resources.SelectPlan}}).always(function(){c.controls.Loader.hide();
c.planPickerInstance.toggleEnabled(c.isTopicSelected());c.topicPickerInstance.toggleEnabled(!0)}).done(function(a){var b=1<a.length||!c.isTopicSelected();c.planPickerInstance.loadMenu(a);c.planPickerInstance.selectItem(2===a.length?a[1].id:c.settings.NotChosenOptionValue);c.controls.PlanPicker.toggle(b);c.controls.NoPlansLabel.toggle(!b);c.planPickerInstance.resizeComponent()})):(c.planPickerInstance.selectItem(c.settings.NotChosenOptionValue),c.controls.PlanPicker.show(),c.controls.NoPlansLabel.hide(),
c.planPickerInstance.resizeComponent())}))})}Object.defineProperty(d.prototype,"topicPickerInstance",{get:function(){return"undefined"===typeof this.topicPickerInstanceValue?this.topicPickerInstanceValue=window[this.settings.ClientInstanceNames.Topic]:this.topicPickerInstanceValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"planPickerInstance",{get:function(){return"undefined"===typeof this.planPickerInstanceValue?this.planPickerInstanceValue=window[this.settings.ClientInstanceNames.Plan]:
this.planPickerInstanceValue},enumerable:!0,configurable:!0});return d}();e.ElementPlanPicker=f})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=e.CalendarControllerModels.EventType,b=function(){function a(a){this.utility=a}a.prototype.parseEventType=function(a){if(this.hasEventTypePrefix(this.coursePrefix,a)){var b=d.Course;a=parseInt(a.substring(this.coursePrefix.length),10)}else this.hasEventTypePrefix(this.projectPrefix,a)?(b=d.Project,a=parseInt(a.substring(this.projectPrefix.length),10)):(b=d.Person,a=0);return{eventType:b,locationId:a}};a.prototype.parseCourseId=function(a){var b=this.parseEventType(a);
if(b.eventType!==d.Course)throw Error("Invalid location: expected course, got "+a);return b.locationId};a.prototype.hasEventTypePrefix=function(a,b){return b&&b.startsWith(a)&&b.length>a.length};Object.defineProperty(a.prototype,"coursePrefix",{get:function(){return this.utility.settings.locationPrefixes.courseValuePrefix},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"projectPrefix",{get:function(){return this.utility.settings.locationPrefixes.projectValuePrefix},enumerable:!0,
configurable:!0});return a}();f.EventTypeParser=b})(e.Schedule||(e.Schedule={}))})(f.Calendar||(f.Calendar={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d){var b=this;this.findSectionOrMeasurement=function(a,c){$.getJSON(b.settings.FindSectionOrMeasurementUrl,{search:a.term},function(a){c($.map(a,function(a){return{value:a.Name,isMeasurement:a.IsMeasurement,id:a.Id}}))})};this.renderSearchBoxItem=function(a,b){return $("<li/>").append("<span "+(b.isMeasurement?"":"class='h-fnt-bd'")+">"+b.value+"</span>").appendTo(a)};this.selectSearchBoxItem=function(a,c){b.searchKpiContent(c.item.value,
c.item.id)};this.searchKpiContent=function(a,c){window.location.search="?"+b.settings.SearchStringParamName+"="+a+"&"+b.settings.SearchValueParamName+"="+(c?c:"")};e.measureFilterInstance=this;this.settings=d;this.settings.Controls.SearchBoxContainer.on(this.settings.TextSearchEvent,function(a,c){return b.searchKpiContent(c,null)})}}();e.MeasureFilter=f})(f.FeatureAdoption||(f.FeatureAdoption={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e;(function(d){d[d.Initial=0]="Initial";d[d.Started=1]="Started";d[d.StoppingInProcess=2]="StoppingInProcess";d[d.Stopped=3]="Stopped";d[d.Preview=4]="Preview";d[d.Paused=5]="Paused";d[d.Delete=6]="Delete";d[d.Upload=7]="Upload"})(e||(e={}));var k=function(){function d(b,a){this.timeout=0;this.updateProgressEvent=null;this.currentRecordDuration=0;this.currentState=e.Initial;window[b]=this;this.settings=a;this.eventNames=a.EventNames;this.initialize()}d.prototype.initialize=function(){var b=
this;this.$mainPanel=$("#"+this.settings.MainPanelClientId);this.$startRecordingButton=$("#"+this.settings.StartResumeButtonClientId);this.$stopRecordingButton=$("#"+this.settings.StopButtonClientId);this.$stopRecordingButton.hide();this.$currentTimeLabel=$("#"+this.settings.CurrentTimeLabelClientId);this.$playPausePreviewButton=$("#"+this.settings.PlayRecordButtonClientId);this.$recordingLight=$("#"+this.settings.RecordingLightClientId);this.$progressBar=$("#"+this.settings.ProgressBarClientId);
this.isPreviewSessionStarted=!1;this.recorder=window[this.settings.RecorderClientInstanceName];this.timeout=this.settings.ShouldRecordVideo?this.settings.MaxSecondsVideo:this.settings.MaxSecondsAudio;$(document).on(this.eventNames.RecordingStoppedEventName,function(){if(b.currentState===e.Delete)b.onDeleteRecord();else b.currentState!==e.Initial&&b.currentState!==e.Started&&b.getRecorder().preparePreview()});$(document).on(this.eventNames.PreviewPreparedEventName,function(){b.currentRecordDuration=
b.getRecorder().getDuration();b.currentState!==e.Initial&&b.currentState!==e.Started&&(b.setProgress(0,b.currentRecordDuration,!1),b.getRecorder().supportsSeek()&&(b.$progressBar.on("click",function(a){b.seekInPlayback(a)}),b.$progressBar.css("cursor","pointer")),b.currentState===e.Upload?(b.updateControls(e.Stopped),$(document).trigger(b.eventNames.UploadPreparedEventName)):b.setState(e.Stopped))});$(document).on(this.eventNames.PreviewPreparedFailedEventName,function(){b.onDeleteRecord()});$(document).on(this.eventNames.RecordingPlaybackEndedEventName,
function(){clearTimeout(b.updateProgressEvent);b.setProgress(b.currentRecordDuration,b.currentRecordDuration,!1);b.setState(e.Stopped);b.isPreviewSessionStarted=!1});$(document).on(this.eventNames.HasUserMediaAccessEventName,function(){$(document).trigger(b.eventNames.RecordingStartedEventName);clearTimeout(b.updateProgressEvent);b.updateProgressEvent=setInterval(function(){b.updateProgress(b.timeout,!0)},100);b.setState(e.Started)});$(document).on(this.eventNames.RecordingInteruptedEventName,function(){b.onDeleteRecord();
b.closeRecordingSession()});$(document).on(this.eventNames.SwitchToAudioRecorderEventName,function(){b.settings.ShouldRecordVideo=!1;b.timeout=b.settings.MaxSecondsAudio;b.setProgress(0,b.timeout,!0);b.$mainPanel.removeClass(b.settings.CssMainContainerVideo);b.$mainPanel.addClass(b.settings.CssMainContainerAudio)});$(document).on(this.eventNames.UpdateMaximumRecordingLength,function(a,c){b.timeout=Math.min(c,b.settings.ShouldRecordVideo?b.settings.MaxSecondsVideo:b.settings.MaxSecondsAudio);b.setProgress(0,
b.timeout,!0)});this.setProgress(0,this.timeout,!0);this.setState(e.Initial)};d.prototype.startRecording=function(){var b=this.getRecorder();b&&this.currentState!==e.Started&&b.startRecording()};d.prototype.stopRecording=function(){this.stopRecorderAndUpdateState(e.StoppingInProcess)};d.prototype.deleteRecording=function(){if(this.getRecorder())if(this.currentState===e.Started)this.stopRecorderAndUpdateState(e.Delete);else this.onDeleteRecord()};d.prototype.onDeleteRecord=function(){clearTimeout(this.updateProgressEvent);
var b=this.getRecorder();b&&(this.currentRecordDuration=0,this.setProgress(0,this.timeout,!1),$(document).trigger(this.eventNames.RecordingDeletedEventName),b.deleteRecord(),this.setState(e.Initial))};d.prototype.stopRecorderAndUpdateState=function(b){var a=this.getRecorder();a&&this.currentState===e.Started&&(clearTimeout(this.updateProgressEvent),this.setState(b),a.stopRecording())};d.prototype.closeRecordingSession=function(){try{var b=this.getRecorder();b&&(clearTimeout(this.updateProgressEvent),
b.closeRecordingSession())}catch(a){}};d.prototype.previewRecording=function(){var b=this;this.getRecorder().previewRecord();clearTimeout(this.updateProgressEvent);this.updateProgressEvent=setInterval(function(){b.updateProgress(b.currentRecordDuration,!1)},100);this.isPreviewSessionStarted=!0;this.setState(e.Preview)};d.prototype.pauseResumePreview=function(b){var a=this.getRecorder();a&&(a.pauseResumePreview(b),this.setState(b?e.Paused:e.Preview))};d.prototype.prepareUpload=function(){this.currentState===
e.Started?(this.updateControls(e.StoppingInProcess),this.stopRecorderAndUpdateState(e.Upload)):(this.currentState===e.Preview&&this.pauseResumePreview(!0),$(document).trigger(this.eventNames.UploadPreparedEventName))};d.prototype.uploadRecord=function(b){var a=this.getRecorder();a&&a.uploadRecord(this.settings.UploadProxyUrl,b)};d.prototype.seekInPlayback=function(b){var a=$(b.currentTarget),c=a.offset();b=this.currentRecordDuration*(b.pageX-c.left)/a.width();this.getRecorder().seek(b);this.currentState===
e.Stopped&&this.updateProgress(this.currentRecordDuration,!1)};d.prototype.getRecorder=function(){this.recorder||(this.recorder=window[this.settings.RecorderClientInstanceName]);return this.recorder};d.prototype.setState=function(b){this.currentState=b;this.updateControls(b)};d.prototype.updateControls=function(b){var a=this;switch(b){case e.Initial:this.$stopRecordingButton.removeClass(this.settings.CssStateStopping).hide();this.$startRecordingButton.show();this.$playPausePreviewButton.hide();this.$progressBar.off("click");
this.$progressBar.css("cursor","default");this.$recordingLight.hide();clearTimeout(this.updateProgressEvent);break;case e.Started:this.$stopRecordingButton.on("click",function(){a.stopRecording()});this.$stopRecordingButton.show();this.$startRecordingButton.hide();this.$recordingLight.show().css("display","inline-block");break;case e.Delete:case e.StoppingInProcess:this.$mainPanel.removeClass(this.settings.CssStatePlaying);this.$stopRecordingButton.addClass(this.settings.CssStateStopping);this.$stopRecordingButton.off("click");
this.$recordingLight.hide();break;case e.Stopped:this.$mainPanel.removeClass(this.settings.CssStatePlaying);this.$stopRecordingButton.removeClass(this.settings.CssStateStopping);this.$stopRecordingButton.hide();this.$playPausePreviewButton.show();this.$playPausePreviewButton.attr("title",this.settings.PlayPreviewButtonTooltip);this.$playPausePreviewButton.off("click");this.$playPausePreviewButton.on("click",function(){a.previewRecording()});break;case e.Preview:this.$mainPanel.addClass(this.settings.CssStatePlaying);
this.$playPausePreviewButton.attr("title",this.settings.PausePreviewButtonTooltip);this.$playPausePreviewButton.off("click");this.$playPausePreviewButton.on("click",function(){a.pauseResumePreview(!0)});break;case e.Paused:this.$mainPanel.removeClass(this.settings.CssStatePlaying),this.$playPausePreviewButton.attr("title",this.settings.PlayPreviewButtonTooltip),this.$playPausePreviewButton.off("click"),this.$playPausePreviewButton.on("click",function(){a.pauseResumePreview(!1)})}};d.prototype.updateProgress=
function(b,a){var c=this.getRecorder();c&&(c=c.getCurrentTime())&&this.setProgress(c,b,a)};d.prototype.setProgress=function(b,a,c){c?0>=Math.floor(10*(a-b))?(b=this.convertTime(a),this.stopRecorderAndUpdateState(e.StoppingInProcess)):b=this.convertTime(b):(this.updateProgressBar(b,a),b=this.convertTime(b));b+=" / "+this.convertTime(a);this.$currentTimeLabel.text(b)};d.prototype.convertTime=function(b){b=Math.round(b);var a=Math.floor(b/60);b=Math.floor(b-60*a);return(10<=a?"":"0")+a+":"+((10<=b?"":
"0")+b)};d.prototype.updateProgressBar=function(b,a){var c=$("."+this.settings.CssPlayBar);c&&c.width(100*b/a+"%")};return d}();f.MediaRecorderControl=k})(ItslearningWeb||(ItslearningWeb={}));
(function(f){var e=function(){function e(d,b){this.flashId="FlashRecorder";window[d]=this;this.settings=b;this.eventNames=b.EventNames;this.name=d;this.initialize()}e.prototype.initialize=function(){var d={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",allowfullscreen:"true",wmode:"transparent"},b={id:this.flashId,name:"FlashRecorder",align:"middle",wmode:"transparent"};this.settings.RequestMediaResourcesOnLoad&&(swfobject.embedSWF("flash/FlashRecorder.swf","flashContent",545,220,"11.4.0",
"playerProductInstall.swf",{},d,b,this.flashReady(this)),swfobject.createCSS("#flashContent","display:block;text-align:left;"))};e.prototype.startRecording=function(){this.flash.startRecording()};e.prototype.stopRecording=function(){this.flash.stopRecording(this.eventNames.RecordingStoppedEventName)};e.prototype.preparePreview=function(){raiseEvent(this.eventNames.PreviewPreparedEventName,"","")};e.prototype.pauseResumePreview=function(d){this.flash.pauseResumePlayback(d)};e.prototype.getCurrentTime=
function(){return this.flash.getCurrentTime()};e.prototype.getDuration=function(){return this.flash.getDuration()};e.prototype.previewRecord=function(){this.flash.previewRecord()};e.prototype.deleteRecord=function(){this.flash.resetRecording()};e.prototype.uploadRecord=function(d,b){this.flash.saveRecording(b,d)};e.prototype.flashReady=function(d){var b=this;setTimeout(function(){d.flash=document.getElementById(d.flashId);if(d.flash){var a=$(d.flash).parent().width(),c=$(d.flash).parent().height();
$(d.flash).width(a).height(c);window.top.onresize=function(){var a=$(d.flash).parent().width();$(d.flash).width(a).height(c)};d.flash.init(d.flashId,a,c,d.settings.ShouldRecordVideo,b.eventNames.HasUserMediaAccessEventName,b.eventNames.RecordingPlaybackEndedEventName,b.eventNames.RecordingUploadCompletedEventName,b.name,b.settings.ShouldRecordVideo?b.settings.MaxSecondsVideo:b.settings.MaxSecondsAudio)}else $("."+b.settings.RecorderControlsClassName).hide()},750)};e.prototype.closeRecordingSession=
function(){this.flash.closeRecordingSession()};e.prototype.seek=function(d){this.flash.seek(d)};e.prototype.supportsSeek=function(){return!0};e.prototype.showAccessDenied=function(){window.top.jAlert?window.top.jAlert(this.settings.AccessDeniedErrorMessage,"",null):jAlert(this.settings.AccessDeniedErrorMessage,"",null)};e.prototype.confirmSwitchToAudio=function(){var d=this;this.showConfirmAudioSwitch(this.settings.ChangeToAudioRecorderMessage,function(b){b?(d.settings.ShouldRecordVideo=!1,d.flash.switchToAudio(),
$(document).trigger(d.eventNames.SwitchToAudioRecorderEventName)):$(document).trigger(d.eventNames.SwitchToUploadTabEventName)})};e.prototype.showConfirmAudioSwitch=function(d,b){var a=this.settings.UploadFileButtonText.replace(/(["])/g,"&quot;");window.top.jConfirm?(window.top.$.alerts.cancelButton=a,window.top.jConfirm(d,"",b)):($.alerts.cancelButton=a,jConfirm(d,"",b))};e.prototype.updateMaximumRecordingLength=function(d){$(document).trigger(this.eventNames.UpdateMaximumRecordingLength,d)};return e}();
f.FlashRecorder=e})(ItslearningWeb||(ItslearningWeb={}));function raiseEvent(f,e,k){$(document).trigger(f,[e,k])}function resizeAudioPlayer(f){$("#"+f).width(1).height(1)}function showAccessDenied(f){window[f].showAccessDenied()}function confirmSwitchToAudio(f){window[f].confirmSwitchToAudio()}function updateMaximumRecordingLength(f,e){window[f].updateMaximumRecordingLength(e)}
(function(f){(function(e){(function(e){e[e.SingleFile=1]="SingleFile";e[e.MultipleFiles=2]="MultipleFiles";e[e.MultipleFilesAndFolders=3]="MultipleFilesAndFolders"})(e.UploadType||(e.UploadType={}));(function(e){e[e.Pending=1]="Pending";e[e.InProgress=2]="InProgress";e[e.Success=3]="Success";e[e.Error=4]="Error";e[e.PartialSuccess=5]="PartialSuccess"})(e.UploadStatus||(e.UploadStatus={}))})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,b,a){var c=this;this.settings=d;this.summaryParser=b;this.feedbackManager=a;this.handleInitialUploadSummary=function(a){a.IsProcessingInProgress?(c.feedbackManager.showInformationFeedback(c.settings.uploadInProgressMessage),c.wasPollingStarted=!0,c.checkStatusAfterInterval()):c.handleUploadsFinished(a)};this.checkStatusAfterInterval=function(){setTimeout(c.checkUploadStatus,c.settings.pollingIntervalInMilliseconds)};this.checkUploadStatus=
function(){$.getJSON(c.settings.statusServiceUrl,{folderId:c.settings.folderId}).then(c.handleSubsequentUploadSummary).fail(c.handleErrorResponse)};this.handleSubsequentUploadSummary=function(a){a.IsProcessingInProgress?c.checkStatusAfterInterval():c.handleUploadsFinished(a)};this.handleUploadsFinished=function(a){c.feedbackManager.hideInformationFeedback();c.summaryParser.isThereOnlyOneSingleFileUpload(a)?c.handleOneSingleFileUploadFinished(a):c.summaryParser.areThereAnyUploadsToHandle(a)&&c.handleManyFileUploadsFinished(a)};
this.handleOneSingleFileUploadFinished=function(a){c.summaryParser.areAllUploadsFinishedWithSuccess(a)?(a=c.summaryParser.getFileNamesForSingleFileUploads(a)[0],a=CCL.CommonFunctions.htmlEncode(a),a=c.settings.singleFileXUploadSuccessMessage.replace("{0}","<strong>"+a+"</strong>"),c.feedbackManager.showInformationFeedback(a),c.refreshTreeMenuIfNeeded()):c.feedbackManager.showErrorFeedback(c.settings.singleFileUploadErrorMessage)};this.handleManyFileUploadsFinished=function(a){c.summaryParser.areAllUploadsFinishedWithSuccess(a)?
c.displayMessageWithRefreshInstructionsIfNeeded(c.settings.multipleFileUploadSuccessMessage):c.summaryParser.areUploadsFinishedWithPartialSuccess(a)?c.displayMessageWithRefreshInstructionsIfNeeded(c.settings.partialSuccessMessage):c.feedbackManager.showErrorFeedback(c.settings.multipleFileUploadErrorMessage)};this.displayMessageWithRefreshInstructionsIfNeeded=function(a){c.shouldDisplayRefreshButton()?c.feedbackManager.showInformationFeedback("<strong>"+a+"</strong> "+c.settings.pleaseRefreshThePageToSeeThemMessage,
c.refreshElementsList):(c.refreshTreeMenuIfNeeded(),c.feedbackManager.showInformationFeedback(a))};this.shouldDisplayRefreshButton=function(){return c.wasPollingStarted};this.handleErrorResponse=function(a){401===a.status?c.redirectToLogOutPage():c.checkStatusAfterInterval()};this.redirectToLogOutPage=function(){window.top.location.replace(c.settings.logOutPageUrl)};this.refreshElementsList=function(){c.refreshTreeMenuIfNeeded();c.refreshWindow()};this.refreshTreeMenuIfNeeded=function(){if(c.settings.isTreeMenuRendered){var a=
new CCL.CommonWindowMessages.GenericMessage(c.settings.refreshTreeMenuPostMessageName);CCL.CommonFunctions.makePostMessageCall(window.parent,a)}};this.refreshWindow=function(){location.reload()};b.areThereAnyUploadsToHandle(d.initialSummary)&&this.handleInitialUploadSummary(d.initialSummary)}}();e.UploadStatusChecker=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,b,a){var c=this;this.refreshButtonText=a;this.showInformationFeedback=function(a,b){var g={disableAutomaticHiding:!0};b&&(g.extraButtonName=c.refreshButtonText,g.extraButtonCallback=b);CCL.InformationFeedback.showFeedback(c.informationFeedbackContainer,a,g)};this.showErrorFeedback=function(a){CCL.CommonFunctions.isMobileDevice()?CCL.ErrorFeedback.showFeedback(c.errorFeedbackContainer,a,function(){}):(c.hideBottomNavigationBar(),CCL.ErrorFeedback.showFeedback(c.errorFeedbackContainer,
a,c.showBottomNavigationBar))};this.hideInformationFeedback=function(){CCL.InformationFeedback.hideFeedback(c.informationFeedbackContainer)};this.showBottomNavigationBar=function(){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.showBottomNavigationBar))};this.hideBottomNavigationBar=function(){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.hideBottomNavigationBar))};
this.informationFeedbackContainer=$("#"+d);this.errorFeedbackContainer=$("#"+b);if(!CCL.CommonFunctions.isMobileDevice())$(window).on("beforeunload",function(){c.showBottomNavigationBar()})}}();e.UploadStatusFeedbackManager=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){var d=this;this.areThereAnyUploadsToHandle=function(b){return b&&(b.IsProcessingInProgress||b.UploadInfos&&0<b.UploadInfos.length)};this.isThereOnlyOneSingleFileUpload=function(b){return b&&b.UploadInfos&&1===b.UploadInfos.length&&b.UploadInfos[0].UploadType===e.UploadType.SingleFile};this.areAllUploadsFinishedWithSuccess=function(b){return b&&b.UploadInfos&&0<b.UploadInfos.length&&b.UploadInfos.every(function(a){return a.Status===e.UploadStatus.Success})};
this.areUploadsFinishedWithPartialSuccess=function(b){return b&&b.UploadInfos&&(b.UploadInfos.some(function(a){return a.Status===e.UploadStatus.PartialSuccess})||b.UploadInfos.some(function(a){return a.Status===e.UploadStatus.Success})&&b.UploadInfos.some(function(a){return a.Status===e.UploadStatus.Error}))};this.getFileNamesForSingleFileUploads=function(b){return b&&b.UploadInfos?b.UploadInfos.filter(function(a){return a.UploadType===e.UploadType.SingleFile}).map(d.getSingleFileUploadFileName):
[]};this.getSingleFileUploadFileName=function(b){return b.Details&&b.Details.Name?b.Details.Name:""}}}();e.UploadSummaryParser=f})(f.Folder||(f.Folder={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b){this.settings=b;this.elementLinkDialogManagerInstance=f.ElementLinkDialog.elementLinkDialogManagerInstance;e.learningObjectiveStateRepositoryManagerInstance=this;this.hasAnyChanges=!1}d.prototype.openDialog=function(b,a){var c=this,g=[];a={elementStates:e.LearningObjectiveRepositoryHelper.convertElementIdsToElementStateMapping(a,f.CheckboxStateMachine.State.AttachedByUser),disabledElementIds:a,showAll:!0,header:this.settings.Terms.Header,elementType:f.ElementLinkDialog.ContentElementType.LearningObjectives,
allowFolderSelection:!0,openerPage:f.ElementLinkDialog.ElementsPopupOpener.None,afterOkClickCallback:function(a){a&&(a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.Saved||g.push(b)}),0<g.length&&(c.hasAnyChanges=!0,c.connectElementsToState(g,b)))},afterCloseDialogCallback:function(){c.hasAnyChanges&&setTimeout(function(){location.reload()},100)}};this.elementLinkDialogManagerInstance.openDialog(a,{countryCode:this.settings.CountryCode})};
d.prototype.deleteLearningObjectivesFromState=function(b,a){$.ajax({type:"DELETE",url:this.settings.Urls.DeleteLearningObjectivesFromState,data:{learningObjectiveId:b,stateId:a},dataType:"html"}).done(function(){location.reload()})};d.prototype.connectElementsToState=function(b,a){$.ajax({type:"PUT",url:this.settings.Urls.AddLearningObjectivesToState,data:{learningObjectiveIds:b,stateId:a},dataType:"html"}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};return d}();e.LearningObjectiveStateRepositoryManager=
k})(f.LearningObjectiveRepository||(f.LearningObjectiveRepository={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.dialogSelfClickHandler=function(b){b.stopPropagation();a.contextDialog.isOpened()&&window.setTimeout(function(){a.contextDialog.closeDialog()},100)};this.contextDialogControlId="#"+b.ContextDialogControlId;this.alignmentReportItemSelector=$(b.ReportItemSelector);this.contextDialogActivatorSelector=$(b.ContextDialogActivatorSelector);this.activeItemClassName=b.ActiveItemClassName;this.contextDialogContentContainerSelector=b.ContextDialogContentContainerSelector;
this.filterContainer=$(b.FilterContainerSelector);this.filterDataAttributeSuffix=b.FilterDataAttributeSuffix;this.itemsContainer=$(b.ItemsContainerSelector);this.measureViewAlignedUrl=b.MeasureViewAlignedUrl;this.measureViewNotAlignedUrl=b.MeasureViewNotAlignedUrl;this.measureViewAttachedDataUrl=b.MeasureViewAttachedDataUrl;this.initContextDialog();this.initReportItem();this.initFilter()}d.prototype.openContextDialog=function(b){this.contextDialog.isOpened()&&this.contextDialog.closeDialog();this.contextDialog.openDialogAt(b.x,
b.y)};d.prototype.initReportItem=function(){var b=this;this.contextDialogActivatorSelector.on("click",function(a){var c=$(a.currentTarget);c.addClass(b.activeItemClassName);var g=c.find(b.contextDialogContentContainerSelector).html();b.contextDialog.setContent(g);c=c.position();b.openContextDialog({x:c.left,y:c.top});b.contextDialog.setBeforeCloseDialog(function(){$(a.currentTarget).removeClass(b.activeItemClassName)});$.ajax(b.measureViewAttachedDataUrl)})};d.prototype.initContextDialog=function(){var b=
this;this.contextDialog=new ContextDialog(this.contextDialogControlId,{showHeader:!1,blackThemeActivated:!1,showCloseLink:!0,width:"404px",scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!0,marginTop:35,marginLeft:-2,marginRight:0,marginBottom:0,cssClass:"itsl-lo-alignment-report-context-dialog"});$(document).on({"contextdialog:show":function(){window.setTimeout(function(){b.contextDialog.mainContainer.on("click",b.dialogSelfClickHandler)},100)},"contextdialog:close":function(){b.contextDialog.mainContainer.off("click",
b.dialogSelfClickHandler)}})};d.prototype.initFilter=function(){var b=this,a=this.filterContainer.find("a[data-"+this.filterDataAttributeSuffix+"]"),c=a.map(function(a,c){return $(c).data(b.filterDataAttributeSuffix)}).get().join(" ");a.click(function(g){g=$(g.target);a.removeClass(b.activeItemClassName);g.addClass(b.activeItemClassName);g=g.data(b.filterDataAttributeSuffix);b.itemsContainer.removeClass(c).addClass(g);"filter-aligned"===g?$.ajax(b.measureViewAlignedUrl):"filter-not-aligned"===g&&
$.ajax(b.measureViewNotAlignedUrl)})};return d}();e.AlignmentReport=f})(f.LearningObjective||(f.LearningObjective={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this._settings=b;this._parameters=b.ParametersNames}d.prototype.browseLibrary=function(b){var a=CCL.CommonFunctions.setQueryStringParameter(this._settings.BrowseLibraryUrl,this._parameters.CourseId,b.CourseId||this._settings.CourseId);b.RelatedEntityId&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.RelatedEntityId,b.RelatedEntityId));b.ElementCategory&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.ElementType,
b.ElementCategory));b.CustomId&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.CustomId,b.CustomId));b.LearningObjectivesIds&&0<b.LearningObjectivesIds.length&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.LearningObjectiveId,b.LearningObjectivesIds.join(",")));b.FolderId&&(a=CCL.CommonFunctions.setQueryStringParameter(a,this._parameters.FolderId,b.FolderId));this.browserDialog.setIframeUrl(a,!0);this.browserDialog.openDialog()};d.prototype.setDialogCustomScripts=
function(b){this.browserDialog.setCustomScripts(b)};Object.defineProperty(d.prototype,"browserDialog",{get:function(){return window[this._settings.ModalId]},enumerable:!0,configurable:!0});return d}();e.LibraryBrowser=f})(f.Library||(f.Library={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.settings=b;this.iframeHolders=$();this.loadEmbedContentDebouncer=new CCL.CallbackDebouncer(function(){return a.loadEmbedContentAsync()});this.loadEmbedContentTimeoutInMilliseconds=300;this.embedConsideredVisibleRatio=.2;this.loadEmbedContentAftercallTimes=5;this.embedIframeShowAnimationSpeedInMilliseconds=500;$(window).on(this.settings.isIosDevice?"touchmove":"scroll",function(){return a.loadEmbedContentDebouncer.invokeCallback(0,
a.loadEmbedContentTimeoutInMilliseconds)})}d.prototype.loadEmbedContentAsync=function(b){var a=this;void 0===b&&(b=-1);var c=this.getPendingIframeHolder();if(c){var g=this.createAjaxLoader();-1<b&&g.height(b);var d=this.createIframe(this.getEmbedIframeUrl(c),!1);this.findClosestEmbedBox(c).append(g);c.append(d);d.one("load",function(){d.fadeIn(a.embedIframeShowAnimationSpeedInMilliseconds);a.loadEmbedContentAftercallIterationNumber=1;a.loadEmbedContentDebouncer.invokeCallback(0,a.loadEmbedContentTimeoutInMilliseconds)})}else 0<
this.loadEmbedContentAftercallIterationNumber&&(this.loadEmbedContentDebouncer.invokeCallback(0,this.loadEmbedContentAftercallIterationNumber*this.loadEmbedContentTimeoutInMilliseconds),this.loadEmbedContentAftercallIterationNumber+=1,this.loadEmbedContentAftercallIterationNumber>this.loadEmbedContentAftercallTimes&&(this.loadEmbedContentAftercallIterationNumber=0))};d.prototype.findIframeHolders=function(b){return b.find("[data-"+this.settings.dataAttributes.embedIframeUrl+"]")};d.prototype.appendIframeHolders=
function(b){this.iframeHolders=this.iframeHolders.add(this.findIframeHolders(b))};d.prototype.getEmbedIframeUrl=function(b){return b.data(this.settings.dataAttributes.embedIframeUrl)};d.prototype.createAjaxLoader=function(){return $("<div class='"+this.settings.cssClasses.ajaxLoader+"'></div>")};d.prototype.findAjaxLoader=function(b){return b.find("."+this.settings.cssClasses.ajaxLoader)};d.prototype.createIframe=function(b,a){return $("<iframe src='"+b+"' width='100%' height='100%' scrolling='no' class='"+
this.settings.cssClasses.noBorder+"' allowfullscreen "+(a?"":"style='display:none'")+"></iframe>")};d.prototype.removeAjaxLoader=function(b){b.find("."+this.settings.cssClasses.ajaxLoader).remove()};d.prototype.isEmbedInProgress=function(b){return 0<this.findAjaxLoader(b).length};d.prototype.getPendingIframeHolder=function(){for(var b=0;b<this.iframeHolders.length;b++){var a=this.iframeHolders.eq(b),c=this.findClosestBulletinItem(a);if(!this.isEmbedInProgress(a)&&!d.isEmbedFinished(a)&&!this.isEmbedError(c)&&
this.isOnScreen(c))return a}};d.isEmbedFinished=function(b){return 0<b.find("iframe").length};d.prototype.isEmbedError=function(b){return 0<b.find("."+this.settings.cssClasses.oembedError).length};d.prototype.isOnScreen=function(b){return CCL.CommonFunctions.isOnScreen(b,this.embedConsideredVisibleRatio,this.embedConsideredVisibleRatio,this.settings.isIosDevice?window.parent:window)};d.prototype.findClosestEmbedBox=function(b){return b.closest(this.settings.selectors.embedBox)};d.prototype.findClosestBulletinItem=
function(b){return b.closest(this.settings.selectors.bulletinItem)};return d}();e.EmbedAsynchronousLoader=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=f.Controls.Validation.ValidatorFactory,d=f.Controls.Validation.DateTimePickerValidatorFactory,b=function(){function a(a){var b=this;this.utility=a;this.undoBadInputActiveFrom=function(){b.activeFrom.highlightOnAutoCorrectInvalidInput(500);setTimeout(function(){b.activeFrom.setDateTime(b.currentStrategyValue.activeFromDate)},500)};this.undoBadInputActiveTo=function(){b.activeTo.highlightOnAutoCorrectInvalidInput(500);setTimeout(function(){b.activeTo.minDate=b.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds;
b.activeTo.minDate.setMinutes(b.activeTo.minDate.getMinutes()+5);b.activeTo.setDateTime(!b.currentStrategyValue.activeToDate||b.currentStrategyValue.activeToDate<b.activeTo.minDate?b.activeTo.minDate:b.currentStrategyValue.activeToDate)},500)};this.runCheckOnBlurEvent(this.activeFrom,k.until(d.invalidDateDenyEmptyNoHighlight(this.activeFrom,this.utility.settings.Resources.InvalidDateFormat,this.undoBadInputActiveFrom),k.checkNoHighlight(this.activeFrom,function(){return b.activeFrom.getDateTime()<
b.activeFrom.minDate},"",this.undoBadInputActiveFrom)));this.runCheckOnBlurEvent(this.activeTo,k.until(d.invalidDateAllowEmptyNoHighlight(this.activeTo,this.utility.settings.Resources.InvalidDateFormat,this.undoBadInputActiveTo),k.checkNoHighlight(this.activeTo,function(){return b.activeTo.getDateTime()<=b.activeTo.minDate},"",this.undoBadInputActiveTo),k.checkNoHighlight(this.activeTo,function(){return b.activeTo.getDateTime()<=b.activeFrom.getDateTime()},this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate,
void 0)))}Object.defineProperty(a.prototype,"currentStrategy",{set:function(a){this.currentStrategyValue=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeFrom",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"activeTo",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},enumerable:!0,configurable:!0});a.prototype.validateDates=function(){var a=
this;return k.all(d.invalidDateDenyEmpty(this.activeFrom,this.utility.settings.Resources.InvalidDateFormat),k.until(k.checkNoHighlight(this.activeFrom,function(){return a.activeFrom.getDateTime()<a.activeFrom.minDate},"",this.undoBadInputActiveFrom),d.invalidDateAllowEmpty(this.activeTo,this.utility.settings.Resources.InvalidDateFormat),k.checkNoHighlight(this.activeTo,function(){return a.activeTo.getDateTime()<=a.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds},"",this.undoBadInputActiveTo),
d.compareDates(k.lessThanOrEqual,this.activeTo,this.activeFrom.getDateTime(),this.utility.settings.Resources.ActiveFromDateShouldBeLaterThanActiveToDate)))()};a.prototype.runCheckOnBlurEvent=function(a,b){$(a).on("blur",function(){setTimeout(function(){a.isFocusWithinControl()||b()},1)})};return a}();e.ScheduleDialogInputValidator=b})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.inputValidator=a;this.utilityValue=b;this.activeFromPickerInstance.dependentPicker=this.activeToPickerInstance}Object.defineProperty(d.prototype,"activeFromDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeToDate",{get:function(){throw Error("Abstract method should be overriden");},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"strategicData",{get:function(){return this.strategicDataValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"utility",{get:function(){return this.utilityValue},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeFromPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.FromDateTimePicker]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"activeToPickerInstance",{get:function(){return window[this.utility.settings.ClientInstances.ToDateTimePicker]},
enumerable:!0,configurable:!0});d.prototype.loadDialogState=function(b,a){this.strategicDataValue=a;this.inputValidator.currentStrategy=this;this.utility.synchronizeDateTimePicker(this.activeFromPickerInstance);this.activeFromPickerInstance.toggleValidationError({isInvalid:!1});this.activeToPickerInstance.toggleValidationError({isInvalid:!1});this.loadDialogStateDone(b)};d.prototype.persistDialogState=function(){this.inputValidator.validateDates()&&(this.persistValidatedDialogState(),this.inputValidator.currentStrategy=
void 0)};d.prototype.loadDialogStateDone=function(b){throw Error("Abstract method should be overriden");};d.prototype.persistValidatedDialogState=function(){throw Error("Abstract method should be overriden");};return d}();e.ScheduleDialogBaseStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function b(a,b){d.call(this,a,b);this.resetStorage()}__extends(b,d);Object.defineProperty(b.prototype,"activeFromDate",{get:function(){return this.storage.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeToDate",{get:function(){return this.storage.activeTo},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeFrom",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom)},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeTo",{get:function(){return CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)},enumerable:!0,configurable:!0});b.prototype.resetStorage=function(){this.storage={activeFrom:void 0,activeTo:void 0}};b.prototype.loadDialogStateDone=function(a){a.OkButton.val(this.utility.settings.Resources.ApplyButtonText);a=this.utility.dateTimeSynchronizer.currentServerTimeWithoutSeconds;if(!this.storage.activeFrom||this.storage.activeFrom<
a)this.storage.activeFrom=a;this.storage.activeTo&&this.storage.activeTo<a&&(this.storage.activeTo=a);this.activeFromPickerInstance.minDate=a;this.activeToPickerInstance.minDate=a;this.activeFromPickerInstance.setDateTime(this.storage.activeFrom);this.activeToPickerInstance.setDateTime(this.storage.activeTo)};b.prototype.persistValidatedDialogState=function(){this.storage={activeFrom:this.activeFromPickerInstance.getDateTime(),activeTo:this.activeToPickerInstance.getDateTime()};this.storage.activeFrom||
this.storage.activeTo?this.utility.ajaxClient.getTimeSpan({ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeFrom),ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.storage.activeTo)}).done(this.strategicData.onSuccess).always(CssModal.closeDialog):CssModal.closeDialog()};return b}(e.ScheduleDialogBaseStorageStrategy);e.ScheduleDialogTemporaryStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(d){function b(a,b){d.call(this,a,b)}__extends(b,d);Object.defineProperty(b.prototype,"activeFromDate",{get:function(){return this.activeFrom},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeToDate",{get:function(){return this.activeTo},enumerable:!0,configurable:!0});b.prototype.loadDialogStateDone=function(a){var b=this;a.OkButton.val(this.utility.settings.Resources.OkButtonText);this.activeFromPickerInstance.setDateTime(void 0);this.activeToPickerInstance.setDateTime(void 0);
this.activeTo=this.activeFrom=void 0;this.utility.ajaxClient.getSchedule(this.strategicData.lightBulletinId).done(function(a){return e.GenericResponseHandler.handle(a,function(){var c=a.ResponseData;b.activeFrom=CCL.SerializableDateTimeConverter.toDate(c.ActiveFrom);b.activeTo=CCL.SerializableDateTimeConverter.toDate(c.ActiveTo);b.activeFromPickerInstance.setDateTime(b.activeFrom);b.activeFromPickerInstance.minDate=CCL.SerializableDateTimeConverter.toDate(c.Created);b.activeToPickerInstance.setDateTime(b.activeTo);
b.activeToPickerInstance.minDate=new Date},function(){CssModal.closeDialog();a.Code===e.GenericResponseCode.LightBulletinNotFound&&b.utility.removeBulletin(b.utility.getBulletinById(b.strategicData.lightBulletinId))})})};b.prototype.persistValidatedDialogState=function(){this.utility.ajaxClient.updateSchedule(this.strategicData.lightBulletinId,{ActiveFrom:CCL.SerializableDateTimeConverter.fromDate(this.activeFromPickerInstance.getDateTime()),ActiveTo:CCL.SerializableDateTimeConverter.fromDate(this.activeToPickerInstance.getDateTime())},
this.strategicData.bulletinsDisplayMode).done(this.strategicData.onSuccess).always(CssModal.closeDialog)};return b}(e.ScheduleDialogBaseStorageStrategy);e.ScheduleDialogAjaxStorageStrategy=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.utility=b}Object.defineProperty(d.prototype,"areCommentsDisabledForNewBulletins",{get:function(){return this.areCommentsDisabledForNewBulletinsValue},set:function(b){this.areCommentsDisabledForNewBulletinsValue=b;this.utility.controls.AddMenu.ToggleCommentsOptionSpan.text(this.getToggleCommentsTerm(b));this.utility.controls.CommentsAvailabilityStatusPlaceHolder.toggle(b)},enumerable:!0,configurable:!0});d.prototype.resetCommentsDisabledForNewBulletins=
function(){this.areCommentsDisabledForNewBulletins=this.utility.settings.DisableLightBulletinCommentsDefaultValue};d.prototype.togglePossibilityToAddComments=function(b,a,c){c&&CCL.DomElementClass.GetInstanceForElement(b.CommentControlClientInstanceName).togglePossibilityToAddComments(!b.DisableComments);a.text(this.getToggleCommentsTerm(b.DisableComments))};d.prototype.getToggleCommentsTerm=function(b){return b?this.utility.settings.Resources.EnableComments:this.utility.settings.Resources.DisableComments};
return d}();e.LightBulletinCommentToggler=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.scrollTopTimeoutMilliseconds=200;this.animationTimeInMilliseconds=b.animationTimeInMilliseconds}d.prototype.animateShow=function(b,a){b.slideDown(this.animationTimeInMilliseconds,function(){a&&a();b.css("overflow","")})};d.prototype.animateHideAndRemove=function(b,a){this.animateHide(b,function(){b.remove();a&&a()})};d.prototype.animateScrollTop=function(b,a,c){var g=this;void 0===c&&(c=!1);setTimeout(function(){$("html, body").animate({scrollTop:b},
{duration:c?0:g.animationTimeInMilliseconds,complete:a})},this.scrollTopTimeoutMilliseconds)};d.prototype.animateHide=function(b,a){b.slideUp(this.animationTimeInMilliseconds,a)};return d}();e.LightBulletinAnimator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){f=f.LightBulletin||(f.LightBulletin={});f=f.LightBulletinConstants||(f.LightBulletinConstants={});f.maxCountOfAddedElements=50;f.animationTimeInMilliseconds=250;f.watchEmbedsPasteTimeoutInMilliseconds=50;f.watchEmbedsKeyUpTimeoutInMilliseconds=1500;f.renderShowMoreDelayInMilliseconds=500;f.domainPartOfEmailRegexParams={regex:/(^|\s)[^a-z0-9._%+-]*(@[a-z0-9.-]+\.[a-z]{2,3})/ig,replaceGroupIndex:1};f.dataAttributeNames={pendingProcessId:"pending-process-id",loadedProcessId:"loaded-process-id"}})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b){this.utility=b;this.elementStates=new Map;this.settings=b.settings;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.newsContentBlock=this.utility.controls.Container.parents("."+this.settings.CssClasses.WidgetCbNews)}d.prototype.onResourceButtonClick=function(b,a,c,g,d){var h=this,l=this.elementStates.has(b)?this.elementStates.get(b):this.initiallyLoadElementStatesFromUi(b,a),k={locationId:this.settings.CourseId,locationType:this.settings.LocationTypeCourse};
f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog({elementStates:f.MapUtils.makeCopy(l),afterOkClickCallback:function(e){return h.onDialogAddButtonClick(b,a,f.MapUtils.makeCopy(e),c,g,d)},afterCloseDialogCallback:function(){h.utility.animator.animateScrollTop(0<b?a.offset().top:h.newsContentBlock.offset().top,function(){return a.find("."+h.settings.CssClasses.EditorTextarea).focus()},h.settings.IsIeBrowser)},maxCountOfAddedElements:e.LightBulletinConstants.maxCountOfAddedElements,elementType:f.ElementLinkDialog.ContentElementType.All,
showAll:!0,header:this.settings.Resources.ElementLinkDialogHeader,allowFolderSelection:!0},k)};d.prototype.onDetachResourceButtonClick=function(b,a,c,g){var d=c.data(this.settings.DataAttributes.ElementLinkElementId);this.elementStates.has(b)||this.elementStates.set(b,this.initiallyLoadElementStatesFromUi(b,a));var e=this.elementStates.get(b),l=e.get(d);l=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(!1,l);e.set(d,l);l===f.CheckboxStateMachine.State.Empty?(c.remove(),g()):l===
f.CheckboxStateMachine.State.DetachedByUser&&this.hideWhenEditOrRemoveWhenNew(b,c,g);this.toggleDetailedView(this.utility.getElementLinkList(this.utility.getCurrentBulletinItemOrNew(a)))};d.prototype.resetUnsavedElementLinks=function(b,a){if(this.elementStates.has(b)){var c=this.utility.getElementLinkList(a),g=[],d=[];this.forEachElementState(b,function(a,b){a===f.CheckboxStateMachine.State.AttachedByUser?g.push(b):a===f.CheckboxStateMachine.State.DetachedByUser&&d.push(b)});b=this.elementStates.get(b);
var e=void 0;for(e=0;e<g.length;e++){var l=g[e];c.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+l+'"]').remove();b.delete(l)}for(e=0;e<d.length;e++)l=d[e],this.utility.animator.animateShow(c.find("[data-"+this.settings.DataAttributes.ElementLinkElementId+'="'+l+'"]')),b.set(l,f.CheckboxStateMachine.State.Saved);this.toggleDetailedView(this.utility.getElementLinkList(a))}};d.prototype.getElementIdsForBulletin=function(b){var a=[],c=[];this.forEachElementState(b,function(b,d){b===
f.CheckboxStateMachine.State.AttachedByUser?a.push(d):b===f.CheckboxStateMachine.State.DetachedByUser&&c.push(d)});return{elementsToAttach:a,elementsToDetach:c}};d.prototype.cleanAppendData=function(b,a){var c=this;if(0===b)this.elementStates.delete(b);else{var g=this.elementStates.get(b),d=[];this.forEachElementState(b,function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.DetachedByUser||d.push(b)});var e=this.utility.getElementLinkList(a);d.forEach(function(a){var b=
c.checkboxStateMachine.transferElementStateAfterSave(g.get(a));g.set(a,b);b===f.CheckboxStateMachine.State.Empty&&e.find("[data-"+c.settings.DataAttributes.ElementLinkElementId+'="'+a+'"]').remove()})}};d.prototype.onDialogAddButtonClick=function(b,a,c,g,d,m){var h=this;d();this.elementStates.set(b,c);var k=this.utility.getElementLinkList(a);0===k.length&&(k=$(this.utility.controls.Container.data(this.settings.DataAttributes.ElementLinkList)),a.find("[data-"+this.settings.DataAttributes.ElementLinkAppendTarget+
"]").append(k));var n=[],p=[];this.forEachElementState(b,function(a,c){var g=k.find("[data-"+h.settings.DataAttributes.ElementLinkElementId+'="'+c+'"]');switch(a){case f.CheckboxStateMachine.State.Empty:g.remove();break;case f.CheckboxStateMachine.State.AttachedByUser:0===g.length?p.push(c):n.push(c);break;case f.CheckboxStateMachine.State.Saved:h.utility.animator.animateShow(g);n.push(c);break;case f.CheckboxStateMachine.State.DetachedByUser:h.hideWhenEditOrRemoveWhenNew(b,g)}});0<p.length?this.utility.ajaxClient.elementLinkItemsContent(p).done(function(b){b&&
(k.append($(b)),h.sortElementLinks(k),h.toggleDetailedView(k),a.find("."+h.settings.CssClasses.ElementLinkDelete).show(),m&&m())}).fail(function(a,b,c){g();CCL.CommonFunctions.alertAjaxError(a,b,c)}):this.toggleDetailedView(k);p.length+n.length>=e.LightBulletinConstants.maxCountOfAddedElements&&this.utility.toggler.toggleResourceButton(a,!1)};d.prototype.sortElementLinks=function(b){var a=this;b.children("li").get().sort(function(b,g){var c=a.settings.IsElementListSortOrderAscending?g:b,d="data-"+
a.settings.DataAttributes.ElementLinkListItemSortExpression;return $(a.settings.IsElementListSortOrderAscending?b:g).attr(d).localeCompare($(c).attr(d))}).forEach(function(a){b.append(a)})};d.prototype.toggleDetailedView=function(b){b=b.children("li").removeClass(this.settings.CssClasses.ElementLinkListItemDetailedView).filter(":visible");1===b.length&&b.addClass(this.settings.CssClasses.ElementLinkListItemDetailedView)};d.prototype.initiallyLoadElementStatesFromUi=function(b,a){var c=this,g=new Map;
this.utility.getElementLinkList(a).children("li").each(function(a,b){a=$(b).data(c.settings.DataAttributes.ElementLinkElementId);g.set(a,f.CheckboxStateMachine.State.Saved)});this.elementStates.set(b,g);return g};d.prototype.forEachElementState=function(b,a){(b=this.elementStates.get(b))&&b.forEach(a)};d.prototype.hideWhenEditOrRemoveWhenNew=function(b,a,c){0===b?a.remove():a.hide();"function"===typeof c&&c()};return d}();e.ElementLinkBuilder=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.oembedErrorCssClasses=b;this.oembedErrorResources=a;this.linkParser=new CCL.LinkParser}d.prototype.hasOembedError=function(b){return 0!==b.find("."+this.oembedErrorCssClasses.OembedBoxError).length};d.prototype.generateOembedError=function(b,a,c,g){var d=this;b.oembedPlaceHolder.find("iframe").remove();var e=$("<a>").prop("target","_blank").prop("href",b.originalEmbedCode).text(this.linkParser.getDomain(b.originalEmbedCode));e=CCL.CommonFunctions.formatString(this.oembedErrorResources.OembedErrorMessage,
e.get(0).outerHTML);e=$('<div class="'+this.oembedErrorCssClasses.OembedErrorContentBlock+'"></div>').append('<p class="'+this.oembedErrorCssClasses.OembedErrorTitle+'">'+this.oembedErrorResources.OembedErrorTitle+"</p>").append('<span class="'+this.oembedErrorCssClasses.OembedErrorMessage+'">'+e+"</span>").append("<br />").append($('<button type="button" class="'+this.oembedErrorCssClasses.OembedErrorTryAgain+'">'+this.oembedErrorResources.OembedErrorTryAgain+"</button>").on("click",function(){var e=
"function"===typeof c?c():0,f=b.oembedPlaceHolder.find("."+d.oembedErrorCssClasses.OembedBoxError),h=f.outerHeight();f.remove();b.oembedPlaceHolder.find("iframe").remove();a.loadEmbedContentAsync(h+e);"function"===typeof g&&g()}));return $('<div class="'+this.oembedErrorCssClasses.OembedBoxError+" "+this.oembedErrorCssClasses.Clearfix+'"></div>').append('<span class="'+this.oembedErrorCssClasses.OembedErrorImageBox+'"></span>').append(e)};return d}();e.EmbedError=f})(f.LightBulletin||(f.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.utility=b;this.settings=b.settings;this.controls=b.controls}d.prototype.getBulletinEditor=function(b){return this.utility.isAddMode(b)?this.controls.NewBulletinText:b.data(d.bulletinEditorDataAttribute)};d.prototype.getBulletinEditorInstance=function(b){return b.data(d.bulletinEditorInstanceDataAttribute)};d.prototype.makeEditorAutoResizable=function(b){setTimeout(function(){return b.autogrow({whiteSpaceMatters:!0})})};d.prototype.createBulletinEditor=
function(b){var a=new e.LightBulletinEditorInstance(this.utility,b);b.data(d.bulletinEditorInstanceDataAttribute,a);return a};d.prototype.removeBulletinEditorInstanceDataAttribute=function(b){b.removeData(d.bulletinEditorInstanceDataAttribute)};d.prototype.resetEditor=function(b,a){b.removeAttr("style");a&&b.focus();this.utility.watchEmbeds.watchEmbeds(b)};d.bulletinEditorDataAttribute="bulletinEditor";d.bulletinEditorInstanceDataAttribute="bulletinEditorInstance";return d}();e.LightBulletinEditor=
f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.utility=b;this.bulletinItem=a;b=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorButtonsTemplate));this.editor=$(this.utility.controls.Container.attr("data-"+this.utility.settings.DataAttributes.BulletinItemEditorTemplate));this.editorButtons=b;this.cancelButton=b.find(this.utility.selectors.cancelEditAction);this.applyButton=b.find(this.utility.selectors.applyEditAction);this.bulletinId=
this.utility.getBulletinId(a)}d.prototype.removeBulletinEditor=function(){this.bulletinItem.find("[data-"+this.utility.settings.DataAttributes.BulletinItemEditorTarget+"]").children().remove();this.editorButtons.remove()};return d}();e.LightBulletinEditorInstance=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.utility=b}d.prototype.applyNewImageLoadingComplete=function(b){var a=this,c=this.filterNewImageBoxes(this.utility.getImageBox(b));this.utility.getImage(c).one("load",function(){return c.removeClass(a.utility.settings.CssClasses.ImageBoxLoading)})};d.prototype.hideOrRemoveImageBoxFromContainer=function(b){this.hideOrRemoveImageBox(this.utility.getImageBox(b))};d.prototype.hideOrRemoveImageBox=function(b){this.filterNewImageBoxes(b).remove();
this.filterNotNewImageBoxes(b).hide()};d.prototype.resetUnsavedImage=function(b){var a=this.utility.getImageBox(b);this.filterNewImageBoxes(a).remove();this.filterNotNewImageBoxes(a).show();this.removeImageError(b);this.clearAddImageButtonFileInputValue(b)};d.prototype.getParsedUploadResult=function(b){return this.parseSerialzedImageData(this.filterNewImageBoxes(this.utility.getImageBox(b)).last().find("input[type='hidden']"))};d.prototype.getDeleteAttachedImageValue=function(b){b=this.utility.getImageBox(b);
var a;return 0===this.filterNewImageBoxes(b).length&&0<(a=this.filterNotNewImageBoxes(b)).length&&a.length===a.not(":visible").length};d.prototype.applyImageEditsIfNeeded=function(b,a){var c=this.utility.getImageBox(b),g=this.filterNewImageBoxes(c);c=this.filterNotNewImageBoxes(c);var d=c.filter(":hidden");0<g.length&&(c.remove(),this.utility.setImageIsNew(g,!1),a&&g.find("[data-"+this.utility.settings.DataAttributes.BulletinAttachedImageLink+"]").prop("href",a));0<d.length&&d.remove();this.removeImageError(b)};
d.prototype.removeImageError=function(b){this.utility.getImageError(b).remove()};d.prototype.addImageButtonFileInputHasValue=function(b){return!!b.find(this.utility.selectors.addImageButtonFileInput).val()&&0<this.utility.getVisibleImageBox(b).length};d.prototype.clearAddImageButtonFileInputValue=function(b){b.find(this.utility.selectors.addImageButtonFileInput).val("")};d.prototype.filterNewImageBoxes=function(b){var a=this;return b.filter(function(b,g){return a.utility.getImageIsNew($(g))})};d.prototype.filterNotNewImageBoxes=
function(b){var a=this;return b.filter(function(b,g){return!a.utility.getImageIsNew($(g))})};d.prototype.parseSerialzedImageData=function(b){return 0<b.length?CCL.CommonFunctions.safeParseJson(b.val()):void 0};return d}();e.LightBulletinImageBox=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){this.fragments=[];this.createPlaceholder=function(b){return"@@LightBulletinTextObfuscator"+b+"@@"}}d.prototype.replaceTextFragmentsWithPlaceholders=function(b,a){var c=this;return b.replace(a.regex,function(b){for(var g=[],d=1;d<arguments.length;d++)g[d-1]=arguments[d];g=g[a.replaceGroupIndex];d=c.createPlaceholder(c.fragments.length);c.fragments.push(g);return b.replace(g,d)})};d.prototype.replacePlaceholdersWithTextFragments=function(b){var a=
this;b=this.fragments.reduce(function(b,g,d){return b.replace(a.createPlaceholder(d),g)},b);this.fragments=[];return b};return d}();e.LightBulletinTextObfuscator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b){var a=this;this.utility=b;this.watchEmbedsDebouncer=new CCL.CallbackDebouncer(function(b){return a.switchWatchEmbeds(b.element,b.enabled)})}d.prototype.toggleOembedEditClasses=function(b,a){b.find("."+this.utility.settings.CssClasses.OembedBoxHeader).toggle(!a.isViewMode);this.utility.getVisibleOembedBox(b).toggleClass(this.utility.settings.CssClasses.OembedBoxEditMode,!a.isViewMode&&!a.isEmbedInProgress)};d.prototype.toggleAddBulletinMenu=
function(b){this.utility.controls.AddMenu.LinkContainer.toggle(b)};d.prototype.switchWatchEmbeds=function(b,a){this.utility.watchEmbeds.switchWatchEmbedsInBulletinItem(b,a)};d.prototype.toggleResourceButton=function(b,a){this.utility.getCurrentBulletinItemOrNew(b).find(this.utility.selectors.addResourceAction).prop("disabled",!a)};d.prototype.toggleAddEditButton=function(b,a){this.utility.getAddEditButton(b).prop("disabled",!a)};d.prototype.toggleAddImageButton=function(b,a){b=this.utility.getAddImageButton(b);
b.prop("disabled",!a);b.find(this.utility.selectors.addImageButtonFileInput).toggle(a)};d.prototype.toggleAddToOtherCoursesButton=function(b,a){this.utility.getAddToOtherCoursesButton(b).prop("disabled",!a)};d.prototype.toggleControlsInBulletin=function(b,a){var c=this.utility.getAddEditButton(b);this.utility.isAddMode(b)?c.prop("disabled",!a.canBePosted):c.prop("disabled",a.isEmbedInProgress);this.toggleAttachingActionsToBulletin(b,a)};d.prototype.toggleAttachingActionsToBulletin=function(b,a){b=
this.utility.getCurrentBulletinItemOrNew(b);this.toggleResourceButton(b,!(a.hasVisibleOembedBox||a.isEmbedInProgress||a.maxCountOfAddedElementsReached||a.hasVisibleImage||a.isMultiCourseLightBulletin));var c=a.hasVisibleOembedBox||a.isEmbedInProgress||a.hasAttachedElementLinks||a.hasVisibleImage;this.toggleAddImageButton(b,!(a.hasVisibleOembedBox||a.isEmbedInProgress||a.hasAttachedElementLinks));var g=f.Controls.MultipleCourseSearchSelector.multipleCourseSearchSelectorDialogClientInstance.getAvailableCoursesCount();
this.toggleAddToOtherCoursesButton(b,!a.hasAttachedElementLinks&&0<g);this.watchEmbedsDebouncer.invokeCallback({element:b,enabled:!c},500)};d.prototype.toggleBulletinAttachmentButtons=function(b,a){this.toggleResourceButton(b,a);this.toggleAddImageButton(b,a)};return d}();e.LightBulletinToggler=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){f.linkifyNodes=function(d){var b=new e.LightBulletinTextObfuscator;d.each(function(a,c){c.innerHTML=b.replaceTextFragmentsWithPlaceholders(c.innerHTML,e.LightBulletinConstants.domainPartOfEmailRegexParams);c.innerHTML=linkifyHtml(c.innerHTML);c.innerHTML=b.replacePlaceholdersWithTextFragments(c.innerHTML)})}})(e.LightBulletinLinkifyWrapper||(e.LightBulletinLinkifyWrapper={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b,a,c,g){this.controls=b;this.settings=a;this.initSelectors();this.initClasses(c,g)}d.prototype.synchronizeDateTimePicker=function(b){var a=this;b.dateTimeSynchronizer=this.dateTimeSynchronizer;this.dateTimeSynchronizer.isSynchronizeNeeded&&this.ajaxClient.getCurrentDateTime().done(function(b){return a.dateTimeSynchronizer.synchronize(CCL.SerializableDateTimeConverter.toDateWithSeconds(b))})};d.prototype.validateBulletinAndToggleControls=function(b){var a=
this.textValidator.validateBulletin(this.editor.getBulletinEditor(b),this.getCurrentBulletinItemOrNew(b));this.toggler.toggleControlsInBulletin(b,a);this.isAddMode(b)&&this.toggler.toggleAddBulletinMenu(a.passedEmptyTextValidation);return a};d.prototype.linkifyTextNodes=function(b){this.linkifyNodes(b.find("[data-"+this.settings.DataAttributes.Text+"]"))};d.prototype.linkifyNodes=function(b){e.LightBulletinLinkifyWrapper.linkifyNodes(b)};d.prototype.isAddMode=function(b){return 0===b.length||b.get(0)===
this.controls.NewBulletinItem.get(0)};d.prototype.isViewMode=function(b){return 0===this.getAddEditButton(b).length};d.prototype.getBulletinId=function(b){return b.data(this.settings.DataAttributes.BulletinId)||0};d.prototype.getBulletinById=function(b){return this.controls.Container.find("[data-"+this.settings.DataAttributes.BulletinId+"='"+b+"']")};d.prototype.findBulletinItemByChild=function(b){return b.closest(this.selectors.bulletinItem)};d.prototype.getCurrentBulletinItemOrNew=function(b){return this.isAddMode(b)?
this.controls.NewBulletinItem:b};d.prototype.getAddEditButton=function(b){return this.isAddMode(b)?this.controls.PostNewBulletin:b.find(this.selectors.applyEditAction)};d.prototype.getAddImageButton=function(b){return this.getCurrentBulletinItemOrNew(b).find(this.selectors.addImageButton)};d.prototype.getAddToOtherCoursesButton=function(b){return this.controls.AddMenu.AddToOtherCoursesButton};d.prototype.removeBulletin=function(b){this.animator.animateHideAndRemove(b.closest("li"))};d.prototype.getOembedBox=
function(b){return b.find("."+this.settings.CssClasses.OembedBox)};d.prototype.getVisibleOembedBox=function(b){return this.getOembedBox(b).filter(":visible")};d.prototype.hasVisibleOembedBox=function(b){return 0<this.getVisibleOembedBox(b).length};d.prototype.getHiddenOembedBox=function(b){return this.getOembedBox(b).filter(":hidden")};d.prototype.getImageBox=function(b){return b.find("."+this.settings.CssClasses.ImageBox)};d.prototype.getImageError=function(b){return b.find("."+this.settings.CssClasses.ImageError)};
d.prototype.getVisibleImageBox=function(b){return this.getImageBox(b).filter(":visible")};d.prototype.hasVisibleImage=function(b){return 0<this.getVisibleImageBox(b).length};d.prototype.getHiddenImageBox=function(b){return this.getImageBox(b).filter(":hidden")};d.prototype.hasHiddenImage=function(b){return 0<this.getHiddenImageBox(b).length};d.prototype.getImageIsNew=function(b){return b.data(this.settings.DataAttributes.ImageIsNew)};d.prototype.setImageIsNew=function(b,a){b.data(this.settings.DataAttributes.ImageIsNew,
a)};d.prototype.getImage=function(b){return b.find("[data-"+this.settings.DataAttributes.BulletinAttachedImage+"]")};d.prototype.getTimeSpan=function(b){return b.find("."+this.settings.CssClasses.TimeSpan)};d.prototype.getAuthorContainer=function(b){return b.find("."+this.settings.CssClasses.Author)};d.prototype.hasOembedAttachedOrLoading=function(b,a){b=this.getCurrentBulletinItemOrNew(b);return this.hasVisibleOembedBox(b)||a.isEmbedInProgress(b)};d.prototype.getElementLinkList=function(b){return b.find("[data-"+
this.settings.DataAttributes.ElementLinkList+"]")};d.prototype.getCoursesContainer=function(b){return b.find("."+this.settings.CssClasses.Courses)};d.prototype.countResourcesOnUi=function(b){return this.getElementLinkList(this.getCurrentBulletinItemOrNew(b)).find("li").filter(":visible").length};d.setTabindexToHiddenElements=function(b,a,c){var g=0<a.length?a.get(0).getBoundingClientRect().top:0;b.find(c).each(function(b,c){b=c.getBoundingClientRect().top;g<b&&a.is(":visible")?$(c).attr("tabindex",
"-1"):$(c).removeAttr("tabindex")})};d.prototype.initSelectors=function(){this.selectors={applyEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionApplyEditValue+'"]',addResourceAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionAddResourceValue+'"]',cancelEditAction:"[data-"+this.settings.DataAttributes.BulletinAction+'="'+this.settings.DataAttributes.BulletinActionCancelEditValue+
'"]',bulletinItem:"[data-"+this.settings.DataAttributes.BulletinId+"]",mediaAppendTarget:"[data-"+this.settings.DataAttributes.MediaAppendTarget+"]",addImageButton:"."+this.settings.CssClasses.AddImageButton,addImageButtonFileInput:"."+this.settings.CssClasses.AddImageButtonFileInput,lightBulletinActionDropDownItem:"[data-"+this.settings.SingleItemDataDataAttributes.LightBulletinActionDropDownItem+"]"}};d.prototype.initClasses=function(b,a){this.editor=new e.LightBulletinEditor(this);this.watchEmbeds=
new e.LightBulletinWatchEmbeds(b,this);this.imageBox=new e.LightBulletinImageBox(this);this.toggler=new e.LightBulletinToggler(this);this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.embedAsynchronousLoader=new e.EmbedAsynchronousLoader({isIosDevice:this.settings.IsIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+
this.settings.CssClasses.OembedBox+":visible",bulletinItem:this.selectors.bulletinItem},dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.textValidator=new e.LightBulletinTextValidator(this);this.ajaxClient=new e.LightBulletinAjaxClient(this.settings,a);this.animator=new e.LightBulletinAnimator({animationTimeInMilliseconds:e.LightBulletinConstants.animationTimeInMilliseconds});this.commentToggler=new e.LightBulletinCommentToggler(this);this.elementLinkBuilder=new e.ElementLinkBuilder(this);
this.oembedError=new e.EmbedError(this.settings.OembedErrorCssClasses,this.settings.OembedErrorResources);this.linkParser=new CCL.LinkParser;this.dateTimeSynchronizer=new f.Controls.DateTimeSynchronizer(CCL.SerializableDateTimeConverter.toDateWithSeconds(this.settings.Today));this.singleItemDataManager=new e.LightBulletinSingleItemDataManager(this.settings.SingleItemDataDataAttributes,this.settings.SingleItemDataResources)};return d}();e.LightBulletinUtility=k})(f.LightBulletin||(f.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.utility=a;this.tryAgainBulletinIds=[];this.watchEmbedsPasteHandler=function(a){c.embedCallbackDebouncer.invokeCallback($(a.currentTarget),e.LightBulletinConstants.watchEmbedsPasteTimeoutInMilliseconds)};this.watchEmbedsKeyUpHandler=function(a){var b=$(a.currentTarget);a.which===CCL.CommonConstants.keyCodes.space||a.which===CCL.CommonConstants.keyCodes.enter?c.embedCallbackDebouncer.invokeCallback(b,0):c.embedCallbackDebouncer.invokeCallback(b,
e.LightBulletinConstants.watchEmbedsKeyUpTimeoutInMilliseconds)};this.embedCallbackDebouncer=new CCL.CallbackDebouncer(b)}d.prototype.switchWatchEmbedsInBulletinItem=function(b,a){a?this.watchEmbedsInBulletinItem(b):this.stopWatchEmbedsInBulletinItem(b)};d.prototype.watchEmbedsInBulletinItem=function(b){b=this.utility.editor.getBulletinEditor(b);this.watchEmbeds(b)};d.prototype.watchEmbeds=function(b){b&&(this.stopWatchEmbeds(b),b.on("paste",this.watchEmbedsPasteHandler).keyup(this.watchEmbedsKeyUpHandler))};
d.prototype.stopWatchEmbedsInBulletinItem=function(b){b=this.utility.editor.getBulletinEditor(b);this.stopWatchEmbeds(b)};d.prototype.stopWatchEmbeds=function(b){b.off("paste",this.watchEmbedsPasteHandler).off("keyup",this.watchEmbedsKeyUpHandler)};d.prototype.shouldAppendOembedError=function(b){var a=b.oembedPlaceHolder;if(this.utility.oembedError.hasOembedError(b.oembedPlaceHolder))return!1;b=this.utility.findBulletinItemByChild(a);var c=this.utility.getBulletinId(b);return-1===this.tryAgainBulletinIds.indexOf(c)&&
(this.utility.isAddMode(b)||a.data(this.utility.settings.DataAttributes.OembedIsNew))?(a.remove(),!1):0>=this.utility.countResourcesOnUi(b)};d.prototype.appendOembedError=function(b){var a=this,c=b.oembedPlaceHolder,g=this.utility.findBulletinItemByChild(c),d=this.utility.getBulletinId(g),e=this.tryAgainBulletinIds.indexOf(d);-1!==e&&(c.data(this.utility.settings.DataAttributes.OembedIsNew,!1),this.tryAgainBulletinIds.splice(e,1));c.append(this.utility.oembedError.generateOembedError(b,this.utility.embedAsynchronousLoader,
function(){a.tryAgainBulletinIds.push(d);var c=b.oembedPlaceHolder.outerHeight();a.utility.toggler.toggleOembedEditClasses(g,{isViewMode:a.utility.isViewMode(g),isEmbedInProgress:!0});c-=b.oembedPlaceHolder.outerHeight();a.utility.linkParser.removeFromSkipUrl(b.originalEmbedCode);return c},function(){a.utility.isViewMode(g)||a.utility.validateBulletinAndToggleControls(g)}));c.removeClass(this.utility.settings.CssClasses.OembedBoxLoading)};return d}();e.LightBulletinWatchEmbeds=f})(f.LightBulletin||
(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){var b=this;this.controls=a;this.modalDialog=window[this.dialogId];this.controls.OkButton.click(function(a){a.preventDefault();b.currentStrategy.persistDialogState()})}Object.defineProperty(b.prototype,"dialogId",{get:function(){return this.controls.Container.prop("id")},enumerable:!0,configurable:!0});b.prototype.openDialog=function(a){this.currentStrategy=a.strategy;this.modalDialog.openDialog(!1);this.currentStrategy.loadDialogState(this.controls,
a.strategicData)};return b}();e.ScheduleDialogManager=d})(e.ScheduleDialog||(e.ScheduleDialog={}))})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.settings=b;this.textExpander=a}d.prototype.renderShowMoreLink=function(b,a,c){var g=this;void 0===c&&(c=function(){});b.each(function(b,d){b=$(d);g.textExpander.renderShowMoreTextSection(g.findClickablePlaceholder(b),g.findCollapsibleTextContainer(b),g.findContent(b),a,c)})};d.prototype.renderShowMoreLinkOnEmbedResize=function(b){b=b.closest("[data-"+this.settings.DataAttributes.BulletinId+"]");0===b.find("."+this.settings.CssClasses.EditorTextarea).length&&
this.renderShowMoreIfNeeded(b,function(){})};d.prototype.renderShowMoreWithImagesHack=function(b,a,c,g){var d=this;b.find(a).one("load",function(a){return d.renderShowMoreIfNeeded($(a.currentTarget).closest(c),g)});this.renderShowMoreLink(b,!1,g)};d.prototype.findClickablePlaceholder=function(b){return this.findByDataAttribute(b,this.settings.DataAttributes.ClickablePlaceholder)};d.prototype.findCollapsibleTextContainer=function(b){return this.findByDataAttribute(b,this.settings.DataAttributes.CollapsibleTextContainer)};
d.prototype.renderShowMoreIfNeeded=function(b,a){var c=this.findClickablePlaceholder(b);c.is(":visible")&&!this.textExpander.isCollapsed(c)&&this.textExpander.hasEnoughHeightForRenderingShowMore(this.findContent(b))||this.renderShowMoreLink(b,!1,a)};d.prototype.findContent=function(b){return this.findByDataAttribute(b,this.settings.DataAttributes.Content)};d.prototype.findByDataAttribute=function(b,a){return b.find("[data-"+a+"]")};return d}();e.ShowMoreLinkRenderer=f})(f.LightBulletin||(f.LightBulletin=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.utility=b;this.settings=b.settings;this.modernInput=new CCL.ModernInput(this.settings.ModernInputCssClasses,this.settings.ModernInputDataAttributes)}d.prototype.validateEditorTextMaxLength=function(b,a){b=b.length;var c=b<=this.settings.TextMaxLength;this.modernInput.toggleTextError(a,this.createTextTooLongMessage(b),!c);return c};d.prototype.validateBulletin=function(b,a){var c=this.utility.embedAsynchronousLoader.isEmbedInProgress(a);b=
this.checkNotEmpty(b.val());var g=this.utility.hasVisibleOembedBox(a),d=this.utility.countResourcesOnUi(a),f=e.lightBulletinContentBlockInstance.isMultiCourseLightBulletin(a);return{canBePosted:!c&&(b||g),passedEmptyTextValidation:b||g&&!c,isEmbedInProgress:c,hasVisibleOembedBox:g,maxCountOfAddedElementsReached:d===e.LightBulletinConstants.maxCountOfAddedElements,hasAttachedElementLinks:0<d,hasVisibleImage:this.utility.hasVisibleImage(a),isMultiCourseLightBulletin:f}};d.prototype.toggleNoTextYetErrorMessage=
function(b,a){this.modernInput.toggleTextError(b,this.settings.Resources.NoTextYetError,!a.passedEmptyTextValidation)};d.prototype.checkNotEmpty=function(b){return 0<$.trim(b).length};d.prototype.createTextTooLongMessage=function(b){return CCL.CommonFunctions.formatString(this.settings.Resources.TextTooLongError,this.settings.TextMaxLength,b)};return d}();e.LightBulletinTextValidator=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(d){function b(a,b){d.call(this,a.Urls.CheckSession,a.Resources.AnErrorOccurred,b);this.settings=a}__extends(b,d);b.prototype.page=function(a,b,g){return $.ajax({type:"GET",url:this.settings.Urls.Page,data:{courseId:this.settings.CourseId,boundaryLightBulletinId:a,boundaryLightBulletinActiveFromTicks:b,displayMode:g}})};b.prototype.createLightBulletin=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.CreateLightBulletin,data:{inputData:a},
dataType:"html"})};b.prototype.updateLightBulletin=function(a){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.UpdateLightBulletin,data:{inputData:a},dataType:"json"})};b.prototype.getSchedule=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetSchedule,data:{lightBulletinId:a},dataType:"json"})};b.prototype.getCurrentDateTime=function(){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetCurrentDateTime,dataType:"json"})};b.prototype.getTimeSpan=
function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.GetTimeSpan,data:{schedule:a},dataType:"html"})};b.prototype.updateSchedule=function(a,b,g){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.UpdateSchedule,data:{lightBulletinId:a,schedule:b,bulletinsDisplayMode:g},dataType:"html"})};b.prototype.deleteLightBulletinPermanently=function(a,b){return CCL.CommonFunctions.safeAjax({type:"DELETE",url:b?this.settings.Urls.DeleteLightBulletinFromAllCoursesPermanently:
this.settings.Urls.DeleteLightBulletinPermanently,data:{bulletinId:a},dataType:"json"})};b.prototype.setBulletinCommentsAvailability=function(a,b){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.SetBulletinCommentsAvailability,data:{bulletinId:a,disableComments:b},dataType:"json"})};b.prototype.toggleLightBulletinSubscriptionForPerson=function(a,b){return CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,
subscribe:b},dataType:"json"})};b.prototype.embed=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.Embed,data:{embedUrl:a},dataType:"html"})};b.prototype.elementLinkItemsContent=function(a){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.ElementLinkItemsContent,data:{elementIds:a},dataType:"html"})};b.prototype.getBulletinElementLinksAnnouncementCompleted=function(a){return $.get(this.settings.Urls.IsBulletinElementLinksAnnouncementCompletedUrl+"?courseId="+
a)};b.prototype.uploadImage=function(a,b,g){return $.ajax({type:"PUT",url:this.settings.Urls.UploadImage+"?courseId="+a+"&lightBulletinId="+b,contentType:!1,processData:!1,dataType:"html",data:g})};b.prototype.callInsertOrUpdatePersonSettingService=function(a,b){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.Urls.InsertOrUpdateSetting,data:{name:a,value:b}})};return b}(f.CommonAjaxClient);e.LightBulletinAjaxClient=k})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var f=function(){function d(){}d.listenToEmbedSizePostmessages=function(b,a,c,g,d){CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentSize,function(e){var f=b.find("#"+e.oembedPlaceHolderId),h=f.hasClass(a)?f:f.find("."+a);e.height&&(h.css("height",e.height),c.renderShowMoreLinkOnEmbedResize(f),g.removeAjaxLoader(f.parent()),d&&d(f))})};return d}();e.EmbedResizer=f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){var k=f.Controls.MultipleCourseSearchSelector.MultipleCourseSearchSelector,d=function(){function b(a,b){var c=this;this.controls=a;this.settings=b;this.pendingEmbedProcessManager=new e.PendingEmbedProcessManager;this.embedBufferMap=new Map;this.renderShowMoreCallbackDebouncer=new CCL.CallbackDebouncer(function(a){return c.renderShowMoreInAddMode(a)});this.uploadImagePromiseQueue=new CCL.PromiseQueue;this.maskNavigationBarMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.maskNavigationBar);this.unmaskNavigationBarMessage=
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.unmaskNavigationBar);this.expandContentIframeMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame);this.collapseContentIframeMessage=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame);this.afterAddingComment=function(a){a=a.userData.sourceId;var b=c.utility.getBulletinById(a);c.singleItemDataManager.subscribeToCommentsIfNeeded(b,
a)};this.lightBulletinMenuClicked=function(a){var b=c.singleItemDataManager.getLightBulletinActionDropDownItem(a),g=c.utility.getBulletinById(b.LightBulletinId);switch(b.ActionType){case e.LightBulletinDropDownMenuActionType.Edit:c.appendBulletinEditor(c.editor.createBulletinEditor(g));c.toggleViewEditMode(g,!1);break;case e.LightBulletinDropDownMenuActionType.SetCommentsAvailability:var d=!c.singleItemDataManager.getSingleItemData(g).DisableComments;c.ajaxClient.setBulletinCommentsAvailability(b.LightBulletinId,
d).done(function(b){e.GenericResponseHandler.handle(b,function(){var b=c.singleItemDataManager.refreshSingleItemData(g,function(a){return a.DisableComments=d});c.commentToggler.togglePossibilityToAddComments(b,a,c.settings.AllowedToCommentAnnouncements)},function(){b.Code===e.GenericResponseCode.LightBulletinNotFound&&c.utility.removeBulletin(g)})}).fail(c.ajaxClient.handleAjaxError);c.resetFocusOnCurrentItem(g);break;case e.LightBulletinDropDownMenuActionType.ScheduleBulletin:e.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:c.ajaxStorageStrategy,
strategicData:{lightBulletinId:b.LightBulletinId,bulletinsDisplayMode:c.activationFilterCurrentValue,onSuccess:function(a){a=$(a);a.hasClass(c.settings.CssClasses.TimeSpan)?c.utility.getTimeSpan(g).replaceWith(a):(c.utility.removeBulletin(g),c.showInformationFeedback(a,c.settings.Resources.BulletinHasBeenEditedButDoesNotMatchFilter))}}});c.resetFocusOnCurrentItem(g);break;case e.LightBulletinDropDownMenuActionType.Delete:var f=void 0,h=c.utility.getCoursesContainer(g).find("li").length;f=1<h?c.settings.Resources.DeleteGroupConfirmationText.replace("{0}",
h.toString()):c.settings.Resources.DeleteConfirmationText;var k=[];k.push(new CCL.ConfirmButtonMetaData(0===h?c.settings.Resources.Delete:c.settings.Resources.DeleteFromThisCourse,c.settings.CssClasses.DeleteButton,"confirm_delete"));1<h&&k.push(new CCL.ConfirmButtonMetaData(c.settings.Resources.DeleteFromAllCourses,c.settings.CssClasses.DeleteButton,"confirm_delete_from_all"));k.push(new CCL.ConfirmButtonMetaData(c.settings.Resources.Cancel,"","confirm_cancel"));c.toggleDeleteConfirmationAdditionalStyles(!0);
CCL.CommonFunctions.jAjaxMultiButtonConfirm(f,c.settings.Resources.DeleteBulletin,k,function(a){c.toggleDeleteConfirmationAdditionalStyles(!1);!a||"confirm_delete"!==a.customId&&"confirm_delete_from_all"!==a.customId||(c.ajaxClient.deleteLightBulletinPermanently(b.LightBulletinId,"confirm_delete_from_all"===a.customId).done(function(a){return e.GenericResponseHandler.handle(a,function(){return c.utility.removeBulletin(g)},function(){a.Code===e.GenericResponseCode.LightBulletinNotFound&&c.utility.removeBulletin(g)})}).fail(c.ajaxClient.handleAjaxError),
c.setFocusOnPreviousItem(g))});break;case e.LightBulletinDropDownMenuActionType.ToggleSubscription:var u=c.singleItemDataManager.getSingleItemData(g).SubscriptionStatus!==e.PersonSubscriptionStatus.Subscribed;c.ajaxClient.toggleLightBulletinSubscriptionForPerson(b.LightBulletinId,u).done(function(b){return e.GenericResponseHandler.handle(b,function(){return c.singleItemDataManager.updateSubscriptionStatus(g,a,u)},function(){b.Code===e.GenericResponseCode.LightBulletinNotFound&&c.utility.removeBulletin(g)})}).fail(c.ajaxClient.handleAjaxError);
c.resetFocusOnCurrentItem(g);break;case e.LightBulletinDropDownMenuActionType.ImmersiveReader:window.fetch("/restapi/personal/immersivereader/v1?ResourceType=Bulletin&ResourceId="+b.LightBulletinId).then(function(a){if(a.ok)a.json().then(function(a){window.ImmersiveReader.launchAsync(a.AccessToken,a.SubDomain,{title:a.Title,chunks:[{content:a.Text}]},{uiZIndex:1E6})});else throw Error(a.statusText);})}};this.toggleMobileMode=function(a){CCL.CommonFunctions.makePostMessageCall(window.parent,a?c.expandContentIframeMessage:
c.collapseContentIframeMessage);IframeResizer.reportSetIframeDefaultHeight()};this.onDeleteImageButtonClick=function(a){a=$(a.target);var b=c.utility.getCurrentBulletinItemOrNew(c.utility.findBulletinItemByChild(a));c.utility.imageBox.hideOrRemoveImageBox(a.closest("."+c.settings.CssClasses.ImageBox));c.utility.imageBox.clearAddImageButtonFileInputValue(b);c.focusOnTextArea(b);c.utility.validateBulletinAndToggleControls(b)};this.checkInputForEmbedUrl=function(a){c.watchEmbeds.stopWatchEmbeds(a);var b=
c.utility.findBulletinItemByChild(a),g=c.utility.getCurrentBulletinItemOrNew(b),d=c.utility.isAddMode(b)?a.closest(c.selectors.mediaAppendTarget):b.find(c.selectors.mediaAppendTarget);if(!c.utility.hasVisibleOembedBox(d)&&0===c.utility.countResourcesOnUi(b)){var f=c.utility.linkParser.getFirstLink(a.val());if(f&&f.length<=c.settings.EmbedUrlMaxLength){c.toggler.toggleBulletinAttachmentButtons(b,!1);c.toggler.toggleAddEditButton(b,!1);c.utility.imageBox.removeImageError(g);var h=c.embedAsynchronousLoader.createAjaxLoader();
d.append(h);var k=c.pendingEmbedProcessManager.createProcess(c.ajaxClient.embed(f));h.data(e.LightBulletinConstants.dataAttributeNames.pendingProcessId,k.processId);k.ajaxRequest.done(function(a){a=$(a);d.append(a);a=c.embedAsynchronousLoader.findIframeHolders(a);var b=c.embedAsynchronousLoader.createIframe(c.embedAsynchronousLoader.getEmbedIframeUrl(a),!0);a.append(b);a.data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId,k.processId);c.pendingEmbedProcessManager.clearProcessAjaxRequest(k)}).fail(function(m){h.remove();
k.pendingStatus!==e.PendingProcessStatus.Aborted&&(c.pendingEmbedProcessManager.setProcessFailed(k),c.ajaxClient.handleAjaxError(m),c.watchEmbeds.watchEmbeds(a),c.watchEmbeds.shouldAppendOembedError({originalEmbedCode:f,oembedPlaceHolder:d})&&c.watchEmbeds.appendOembedError({originalEmbedCode:f,oembedPlaceHolder:d}),c.toggler.toggleOembedEditClasses(g,{isViewMode:!1,isEmbedInProgress:!0}),c.utility.validateBulletinAndToggleControls(b))})}else c.watchEmbeds.watchEmbeds(a)}};e.lightBulletinContentBlockInstance=
this;this.utility=new e.LightBulletinUtility(a,b,this.checkInputForEmbedUrl,function(){return c.formCheckBeforeUnload.DetachHandler()});this.watchEmbeds=this.utility.watchEmbeds;this.selectors=this.utility.selectors;this.editor=this.utility.editor;this.toggler=this.utility.toggler;this.embedAsynchronousLoader=this.utility.embedAsynchronousLoader;this.textValidator=this.utility.textValidator;this.commentToggler=this.utility.commentToggler;this.ajaxClient=this.utility.ajaxClient;this.elementLinkBuilder=
this.utility.elementLinkBuilder;this.singleItemDataManager=this.utility.singleItemDataManager;if(this.settings.CanAddNewBulletins||this.settings.HasOwnBulletin)this.scheduleDialogInputValidator=new e.ScheduleDialogInputValidator(this.utility),this.temporaryStorageStrategy=new e.ScheduleDialogTemporaryStorageStrategy(this.utility,this.scheduleDialogInputValidator),this.ajaxStorageStrategy=new e.ScheduleDialogAjaxStorageStrategy(this.utility,this.scheduleDialogInputValidator);this.boundaryLightBulletinId=
this.settings.InitialPageData.BoundaryLightBulletinId;this.boundaryLightBulletinActiveFromTicks=this.settings.InitialPageData.BoundaryLightBulletinActiveFromTicks;this.activationFilterCurrentValue=this.settings.BulletinsDisplayMode;this.setupFormCheckBeforeUnload();this.setupControls();this.setupControlsEvents();this.setupEventListeners();this.setupGhostBulletin()}b.prototype.isMultiCourseLightBulletin=function(a){return 0<this.utility.getBulletinId(a)?this.singleItemDataManager.getSingleItemData(a).IsMultiCourseLightBulletin:
this.postedToCoursesInNewBulletin&&0<this.postedToCoursesInNewBulletin.length};b.prototype.onActivationFilterChanged=function(a){this.activationFilterCurrentValue=parseInt(a,10);this.ajaxClient.callInsertOrUpdatePersonSettingService(this.settings.BulletinsContentBlockDisplayModePersonSettingName,a).done(WidgetLayout._reloadWindow)};b.prototype.setFocusOnPreviousItem=function(a){var b=$(this.controls.Container).children();a=b.index(a.parent().first());0<a&&a--;$(b[a]).find(".itsl-light-bulletins-person-name > a").first().focus()};
b.prototype.resetFocusOnCurrentItem=function(a){$(a).find(".itsl-light-bulletins-person-name > a").first().focus()};b.prototype.toggleDeleteConfirmationAdditionalStyles=function(a){this.adjustDialogPositionOnIosDevice(a);CCL.CommonFunctions.isPhoneScreenSize()?this.toggleMobileMode(a):CCL.CommonFunctions.makePostMessageCall(window.parent,a?this.maskNavigationBarMessage:this.unmaskNavigationBarMessage);$.alerts.dialogClass=a?this.settings.DeleteConfirmationStyle.DialogCssClass:""};b.prototype.adjustDialogPositionOnIosDevice=
function(a){CCL.CommonFunctions.isIosDevice()&&$("body").toggleClass(this.settings.CssClasses.BodyIosPositioningFix,a)};b.prototype.focusOnTextArea=function(a){this.utility.editor.getBulletinEditor(a).focus()};b.prototype.uploadImage=function(a){var b=this,g=$(a.target).closest(this.utility.selectors.addImageButton);if(!g.prop("disabled")){var d=f.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a.target).formData;if(d){var e=this.utility.findBulletinItemByChild(g),l=this.utility.isAddMode(e)?
g.closest(this.selectors.mediaAppendTarget):e.find(this.selectors.mediaAppendTarget),k=this.utility.getCurrentBulletinItemOrNew(e);this.utility.imageBox.hideOrRemoveImageBoxFromContainer(l);this.utility.imageBox.removeImageError(l);this.watchEmbeds.stopWatchEmbedsInBulletinItem(e);this.toggler.toggleResourceButton(e,!1);this.toggler.toggleAddImageButton(e,!1);l.append(this.embedAsynchronousLoader.createAjaxLoader());this.uploadImagePromiseQueue.enqueue(function(){return b.ajaxClient.uploadImage(b.settings.CourseId,
b.utility.getBulletinId(e),d).always(function(){b.editor.getBulletinEditor(e).focus();b.embedAsynchronousLoader.removeAjaxLoader(l)}).done(function(a){b.utility.isViewMode(k)||b.utility.hasVisibleImage(k)||(l.append($(a)),b.utility.validateBulletinAndToggleControls(e),b.utility.imageBox.applyNewImageLoadingComplete(l),0<b.utility.getImageError(k).length&&b.utility.imageBox.clearAddImageButtonFileInputValue(k))}).fail(function(a){b.utility.validateBulletinAndToggleControls(e);b.utility.imageBox.clearAddImageButtonFileInputValue(k);
b.ajaxClient.handleAjaxError(a)})})}}};b.prototype.setupEventListeners=function(){this.listenToEmbedPostmessages();this.listenToEmbedSizePostmessages()};b.prototype.setupControls=function(){var a=this;this.loadEmbedContent(this.controls.Container);this.setupShowMoreLink();this.utility.linkifyTextNodes(this.controls.Container);this.settings.CanAddNewBulletins&&this.setupEditorAndApplyButton({editor:this.controls.NewBulletinText,applyButton:this.controls.PostNewBulletin},function(){return a.createLightBulletin()},
function(){return a.resetUnsavedTextInAddMode()});this.commentToggler.resetCommentsDisabledForNewBulletins();this.controls.NewBulletinItem.length&&this.utility.validateBulletinAndToggleControls(this.controls.NewBulletinItem)};b.prototype.setupFormCheckBeforeUnload=function(){var a=this;if(this.settings.CanAddNewBulletins){CCL.DialogWhiteList.allowDialogWithId(f.ElementLinkDialog.elementLinkDialogManagerInstance.getDialogId());CCL.DialogWhiteList.allowDialogWithId(e.ScheduleDialog.ScheduleDialogManager.instance.dialogId);
CCL.DialogWhiteList.allowDialogWithId(k.instance.dialogId);var b={enabled:!0,clearStateCallback:function(){a.resetUnsavedTextInAddMode();a.utility.imageBox.resetUnsavedImage(a.controls.NewBulletinItem);a.resetUnsavedEmbed(a.controls.NewBulletinItem,0,{preserveAjaxLoader:!1});a.elementLinkBuilder.resetUnsavedElementLinks(0,a.controls.NewBulletinItem);a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);a.textValidator.validateEditorTextMaxLength("",a.controls.NewBulletinItem);a.controls.Container.find(a.selectors.bulletinItem).each(function(b,
c){b=$(c);a.utility.isViewMode(b)||a.cancelEditMode(a.editor.getBulletinEditorInstance(b))})}}}else b={enabled:!1,clearStateCallback:function(){}};this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.Container.closest("form"),this.settings.Resources.FormBeforeUnloadWarning,{callback:function(){return a.isAddingEditingBulletinsNotFinished()},whiteList:b})};b.prototype.setupShowMoreLink=function(){var a=this;this.showMoreRenderer=new e.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,
this.utility.textExpander);this.renderShowMoreWithImagesHack(this.controls.Container.find(this.selectors.bulletinItem));this.controls.Container.find(this.selectors.bulletinItem).each(function(b,g){b=$(g);e.LightBulletinUtility.setTabindexToHiddenElements(b,a.showMoreRenderer.findClickablePlaceholder(b),"."+a.settings.CssClasses.ElementLink)})};b.prototype.renderShowMoreWithImagesHack=function(a){var b=this;this.showMoreRenderer.renderShowMoreWithImagesHack(a,"[data-"+this.settings.DataAttributes.BulletinAttachedImage+
"]",this.utility.selectors.bulletinItem,function(a,c){e.LightBulletinUtility.setTabindexToHiddenElements(a,c,"."+b.settings.CssClasses.ElementLink)})};b.prototype.loadEmbedContent=function(a){this.embedAsynchronousLoader.appendIframeHolders(a);this.embedAsynchronousLoader.loadEmbedContentAsync()};b.prototype.setupControlsEvents=function(){var a=this;this.controls.ShowMoreLink.click(function(b){a.controls.ShowMoreLink.hide();a.ajaxClient.page(a.boundaryLightBulletinId,a.boundaryLightBulletinActiveFromTicks,
a.settings.BulletinsDisplayMode).done(function(b){var c=void 0;b=0<$.trim(b).length?(c=$(b)).filter("[data-"+a.settings.DataAttributes.PageData+"]"):$();if(0<b.length&&c){var g=b.data(a.settings.DataAttributes.PageData);a.utility.linkifyTextNodes(c);a.controls.Container.append(c);b.remove();a.renderShowMoreWithImagesHack(c.find(a.selectors.bulletinItem));a.boundaryLightBulletinId=g.BoundaryLightBulletinId;a.boundaryLightBulletinActiveFromTicks=g.BoundaryLightBulletinActiveFromTicks;a.controls.ShowMoreLink.toggle(g.NeedToShowMore);
a.loadEmbedContent(c)}}).fail(a.ajaxClient.handleAjaxError);b.preventDefault()});this.controls.Container.on("click","."+this.settings.CssClasses.OembedDelete,function(b){return a.lightBulletinDeleteEmbedClicked(b)});this.controls.Container.on("click",this.selectors.addResourceAction,function(b){b=$(b.target);if(!b.closest(a.selectors.addResourceAction).prop("disabled")){var c=a.utility.findBulletinItemByChild(b),d=a.utility.getCurrentBulletinItemOrNew(c);b=function(){a.watchEmbeds.stopWatchEmbedsInBulletinItem(c);
a.toggler.toggleAddImageButton(c,!1);a.toggler.toggleResourceButton(c,!0);var b=a.utility.getVisibleOembedBox(d);a.embedAsynchronousLoader.removeAjaxLoader(b.closest(a.selectors.mediaAppendTarget));a.removeOembedBox(b,c);a.utility.imageBox.removeImageError(d)};var e=function(){a.watchEmbeds.watchEmbedsInBulletinItem(c);a.toggler.toggleAddImageButton(c,!0)};if(!a.utility.hasVisibleOembedBox(d))a.elementLinkBuilder.onResourceButtonClick(a.utility.getBulletinId(c),d,e,b,function(){a.utility.validateBulletinAndToggleControls(c)})}});
this.controls.Container.on("click","a."+this.settings.CssClasses.ElementLinkDelete,function(b){b=$(b.currentTarget).closest("."+a.settings.CssClasses.ElementLinkListItem);var c=a.utility.findBulletinItemByChild(b);a.elementLinkBuilder.onDetachResourceButtonClick(a.utility.getBulletinId(c),c,b,function(){a.focusOnTextArea(c);a.utility.validateBulletinAndToggleControls(c)})});this.controls.Container.on("click","."+this.settings.CssClasses.ImageDelete,this.onDeleteImageButtonClick);this.controls.Container.on("click",
this.utility.selectors.addImageButtonFileInput,function(b){var c=a.utility.getCurrentBulletinItemOrNew(a.utility.findBulletinItemByChild($(b.target)));a.utility.hasVisibleImage(c)&&!confirm(a.settings.Resources.ReloadImageConfirmation)&&b.preventDefault()});this.controls.Container.on("change",this.utility.selectors.addImageButtonFileInput,function(b){return a.uploadImage(b)});this.controls.Container.on("keyup",this.utility.selectors.addImageButton,function(b){b.which===CCL.CommonConstants.keyCodes.enter&&
a.clickOnFileInputInsideAddImageButton($(b.target))});this.controls.Container.on("click",this.utility.selectors.addImageButton,function(b){return a.clickOnFileInputInsideAddImageButton($(b.target))});this.utility.controls.AddMenu.Menu.on(this.utility.settings.IsIosDevice?"touchstart":"click","a, button",function(b){b.preventDefault();b=b.currentTarget;switch(b){case a.utility.controls.AddMenu.ToggleCommentsOptionButton.get(0):a.commentToggler.areCommentsDisabledForNewBulletins=!a.commentToggler.areCommentsDisabledForNewBulletins;
break;case a.utility.controls.AddMenu.ScheduleOptionButton.get(0):e.ScheduleDialog.ScheduleDialogManager.instance.openDialog({strategy:a.temporaryStorageStrategy,strategicData:{onSuccess:function(b){a.utility.getTimeSpan(a.utility.controls.NewBulletinItem).remove();a.utility.getAuthorContainer(a.utility.controls.NewBulletinItem).append($(b))}}});break;case a.utility.controls.AddMenu.AddToOtherCoursesButton.get(0):b=$(b);if(b.prop("disabled"))return;var c=a.utility.findBulletinItemByChild(b),d=a.utility.getCurrentBulletinItemOrNew(c);
k.instance.openDialog(a.postedToCoursesInNewBulletin,function(){CssModal.closeDialog();a.setPostedToCourses(d,f.Controls.MultipleCourseSearchSelector.multipleCourseSearchSelectorDialogClientInstance.selectedCourses);a.utility.validateBulletinAndToggleControls(c)})}a.resetFocusOnCurrentItem(a.utility.controls.NewBulletinItem)});this.singleItemDataManager.registerDropDownMenuClickHandler(this.utility.settings.IsIosDevice,this.lightBulletinMenuClicked)};b.prototype.clickOnFileInputInsideAddImageButton=
function(a){a.prop("disabled")||a.find(this.utility.selectors.addImageButtonFileInput).click()};b.prototype.setPostedToCourses=function(a,b){this.postedToCoursesInNewBulletin=b;a=this.utility.getCoursesContainer(a);a.empty();if(b&&0<b.length){var c=$('<ul class="'+this.settings.CssClasses.CoursesList+'"></ul>');c.append("<li>"+this.settings.CourseTitle+"</li>");b.map(function(a){return a.Title}).sort(function(a,b){a=a?a.toLowerCase():"";b=b?b.toLocaleLowerCase():"";return a<b?-1:a>b?1:0}).forEach(function(a){c.append("<li>"+
CCL.CommonFunctions.htmlEncode(a)+"</li>")});a.append(c)}this.utility.controls.AddMenu.AddToOtherCoursesSpan.text(this.postedToCoursesInNewBulletin&&0<this.postedToCoursesInNewBulletin.length?this.utility.settings.Resources.EditListOfCourses:this.utility.settings.Resources.AddToOtherCourses)};b.prototype.listenToEmbedPostmessages=function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var c=a.controls.Container.find("#"+
b.oembedPlaceHolderId),d=a.utility.findBulletinItemByChild(c),f={originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:c},l=a.embedAsynchronousLoader.findIframeHolders(c),k=l.data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId),n=a.pendingEmbedProcessManager.getProcessById(k);b.isPlainLink||0<a.utility.countResourcesOnUi(d)||c.data(a.settings.DataAttributes.OembedIsNew)&&a.utility.isViewMode(d)||n&&n.pendingStatus===e.PendingProcessStatus.Aborted?(a.controls.Container.removeClass(a.settings.CssClasses.OembedBoxLoading),
a.embedAsynchronousLoader.removeAjaxLoader(c.closest(a.selectors.mediaAppendTarget)),c.removeClass(a.settings.CssClasses.OembedContent),b.isPlainLink&&a.utility.linkParser.skipUrl(b.originalEmbedCode),a.watchEmbeds.shouldAppendOembedError(f)?(a.embedBufferMap.set(a.utility.getBulletinId(d),f),a.watchEmbeds.appendOembedError(f),a.showMoreRenderer.renderShowMoreLink(d,!1)):c.remove(),k&&(a.pendingEmbedProcessManager.removeProcessById(k),l.removeData(e.LightBulletinConstants.dataAttributeNames.loadedProcessId))):
(a.embedBufferMap.set(a.utility.getBulletinId(d),f),c.removeClass(a.settings.CssClasses.OembedBoxLoading),c.data(a.settings.DataAttributes.OembedIsNew)&&(a.embedAsynchronousLoader.removeAjaxLoader(c.closest(a.selectors.mediaAppendTarget)),c.find("."+a.settings.CssClasses.OembedBoxHeader).show()),a.toggler.toggleOembedEditClasses(d,{isViewMode:a.utility.isViewMode(d),isEmbedInProgress:!1}));a.utility.validateBulletinAndToggleControls(d)})};b.prototype.listenToEmbedSizePostmessages=function(){var a=
this;e.EmbedResizer.listenToEmbedSizePostmessages(this.controls.Container,this.settings.CssClasses.OembedContent,this.showMoreRenderer,this.embedAsynchronousLoader,function(b){var c=a.utility.findBulletinItemByChild(b);a.utility.isViewMode(c)||a.utility.validateBulletinAndToggleControls(c);b=a.embedAsynchronousLoader.findIframeHolders(b);if(c=b.data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId))a.pendingEmbedProcessManager.removeProcessById(c),b.removeData(e.LightBulletinConstants.dataAttributeNames.loadedProcessId)})};
b.prototype.lightBulletinDeleteEmbedClicked=function(a){var b=$(a.target);a=this.utility.findBulletinItemByChild(b);b=b.closest("."+this.settings.CssClasses.OembedBox+":visible");this.removeOembedBox(b,a,b.data(this.settings.DataAttributes.OembedIsNew));this.focusOnTextArea(a);this.utility.validateBulletinAndToggleControls(a)};b.prototype.toggleViewEditMode=function(a,b){var c=a.find("[data-"+this.settings.DataAttributes.Text+"]"),d=this.showMoreRenderer.findClickablePlaceholder(a);b||this.utility.textExpander.expand(this.showMoreRenderer.findCollapsibleTextContainer(a),
d);c.toggle(b&&0<c.html().length);d.toggle(b);e.LightBulletinUtility.setTabindexToHiddenElements(a,d,"."+this.settings.CssClasses.ElementLink);a.find("."+this.settings.CssClasses.ListItemAction).toggle(b);this.toggler.toggleOembedEditClasses(a,{isViewMode:b,isEmbedInProgress:this.embedAsynchronousLoader.isEmbedInProgress(a)});b||this.utility.validateBulletinAndToggleControls(a);a.find("."+this.settings.CssClasses.ElementLinkDelete).toggle(!b);a.find("."+this.utility.settings.CssClasses.ImageBoxHeader).toggle(!b);
a.find("."+this.settings.CssClasses.ImageBox).toggleClass(this.settings.CssClasses.ImageBoxEditMode,!b)};b.prototype.isAddingEditingBulletinsNotFinished=function(){return this.isPostingNewBulletin()||0<this.controls.NewBulletinItem.find("li[data-"+this.settings.DataAttributes.ElementLinkElementId+"]").length||this.utility.imageBox.addImageButtonFileInputHasValue(this.controls.NewBulletinItem)||0<this.controls.Container.find(this.selectors.applyEditAction).length};b.prototype.isPostingNewBulletin=
function(){return this.settings.CanAddNewBulletins&&(!this.controls.PostNewBulletin.prop("disabled")||this.textValidator.checkNotEmpty(this.controls.NewBulletinText.val()))};b.prototype.createLightBulletin=function(){var a=this,b=this.controls.NewBulletinText.val(),g=this.embedBufferMap.get(0);g=g?g.originalEmbedCode:void 0;this.removeOembedBox(this.utility.getOembedBox(this.controls.NewBulletinItem),this.controls.NewBulletinItem);var d=this.elementLinkBuilder.getElementIdsForBulletin(0),m=this.postedToCoursesInNewBulletin?
this.postedToCoursesInNewBulletin.map(function(a){return a.CourseId}):[];b={CourseId:this.settings.CourseId,AdditionalCourseIds:m,Text:b,EmbedUrl:g,DisableComments:this.commentToggler.areCommentsDisabledForNewBulletins,ElementIdsToAttach:d.elementsToAttach,UploadResult:this.utility.imageBox.getParsedUploadResult(this.controls.NewBulletinItem),Schedule:{ActiveFrom:this.temporaryStorageStrategy.activeFrom,ActiveTo:this.temporaryStorageStrategy.activeTo},BulletinsDisplayMode:this.activationFilterCurrentValue};
this.controls.PostNewBulletin.prop("disabled",!0);this.resetUnsavedTextInAddMode();this.ajaxClient.createLightBulletin(b).done(function(b){if(b){var c=$(b);if(c.is(":visible")){a.utility.controls.GhostArrow.parent().remove();var g=$("<li style='display:none;'>"+b+"</li>").addClass(a.settings.CssClasses.ListItem).addClass(a.settings.CssClasses.PositionRelative);a.utility.linkifyTextNodes(g);a.controls.NewBulletinItem.after(g);a.utility.animator.animateShow(g);a.renderShowMoreInAddMode(g);a.utility.getImage(g).one("load",
function(){a.renderShowMoreInAddMode(g);a.renderShowMoreCallbackDebouncer.invokeCallback(g,e.LightBulletinConstants.renderShowMoreDelayInMilliseconds)}).each(function(){this.complete&&$(this).load()});b=a.embedAsynchronousLoader.findIframeHolders(g);0<b.length&&(c=a.embedAsynchronousLoader.createAjaxLoader(),g.find(a.selectors.mediaAppendTarget).append(c),b.append(a.embedAsynchronousLoader.createIframe(a.embedAsynchronousLoader.getEmbedIframeUrl(b),!0)))}else a.showInformationFeedback(c,a.settings.Resources.BulletinHasBeenCreatedButDoesNotMatchFilter)}a.elementLinkBuilder.cleanAppendData(0,
void 0);a.temporaryStorageStrategy.resetStorage();a.commentToggler.resetCommentsDisabledForNewBulletins();a.toggler.toggleAddBulletinMenu(!1);a.setPostedToCourses(a.controls.NewBulletinItem,[]);f.Controls.MultipleCourseSearchSelector.multipleCourseSearchSelectorDialogClientInstance.clear();a.utility.getVisibleImageBox(a.controls.NewBulletinItem).remove();a.utility.imageBox.clearAddImageButtonFileInputValue(a.controls.NewBulletinItem);a.utility.imageBox.removeImageError(a.controls.NewBulletinItem);
a.utility.getElementLinkList(a.controls.NewBulletinItem).remove();a.utility.validateBulletinAndToggleControls(a.controls.NewBulletinItem);a.utility.getTimeSpan(a.controls.NewBulletinItem).remove()}).fail(function(b){a.controls.PostNewBulletin.prop("disabled",!0);a.ajaxClient.handleAjaxError(b)})};b.prototype.showInformationFeedback=function(a,b){var c=this,d=a.data(this.settings.DataAttributes.InformationFeedbackButtonText),e=a.data(this.settings.DataAttributes.ActivationFilterValueToShowBulletin);
CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.InformationFeedbackMainContainer,b,d,function(){CCL.InformationFeedback.hideFeedback(c.controls.InformationFeedbackMainContainer);c.onActivationFilterChanged(e)})};b.prototype.renderShowMoreInAddMode=function(a){var b=this;this.showMoreRenderer.renderShowMoreLink(a,!0,function(a,c){e.LightBulletinUtility.setTabindexToHiddenElements(a,c,"."+b.settings.CssClasses.ElementLink)})};b.prototype.setupEditorAndApplyButton=function(a,b,g){var c=
this,d=!0,f=this.utility.getCurrentBulletinItemOrNew(this.utility.findBulletinItemByChild(a.editor)),k=function(g){d&&!a.applyButton.prop("disabled")&&(g=c.utility.validateBulletinAndToggleControls(f),c.textValidator.toggleNoTextYetErrorMessage(f,g),g.canBePosted?b():a.editor.focus())};f.data(e.LightBulletinEditor.bulletinEditorDataAttribute,a.editor);a.applyButton.click(k);this.editor.makeEditorAutoResizable(a.editor);this.editor.resetEditor(a.editor,!1);a.editor.keyup(function(a){a.which===CCL.CommonConstants.keyCodes.escape?
(g(),d=c.textValidator.validateEditorTextMaxLength("",f)):a.ctrlKey&&a.which===CCL.CommonConstants.keyCodes.enter&&k(a)}).on("input paste remove",function(b){d=c.textValidator.validateEditorTextMaxLength("remove"===b.type?"":a.editor.val(),f);c.utility.isAddMode(f)&&c.utility.validateBulletinAndToggleControls(f)});this.utility.validateBulletinAndToggleControls(f)};b.prototype.appendBulletinEditor=function(a){var b=this,g=a.bulletinItem.find("[data-"+this.settings.DataAttributes.Text+"]"),d=g.attr("data-"+
this.settings.DataAttributes.Text);a.editor.val(d);a.bulletinItem.find("[data-"+this.settings.DataAttributes.BulletinItemEditorTarget+"]").append(a.editor);a.bulletinItem.find("[data-"+this.settings.DataAttributes.BulletinItemEditorButtonsTarget+"]").append(a.editorButtons);a.editor.focus();this.setupEditorAndApplyButton(a,function(){var c=b.embedBufferMap.get(a.bulletinId),d=b.elementLinkBuilder.getElementIdsForBulletin(a.bulletinId);b.ajaxClient.updateLightBulletin({BulletinId:a.bulletinId,Text:a.editor.val(),
EmbedUrl:c?c.originalEmbedCode:void 0,ElementIdsToAttach:d.elementsToAttach,ElementIdsToDetach:d.elementsToDetach,UploadResult:b.utility.imageBox.getParsedUploadResult(a.bulletinItem),DeleteAttachedImage:b.utility.imageBox.getDeleteAttachedImageValue(a.bulletinItem)}).done(function(c){e.GenericResponseHandler.handle(c,function(){b.utility.getHiddenOembedBox(a.bulletinItem).remove();var d=c.ResponseData;b.embedAsynchronousLoader.removeAjaxLoader(a.bulletinItem);a.removeBulletinEditor();g.html(d.OutputText).attr("data-"+
b.settings.DataAttributes.Text,d.DataAttributeText);b.utility.getVisibleOembedBox(a.bulletinItem).data(b.settings.DataAttributes.OembedIsNew,!1);b.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0,function(a,c){e.LightBulletinUtility.setTabindexToHiddenElements(a,c,"."+b.settings.CssClasses.ElementLink)});b.toggleViewEditMode(a.bulletinItem,!0);b.utility.linkifyNodes(g);b.elementLinkBuilder.cleanAppendData(a.bulletinId,a.bulletinItem);b.utility.imageBox.applyImageEditsIfNeeded(a.bulletinItem,
d.LargeImageUrl)},function(){b.cancelEditMode(a);c.Code===e.GenericResponseCode.LightBulletinNotFound&&b.utility.removeBulletin(a.bulletinItem)})}).fail(function(c,g,d){b.cancelEditMode(a);b.ajaxClient.handleAjaxError(c)})},function(){return b.cancelEditMode(a)});a.cancelButton.click(function(){b.cancelEditMode(a)})};b.prototype.resetUnsavedTextInAddMode=function(){this.editor.resetEditor(this.controls.NewBulletinText.val(""),!0)};b.prototype.cancelEditMode=function(a){var b=this;this.resetUnsavedEmbed(a.bulletinItem,
a.bulletinId,{preserveAjaxLoader:!0});this.utility.imageBox.resetUnsavedImage(a.bulletinItem);a.removeBulletinEditor();this.editor.removeBulletinEditorInstanceDataAttribute(a.bulletinItem);this.toggleViewEditMode(a.bulletinItem,!0);this.showMoreRenderer.renderShowMoreLink(a.bulletinItem,!0,function(a,c){e.LightBulletinUtility.setTabindexToHiddenElements(a,c,"."+b.settings.CssClasses.ElementLink)});this.elementLinkBuilder.resetUnsavedElementLinks(a.bulletinId,a.bulletinItem)};b.prototype.resetUnsavedEmbed=
function(a,b,g){var c=this.utility.getVisibleOembedBox(a),d=this.embedAsynchronousLoader.findIframeHolders(c).data(e.LightBulletinConstants.dataAttributeNames.loadedProcessId)||this.embedAsynchronousLoader.findAjaxLoader(a).data(e.LightBulletinConstants.dataAttributeNames.pendingProcessId);d&&this.pendingEmbedProcessManager.cancelProcess(d);(d=c.data(this.settings.DataAttributes.OembedIsNew))&&this.removeOembedBox(c,a);c=this.utility.getHiddenOembedBox(a);if(0<c.length){c.show();var f=c.data(this.settings.DataAttributes.OembedUrl);
this.embedBufferMap.set(b,{oembedPlaceHolder:c,originalEmbedCode:f})}g.preserveAjaxLoader&&!d||this.embedAsynchronousLoader.removeAjaxLoader(a)};b.prototype.removeOembedBox=function(a,b,g){void 0===g&&(g=!0);if(0<a.length){var c=this.embedBufferMap.get(this.utility.getBulletinId(b));c&&a.data(this.settings.DataAttributes.OembedUrl,c.originalEmbedCode);g?a.remove():a.hide();this.embedBufferMap.delete(this.utility.getBulletinId(b))}};b.prototype.setupOnboardingFeatures=function(){var a=this;this.settings.CanAddNewBulletins&&
this.ajaxClient.getBulletinElementLinksAnnouncementCompleted(this.settings.CourseId).done(function(b){b&&a.setupElementLinksAnnouncementContextDialog(b)}).fail(this.ajaxClient.handleAjaxError)};b.prototype.setupGhostBulletin=function(){var a=this;if(this.settings.HasGhostBulletin){var b=new CCL.CallbackDebouncer(function(){var b=a.controls.GhostArrow;if(0===b.length)$(window).off("resize",g);else{var c=b.next(),d=a.utility.controls.PostNewBulletin;b.css({height:c.position().top-5,width:c.position().top/
2,left:d.position().left+d.width()/2});b.show()}});var g=function(){return b.invokeCallback(null,300)};g();$(window).on("resize",g)}};b.prototype.setupElementLinksAnnouncementContextDialog=function(a){var b=this,g=$(this.selectors.addResourceAction);if(g.is(":visible")){g.after(a);var d="#"+this.utility.settings.ElementLinksAnnouncementContainerClientId,e=new ContextDialog(d,{marginTop:g.height(),marginLeft:(g.width()-420)/2,valign:"bottom",width:420,zIndex:1,blackThemeActivated:!0,closeWithOutsideClick:!1,
showHeader:!1,showCloseLink:!1,scrollToLastWindowOnClose:!1,useMobileViewIfNeeded:!1,allowAccessToParentWindow:!1,expandParentFrame:!1});this.controls.Container.on("click",d+","+this.selectors.addResourceAction,function(){$(d).is(":visible")&&e.closeDialog()});var f,k=function(){if(CCL.CommonFunctions.isOnScreen(g,.5,.5,b.utility.settings.IsIosDevice?window.parent:window)){var a=g.position().left+g.width()/2+10,c=g.position().top+10;e.openDialogAt(a,c,!1);return!0}return!1};if(!(f=k()))$(window).on(this.utility.settings.IsIosDevice?
"touchmove":"scroll",function(){f||k()})}else setTimeout(this.setupElementLinksAnnouncementContextDialog,50)};return b}();e.LightBulletinContentBlock=d})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.utility=b}d.prototype.folderContent=function(b){return $.ajax({type:"GET",url:this.utility.settings.Urls.FolderContent,data:b,dataType:"html"})};return d}();e.ElementLinkDialogAjaxClient=f})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k;(function(b){b[b.Expanded=1]="Expanded";b[b.Collapsed=2]="Collapsed";b[b.Loading=3]="Loading"})(k||(k={}));var d=function(){function b(a,b){var c=this;this.controls=a;this.settings=b;this.inputTypeCheckboxSelector="input:checkbox";this.updateElementStateAndToggleOkButtonEnabled=function(a){var b=$(a.target);a=c.utility.closestElementItem(b);b=c.updateElementState(a,b.is(":checked"));c.controls.OkButton.prop("disabled",!c.currentParams.allowEmptySubmit&&(0===b||b>c.currentParams.maxCountOfAddedElements));
a.find(c.inputTypeCheckboxSelector).first().focus();if(c.currentParams.disallowMultipleSelection){var g=c.utility.getElementId(a);a=c.getCheckedElements();if(1<a.length){var d=[];$.each(a,function(a,b){b!==g&&d.push(b)});a=c.utility.getCheckbox(d[0]);a.prop("checked",!1);a.trigger("change")}}};this.utility=new e.Utility(a,b);this.modalDialog=window[this.getDialogId()];this.ajaxClient=new e.ElementLinkDialogAjaxClient(this.utility);this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler();
this.setupOkButtonClickHandler();this.modalDialog.setCustomScripts({afterOpenDialogAjaxDynamicallySuccess:function(){return c.onFolderContentLoaded()},afterCloseDialog:function(){void 0!==c.currentParams.afterCloseDialogCallback&&c.currentParams.afterCloseDialogCallback()}});this.preventExternalFormSubmitAndMakeSaveOnEnterKey()}b.prototype.openDialog=function(a,b){this.currentParams=a;$.extend(b,{elementType:this.currentParams.elementType,showAll:this.currentParams.showAll});this.ajaxParams=b;this.currentParams.openerPage&&
(b.openerPage=this.currentParams.openerPage);this.currentParams.relatedEntityId&&(b.relatedEntityId=this.currentParams.relatedEntityId);this.currentParams.learningObjectiveId&&(b.learningObjectiveId=this.currentParams.learningObjectiveId);this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,b,!1);this.modalDialog.setTitle(this.currentParams.header);this.modalDialog.openDialog(!1);this.modalDialog.setPreferredSize(this.settings.PreferredWidth,0);a=this.countCheckedElements();a=void 0!=this.currentParams.maxCountOfAddedElements&&
a>this.currentParams.maxCountOfAddedElements?!1:this.currentParams.allowEmptySubmit||0<a&&0<this.countElementsChanged();this.controls.OkButton.prop("disabled",!a)};b.prototype.refreshDialog=function(a){a=void 0===a?{}:a;var b=a.showAll;b=void 0===b?!1:b;a=a.isFilteredByLearningObjectives;this.isFilteredByLearningObjectives=void 0===a?!1:a;this.ajaxParams.showAll=b;this.currentParams.showAll=b;this.modalDialog.setAjaxUrl(this.settings.Urls.DialogContent,this.ajaxParams,!0)};b.prototype.closeDialog=
function(){CssModal.closeDialog()};b.prototype.getDialogId=function(){return this.controls.Container.prop("id")};b.prototype.onFolderContentLoaded=function(){var a=this;this.currentParams.elementStates.forEach(function(b,g){a.checkboxStateMachine.isElementChecked(b)&&(b=a.utility.getCheckbox(g))&&b.length&&b.prop("checked",!0)});this.currentParams.disabledElementIds&&this.currentParams.disabledElementIds.forEach(function(b){(b=a.utility.getCheckbox(b))&&b.length&&b.prop("disabled",!0)})};b.prototype.setupOkButtonClickHandler=
function(){var a=this;this.controls.OkButton.on("click",function(b){b.preventDefault();a.controls.OkButton.is(":visible")&&a.controls.OkButton.is(":enabled")&&(a.currentParams.afterOkClickCallback(a.currentParams.elementStates),CssModal.closeDialog())})};b.prototype.setupListItemFocusedAreaClickHandler=function(){var a=this;this.controls.Container.on((b={},b.change=this.updateElementStateAndToggleOkButtonEnabled,b),this.inputTypeCheckboxSelector);this.controls.Container.on("click",this.utility.selectors.listItemFocusedArea,
function(b){b=$(b.target);var c=a.utility.closestElementItem(b);a.isClickTargetEnabled(b,c)?a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(c):a.utility.isListItemFocusedArea(b)&&a.isCheckboxExistAndEnabled(c)&&(b=a.utility.getCheckbox(a.utility.getElementId(c)),b.toggle(!b.is(":checked"))):a.isFolder(c)&&a.expandOrCollapseFolder(c)});this.controls.Container.on("keyup",this.utility.selectors.listItemFocusedArea,function(b){b.which!==CCL.CommonConstants.keyCodes.space||CCL.CommonFunctions.isFirefox()||
(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.utility.closestElementItem(b)))});var b};b.prototype.preventExternalFormSubmitAndMakeSaveOnEnterKey=function(){var a=this;this.controls.DialogContent.keypress(function(b){b.which!==CCL.CommonConstants.keyCodes.enter||a.controls.OkButton.is(":focus")||(b.preventDefault(),a.controls.OkButton.click())})};b.prototype.isClickTargetEnabled=function(a,b){return 0===b.find(this.utility.selectors.elementLinkFolderActionExpand).length||
this.targetIsFolderActionExpand(a)||this.currentParams.allowFolderSelection&&(!this.isFilteredByLearningObjectives||this.currentParams.showAll)&&this.isCheckboxExistAndEnabled(b)};b.prototype.targetIsFolderActionExpand=function(a){return a.is(this.utility.selectors.elementLinkFolderActionExpand)||0<a.closest(this.utility.selectors.elementLinkFolderActionExpand).length};b.prototype.isFolder=function(a){return 0<a.find(this.utility.selectors.elementLinkFolderActionExpand).length};b.prototype.updateElementState=
function(a,b){a=this.utility.getElementId(a);var c=this.currentParams.elementStates.get(a)||f.CheckboxStateMachine.State.Empty;b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(b,c);this.currentParams.elementStates.set(a,b);return this.countCheckedElements()};b.prototype.countElementsChanged=function(){return f.MapUtils.reduce(this.currentParams.elementStates,function(a,b,g){return g===f.CheckboxStateMachine.State.AttachedByUser||g===f.CheckboxStateMachine.State.DetachedByUser?
a+1:a},0)};b.prototype.countCheckedElements=function(){var a=this;return f.MapUtils.reduce(this.currentParams.elementStates,function(b,g,d){return a.checkboxStateMachine.isElementChecked(d)?b+1:b},0)};b.prototype.getCheckedElements=function(){var a=this;return f.MapUtils.reduce(this.currentParams.elementStates,function(b,g,d){a.checkboxStateMachine.isElementChecked(d)&&b.push(g);return b},[])};b.prototype.expandOrCollapseFolder=function(a){var b=this,g=a.find(this.utility.selectors.elementLinkFolderActionExpand).first(),
d=g.data(this.settings.DataAttributes.ElementLinkFolderActionExpand),e=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderAppendTarget)).first();d?d===k.Expanded?this.setFolderState(e,g,k.Collapsed):d===k.Collapsed&&this.setFolderState(e,g,k.Expanded):(this.setFolderState(e,g,k.Loading),this.ajaxClient.folderContent({folderId:this.utility.getElementId(a),elementType:this.currentParams.elementType,openerPage:this.currentParams.openerPage,relatedEntityId:this.currentParams.relatedEntityId,
learningObjectiveId:this.currentParams.learningObjectiveId,showAll:this.currentParams.showAll}).done(function(a){e.append(a);b.setFolderState(e,g,k.Expanded);b.onFolderContentLoaded()}))};b.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.utility.getCheckbox(this.utility.getElementId(a)))&&a.is(":enabled")};b.prototype.setFolderState=function(a,b,g){a.toggle(g===k.Expanded);this.utility.closestListItemFocusedArea(b).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ElementLinkFolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
g===k.Expanded);b.data(this.settings.DataAttributes.ElementLinkFolderActionExpand,g);a=b.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,g!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,g===k.Expanded);a.closest("."+this.settings.CssClasses.ExpandButton).attr("aria-label",g===k.Expanded?this.settings.Terms.CollapseFolder:this.settings.Terms.ExpandFolder)};
b.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};return b}();e.ElementLinkDialogManager=d})(f.ElementLinkDialog||(f.ElementLinkDialog={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){window[b]=this;this.settings=a;this.eventNames=a.EventNames;this.initialize()}d.prototype.initialize=function(){!this.settings.UsesNestedLearningObjectiveSelectorMode&&this.settings.LearningObjectivesEditorClientId&&(this.objectivesEditor=window.parent[this.settings.LearningObjectivesEditorClientId]);var b=this;$(document).on(this.eventNames.EmptyStateChangedEventName,function(a,c){$(b.settings.ClientCssSelectorOfTopWarningFeedbackSelector).toggle(c.isAnyEmpty);
b.objectivesEditor&&b.objectivesEditor.handleCriteriaEmptyStateChangedEvent(c.isAnyEmpty,c.loUpdate)}).on(this.eventNames.DeleteLearningObjectiveEventName,function(a,c){b.settings.UsesNestedLearningObjectiveSelectorMode&&(c.reloadPage?(b.haveChangedLos=!0,b.removeLearningObjective(c.learningObjectiveId),b.updateUrlAndReload()):b.removeLearningObjective(c.learningObjectiveId))}).on(this.eventNames.CriteriaWeightsChangedEventName,function(a,c){b.objectivesEditor?(b.objectivesEditor.updateCriteriaWeights(c.data),
b.objectivesEditor.updateLearningObjectivesCriteriaWeights(c.loCriteriaWeights)):$("#"+b.settings.CriteriaWeightsHiddenClientId).val(JSON.stringify(c.data))});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.submitIframe,function(){var a=$("#"+b.settings.CriteriaWeightsHiddenClientId).val(),c=[];$.each(window[b.settings.LearningObjectivesControlClientId].selectedIds,function(a,b){c.push(parseInt(b))});CCL.CommonFunctions.makePostMessageCall(window.parent,
new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,{loIds:c,criteriaWeights:a}))})};d.prototype.updateUrlAndReload=function(){if(this.haveChangedLos){var b=document.location.href,a=this.getParameterByName(b,"Ids"),c=window[this.settings.LearningObjectivesControlClientId].selectedIds;b=a?b.replace(a[0],a[0][0]+"Ids="+encodeURIComponent(c.join(","))):b+(-1==b.indexOf("?")?"?":"&")+"Ids="+encodeURIComponent(c.join(","));if(a=$("#"+this.settings.CriteriaWeightsHiddenClientId).val())b=
(c=this.getParameterByName(b,"CriteriaWeights"))?b.replace(c[0],c[0][0]+"CriteriaWeights="+encodeURIComponent(a)):b+(-1==b.indexOf("?")?"?":"&")+"CriteriaWeights="+encodeURIComponent(a);a=this.settings.ShowCriteriaWeights?"1":"0";b=(c=this.getParameterByName(b,"ShowCriteriaWeights"))?b.replace(c[0],c[0][0]+"ShowCriteriaWeights="+a):b+(-1==b.indexOf("?")?"?":"&")+"ShowCriteriaWeights="+a;document.location.replace(b)}};d.prototype.addLearningObjectives=function(b){for(var a=[],c=0;c<b.length;c++)a.push(parseInt(b[c]));
window[this.settings.LearningObjectivesControlClientId].setSelectedIds(a,!0);$(document).trigger(this.eventNames.SelectionSavedEventName);window[this.settings.LearningObjectivesControlClientId].showSuccessFeedback();this.haveChangedLos=!0;this.triggerLearningObjectivesDescription()};d.prototype.closeDialogAndRedirect=function(b){var a=window.parent;a.CssModal.closeDialog();a.location=b};d.prototype.removeLearningObjective=function(b){var a=window[this.settings.LearningObjectivesControlClientId].selectedIds;
a.splice(a.indexOf(b.toString()),1);window[this.settings.LearningObjectivesControlClientId].setSelectedIds(a,!0);this.triggerLearningObjectivesDescription()};d.prototype.triggerLearningObjectivesDescription=function(){var b=window[this.settings.LearningObjectivesControlClientId].selectedIds;$("#"+this.settings.AddLearningObjectiveDescriptionClientId).toggle(0==b.length)};d.prototype.getParameterByName=function(b,a){return RegExp("[?&]"+a+"=([^&]*)").exec(b)};return d}();e.ManageMultipleCriteriaPopup=
f})(f.Rubric||(f.Rubric={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function b(a){var c=this;this.showManageRubricModal=function(){$.get(c.settings.WebMethods.GetCriteria).done(function(a){var b=window[c.settings.RubricDialogClientInstanceName],g="&Ids="+a.LoIds.join(","),d="";a.UseAssessmentOrScore&&(d="&ShowCriteriaWeights=True&CriteriaWeights="+JSON.stringify(a.CriteriaWeights));b.setIframeUrl(c.settings.WebMethods.ManageRubricDialogUrl+(g+d));b.openDialog()})};this.updateCriteria=function(a){a=a.extendedData;
if(!a.updateSettings&&void 0!==a.loIds&&void 0!==a.criteriaWeights){var b={};b.LoIds=a.loIds;a.criteriaWeights&&(b.CriteriaWeights=JSON.parse(a.criteriaWeights));CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.UpdateCriteria,data:b}).done(function(){e.Settings.Manager.getInstance().refreshReadView()})}};this.settings=a;window[b.clientInstanceName]=this;a=$(window);CCL.CommonFunctions.attachPostMessageEventListener(a,CCL.CommonWindowMessages.MessageNames.assignmentShowManageRubric,function(){c.showManageRubricModal()});
CCL.CommonFunctions.attachPostMessageEventListener(a,CCL.CommonWindowMessages.MessageNames.closeCssModalDialog,function(a){c.updateCriteria(a)})}b.clientInstanceName="AssignmentListenerClientInstanceName";return b}();f.AssignmentListener=d})(e.Controls||(e.Controls={}))})(f.LearningToolElement||(f.LearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){e.makeCopy=function(e){var d=new Map;e.forEach(function(b,a,c){d.set(a,b)});return d};e.reduce=function(e,d,b){var a=b;e.forEach(function(b,g,e){a=d(a,g,b)});return a};e.mapToJsonString=function(e){var d=Object.create(null);e.forEach(function(b,a){return d[a.toString()]=b});return JSON.stringify(d)};e.jsonStringToMap=function(e,d){e=e?JSON.parse(e):{};for(var b=new Map,a=0,c=Object.keys(e);a<c.length;a++){var g=c[a];b.set(d(g),e[g])}return b};e.stringKeyConverter=function(e){return e};
e.numberKeyConverter=function(e){return parseInt(e,10)}})(f.MapUtils||(f.MapUtils={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){this.defaultLabelColor=null;this.animate=!1;e.assessmentLettersInstance=this;this.context=a;if(e.assessmentLettersInstance.context.Settings.IsMentorCanSendReminders)$("#"+e.assessmentLettersInstance.context.Controls.SendReminderButtonId).on("click",this.SendReminder);this.SetTimestamp(e.assessmentLettersInstance.context.Settings.SendDate)}b.prototype.SendReminder=function(){CCL.CommonFunctions.safeAjaxPost({url:e.assessmentLettersInstance.context.WebMethods.SendReminderUrl,
data:{termId:e.assessmentLettersInstance.context.Settings.TermId,organisationId:e.assessmentLettersInstance.context.Settings.OrganisationId}}).done(function(a){e.assessmentLettersInstance.SetTimestamp(a)}).fail(function(a,b,g){CCL.CommonFunctions.alertAjaxError(a,b,g)})};b.prototype.SetTimestamp=function(a){if(null!==a){var b=$("#"+e.assessmentLettersInstance.context.Controls.TimestampLabelId),g=b.text();b.text(CCL.CommonFunctions.formatString(e.assessmentLettersInstance.context.Settings.TimestampText,
a));g&&this.blink(b)}};b.prototype.blink=function(a){this.animate||(this.animate=!0,this.defaultLabelColor||(this.defaultLabelColor=a.css("color")),a.css("color","#F9F5BE"),a.animate({color:this.defaultLabelColor},1E3,function(){e.assessmentLettersInstance.animate=!1}))};return b}();e.TermAssessmentOverview=d})(e.Mentor||(e.Mentor={}))})(f.Assessment||(f.Assessment={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.onboardingControlUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();e.FinalModalLoader=d;d=function(b){function a(a,g){b.call(this,g);this.context=a}__extends(a,b);a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$finalModalOverlayModal.overlayModal("open")};a.prototype.initEvents=function(){var a=this;$(document).on(CCL.OverlayModalEvents.hide,function(b,c){a.onOverlayModalHide(b,c)})};a.prototype.onOverlayModalHide=function(a,b){(b.closeType===CCL.OverlayModalCloseType.CloseButtonClicked||b.closeType===CCL.OverlayModalCloseType.EscapeKeyPressed)&&this.$finalModalOverlayModal.get(0).id===b.activeElement.id&&CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close()};return a}(OnboardingSystem.OnboardingControl);
e.FinalModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.onboardingControlUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();e.RecurringEventModalLoader=d;d=function(b){function a(a,d){b.call(this,d);this.context=a}__extends(a,b);a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this)};
return a}(OnboardingSystem.OnboardingControl);e.RecurringEventModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.onboardingControlUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.onboardingControlUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();e.CalendarModalLoader=d;d=function(b){function a(a,d){b.call(this,d);this.context=a}__extends(a,b);a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);
this.initEvents();this.$welcomeModalOverlayModal.overlayModal("open")};a.prototype.initEvents=function(){var a=this;this.$LetsGoButton.click(function(){a.onLetsGoButtonClick()});this.$NoThanksButton.click(function(){a.onNoThanksButtonClick()});$(document).on(CCL.OverlayModalEvents.hide,function(b,c){a.onOverlayModalHide(b,c)})};a.prototype.hideWelcomeModalAndCompleteFeature=function(a){CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(b={},b[this.context.AntiForgerySettings.HeaderName]=
this.context.AntiForgerySettings.HeaderValue,b)});this.raiseEvent(OnboardingSystem.ControlEvents.courseModernExistingWelcomeModalCompleted);var b};a.prototype.onLetsGoButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!1)};a.prototype.onNoThanksButtonClick=function(){CCL.OverlayModal.instance.close();this.hideWelcomeModalAndCompleteFeature(!0)};a.prototype.onOverlayModalHide=function(a,b){b.closeType!==CCL.OverlayModalCloseType.CloseButtonClicked&&b.closeType!==
CCL.OverlayModalCloseType.EscapeKeyPressed||this.$welcomeModalOverlayModal.get(0).id!==b.activeElement.id||(this.hideWelcomeModalAndCompleteFeature(!0),CCL.OverlayModal.instance&&CCL.OverlayModal.instance.close())};return a}(OnboardingSystem.OnboardingControl);e.CalendarModal=d})(e.Calendar||(e.Calendar={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.welcomeTopBannerUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.welcomeTopBannerUrl,type:"GET",cache:!1}).done(function(b,d,e){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();e.WelcomeTopBannerLoader=d;d=function(b){function a(a,d){b.call(this,d);this.height=207;this.slideUpduration=1E3;this.context=a}__extends(a,b);a.prototype.init=function(){this.context.Scripts.WelcomeTopBannerDisplayMeasureKpiScript();
OnboardingSystem.onboardingManagerInstance.registerControl(this);this.$whatsNewOverlayModal=$("#"+this.context.Controls.WhatsNewOverlayModal);this.$tellMeMoreButton=$("#"+this.context.Controls.TellMeMoreButton);this.$gotItButton=$("#"+this.context.Controls.GotItButton);this.initEvents()};a.prototype.initEvents=function(){var a=this;this.$tellMeMoreButton.click(function(){a.onTellMeMoreButtonClick()});this.$gotItButton.click(function(){a.onGotItButtonClick()});$(document).on(CCL.OverlayModalEvents.hide,
function(b,c){a.onOverlayModalHide(b,c)})};a.prototype.hideTopBannerAndCompleteFeature=function(){$("#"+this.context.Controls.WelcomeTopBanner).css({"min-height":0,height:this.height}).slideUp(this.slideUpduration);CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(a={},a[this.context.AntiForgerySettings.HeaderName]=this.context.AntiForgerySettings.HeaderValue,a)});var a};a.prototype.onTellMeMoreButtonClick=function(){this.context.Scripts.WelcomeTellMeMoreMeasureKpiScript();
this.$whatsNewOverlayModal.overlayModal("open")};a.prototype.onGotItButtonClick=function(){this.context.Scripts.WelcomeGotItMeasureKpiScript();this.hideTopBannerAndCompleteFeature();this.raiseEvent(OnboardingSystem.ControlEvents.dashboardModernExistingWelcomeTopBannerAndModalCompleted)};a.prototype.onOverlayModalHide=function(a,b){this.$whatsNewOverlayModal.get(0).id===b.activeElement.id&&(this.hideTopBannerAndCompleteFeature(),this.raiseEvent(OnboardingSystem.ControlEvents.dashboardModernExistingWelcomeTopBannerAndModalCompleted))};
return a}(OnboardingSystem.OnboardingControl);e.WelcomeTopBanner=d})(e.Dashboard||(e.Dashboard={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.coursesMenuCallToActionUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.coursesMenuCallToActionUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b),a.$targetElement.find(".ccl-context-dialog-arrow").css("left",a.$targetElement.outerWidth()/2))})};return b}();e.CoursesMenuCallToActionLoader=d;d=function(b){function a(a,d){b.call(this,
d);this.context=a}__extends(a,b);a.prototype.onGotItClick=function(){$("."+this.context.Controls.CoursesMenuCallToActionId).hide()};a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);var a=this,b=$("."+a.context.Controls.CoursesMenuCallToActionId);b.click(function(){return a.onGotItClick()});b.show();this.coursesMenuItemIsVisible()&&CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(d={},d[this.context.AntiForgerySettings.HeaderName]=
this.context.AntiForgerySettings.HeaderValue,d)});var d};a.prototype.coursesMenuItemIsVisible=function(){return $(this.context.Controls.CoursesMenuItemSelector).is(":visible")};return a}(OnboardingSystem.OnboardingControl);e.CoursesMenuCallToAction=d})(e.TopMenu||(e.TopMenu={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b,d){this.coursesMenuItemUrl=a;this.$targetElement=b;this.coursesMenuItemPageContext=d}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.coursesMenuItemUrl,type:"GET",cache:!1}).done(function(b,d,e){b&&0!==b.length&&(b=$(b),a.$targetElement.append(b),$(document).trigger("document:coursesMenuItemLoaded",a.coursesMenuItemPageContext))})};return b}();e.CoursesMenuItemLoader=d;d=function(){function b(a){e.coursesMenuItemInstance=
this;this.context=a}b.prototype.init=function(){var a=this;this.$coursesMenuItem=$(this.context.Controls.CoursesMenuItemSelector);this.$coursesMenuItem.one("click touchstart",function(){a.coursesMenuItemOnClick(a)});this.$gotItButton=$("#"+this.context.Controls.GotItButtonId);this.$gotItButton.on("click touchstart",this.gotItButtonOnClick);this.$allCoursesLink=$("."+this.context.Controls.AllCoursesLink);this.$allCoursesLink.on("click touchstart",this.allCoursesLinkClick);this.$coursesMenuItemAnchor=
this.$coursesMenuItem.children("button").first();this.$originalDropDownMenu=this.$coursesMenuItem.children(".ccl-context-dialog.ccl-dropdownmenu").first().detach();this.$onboardingSplash=$("#"+this.context.Controls.SplashPanelIdControl).detach();this.initSplash()};b.prototype.initSplash=function(){this.$coursesMenuItemAnchor.after(this.$onboardingSplash);this.$originalDropDownMenu.detach()};b.prototype.disposeSplash=function(){this.$coursesMenuItemAnchor.after(this.$originalDropDownMenu);this.$onboardingSplash.detach()};
b.prototype.updateOnboardingService=function(a){CCL.CommonFunctions.safeAjax({type:"PUT",url:a,headers:(b={},b[this.context.AntiForgerySettings.HeaderName]=this.context.AntiForgerySettings.HeaderValue,b)});var b};b.prototype.completeSplash=function(){this.updateOnboardingService(this.context.Urls.CompleteSplashFeatureUrl)};b.prototype.coursesMenuItemOnClick=function(a){a.updateOnboardingService(a.context.Urls.CompleteSplashFeatureDisplayedUrl)};b.prototype.gotItButtonOnClick=function(){var a=CCL.CommonFunctions.isMobileDevice()?
"touchstart":"click";e.coursesMenuItemInstance.completeSplash();(new Function(e.coursesMenuItemInstance.context.Functions.HideDropDowns))();e.coursesMenuItemInstance.disposeSplash();e.coursesMenuItemInstance.$coursesMenuItemAnchor.trigger(a);e.coursesMenuItemInstance.$coursesMenuItem.find(".js-titlesFilter").focus()};b.prototype.allCoursesLinkClick=function(){e.coursesMenuItemInstance.completeSplash()};return b}();e.CoursesMenuItem=d;(function(b){function a(a,d){b.call(this,a);this.coursesMenuItem=
d}__extends(a,b);return a})(OnboardingSystem.OnboardingControl)})(e.TopMenu||(e.TopMenu={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a,b){this.allCoursesUrl=a;this.$targetElement=b}b.prototype.renderOnboarding=function(){var a=this;$.ajax({url:this.allCoursesUrl,type:"GET",cache:!1}).done(function(b){b&&0!==b.length&&(b=$(b),a.$targetElement.prepend(b))})};return b}();e.AllCoursesTidyUpFavouriteListLoader=d;d=function(b){function a(a,d){b.call(this,d);this.timeoutForOnboarding=8E3;this.context=a}__extends(a,b);a.prototype.onGotItClick=function(){$("#ctl00_ContentAreaIframe").contents().find("."+
this.context.Controls.AllCoursesTidyUpFavouriteListId).hide();this.isMobile()||CCL.CommonFunctions.safeAjax({url:this.context.OnboardingProxyUrl,type:"PUT",headers:(a={},a[this.context.AntiForgerySettings.HeaderName]=this.context.AntiForgerySettings.HeaderValue,a)});var a};a.prototype.init=function(){OnboardingSystem.onboardingManagerInstance.registerControl(this);var a=this;$("#ctl00_ContentAreaIframe").contents().find("."+a.context.Controls.AllCoursesTidyUpFavouriteListId).click(function(){return a.onGotItClick()});
$(setTimeout(function(){a.onGotItClick()},a.timeoutForOnboarding))};a.prototype.isMobile=function(){return CCL.CommonFunctions.checkScreenSize(CCL.CommonConstants.mediaScreenSizes.mobile,!1)};return a}(OnboardingSystem.OnboardingControl);e.AllCoursesTidyUpFavouriteList=d})(e.AllCourses||(e.AllCourses={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Welcome=38]="Welcome";a[a.LinkToClassic=39]="LinkToClassic";a[a.Messages=40]="Messages";a[a.Courses=41]="Courses";a[a.MenuMoreButton=42]="MenuMoreButton";a[a.ClassLog=44]="ClassLog"})(d||(d={}));var b=function(){function a(a){this.settings=a;this.dialogsToShow=a.dialogClientIds.filter(function(a){return null!=window[a]}).map(function(a){return window[a]});this.dialogsHandlerMapping={};this.dialogsHandlerMapping[d.LinkToClassic]=this.getOpenCloseMoreMenuOnboardingHandlers(this.settings.classicSkoleIntraMenuItemCssClass);
this.dialogsHandlerMapping[d.Courses]=this.getOpenCloseMoreMenuOnboardingHandlers(this.settings.coursesMenuItemCssClass);this.dialogsHandlerMapping[d.MenuMoreButton]=this.getMoreMenuOnboardingHandlers();this.dialogsHandlerMapping[d.ClassLog]=this.getClassLogOnboardingHandlers(this.settings.classLogMenuItemCssClass)}a.prototype.start=function(){CCL.CommonFunctions.isPhoneScreenSize()||this.showNextDialog()};a.prototype.showNextDialog=function(){var a=this;if(0<this.dialogsToShow.length){var b=this.dialogsToShow[0];
this.dialogsToShow=this.dialogsToShow.slice(1);var d=function(){b.blockHighlightZone=!0;b.openDialog(function(c){return a.dialogCloseHandler(b,c)});a.currentlyOpenedDialog=b};if(0<b.settings.OnboardingFeatureId){var e=this.dialogsHandlerMapping[b.settings.OnboardingFeatureId];e&&"function"===typeof e.beforeOpenHandler?setTimeout(function(){e.beforeOpenHandler();setTimeout(d,200)},100):d()}else d()}};a.prototype.dialogCloseHandler=function(a,b){0<a.settings.OnboardingFeatureId&&(a=this.dialogsHandlerMapping[a.settings.OnboardingFeatureId])&&
"function"===typeof a.afterCloseHandler&&a.afterCloseHandler();this.currentlyOpenedDialog=null;b?this.registerCompletionForAll():this.showNextDialog()};a.prototype.registerCompletionForAll=function(){for(var a=0;a<this.dialogsToShow.length;a++)this.dialogsToShow[a].registerOnboardingCompletion()};a.prototype.getOpenCloseMoreMenuOnboardingHandlers=function(a){return{beforeOpenHandler:this.getCollapseExpandMoreMenuHandler(a,!1),afterCloseHandler:this.getCollapseExpandMoreMenuHandler(a,!0)}};a.prototype.getCollapseExpandMoreMenuHandler=
function(a,b){var c=this;return function(){var d=0<$("."+a).parent("#"+c.settings.moreMainMenuDropdownContainerId).length,g=b?":visible":":not(:visible)";d&&$("#"+c.settings.moreMainMenuDropdownContainerId).is(g)&&$("."+c.settings.menuContainerCssClass+" ."+c.settings.menuMoreButtonCssClass+" > ."+c.settings.menuLinkCssClass).trigger("click")}};a.prototype.getMoreMenuOnboardingHandlers=function(){return{beforeOpenHandler:this.getForceMainMenuWidthHandler(CCL.CommonConstants.mediaScreenSizes.iPadLandscapeMode+
"px",!1),afterCloseHandler:this.getForceMainMenuWidthHandler("auto",!0)}};a.prototype.getForceMainMenuWidthHandler=function(a,b){var c=this;return function(){var d=b?":visible":":not(:visible)";$("."+c.settings.menuContainerCssClass+" ."+c.settings.menuMoreButtonCssClass).is(d)&&($("."+c.settings.menuItemsCssClass).width(a),$(window).trigger("resize"))}};a.prototype.getClassLogOnboardingHandlers=function(a){var b=this;return{beforeOpenHandler:b.getCollapseExpandMoreMenuHandler(a,!1),afterCloseHandler:function(){b.getCollapseExpandMoreMenuHandler(a,
!0)();b.handleClassLogDialogBeingClosed()}}};a.prototype.handleClassLogDialogBeingClosed=function(){if(this.currentlyOpenedDialog&&this.currentlyOpenedDialog.gotItClicked){var a=$(this.settings.classlogMenuLinkSelector)[0];if(a){var b=a.href;(a=$("iframe[name="+a.target+"]")[0])&&b&&(a.src=b)}}};return a}();e.SkoleIntraTopMenuTour=b})(e.SkoleIntra||(e.SkoleIntra={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.context=a;this.controls=b;this.getExternalGrades();$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return c.pagerEventHandler(b)})}d.prototype.refreshGrid=function(b,a){var c=this;$.post(this.context.WebMethods.GetExternalGradebookContent,{courseId:this.context.CourseId,pageIndex:b,pageSize:a}).done(function(a){null!=a&&(a=$(a),c.controls.Container.replaceWith(a),
c.controls.Container=a,c.getExternalGrades())}).fail(function(a){e.Utils.handleAjaxError(a)})};d.prototype.pagerEventHandler=function(b){b===this.context.Pager.Name&&(b=window[b],this.refreshGrid(b.pageNumber,b.pageSize))};d.prototype.getExternalGrades=function(){var b=this;$.post(this.context.WebMethods.GetExternalGradesForCourse,{courseId:this.context.CourseId}).done(function(a){null!=a&&null!=a.length&&0<a.length?b.fillGrades(a):b.clearGrades()}).fail(function(){b.clearGrades()})};d.prototype.fillGrades=
function(b){var a=this;this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").each(function(c,g){c=$(g);var e=c.data(a.context.DataAttributes.LineItemSourcedId),f=c.data(a.context.DataAttributes.PersonSourcedId),l=d.defaultCellText;$.each(b,function(b,c){if(e===c.LineItemSourcedId&&f===c.PersonSourcedId)return l=a.getCellText(c),!1});c.text(l)})};d.prototype.getCellText=function(b){var a=d.defaultCellText;null!=b.Score&&0<b.Score.length&&(a=b.Score);var c=d.defaultCellText;
null!=b.Scale&&0<b.Scale.length&&(c=b.Scale);return a+" / "+c};d.prototype.clearGrades=function(){this.controls.Container.find("[data-"+this.context.DataAttributes.LineItemSourcedId+"]").empty().text(d.defaultCellText)};d.defaultCellText="-";return d}();e.ExternalGradebook=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.context=b;this.controls=a;this.mappingTypesList.on("change",function(){return c.onMappingTypeChanged()});this.existingAssessmentsList.on("change",function(){return c.onGradeBookItemChanged()});this.existingAssessmentScalesList.on("change",function(){return c.onAssessmentScaleChanged()});this.bindButtonsToEvent()}Object.defineProperty(d.prototype,"mappingTypesList",{get:function(){return this.controls.MappingTypesList},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"existingAssessmentsList",{get:function(){return this.controls.ExistingAssessmentsList},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"existingAssessmentScalesList",{get:function(){return this.controls.ExistingAssessmentScalesList},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"currentButton",{get:function(){return this.controls.SendButton.length?this.controls.SendButton:this.controls.SaveButton},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"settings",{get:function(){return this.context.Settings},enumerable:!0,configurable:!0});d.addOrUpdateDraftItem=function(b){var a=!0;$.each(d.draftItems,function(c,d){if(b.SyncKey.toLowerCase()===d.SyncKey.toLowerCase())return d.GradeType=b.GradeType,d.AssessmentRecordItemId=b.AssessmentRecordItemId,d.AssessmentScaleId=b.AssessmentScaleId,a=!1});a&&d.draftItems.push(b)};d.getDraftItemsBySyncKeys=function(b){var a=[];$.each(b,function(b,g){$.each(d.draftItems,
function(b,c){if(c.SyncKey.toLowerCase()===g.toLowerCase())return a.push(c),!1})});return a};d.prototype.bindButtonsToEvent=function(){var b=this,a=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";if(!this.controls.SaveButton.is(":disabled"))this.controls.SaveButton.on(a,function(){return b.saveResults()});if(!this.controls.SendButton.is(":disabled"))this.controls.SendButton.on(a,function(){return b.sendResults()})};d.prototype.onMappingTypeChanged=function(){this.setControlAvailability(this.mappingTypesList,
!1);var b=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.mappingTypesList.toggleClass(this.context.CssClasses.DefaultMappingType,b===this.context.Settings.MappingTypeEnum.NotLinked);var a=this.settings.LineItemsSyncKeys;switch(b){case this.context.Settings.MappingTypeEnum.NotLinked:this.hideAndClearAssessmentsDropDownList();this.hideAssessmentScalesDropDownList();this.createDraftVersion(this.context.Settings.MappingTypeEnum.NotLinked,a);break;case this.context.Settings.MappingTypeEnum.OverallAverage:this.hideAndClearAssessmentsDropDownList();
this.setButtonAvailability(!1);if(this.settings.DoesOverallAverageHaveMultipleScales)this.showAssessmentScalesDropDownList();else this.onAssessmentScaleChanged();break;case this.context.Settings.MappingTypeEnum.Assessment:case this.context.Settings.MappingTypeEnum.FinalAssessment:this.hideAssessmentScalesDropDownList();this.setButtonAvailability(!1);this.populateAndShowAssessmentsDropDownList();break;case this.context.Settings.MappingTypeEnum.Manual:this.hideAssessmentScalesDropDownList(),this.hideAndClearAssessmentsDropDownList(),
this.createDraftVersion(this.context.Settings.MappingTypeEnum.Manual,a)}this.setControlAvailability(this.mappingTypesList,!0)};d.prototype.onGradeBookItemChanged=function(){this.setControlAvailability(this.existingAssessmentsList,!1);var b=parseInt(this.existingAssessmentsList.find("option:selected").val(),10);if(b!==this.context.Settings.ExistingAssessmentDefaultValue){this.setControlAvailability(this.mappingTypesList,!1);var a=parseInt(this.mappingTypesList.find("option:selected").val(),10);this.createDraftVersion(a,
this.settings.LineItemsSyncKeys,b);this.setControlAvailability(this.mappingTypesList,!0)}else this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentsList,!0)};d.prototype.hideAndClearAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.hide().empty()};d.prototype.populateAndShowAssessmentsDropDownList=function(){this.controls.ExistingAssessmentsList.empty();var b=parseInt(this.controls.MappingTypesList.find("option:selected").val(),10),a={courseId:this.settings.CourseId,
termId:this.settings.TermId};b===this.context.Settings.MappingTypeEnum.Assessment?this.populateGradebookItemsList(this.context.WebMethods.GetNormalAssessments,a):b===this.context.Settings.MappingTypeEnum.FinalAssessment&&this.populateGradebookItemsList(this.context.WebMethods.GetFinalAssessments,a);this.controls.ExistingAssessmentsList.show()};d.prototype.onAssessmentScaleChanged=function(){this.setControlAvailability(this.existingAssessmentScalesList,!1);var b=parseInt(this.existingAssessmentScalesList.find("option:selected").val(),
10);b!==this.context.Settings.AssessmentScaleDefaultValue?(this.setControlAvailability(this.mappingTypesList,!1),this.createDraftVersion(this.context.Settings.MappingTypeEnum.OverallAverage,this.settings.LineItemsSyncKeys,null,b),this.setControlAvailability(this.existingAssessmentScalesList,!0)):this.setButtonAvailability(!1);this.setControlAvailability(this.existingAssessmentScalesList,!0)};d.prototype.showAssessmentScalesDropDownList=function(){this.existingAssessmentScalesList.show()};d.prototype.hideAssessmentScalesDropDownList=
function(){this.existingAssessmentScalesList.hide()};d.prototype.populateGradebookItemsList=function(b,a){var c=this;$.get(b,a).done(function(a){c.controls.ExistingAssessmentsList.append($("<option />").val(c.context.Settings.ExistingAssessmentDefaultValue.toString()).text(c.context.LanguageTerms.ExistingAssessmentDefaultText));$.each(a,function(a,b){c.controls.ExistingAssessmentsList.append($("<option />").val(b.GradeBookItemId.toString()).text(b.Title))})}).fail(function(a){e.Utils.handleAjaxError(a)})};
d.prototype.createDraftVersion=function(b,a,c,g){null==c&&(c=this.context.Settings.ExistingAssessmentDefaultValue);null==g&&(g=this.context.Settings.AssessmentScaleDefaultValue);$.each(a,function(a,e){d.addOrUpdateDraftItem({SyncKey:e,GradeType:b,AssessmentRecordItemId:c,AssessmentScaleId:g})});this.updateGradingPeriodSection();e.LineItemsResults.refreshGrid(this.settings.AggregatedSyncItemId)};d.prototype.setButtonAvailability=function(b){this.setControlAvailability(this.currentButton,b)};d.prototype.setControlAvailability=
function(b,a){a?b.removeAttr("disabled"):b.attr("disabled","disabled")};d.prototype.disableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!1);this.setControlAvailability(this.existingAssessmentsList,!1);this.setControlAvailability(this.existingAssessmentScalesList,!1);this.currentButton.addClass(this.context.CssClasses.ButtonWithLoader)};d.prototype.enableMappingControls=function(){this.setControlAvailability(this.mappingTypesList,!0);this.setControlAvailability(this.existingAssessmentsList,
!0);this.setControlAvailability(this.existingAssessmentScalesList,!0);this.currentButton.removeClass(this.context.CssClasses.ButtonWithLoader);this.currentButton.blur()};d.prototype.sendResults=function(){this.handleButtonClick(this.context.WebMethods.SendResults,{courseId:this.settings.CourseId,lineItemIds:this.settings.LineItemsSyncKeys})};d.prototype.saveResults=function(){this.handleButtonClick(this.context.WebMethods.SaveResults,{courseId:this.settings.CourseId,termId:this.settings.TermId,draftItems:d.getDraftItemsBySyncKeys(this.settings.LineItemsSyncKeys)})};
d.prototype.handleButtonClick=function(b,a){var c=this;this.currentButton.is(":disabled")||(this.disableMappingControls(),$.post(b,a).done(function(a){var b=c.controls.InformationFeedbackPlaceholder.offset();c.updateGradingPeriodSection();e.LineItemsResults.refreshGrid(c.settings.AggregatedSyncItemId);a&&a.feedbackMessage&&0<a.feedbackMessage.length&&$(document).trigger(e.GradeExport.showFeedbackEventTitle,[a.feedbackMessage,b]);c.enableMappingControls()}).fail(function(a){e.Utils.handleAjaxError(a);
c.enableMappingControls()}))};d.prototype.updateGradingPeriodSection=function(b,a){void 0===b&&(b=!0);void 0===a&&(a=!1);e.GradingPeriod.refreshSection(this.context.Settings.GradingPeriodId,b,a)};d.draftItems=[];return d}();e.AggregatedSyncItem=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(b,a,c,d,e,f,l){this.courseId=b;this.assessmentRecordId=a;this.termId=c;this.gradingPeriodId=d;this.isExpanded=f;this.isSentAreaExpanded=l;this.draftLineItemGradeTypes=e}}(),d=function(){function b(a,c){var d=this;this.context=a;this.controls=c;a=CCL.CommonFunctions.isMobileDevice()?"touchstart":"click";this.controls.GradingPeriodsSectionHeader.on(a,function(){return d.onGradingPeriodsHeaderClick()});this.controls.SentLineItemsSectionHeader.on(a,
function(){return d.onSentLineItemsHeaderClick()});$(document).off(b.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId));$(document).on(b.getUpdateSectionEventTitle(this.context.Settings.GradingPeriodId),function(a,b,c,g){return d.updateGradingPeriodSection(b,c,g)})}b.prototype.onGradingPeriodsHeaderClick=function(){this.controls.AllLineItemsSection.slideToggle("slow");this.controls.GradingPeriodsSection.toggleClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass);this.controls.GradingPeriodsSectionHeader.toggleClass(this.context.CssClasses.GradingPeriodSectionHeaderCollapsedClass)};
b.prototype.onSentLineItemsHeaderClick=function(){this.controls.SentLineItems.slideToggle("slow");this.controls.SentLineItemsSectionHeader.toggleClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass)};b.getUpdateSectionEventTitle=function(a){return""+b.updateSectionEventTitle+a};b.refreshSection=function(a,c,d){void 0===c&&(c=!0);void 0===d&&(d=!1);$(document).trigger(b.getUpdateSectionEventTitle(a),[c,d,e.AggregatedSyncItem.draftItems])};b.prototype.updateGradingPeriodSection=function(a,
b,d){var c=this,g=!this.controls.GradingPeriodsSection.hasClass(this.context.CssClasses.GradingPeriodSectionCollapsedClass),l=!this.controls.SentLineItemsSectionHeader.hasClass(this.context.CssClasses.SentLineItemsSectionHeaderCollapsedClass);a=new f(this.context.Settings.CourseId,this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,this.context.Settings.GradingPeriodId,d,g||a,l||b);$.post(this.context.WebMethods.GradingPeriod,a).done(function(a){a&&0!==a.length&&(a=$(a),$(c.controls.GradingPeriodsSection).replaceWith(a),
$(c.controls.GradingPeriodsSection).removeClass(c.context.CssClasses.GradingPeriodSectionCollapsedClass))}).fail(function(a){e.Utils.handleAjaxError(a)})};b.updateSectionEventTitle="GradingPeriod:UpdateGradingPeriodSection";return b}();e.GradingPeriod=d})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(a,b,d,e,f){this.courseId=a;this.personId=b;this.lineItemSyncKey=d;this.scoreListItemExtensionId=e;this.currentScore=f}}(),d=function(){return function(a,b,d,e,f,l){void 0===f&&(f="");void 0===l&&(l="");this.courseId=a;this.assessmentRecordId=b;this.termId=d;this.studentNameSearchText=f;this.selectedAggregatedLineItemId=l;this.draftLineItemGradeTypes=e}}(),b=function(){function a(b,g){var c=this;this.context=g;this.controls=b;this.initSearch();
$(document).off(a.refreshGridEventTitle);$(document).on(a.refreshGridEventTitle,function(a,b){return c.updateLineItemsResultsSection(new d(c.context.Settings.CourseId,c.context.Settings.AssessmentRecordId,c.context.Settings.TermId,e.AggregatedSyncItem.draftItems,"",b))})}a.refreshGrid=function(b){$(document).trigger(a.refreshGridEventTitle,b)};a.prototype.initSearch=function(){var a=this;this.controls.SearchImage.on("click",function(){return a.onSearchStudentClick()});this.controls.SearchInput.on("keydown",
function(b){return a.onSearchInputKeyDown(b)})};a.prototype.onSearchStudentClick=function(){this.searchStudents(this.controls.SearchInput.val())};a.prototype.preventEventPropagation=function(a){a.cancelBubble=!0;a.returnValue=!1;a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation()};a.prototype.onSearchInputKeyDown=function(a){a.keyCode===CCL.CommonConstants.keyCodes.enter&&(this.preventEventPropagation(a),this.searchStudents($(a.target).val()))};a.prototype.searchStudents=function(a){this.updateLineItemsResultsSection(new d(this.context.Settings.CourseId,
this.context.Settings.AssessmentRecordId,this.context.Settings.TermId,e.AggregatedSyncItem.draftItems,a?a:""))};a.prototype.updateLineItemsResultsSection=function(a){var b=this;$.post(this.context.WebMethods.LineItemsResults,a).done(function(c){if(c&&0!==c.length){var d=b.controls.SearchInput.attr("id");c=$(c);b.controls.LineItemsResultsTable.parent().empty().prepend(c);a.studentNameSearchText&&$("#"+d).val(a.studentNameSearchText)}}).fail(function(a){e.Utils.handleAjaxError(a)})};a.prototype.handleAjaxError=
function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&a.responseText&&alert(a.responseText)};a.refreshGridEventTitle="LineItemsResults:refreshGrid";return a}();e.LineItemsResults=b;b=function(){function a(a,b){var c=this;this.lineItemCellSelectionChangedEventName="LineItemResultCell:LineItemCellSelectionChanged";this.controls=a;this.context=b;this.isSelected=!1;a=CCL.CommonFunctions.isMobileDevice();this.controls.LineItemResultCell.on(a?"touchstart":"click",function(){return c.focusCell()});
if(!a)this.controls.LineItemResultCell.on("mouseenter",function(){return c.focusCell()});this.controls.LineItemResultCell.focus(function(){return c.onLineitemResultCellFocus()});this.controls.LineItemResultCell.find("*").addBack().blur(function(){return c.onLineitemResultCellBlur()});$(document).on(this.lineItemCellSelectionChangedEventName,function(a,b){c.isSelected&&b!==c.controls.LineItemResultCell.attr("id")&&c.controls.LineItemResultCell.blur()});this.controls.AssessmentScaleItemsList.on("change",
function(a){return c.onAssessmentScaleItemChanged(a)})}a.prototype.focusCell=function(){this.isSelected||this.controls.LineItemResultCell.focus()};a.prototype.onLineitemResultCellFocus=function(){this.isSelected||($(document).trigger(this.lineItemCellSelectionChangedEventName,this.controls.LineItemResultCell.attr("id")),this.controls.LineItemResultCell.addClass(this.context.CssClasses.SelectedCellCssClass),this.controls.LineItemResultCell.height(this.controls.LineItemResultCell.innerHeight()),this.isSelected=
!0)};a.prototype.onLineitemResultCellBlur=function(){var a=this;setTimeout(function(){var b=$(document.activeElement);b.is(a.controls.LineItemResultCell)||0!==a.controls.LineItemResultCell.has(b).length||(a.controls.LineItemResultCell.removeClass(a.context.CssClasses.SelectedCellCssClass),a.controls.LineItemResultCell.css("height",""),a.isSelected=!1)},0)};a.prototype.onAssessmentScaleItemChanged=function(a){a=$(a.target);a.attr("disabled","disabled");var b=this.controls.AssessmentScaleItemsList.val();
b=new f(this.context.Settings.CourseId,this.context.Settings.PersonId,this.context.Settings.LineItemSyncKey,b,this.context.Settings.CurrentScore);this.setCustomScoreListItemExtensionForPerson(b);a.removeAttr("disabled")};a.prototype.setCustomScoreListItemExtensionForPerson=function(a){var b=this;a=JSON.stringify(a);$.ajax({type:"POST",url:this.context.WebMethods.SetCustomScoreListItemExtensionForPerson,data:a,dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(){b.controls.AssessmentScaleCurrentItemLabel.text(b.controls.AssessmentScaleItemsList.find("option:selected").text())}).fail(function(a){e.Utils.handleAjaxError(a)})};
return a}();e.LineItemResultCell=b})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(){}d.handleAjaxError=function(b){b.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=b.responseText&&0<b.responseText.length||null!=b.statusText&&0<b.statusText.length)&&alert(null!=b.responseText&&0<b.responseText.length?b.responseText:b.statusText)};return d}();e.Utils=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;window[b]=this;this.settings=a;$(a.AccordionSelector+" "+a.SectionSelector).click(function(a){c.ShowFeedbackItems(a)})}d.prototype.ShowFeedbackItems=function(b){b=$(b.currentTarget);if(!b.data(this.settings.AccordionSectionLoadedDataAttribute)){b.data(this.settings.AccordionSectionLoadedDataAttribute,!0);var a=b.find(this.settings.ContentSelector);b=a.children().first().data(this.settings.CourseIdDataAttribute);$.ajax({type:"GET",
url:this.settings.WebMethod,data:b?{courseId:b,termId:this.settings.TermId,personId:this.settings.PersonId,personCustomerId:this.settings.PersonCustomerId,reportRoleEnumValue:this.settings.ReportRoleEnumValue,readOnly:this.settings.ReadOnly,returnUrl:this.settings.ReturnUrl,linksTarget:this.settings.LinksTarget}:{termId:this.settings.TermId,personId:this.settings.PersonId},success:function(b,d,e){a.empty().append($(b))},error:function(b,d,e){a.empty();CCL.CommonFunctions.alertAjaxError(b,d,e)}})}};
return d}();e.PersonAssessment=f})(f.Person||(f.Person={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.planLoadingProcessId=null;window[b]=this;d.instanceName=b;this.settings=a;this.terms=a.Terms;this.css=a.Css;this.webMethods=a.WebMethods;this.currentDisplayMode=a.CurrentDisplayMode;$("."+this.css.ExpanderLink).click(function(a){c.expanderLinkClick(a)});CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==c.currentDisplayMode&&(c.currentDisplayMode=
a,c.toggleEnableDisplayModeSwitcher(!1),CCL.CommonFunctions.safeAjaxPost({url:c.webMethods.TogglePlannerDisplayMode,data:{plannerDisplayMode:c.currentDisplayMode}}).done(function(){c.toggleEnableDisplayModeSwitcher(!0);c.refreshExpandedGrids()}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d);c.toggleEnableDisplayModeSwitcher(!0)}))});setTimeout(function(){c.startLoadingMonitor()},100)}d.getInstance=function(){return window[d.instanceName]};d.prototype.openViewCellContentDialog=function(b,
a,c,d,e,f){a=a||window.event;a=a.target||a.srcElement;if(!(a&&0<$(a).closest("a,input,button,textarea").length)){var g=window[this.settings.ViewHtmlTextCellContentDialog];null!=g&&null!=this.webMethods.GetPlanHtmlTextCellContent&&(g.setAjaxUrl(this.webMethods.GetPlanHtmlTextCellContent,{courseId:c,planId:d,columnId:e,childId:0,filterPersonId:f}),b=$(b).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),g.setTitle(b),g.setAfterOpenDialogAjaxDynamicallySuccess(function(){CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(g.getContent())}),
g.openDialog())}};d.prototype.expanderLinkClick=function(b){b.preventDefault();b=$(b.currentTarget);var a=b.parent(),c=b.closest("."+this.css.CoursePlansContainer).find("."+this.css.Plans),d=b.data("grid");d=window[d];a.toggleClass(this.css.Expanded);a.hasClass(this.css.Expanded)?(this.refreshPlanGrid(d),b.prop("title",this.terms.CollapseTooltip)):b.prop("title",this.terms.ExpandTooltip);c.slideToggle("fast")};d.prototype.refreshExpandedGrids=function(){var b=this;$("."+this.css.ExpanderLink).each(function(a,
c){c=$(c);a=c.parent();c=c.data("grid");c=window[c];c.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=b.currentDisplayMode;c.setMode(b.currentDisplayMode===b.settings.DisplayModes.Table?b.css.GridViewModes.TableView:b.css.GridViewModes.DefaultView);a.hasClass(b.css.Expanded)&&b.refreshPlanGrid(c)})};d.prototype.refreshPlanGrid=function(b){if(b.isLoadingInProgress())return!1;this.startLoadingMonitor();b.refresh()};d.prototype.startLoadingMonitor=function(){var b=this;if(null==this.planLoadingProcessId){this.toggleEnableDisplayModeSwitcher(!1);
var a=$("."+this.css.ExpanderLink);this.planLoadingProcessId=setInterval(function(){var c=!0;a.each(function(a,b){a=$(b).data("grid");if(window[a].isLoadingInProgress())return c=!1});c&&(clearTimeout(b.planLoadingProcessId),b.planLoadingProcessId=null,b.toggleEnableDisplayModeSwitcher(!0),a.each(function(a,b){a=$(b).data("grid");a=$("#"+window[a].gridClientID);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a)}))},500)}};d.prototype.toggleEnableDisplayModeSwitcher=function(b){window[this.settings.DisplayModeSwitcher].toggleEnableSwitcher(b)};
return d}();e.AggregatedPlanner=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(){function a(b,d){var c=this;window[b]=this;a.clientInstanceName=b;this.settings=d;this.inlineEditorOptions={multiline:{multiline:!0,autoResize:!0,editFieldCssClass:this.settings.Css.EditModeTextboxMultiline,watermarkCssClass:this.settings.Css.Watermark},singleline:{submitOnEnter:!0,editFieldAutoWidth:!1,editFieldCssClass:this.settings.Css.EditModeTextboxSingleline,watermarkCssClass:this.settings.Css.Watermark,editFieldDisplayInline:!0}};
$(function(){var a={};a[e.PlannerConstants.events.HybridEditorItemInlineModeChanged]=function(a,b){c.onColumnInlineModeChanged(a,b)};a[e.PlannerConstants.events.HybridEditorItemTextUpdated]=function(a,b){c.onColumnTextUpdated(a,b)};a[e.PlannerConstants.events.HybridEditorItemAjaxError]=function(a,b){c.onAjaxError(a,b)};a[e.PlannerConstants.events.HybridEditorItemSaveError]=function(a,b){c.onSaveError(a,b)};$(document).on(a,"div["+e.PlannerConstants.dataAttributes.HybridEditorItem+"]")})}a.prototype.replaceMediaContentWithPlaceholders=
function(){return!1};a.prototype.getSettings=function(a){var b=this.settings.Css.Watermark;switch(a.Type){case e.ClientColumnType.TopicTitle:var c=this.settings.WebMethods.UpdateTopicTitle;var d={courseId:this.settings.CourseId,topicId:a.EntityId};var f="inline";var k=this.settings.Terms.TopicTitleWatermark;b="";break;case e.ClientColumnType.TopicDescription:c=this.settings.WebMethods.UpdateTopicDescription;d={courseId:this.settings.CourseId,topicId:a.EntityId};f="hybrid";k=this.settings.Terms.ClickToAddText;
break;case e.ClientColumnType.PlanDescription:c=this.settings.WebMethods.UpdatePlanDescription;d={courseId:this.settings.CourseId,planId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()};f="hybrid";k=this.settings.Terms.PlanDescriptionWatermark;break;case e.ClientColumnType.PlanTitle:c=this.settings.WebMethods.UpdatePlanTitle;d={courseId:this.settings.CourseId,planId:a.EntityId};f="inline";k=this.settings.Terms.PlanTitleWatermark;b="";break;case e.ClientColumnType.ClassHours:c=
this.settings.WebMethods.UpdateClassHours;d={courseId:this.settings.CourseId,planId:a.EntityId};f="inline";k="0";b="";break;default:c=this.settings.WebMethods.UpdateCustomColumnContent,f="hybrid",k=this.settings.Terms.ClickToAddText,d={courseId:this.settings.CourseId,columnId:a.ColumnId,entityId:a.EntityId,replaceElementsWithPlaceholders:a.IsPlanColumn&&this.replaceMediaContentWithPlaceholders()}}return{hybridEditorClientId:this.settings.HybridEditorClientId,editModeEnabled:f,webMethodParams:d,saveContentWebUrl:c,
inlineEditorOptions:this.getInlineEditorOptions(a),editorDialogTitle:this.settings.Terms.Edit+" "+a.ColumnTitle,textContainerWatermark:k,textContainerWatermarkCssClass:b}};a.prototype.getInlineEditorOptions=function(b){var c=this.inlineEditorOptions.singleline;this.isMultilineColumn(b.Type)?c=this.inlineEditorOptions.multiline:b.Type===e.ClientColumnType.PlanTitle?c=$.extend({},this.inlineEditorOptions.singleline,a.planTitleMaxLength):b.Type===e.ClientColumnType.ClassHours&&(c=$.extend({},this.inlineEditorOptions.singleline,
a.classHoursMaxLength));return c};a.prototype.isMultilineColumn=function(a){return a===e.ClientColumnType.TopicDescription||a===e.ClientColumnType.PlanDescription||a===e.ClientColumnType.RichText};a.prototype.onColumnInlineModeChanged=function(a,b){a=$("#"+a.target.id);var c=this.getColumnData(a);c&&(b.isEditMode||b.isNewTextSaved||c.Type!==e.ClientColumnType.ClassHours||this.removeErrorControlFromCell(a))};a.prototype.onSaveError=function(a,b){a=$("#"+a.target.id);b=b.errorText;var c=this.getColumnData(a);
c&&b&&b.length&&c.Type===e.ClientColumnType.ClassHours&&!this.getErrorControl(a).length&&(a.append(this.renderErrorControl(b)),a.addClass(this.settings.Css.Error))};a.prototype.onAjaxError=function(a,b){b.xhrObject.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&alert(b.xhrObject.responseText?CCL.CommonFunctions.htmlDecode(b.xhrObject.responseText):this.settings.Terms.ErrorMessage)};a.prototype.onColumnTextUpdated=function(a,b){a=$("#"+a.target.id);var c=this.getColumnData(a);a&&(c&&c.Type===
e.ClientColumnType.ClassHours&&this.removeErrorControlFromCell(a),this.updateNoPrintContent(a,b.html),CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a),c.Type===e.ClientColumnType.TopicTitle&&b.customData&&e.PlannerUtility.updateTopicFolderNode(b.customData.folderId,b.customData.folderName),this.measureKpiEditPlan())};a.prototype.removeErrorControlFromCell=function(a){var b=this.getErrorControl(a);b.length&&($(a).removeClass(this.settings.Css.Error),b.remove())};a.prototype.updateNoPrintContent=
function(a,b){a.closest("."+this.settings.Css.CellWrapper).toggleClass(this.settings.Css.NoPrint,0===$.trim(b).length)};a.prototype.getErrorControl=function(a){return $(a).children("div.error")};a.prototype.renderErrorControl=function(a){return"<div class='error'>"+a+"</div>"};a.planTitleMaxLength=255;a.classHoursMaxLength=5;a.hybridEditorItemIdDataAttr="hybrid-editor-item-id";return a}();d.PlannerInlineCellBase=b})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(a){function b(b,c){a.call(this,b,c)}__extends(b,a);b.prototype.getEditorItemSettings=function(b){b=$("#"+b);b=this.getColumnData(b);return a.prototype.getSettings.call(this,b)};b.prototype.measureKpiEditPlan=function(){e.CbPlanner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){var b=a.closest("."+this.settings.Css.CbCellContainer),c=a.closest("."+this.settings.Css.CbPlanContainer);a=parseInt(b.data(e.PlannerConstants.dataAttributes.ColumnId),
10);var d=parseInt(b.data(e.PlannerConstants.dataAttributes.ColumnType),10);c=parseInt(c.data(e.PlannerConstants.dataAttributes.PlanId),10);b=b.data(e.PlannerConstants.dataAttributes.ColumnTitle);return{ColumnId:a,Type:d,IsPlanColumn:!0,EntityId:c,ColumnTitle:b}};return b}(d.PlannerInlineCellBase);d.PlannerCBInlineCell=b})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(){function a(a){var b=this;this.settings=a;this.terms=a.Terms;this.css=a.Css;this.contextDialog=new ContextDialog("#"+this.settings.TimeSpanPickerContentPanelId,{title:this.terms.DateContextDialogTitle,footerContent:this.settings.TimeSpanPickerFooterPanelId,setFocus:!1,width:592,zIndex:5});this.closeContextDialog=this.contextDialog.closeDialog;$(function(){b.contextDialog.setCloseFunction(function(a){return b.completeEditPlanDate(a)});
$(document).on("click","."+b.css.EditPlanTimeSpan,function(a){b.contextDialog.mainContainer.is(":visible")||b.editPlanDate(a)});$("#"+b.settings.CloseContextDialogButton).click(function(){return b.contextDialog.closeDialog()})})}a.prototype.editPlanDate=function(a){var b=this,c=$(a.currentTarget),d=this.getDatePicker();this.contextDialog.mainContainer.removeClass(this.css.CellError);this.currentPlanId=this.getCurrentPlanId(c);c=c.parent().find("input:hidden");var e=eval("("+c.val()+")");this.setDefaultDate(d,
c);d.setShowPopUpCallback(function(){b.openContextDialog(a);b.contextDialog.mainContainer.find(":radio:checked:first").focus()});d.showTimeSpan(e,this.currentPlanId)};a.prototype.completeEditPlanDate=function(a){var b=this;if(!a||!$(a.target).parents().andSelf().hasClass("ui-datepicker")){switch(this.getDatePicker().getCurrentMode()){case e.DatePickerMode.TimeSpan:var c=this.updatePlanTimeSpan(this.currentPlanId);break;case e.DatePickerMode.WeekAndDay:c=this.updatePlanWeekAndDay(this.currentPlanId);
break;case e.DatePickerMode.Event:c=this.updatePlanEvents(this.currentPlanId)}c&&c.always(function(){return b.focusOnDateEditAction(b.currentPlanId)})}};a.prototype.closeDatePicker=function(){this.closeContextDialog()};a.prototype.getDatePicker=function(){return window[this.settings.TimeSpanPickerInstanceName]};return a}();b.PlanDateCellBase=a})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(a){function b(b){a.call(this,b);this.courseId=b.CourseId;this.$contentBlockContainer=$("#"+b.ContentBlockClientId);this.cbPlanner=e.CbPlanner.getInstance()}__extends(b,a);b.prototype.updatePlanTimeSpan=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanTimeSpan,data:{courseId:this.courseId,planId:a,start:c.getStartDate(),stop:c.getStopDate(),filterStartDate:this.cbPlanner.getFilterStartDate(),
filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.TimeSpan)}).fail(function(){c.showErrorMsg(e.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanWeekAndDay,data:{courseId:this.courseId,planId:a,start:c.getStartWeek(),stop:c.getStopWeek(),filterStartDate:this.cbPlanner.getFilterStartDate(),
filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.WeekAndDay)}).fail(function(){c.showErrorMsg(e.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,c=this.getDatePicker(),d=c.getEvents();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanEvents,data:{courseId:this.courseId,planId:a,activityIds:d,filterStartDate:this.cbPlanner.getFilterStartDate(),filterStopDate:this.cbPlanner.getFilterStopDate()}}).done(function(a){a?
b.finalizeUpdateDate(a):c.showErrorMsg(e.DatePickerMode.Event)}).fail(function(){c.showErrorMsg(e.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(a,b){this.getDatePicker().setDefaultDate(this.cbPlanner.getFilterStartDate())};b.prototype.openContextDialog=function(a){var b=$(a.target).closest("."+this.settings.Css.CellContent);a=b.position();b=b.offset();this.contextDialog.openDialogAt(a.left+b.left+10,a.top+b.top-70,!1)};b.prototype.focusOnDateEditAction=function(a){$("."+this.css.EditPlanTimeSpan).focus()};
b.prototype.updateContent=function(a,b){a=$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.css.CellContent);var c=a.parent();a.replaceWith(b);this.cbPlanner.toggleTooltipForField(c.find("."+this.css.CellContent),!0,this.settings.Terms.Tooltip)};b.prototype.getCurrentPlanId=function(a){return parseInt(a.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId).toString(),10)};b.prototype.finalizeUpdateDate=
function(a){this.closeDatePicker();a.hidePlan?(this.showFeedback(a.message,a.extraButtonText,a.navigationUrl,a.periodStartDate),this.hidePlan(a.planId)):this.updateContent(a.planId,a.dateCell)};b.prototype.showFeedback=function(a,b,c,d){var e=this;CCL.InformationFeedback.showFeedbackWithextraButton(this.$contentBlockContainer,a,b,function(){c?window.location.href=c:d&&e.cbPlanner.changeDatePeriod(d);CCL.InformationFeedback.hideFeedback(e.$contentBlockContainer)})};b.prototype.hidePlan=function(a){1<
$("."+this.settings.Css.PlanContainer).length?$("."+this.settings.Css.PlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).remove():this.cbPlanner.reloadPlans()};return b}(b.PlanDateCellBase);b.PlanCbDateCell=a})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(){function a(b,c,d){var e=this;a.clientInstanceName=b;window[b]=this;this.settings=c;this.$plannerContainer=d;$(function(){e.loSelector=window[e.settings.LearningObjectiveSelectorInstanceName];e.attachEvents()})}a.getPlanLearningObjectivesCellInstance=function(){return window[a.clientInstanceName]};a.prototype.updateContent=function(a,b){this.getLearningObjectivesListCell(b).html(a)};a.prototype.updateLearningObjectives=
function(a){var b=this,c=this.currentPlanId;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.AddPlanLearningObjectives,data:{courseId:this.settings.CourseId,learningObjectiveIds:a,planId:c}}).done(function(a){a&&b.updateContent(a.ControlHtml,c)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.removeLOFromPlan=function(a,b,c){a={courseId:this.settings.CourseId,planId:a,learningObjectiveId:b};void 0!=c&&(a.showCollapsedList=c);return CCL.CommonFunctions.safeAjax({type:"DELETE",
url:this.settings.WebMethods.RemovePlanLearningObjective,data:a}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.attachEvents=function(){var a=this;this.$plannerContainer.on("click","."+this.settings.Css.AddLearningObjectives,function(b){a.currentPlanId=a.getCurrentPlanId($(b.currentTarget));a.loSelector.setSelectedIds(a.getLearningObjectiveIds(a.currentPlanId,!1),!0);a.loSelector.openDialog()});$(document).on("click","."+this.settings.Css.RemoveLearningObjective,function(b){b=$(b.currentTarget);
a.removeLearningObjective(b)})};a.prototype.getLearningObjectiveDataAttribute=function(a){return a?e.PlannerConstants.dataAttributes.RepositoryLearningObjectiveId:e.PlannerConstants.dataAttributes.LearningObjectiveId};return a}();b.PlanLearningObjectivesCellBase=a})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(a){function b(b,c){a.call(this,b,c,e.CbPlanner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var c=this,d=this.getCurrentPlanId(b),g=parseInt(b.closest("."+this.settings.Css.LearningObjectivesListItem).data(e.PlannerConstants.dataAttributes.LearningObjectiveId),10);a.prototype.removeLOFromPlan.call(this,d,g).done(function(){b.closest("."+c.settings.Css.LearningObjectivesListItem).remove()})};
b.prototype.getCurrentPlanId=function(a){a=a.closest("."+this.settings.Css.CbPlanContainer);return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId),10)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.CbPlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.AddLearningObjectives).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getLearningObjectiveIds=function(a,b){a=this.getLearningObjectivesListCell(a);
var c=this.getLearningObjectiveDataAttribute(b);b=a.find("."+this.settings.Css.LearningObjectivesListItem+CCL.CommonFunctions.getDataSelector(c));return $.map(b,function(a){return parseInt($(a).data(c),10)})};return b}(b.PlanLearningObjectivesCellBase);b.PlanCbLearningObjectivesCell=a})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(b,a){this.planId=b;this.columnId=a}}();e.PlanColumnId=f;var d=function(){function b(a,c){var d=this;window[a]=this;b.instanceName=a;this.settings=c;this.events=c.Events;this.css=c.Css;this.webMethods=c.WebMethods;this.terms=c.Terms;this.data=c.DataAttributes;this.currentDisplayMode=c.CurrentDisplayMode;this.kpi=c.Kpi;this.courseId=this.settings.CourseId;this.container=$("#"+c.Controls.ContainerId);this.plannerFilter=$("#"+c.Controls.PlannerFilterId);
this._ajaxLoader=$("#"+c.Controls.AjaxLoader);this._ajaxLoaderOverlay=$("#"+c.Controls.AjaxLoaderOverlay);setTimeout(function(){d.showNoTopicMessageIfNecessary()},0);var f=this;if(this.settings.Events&&this.settings.Events.TimelineControlInitialized&&this.currentDisplayMode===this.settings.DisplayModes.Timeline)$(document).on(this.settings.Events.TimelineControlInitialized,function(){d.toggleEnableDisplayModeSwitcher(!1);d.toggleTimelineMode(!0);d.toggleEnableDisplayModeSwitcher(!0)});CCL.CommonFunctions.attachPostMessageEventListener($(window),
CCL.MultipleSwitcher.onClickEventName,function(a){a=parseInt(a.extendedData.Key);a!==f.currentDisplayMode&&(f.currentDisplayMode=a,null!=f.webMethods&&null!=f.webMethods.Common&&null!=f.webMethods.Common.TogglePlannerDisplayMode?(f.toggleEnableDisplayModeSwitcher(!1),CCL.CommonFunctions.safeAjaxPost({url:f.webMethods.Common.TogglePlannerDisplayMode,data:{courseId:f.settings.CourseId,plannerDisplayMode:f.currentDisplayMode,childId:f.settings.ChildId}}).done(function(){f.toggleEnableDisplayModeSwitcher(!0);
f.changeDisplayMode()}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c);f.toggleEnableDisplayModeSwitcher(!0)})):f.changeDisplayMode())});this.settings.ReadOnlyMode||(CCL.CommonFunctions.attachPostMessageEventListener($(window),e.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,a.customId,!0)}),$.fn.scrollParent=function(){return $(document)})}
b.prototype.changeDisplayMode=function(){var a=this;this.toggleTimelineMode(this.isTimelineCurrentMode());this.isTimelineCurrentMode()||$.each(e.Cards.TopicCard.getAllTopicCards(),function(b,d){d.changeDisplayMode(a.currentDisplayMode)})};b.getInstance=function(){return window[b.instanceName]};b.prototype.getSetDateDialog=function(){return window[this.settings.Controls.SetDateDialog]};b.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};b.prototype.getTopicColorPicker=
function(){return window[this.settings.TopicColorPickerInstanceName]};b.prototype.openViewCellContentDialog=function(a,b,d,e){b=b||window.event;b=b.target||b.srcElement;if(!(b&&0<$(b).closest("a,input,button,textarea").length)){var c=window[this.settings.Controls.ViewHtmlTextCellContentDialog];null!=c&&null!=this.webMethods.Column.GetPlanHtmlTextCellContent&&(c.setAjaxUrl(this.webMethods.Column.GetPlanHtmlTextCellContent,null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planId:d,
columnId:e,childId:this.settings.ChildId,filterPersonId:0}:{publicAccessKey:this.settings.PublicAccessKey,planId:d,columnId:e}),a=$(a).closest("."+this.css.TableCell).children("."+this.css.PlanCellTitle).text(),c.setTitle(a),c.setAfterOpenDialogAjaxDynamicallySuccess(function(){CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(c.getContent())}),c.openDialog())}};b.prototype.getContainer=function(){return this.container};b.prototype.getPlannerFilter=function(){return this.plannerFilter};
b.prototype.getPlannerFeedback=function(){return window[this.settings.Controls.Feedback]};b.prototype.showConfirmDialog=function(a,b,d,e){void 0===d&&(d="");void 0===e&&(e="");CCL.CommonFunctions.jAjaxConfirm(a,this.terms.ConfirmTitle,""===d?this.terms.Yes:d,""===e?this.terms.No:e,b)};b.prototype.parseDateFromString=function(a){return null!=a?$.datepicker.parseDate(this.settings.DateFormat,a):null};b.prototype.showNoTopicMessageIfNecessary=function(){this.isTimelineCurrentMode()||this.settings.UseTopics&&
this.container.find("."+this.css.NoTopicsMessage).toggle(!this.hasTopicsOrPlansWithoutTopic())};b.prototype.togglePlannerSharing=function(){$("#"+this.settings.Controls.ShareMenuItem).toggle(this.hasTopics());$("#"+this.settings.Controls.StopSharingMenuItem).toggle(this.hasTopics())};b.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};b.prototype.hasTopicCardContainers=function(a){return this.settings.UseTopics?
0<e.Cards.TopicCard.getAllTopicCardContainers(a).length:!1};b.prototype.hasTopics=function(){return this.hasTopicCardContainers(!0)};b.prototype.hasTopicsOrPlansWithoutTopic=function(){return this.hasTopicCardContainers(!1)};b.prototype.getPlannerCellCssClass=function(){return this.currentDisplayMode===this.settings.DisplayModes.Table?this.css.TableCell:this.css.ListCell};b.prototype.toggleEnableDisplayModeSwitcher=function(a){window[this.settings.Controls.DisplayModeSwitcher].toggleEnableSwitcher(a)};
b.prototype.isTimelineCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Timeline};b.prototype.getCurrentDisplayMode=function(){return this.currentDisplayMode};b.prototype.isTableCurrentMode=function(){return this.currentDisplayMode===this.settings.DisplayModes.Table};b.prototype.toggleTimelineMode=function(a){var b=$("#"+this.settings.Controls.GridContainerId);b&&(this.settings.UseTopics?b.toggle(!a):e.Cards.TopicCard.getAllTopicCards()[0].getPlanGrid().getRowsContainer().toggle(!a));
(b=e.PlannerTimeline.getInstance())&&b.toggleTimeline(a,this.settings.UseTopics?this.hasTopics():!0);this.disableTopicToolbarActionItems(a)};b.prototype.disableTopicToolbarActionItems=function(a){if(!this.settings.ReadOnlyMode)if(this.settings.UseTopics){var b=$("#"+this.settings.Controls.AddTopicLink),d=$("#"+this.settings.Controls.ActionLink),f=[];f.push(b);f.push(d);e.Cards.TopicCard.disableMenuItems(f,a,this.settings.Css.DisabledMenuItem,this.settings.Css.DisabledMenuItemContainer,this.settings.Terms.DisableTopicMenuTooltip)}else e.Cards.TopicCard.getAllTopicCards()[0].disablePlanMenu(a)};
b.prototype.loadLargePlanTextContent=function(a){var b=this,d=$("."+CCL.CommonFunctions.getDataSelector(this.data.TopicId,a)).find("."+this.css.HtmlTextContentPlaceHolder);if(0===d.length)this.completeLoadingLargePlanContent(a);else{var e=[];$.each(d,function(a,c){a=$(c);e.push(new f(a.data(b.data.PlanId),a.data(b.data.ColumnId)))});this.processPlanColumnChunks(this.prepareChunks(e)).done(function(){return b.completeLoadingLargePlanContent(a)})}};b.prototype.stopSharingPlanner=function(){var a=this;
this.showConfirmDialog(this.settings.Terms.StopSharingPlannerConfirmText,function(b){b&&(a.toggleLoading(!0),CCL.CommonFunctions.safeAjaxPost({url:a.webMethods.ShareablePlanner.StopSharingPlanner,data:{courseId:a.settings.CourseId,plannerShareableObjectId:a.settings.ShareableObjectId}}).done(function(){window.location=window.location}).fail(function(b,c,d){a.toggleLoading(!1);CCL.CommonFunctions.alertAjaxError(b,c,d)}))})};b.prototype.processPlanColumnChunks=function(a){var b=this,d=a.splice(0,this.settings.ChunkSizeForLoadingLargeText);
return 0===d.length?$.when():$.when.apply($,d.map(function(a){return b.getPlanCellsWithLargeTextPromise(a)})).then(function(){b.processPlanColumnChunks(a)})};b.prototype.prepareChunks=function(a){if(!a||0===a.length)return[];for(var b=[],d=!0;d;)d=a.splice(0,this.settings.ChunkSizeForLoadingLargeText),b.push(d),d=0<a.length;return b};b.prototype.getPlanCellsWithLargeTextPromise=function(a){var b=this,d=[],f=[];a.forEach(function(a){d.push(a.planId);f.push(a.columnId)});return CCL.CommonFunctions.safeAjaxPost({url:this.webMethods.Plan.LoadCellsWithLargeText,
data:null==this.settings.PublicAccessKey?{courseId:this.settings.CourseId,planIds:d,columnIds:f,childId:this.settings.ChildId,currentDisplayMode:this.currentDisplayMode}:{publicAccessKey:this.settings.PublicAccessKey,planIds:d,columnIds:f,currentDisplayMode:this.currentDisplayMode}}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)}).done(function(a){if(a&&($.each(a.cellList,function(a,c){a=b.getPlanTextContentPlaceHolder(c.PlanId,c.ColumnId);a.replaceWith(c.Content);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a)}),
a.columnDataList)){var c=e.Cells.InlineCell.PlannerInlineCell.getInstance();c&&c.addColumnsToEdit(a.columnDataList)}})};b.prototype.getPlanTextContentPlaceHolder=function(a,b){return $("."+this.css.HtmlTextContentPlaceHolder+CCL.CommonFunctions.getDataSelector(this.data.PlanId,a)+CCL.CommonFunctions.getDataSelector(this.data.ColumnId,b))};b.prototype.toggleLoading=function(a){this._ajaxLoaderOverlay.toggle(a);this._ajaxLoader.toggle(a)};b.prototype.completeLoadingLargePlanContent=function(a){a=e.Cards.TopicCard.getInstance(a);
a.removePlanGridMessage();a.loadingLargePlanContentCompleted=!0};return b}();e.Planner=d})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function b(a){var c=this;this.loadingLargePlanContentCompleted=!0;window[b.getTopicCardInstanceName(a.TopicId)]=this;this._settings=a;var d=e.Planner.getInstance();this._topicId=this._settings.TopicId;d.settings.ReadOnlyMode||(this._termStartDate=d.parseDateFromString(this._settings.TermStartDate),this._termEndDate=d.parseDateFromString(this._settings.TermEndDate));this.hasPlans=this._settings.HasPlans;this.hasConnectedFolder=this._settings.HasConnectedFolder;
$(function(){c._planGrid=window[c._settings.PlanGridInstanceName];c._container=$("#"+c._settings.ContainerId);c._topicExpander=c._container.find("."+b.css.TopicExpander);c._topicCheckBox=$("#"+c._settings.TopicCheckBoxId);c._topicExpanderLink=c._container.find("#"+c._settings.TopicExpanderLinkId);c._topicColorPickerLink=c._container.find("#"+c._settings.TopicColorPickerLinkId);c.attachEvents();c.isTopicExpanded()&&!d.isTimelineCurrentMode()&&$(function(){c.refreshPlanGrid();0<c._settings.PlanIdToScroll&&
(c._planIdToScroll=c._settings.PlanIdToScroll)})})}b.setCommonSettings=function(a){b.planner=e.Planner.getInstance();b.commonSettings=a;b.css=b.commonSettings.Css;b.terms=b.commonSettings.Terms;b.isIos=b.planner.settings.IsIos;b.planner.settings.ReadOnlyMode||b.hideTopicMoveOptionsIfNecessary();null!=a.DisplayModeSwitcher&&(b.planner.settings.Controls.DisplayModeSwitcher=a.DisplayModeSwitcher)};b.getInstance=function(a){return window[b.getTopicCardInstanceName(a)]};b.getInstanceByContainer=function(a){a=
a.data(b.planner.data.TopicId);return window[b.getTopicCardInstanceName(a)]};b.prototype.getColorPickerLink=function(){return this._topicColorPickerLink};b.prototype.getColorSchema=function(){return this._settings.TopicColorSchema};b.prototype.getTopicCardContainer=function(){return this._container};b.topicCardsExist=function(){return null!=b.commonSettings};b.getAllTopicCardContainers=function(a){if(!b.topicCardsExist())return $();var c="";a&&(c="[data-"+b.planner.data.TopicId+"!=0]");return $("."+
b.commonSettings.Css.TopicContainer+c)};b.getAllTopicCards=function(){var a=[];b.getAllTopicCardContainers().each(function(c,d){c=b.getInstanceByContainer($(d));null!=c&&a.push(c)});return a};b.getTopicCardsForTopicIds=function(a){var c=[];null!=a&&0<a.length&&b.getAllTopicCardContainers().each(function(d,e){d=b.getInstanceByContainer($(e));null!=d&&-1<a.indexOf(d._topicId)&&c.push(d)});return c};b.getPlansForAllTopics=function(){return b.topicCardsExist()?$("."+b.css.Plans+" ."+b.css.PlanContainer):
$()};b.getParentTopicCardContainer=function(a){return a.closest("."+b.commonSettings.Css.TopicContainer)};b.getParentTopicCard=function(a){a=b.getParentTopicCardContainer(a);return b.getInstanceByContainer(a)};b.getParentPlanContainer=function(a){return a.closest("."+b.commonSettings.Css.PlanContainer)};b.prototype.getPlanGrid=function(){return this._planGrid};b.prototype.getSelectedPlanIds=function(a){var c=this._planGrid.getSelectedValues();return c.length?c:(a&&(a=e.Planner.getInstance().terms,
CCL.CommonFunctions.jAjaxAlert(b.terms.NothingSelected,a.Alert,a.Ok)),null)};b.prototype.clearPlanSelection=function(){return this._planGrid.toggleSelectAll(!1)};b.clearAllTopicSelection=function(){b.planner.getContainer().find("."+b.css.TopicSelector).each(function(a,c){(a=b.getParentTopicCard($(c)))&&a.isTopicSelected()&&a._topicCheckBox&&(a._topicCheckBox.prop("checked",!1),a.toggleTopicSelection())})};b.getSelectedTopicIds=function(a){var c=[];b.topicCardsExist()&&b.planner.getContainer().find("."+
b.css.TopicSelector).each(function(a,d){(a=b.getParentTopicCard($(d)))&&a.isTopicSelected()&&c.push(a._topicId)});return c.length?c:(a&&(a=e.Planner.getInstance().terms,CCL.CommonFunctions.jAjaxAlert(a.NoTopicsSelected,a.Alert,a.Ok)),null)};b.prototype.showPlanFeedbackMessage=function(a,b){this._planGrid.getFeedback().showMessage(a,b)};b.prototype.appendNewPlan=function(a,c){this._planGrid.removeEmptyText();this._planGrid.getRowsContainer().append(a);b.planner.currentDisplayMode===b.planner.settings.DisplayModes.Table&&
this._planGrid.updateHeaderRowCheckBoxSelection();c&&this.scrollToPlan(c);e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop(this._container)};b.prototype.removePlansFromGrid=function(a,b){for(var c in a)a.hasOwnProperty(c)&&this.getPlanContainerById(a[c]).remove();this._planGrid.updateFreezeState();0===this._planGrid.getRowsCount()&&this._planGrid.getRowsContainer().html(b)};b.prototype.getPlanContainerById=function(a){return this._planGrid.getRowById(a)};
b.prototype.sortPlans=function(a){for(var b in a)a.hasOwnProperty(b)&&this._planGrid.getRowsContainer().append(this.getPlanContainerById(a[b]))};b.prototype.refreshPlanGrid=function(a){var c=this;if(this._planGrid.isLoadingInProgress())return!1;b.startLoadingMonitor();b.planner.settings.ReadOnlyMode||this.disablePlanMenu(!0);this._planGrid.refresh().done(function(){CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(c._planGrid.getRowsContainer());a&&a()})};b.prototype.getTopicExpander=function(){return this._topicExpander};
b.prototype.getTopicExpanderLink=function(){return this._topicExpanderLink};b.prototype.updateTopicExpanderLink=function(a){this._topicExpanderLink.html(a)};b.prototype.toggleTopicSelection=function(){var a=this.isTopicSelected();this._planGrid.toggleSelectAll(a);this._planGrid.toggleDisableAll(a);this.disablePlanMenu(a,b.terms.DisabledMenuItemTooltip);this.toggleDisablePlanActionMenu(a)};b.prototype.isTopicSelected=function(){return this._topicCheckBox?this._topicCheckBox.is(":checked"):!1};b.prototype.getTopicId=
function(){return this._topicId};b.prototype.getTopicName=function(){return this._settings.TopicName};b.prototype.setTopicColorSchema=function(a,c){this._settings.TopicColorSchema=a;this._container.find("."+b.css.TopicColorContainer).removeClass().addClass(b.css.TopicColorContainer).addClass(c)};b.prototype.getLastPlanId=function(){return this._planGrid.getRowPrimaryKeyValueByIndex(this._planGrid.getRowsCount()-1)};b.prototype.getPlanIds=function(){return this._planGrid.getAllValues()};b.prototype.containsPlanElements=
function(a){var b=this,d=!1;$.each(a,function(a,c){return 0<b.getPlanContainerById(c).find(e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getActivityResourceListItemSelector()).length?(d=!0,!1):!0});return d};b.prototype.updatePlanCellsCallback=function(a){if(null!=a){for(var b={needToReloadFolders:!1},d=0;d<a.length;d++)this.refreshCell(a[d],b);a=top;b.needToReloadFolders&&a.reloadFolder&&a.reloadFolder("item0","planner",!0,!0)}};b.prototype.redirectToSharePlans=function(a){a=CCL.CommonFunctions.formatString(this._settings.SharePlansPageUrlTemplate,
a);window.location=a};b.prototype.redirectToShareTopic=function(){var a=CCL.CommonFunctions.formatString(this._settings.ShareTopicPageUrlTemplate,this._topicId);window.location=a};b.setDefaultDate=function(a,c){if(c=b.getInstance(c)){var d=Date.now();c=null!=c._termStartDate&&d<c._termStartDate||null!=c._termEndDate&&d>c._termEndDate?c._termStartDate:null;a.setDefaultDate(void 0!=c?c:null)}};b.prototype.setTermDates=function(a,b){this._termStartDate=a;this._termEndDate=b};b.hideTopicMoveOptionsIfNecessary=
function(){var a=b.getAllTopicCardContainers(!0);0<a.length&&$.each(a,function(c,d){if(d=$(d).find(CCL.CommonFunctions.getDataSelector(b.planner.data.DropDownMenuClientId)).attr("data-"+b.planner.data.DropDownMenuClientId))if(d=$(document).find("#"+d))d.find(CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveUpMenu)+","+CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveDownMenu)).show(),0===c&&d.find(CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveUpMenu)).hide(),c===
a.length-1&&d.find(CCL.CommonFunctions.getDataSelector(b.planner.data.TopicMoveDownMenu)).hide()})};b.prototype.showPlanActionMenu=function(){$("."+b.planner.css.PlanActionMenu).show()};b.prototype.hidePlanMoveOptionsIfNecessary=function(){var a=this._planGrid.getRows();if(0<a.length){$("."+b.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.TopicId,this._topicId)).show();$("."+b.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.TopicId,
this._topicId)).show();var c=a.first().data(b.planner.data.GridRowId);$("."+b.planner.css.PlanMoveUpMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.PlanId,c)).hide();a=a.last().data(b.planner.data.GridRowId);$("."+b.planner.css.PlanMoveDownMenuItem+CCL.CommonFunctions.getDataSelector(b.planner.data.PlanId,a)).hide()}};b.topicExpanderLinkClick=function(a){a.preventDefault();a=$(a.currentTarget);var c=b.getParentTopicCardContainer(a),d=b.getInstanceByContainer(c);c=c.find("."+b.css.Plans);
var e=d.getTopicExpander(),f=d.getPlanGrid();e.toggleClass(b.css.TopicExpanded);e.hasClass(b.css.TopicExpanded)?(f.getFeedback().hide(),d.refreshPlanGrid(),a.prop("title",b.terms.CollapseTooltip)):a.prop("title",b.terms.ExpandTooltip);c.slideToggle("fast")};b.prototype.scrollToPlan=function(a){var c=this,d=0,e=window,f=!1;b.isIos&&window!==window.top&&(d+=$('iframe[name="mainmenu"]',window.top.document).offset().top,e=window.top,f=!0);$("html, body",e.document).stop().animate({scrollTop:d+this.getPlanContainerById(a).offset().top-
this._planGrid.getToolbarElement().outerHeight()},function(){b.isIos&&c._planGrid.updateFreezeState(f)})};b.prototype.changeDisplayMode=function(a){this.updateGridView(a);a=a!==b.planner.settings.DisplayModes.Timeline;b.planner.settings.UseTopics&&(a=a&&this.isTopicExpanded());a&&this.refreshPlanGrid()};b.disableMenuItems=function(a,b,d,e,f){$.each(a,function(a,c){a=$(c);c=a.parent("li");var g=a.html(),h=a.attr("class");c.children("span."+d).remove();b?(c.addClass(e),a.hide(),c=$("<span>").attr("class",
h).attr("disabled","disabled").addClass(d).html(g),null!=f&&c.prop("title",f),a.after(c)):(c.removeClass(e),a.show())})};b.prototype.disablePlanMenu=function(a,c){var d=this._container.find("."+b.css.PlanGridToolbar).children("."+b.css.PlanGridToolbarItemsLeft).find("."+b.css.IconLink);b.disableMenuItems(d,a,b.css.DisabledMenuItem,b.css.DisabledMenuItemContainer,c)};b.prototype.toggleDisablePlanActionMenu=function(a){var c=this._container.find($("."+b.planner.css.PlanActionMenu));$.each(c,function(c,
d){c=$(d);c.toggleHyperlink(!a);c.prop("title",a?b.terms.DisabledMenuItemTooltip:"")})};b.prototype.removePlanGridMessage=function(){this._planGrid.removeGridMessage()};b.prototype.scrollToSelectedPlanOnLoad=function(a){var c=this;0>=a||setTimeout(function(){c._container.find("."+b.planner.css.HtmlTextCellViewer+" img[height]").each(function(a,b){a=$(b);b=parseInt(a.attr("height"))/parseInt(a.attr("width"));isNaN(b)||a.height()||(a.addClass("temp-height"),a.height(b*a.width()))});c.scrollToPlan(c._settings.PlanIdToScroll);
$(window).one("resize",function(){$(".temp-height").removeClass("temp-height").height("")})},500)};b.getTopicCardInstanceName=function(a){return b.commonSettings.TopicCardInstanceNamePrefix+a};b.prototype.isTopicExpanded=function(){return this._topicExpander.hasClass(b.css.TopicExpanded)};b.prototype.refreshCell=function(a,b){switch(a.ColumnType){case e.ColumnType.Date:this.refreshDateCell(a);break;case e.ColumnType.LearningObjectives:this.refreshPlanLoCell(a);break;case e.ColumnType.Resources:case e.ColumnType.Activities:case e.ColumnType.Elements:this.refreshElementCell(a),
b.needToReloadFolders=!0}};b.prototype.refreshDateCell=function(a){e.Cells.Plan.DateCell.PlanDateCell.getPlanDateCellInstance().updateContent(a.Content,a.PlanId,a.Properties.planActive);a.Properties.expanderText&&this.updateTopicExpanderLink(a.Properties.expanderText)};b.prototype.refreshElementCell=function(a){e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(a.Content,a.PlanId,a.ColumnId,!1,!1)};b.prototype.refreshPlanLoCell=function(a){e.Cells.Plan.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(a.Content,
a.PlanId)};b.prototype.attachEvents=function(){var a=this;b.planner.settings.ReadOnlyMode||($(document).on(b.planner.events.PlanActivationChanged,function(b,d){b=d.planActivations;null!=b&&$.each(b,function(b,c){0<a.getPlanContainerById(c.planId).length&&a._planGrid.toggleRowStatus(c.planId,c.planActive)})}),this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,function(){a.showPlanActionMenu();a.toggleTopicSelection();a.hidePlanMoveOptionsIfNecessary()}));this._planGrid.getGridElement().on(CclResponsiveGrid.LoadingCompletedEventName,
function(){a.loadLargePlanTextContent();null!=a._planIdToScroll&&(a.scrollToSelectedPlanOnLoad(a._planIdToScroll),a._planIdToScroll=null)});this._topicExpanderLink.click(b.topicExpanderLinkClick);this._topicCheckBox&&this._topicCheckBox.change(function(){return a.toggleTopicSelection()});b.planner.settings.ReadOnlyMode||this._topicColorPickerLink.click(function(){a._container.off(b.planner.events.ColorPickerColorChange);0<a._topicId&&(b.planner.getTopicColorPicker().setupAndOpenTopicColorPicker(a._topicId),
a._container.on(b.planner.events.ColorPickerColorChange,function(c,d){b.planner.getTopicColorPicker().updateTopicColor(a._topicId,d)}))})};b.prototype.loadLargePlanTextContent=function(){0<this._planGrid.totalCount&&(this.loadingLargePlanContentCompleted=!1,this._planGrid.addGridLoadingMessage(),b.planner.loadLargePlanTextContent(this._topicId))};b.prototype.updateGridView=function(a){this._planGrid.ajaxSettings.dataSourceWebMethodParams.currentDisplayMode=a;this._planGrid.setMode(a===b.planner.settings.DisplayModes.Table?
b.planner.css.GridViewModes.TableView:b.planner.css.GridViewModes.DefaultView)};b.startLoadingMonitor=function(){if(null==b.planLoadingProcessId){b.planner.toggleEnableDisplayModeSwitcher(!1);var a=b.getAllTopicCards();b.planLoadingProcessId=setInterval(function(){var c=!0;$.each(a,function(a,b){return b.getPlanGrid().isLoadingInProgress()||!b.loadingLargePlanContentCompleted?c=!1:!0});c&&(clearTimeout(b.planLoadingProcessId),b.planLoadingProcessId=null,b.planner.toggleEnableDisplayModeSwitcher(!0),
b.planner.settings.ReadOnlyMode||e.Cells.Plan.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().initDragAndDrop())},500)}};b.planLoadingProcessId=null;return b}();f.TopicCard=d})(e.Cards||(e.Cards={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(){function a(b,d){window[b]=this;a.instanceName=b;this.settings=d;this.css=this.settings.Css;this._planner=e.Planner.getInstance()}a.getInstance=function(){return window[a.instanceName]};a.prototype.togglePlanContentExpanderLink=function(a,b,d){a=$(a);a.hasClass(this.css.ExpanderLinkExpanded)?this.collapsePlanContentItems(a):this.expandPlanContentItems(a,b,d)};a.prototype.collapsePlanContentItems=function(a){var b=a.parent().find("li").toArray();
b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay);$.each(b,function(a,b){$(b).hide()});a.children("span").first().text(this.settings.Terms.ShowMore);a.removeClass(this.css.ExpanderLinkExpanded)};a.prototype.expandPlanContentItems=function(a,b,d){a.parent().find("ul").hasClass(this.css.ContentListPartiallyLoaded)?d&&d(a):(b=a.parent().find("li").toArray(),b.splice(0,this.settings.MaxCountOfPlanContentItemsToDisplay),$.each(b,function(a,b){$(b).show()}),a.children("span").first().text(this.settings.Terms.ShowLess),
a.addClass(this.css.ExpanderLinkExpanded))};a.prototype.loadAllPlanElements=function(a,b,e){var c=this;$.get(this.settings.WebMethods.LoadAllPlanElements,$.param(null==this._planner.settings.PublicAccessKey?{courseId:this._planner.settings.CourseId,planId:b,columnId:e,childId:this._planner.settings.ChildId,dashboardHierarchyId:this._planner.settings.DashboardHierarchyId,dashboardName:this._planner.settings.DashboardName}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b,columnId:e},
!0)).done(function(g){c._planner.settings.ReadOnlyMode?a.closest("."+c._planner.getPlannerCellCssClass()).html(g.ControlHtml):d.ResourcesCell.PlanActivityResourceCell.getPlanActivityResourceCellInstance().updateContent(g.ControlHtml,b,e,!1,!1)}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};a.prototype.loadAllLearningObjectives=function(a,b){var c=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadAllPlanLearningObjectives,data:null==this._planner.settings.PublicAccessKey?
{courseId:this._planner.settings.CourseId,planId:b,childId:this._planner.settings.ChildId}:{publicAccessKey:this._planner.settings.PublicAccessKey,planId:b}}).done(function(e){c._planner.settings.ReadOnlyMode?a.closest("."+c._planner.getPlannerCellCssClass()).html(e.ControlHtml):d.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance().updateContent(e.ControlHtml,b)}).fail(CCL.CommonFunctions.alertAjaxError)};return a}();d.PlanExpandableContentCellCommonLogic=b})(f.Plan||
(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){(function(d){(function(b){var a=function(){function a(a,b,c){this.fileUploadInProgress=!1;this.fakeElementItemId="fakeElementItemId";this.uploadProgressDataAttributeName="upload-in-progress";this.settings=a;this.courseId=b;this.controls=c}a.prototype.attachEvents=function(){var a=this;$(document).on("click","."+this.settings.Css.RemoveFromPlanLink,function(b){b=$(b.currentTarget);a.removeElementFromPlan(b)}).on("click","."+this.settings.Css.AddElementMenuItem+
", ."+this.settings.Css.AddElementShowAllMenuItem,function(b){b=$(b.currentTarget);switch(a.getDataAttributeValueAsNumber(b,e.PlannerConstants.dataAttributes.ElementExternalSource)){case f.AddResourceMenu.ElementExternalSourceType.Library:a.addFromLibrary(b);break;case f.AddResourceMenu.ElementExternalSourceType.Course:a.addFromCourse(b);break;case f.AddResourceMenu.ElementExternalSourceType.Computer:1===a.getDataAttributeValueAsNumber(b,a.uploadProgressDataAttributeName)?CCL.CommonFunctions.jAlertAjaxError(a.settings.Terms.WaitUntilPreviousFileIsUploaded,
"",a.settings.Terms.Ok,!1):a.addFromComputer(b)}CCL.AlternativeChoiceManager.closeOpenedDialog()}).on("click","."+this.settings.Css.AddElementLink,function(b){a.openElementSelector($(b.currentTarget))});this.attachSpecificEvents()};a.prototype.openElementSelector=function(a){var b=this,c=this.getPlanId(a),d=this.getElementType(a),g=this.getColumnId(a),k=this.getFolderId(a);d=this.settings.ElementSelectorClientInstanceNameTemplate.replace("{0}",d.toString());d=window[d];var p=d.getFirstColumn().find("a");
p.each(function(a,d){a=$(d);a.attr("href",b.updateAddLinkUrl(a.attr("href"),c,k))});d.getSecondColumn().find("a").each(function(a,b){$(b).attr("data-"+e.PlannerConstants.dataAttributes.PlanId,c).attr("data-"+e.PlannerConstants.dataAttributes.ColumnId,g).attr("data-"+e.PlannerConstants.dataAttributes.FolderId,k)});var r=d.getSecondColumn().find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.ElementExternalSource,f.AddResourceMenu.ElementExternalSourceType.Computer));r.css("opacity",
this.fileUploadInProgress?"0.5":"");r.attr("data-"+this.uploadProgressDataAttributeName,this.fileUploadInProgress?"1":"0");d.openDialog(a,this.getElementDialogOffset());CCL.CommonFunctions.isMobileDevice()||p.first().focus()};a.prototype.deletePlanElement=function(a,b,c){return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.DeletePlanElement,data:{courseId:this.courseId,planId:a,elementId:b,deleteFromCourse:c}}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.addFromLibrary=
function(a){var b=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType),c=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId),d=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.FolderId),g=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);a=this.getLibraryBrowserDialog();b={RelatedEntityId:c,ElementCategory:this.getElementCategoryAsStringByElementType(b),FolderId:d,CustomId:g.toString()};
b.LearningObjectivesIds=this.getLearningObjectiveIds(c,!0);a.browseLibrary(b)};a.prototype.addFromCourse=function(a){var b=this,c=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType),d=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId),g=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);a={locationId:this.courseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};var k=[],p=new Map;this.loadCurrentElementStates(d,
g,p);c={elementStates:p,elementType:c,showAll:!1,header:this.getElementLinkDialogTitle(c),afterOkClickCallback:function(a){a&&(a.forEach(function(a,b){a!==f.CheckboxStateMachine.State.AttachedByUser&&a!==f.CheckboxStateMachine.State.Saved||k.push(b)}),0<k.length&&b.updatePlanElements(d,k,g))},allowFolderSelection:c!==f.ElementLinkDialog.ContentElementType.Activities,openerPage:f.ElementLinkDialog.ElementsPopupOpener.Plan,relatedEntityId:d};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,
a)};a.prototype.addFromComputer=function(a){this.currentPlanId=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId);this.currentColumnId=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);$("#"+Components.ComponentName.localPicker).click()};a.prototype.onFileUploadSuccess=function(a){var b=this;this.fileUploadInProgress&&CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.CreateNewFileForPlan,data:{courseId:this.courseId,planId:this.currentPlanId,
fileName:a.name,fileId:a.id,signedFileId:a.signature}}).done(function(a){a.Success?b.refreshResourcesCell(b.currentPlanId,b.currentColumnId,!0):($("#"+b.fakeElementItemId).remove(),CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1))}).fail(function(){$("#"+b.fakeElementItemId).remove();CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,b.settings.Terms.ErrorOccurred,b.settings.Terms.Ok,!1)}).always(function(){b.fileUploadInProgress=
!1;b.currentColumnId=void 0;b.currentPlanId=void 0})};a.prototype.onFileUploadFailed=function(a,b){var c=this;this.fileUploadInProgress=!1;CCL.CommonFunctions.jAjaxConfirm(b,this.settings.Terms.FailedFileUploadChoiceDialogTitle,this.settings.Terms.FailedFileUploadChoiceDialogUploadNewFile,this.settings.Terms.FailedFileUploadChoiceDialogCancel,function(a){a?$("#"+Components.ComponentName.localPicker).click():(c.currentColumnId=void 0,c.currentPlanId=void 0)});$("#"+this.fakeElementItemId).remove()};
a.prototype.onFileSelected=function(a){this.fileUploadInProgress=!0;a='<li id="'+this.fakeElementItemId+'" class="'+this.settings.Css.ActivityResourceListItem+'">\n    <div class="'+this.settings.Css.FakeElementContainer+'">\n        <i class="'+this.settings.Css.FakeElementTitle+'">'+a[0].name+"</i>\n    </div>\n</li>";this.getActivityResourceList(this.currentPlanId,this.currentColumnId).append($(a));$("#"+this.fakeElementItemId+" ."+this.settings.Css.FakeElementContainer).prepend($(this.controls.LoadingWheel).addClass(""+
this.settings.Css.FakeElementImage))};a.prototype.updatePlanElements=function(a,b,c){var d=this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanElements,data:{courseId:this.courseId,planId:a,elementIds:b,columnId:c}}).done(function(){d.refreshResourcesCell(a,c,!0)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getDataAttributeValueAsNumber=function(a,b){return parseInt(a.attr("data-"+b),10)};a.prototype.getElementLinkDialogTitle=function(a){return a===f.ElementLinkDialog.ContentElementType.Activities?
this.settings.Terms.AddActivityModalTitle:this.settings.Terms.AddResourceModalTitle};a.prototype.getElementCategoryAsStringByElementType=function(a){switch(a){case f.ElementLinkDialog.ContentElementType.Resources:return e.ElementCategory[e.ElementCategory.Resource];case f.ElementLinkDialog.ContentElementType.Activities:return e.ElementCategory[e.ElementCategory.Activity]}};a.prototype.loadCurrentElementStates=function(a,b,c){CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetPlanElements,
data:{courseId:this.courseId,planId:a,columnId:b}}).done(function(a){a&&$.each(a.elementIds,function(a,b){c.set(b,f.CheckboxStateMachine.State.Saved)})}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getPlanContainer=function(a){return a.closest("."+this.settings.Css.PlanContainer)};a.prototype.updateAddLinkUrl=function(a,b,c){var d=a.lastIndexOf("?"),e=a.substring(0,d);a=a.substring(d+1).split("&");for(d=0;d<a.length;d++){var f=a[d].substring(0,a[d].indexOf("="));f.toLowerCase()===this.settings.RequestParameters.FolderId.toLowerCase()?
a[d]=f+"="+c:f.toLowerCase()===this.settings.RequestParameters.RelatedEntityId.toLowerCase()&&(a[d]=f+"="+b)}return e+"?"+a.join("&")};a.prototype.getElementType=function(a){return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementType)};return a}();b.PlanResourcesCellBase=a})(d.ResourcesCell||(d.ResourcesCell={}))})(k.Plan||(k.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(a){function b(c,d,f){a.call(this,d,d.CourseId,f);window[c]=this;b.instanceName=c;this.attachEvents();this.cbPlanner=e.CbPlanner.getInstance()}__extends(b,a);b.getPlanActivityResourceCellInstance=function(){return window[b.instanceName]};b.onFileUploadSuccess=function(a){b.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};b.onFileUploadFailed=function(a,c){b.getPlanActivityResourceCellInstance().onFileUploadFailed(a,
c)};b.onFileSelected=function(a){b.getPlanActivityResourceCellInstance().onFileSelected(a)};b.prototype.refreshResourcesCell=function(a,b,c){this.reloadPlanElements(a,b);c&&this.measureKpiEditPlan()};b.prototype.attachSpecificEvents=function(){var a=this;$(document).on("click","."+this.settings.Css.AddHomework,function(b){a.openElementSelector($(b.currentTarget))})};b.prototype.removeElementFromPlan=function(b){var c=this,d=b.closest("."+this.settings.Css.ActivityResourceListItem);b=this.getPlanId(b);
var f=this.getDataAttributeValueAsNumber(d,e.PlannerConstants.dataAttributes.ElementId);a.prototype.deletePlanElement.call(this,b,f,!1).done(function(){d.remove();c.measureKpiEditPlan()})};b.prototype.getLibraryBrowserDialog=function(){return this.cbPlanner.getLibraryBrowserDialog()};b.prototype.getActivityResourceCell=function(a,b){return this.getActivityResourceList(a,b).closest("."+this.settings.Css.CbCellContainer)};b.prototype.getActivityResourceList=function(a,b){return $("."+this.settings.Css.PlanContainer+
CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).find("."+this.settings.Css.ActivityResourceCell)};b.prototype.getLearningObjectiveIds=function(a,b){var c=d.LearningObjectivesCell.PlanLearningObjectivesCellBase.getPlanLearningObjectivesCellInstance();return c?c.getLearningObjectiveIds(a,b):[]};b.prototype.measureKpiEditPlan=function(){this.cbPlanner.measureEditPlan()};b.prototype.reloadPlanElements=function(a,b){var c=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ReloadPlanElements,
data:{courseId:this.courseId,planId:a,columnId:b}}).done(function(d){c.getActivityResourceCell(a,b).html(d.ControlHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};b.prototype.getPlanId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId)};b.prototype.getColumnId=function(a){return 0};b.prototype.getElementDialogOffset=function(){return-35};b.prototype.getFolderId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,
e.PlannerConstants.dataAttributes.FolderId)};return b}(b.PlanResourcesCellBase);b.PlanCbResourcesCell=a})(d.ResourcesCell||(d.ResourcesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.name=b;this.settings=a;window[this.name]=this;d.instanceName=this.name;this.settings=a;this.$useTopicsCheckbox=$("#"+this.settings.ClientIds.UseTopics);this.topicColumnsGrid=window[this.settings.TopicColumnsGridInstanceName];this.planColumnsGrid=window[this.settings.PlanColumnsGridInstanceName];this.$enableAnonymousAccessCheckbox=$("#"+this.settings.ClientIds.EnableAnonymousAccess);this.$addPlanRichTextColumnLink=$("#"+this.settings.ClientIds.AddPlanColumnLink);
this.countOfPlanRichTextColumns=this.settings.PlanRichColumnsCount;this.deletedTopicColumns=[];this.deletedPlanColumns=[];$(function(){c.toggleTopicSettings();c.togglePublicCopyLink();c.togglePlanDefaultStatusContainer();c.toggleAddPlanRichTextColumnLink();c.toggleElementsColumns();c.disableDragAndDropForColumnsByIds(c.settings.NotReorderableTopicColumnIds,!0);c.disableDragAndDropForColumnsByIds(c.settings.NotReorderablePlanColumnIds,!1);c.attachEvents();c.findRowTeplates()})}d.getInstance=function(){return window[d.instanceName]};
d.prototype.deleteCustomColumn=function(b,a){var c=this;b=$(b);var d=b.closest("."+this.settings.Css.GridRow);b.data(this.settings.DataAttributes.HasData)?this.showConfirmDialog(a?this.settings.Terms.DeleteCustomTopicColumnConfirmText:this.settings.Terms.DeleteCustomPlanColumnConfirmText,function(b){b&&(c.cacheDeletedItem(d,a),d.remove())}):(this.cacheDeletedItem(d,a),d.remove());a||(this.countOfPlanRichTextColumns--,this.toggleAddPlanRichTextColumnLink());return!1};d.prototype.afterOpenCopyPublicLinkDialog=
function(){CCL.CommonFunctions.safeAjaxPost({url:this.settings.MeasureCopyPublicLinkUrl})};d.prototype.save=function(){var b=!0;this.$useTopicsCheckbox.prop("checked")&&(b=this.validateColumnNames(this.topicColumnsGrid,!0));b=this.validateColumnNames(this.planColumnsGrid,b)&&b;if(!b)return event.stopPropagation(),!1;this.collectDataForSaving();return!0};d.prototype.showConfirmDialog=function(b,a){CCL.CommonFunctions.jAjaxConfirm(b,this.settings.Terms.ConfirmTitle,this.settings.Terms.Yes,this.settings.Terms.No,
a)};d.prototype.cacheDeletedItem=function(b,a){var c={};c.Id=b.data(this.settings.DataAttributes.GridRowId);c.IsDeleted=!0;0<c.Id&&(a?this.deletedTopicColumns.push(c):this.deletedPlanColumns.push(c))};d.prototype.addTopicCustomColumn=function(){this.addGridRow(this.topicColumnsGrid,this.$topicColumnTemplate)};d.prototype.addPlanCustomColumn=function(){this.$addPlanRichTextColumnLink.getIfHyperLinkEnabled()&&(this.addGridRow(this.planColumnsGrid,this.$planColumnTemplate),this.countOfPlanRichTextColumns++,
this.toggleAddPlanRichTextColumnLink())};d.prototype.findRowTeplates=function(){this.$topicColumnTemplate=this.topicColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$topicColumnTemplate.detach();this.$planColumnTemplate=this.planColumnsGrid.getRowById(this.settings.TemplateColumnId);this.$planColumnTemplate.detach()};d.prototype.addGridRow=function(b,a){var c=a.clone(!0).data(this.settings.DataAttributes.GridRowId,this.settings.NewColumnId);b.getRowsContainer().append(c);b=a.find(this.settings.ShowOnCoursePageInputSelector);
0<b.length&&(a=CCL.CommonFunctions.formatString(this.settings.ToggleInstanceNameTemplate,b[0].id),b=window[a],a=a+"_clone"+(new Date).getTime(),b.clone(c,a));c.find("input."+this.settings.Css.ColumnTitle).focus()};d.prototype.validateColumnNames=function(b,a){var c=this,d=!0,e;b.getRowsContainer().find("input."+this.settings.Css.ColumnTitle+":visible").each(function(a,b){a=$(b);d=c.validateColumnName(a)&&d;null!=e||d||(e=a)});null!=e&&a&&window.scrollTo(0,e.offset().top);return d};d.prototype.validateColumnName=
function(b){if(0===b.val().trim().length)return b.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","visible"),!1;b.parent().find("."+this.settings.Css.ErrorContainer).css("visibility","");return!0};d.prototype.toggleTopicSettings=function(){var b=this.$useTopicsCheckbox.prop("checked");$("#"+this.settings.ClientIds.TopicsHolder).toggle(b);var a=$("#"+this.settings.ClientIds.CreateFolderForEachNewTopic);b?(a.removeProp("readonly"),a.off("click",this.disabledCheckboxOnClick)):(a.prop("readonly",
"readonly"),a.on("click",this.disabledCheckboxOnClick))};d.prototype.togglePublicCopyLink=function(){var b=this.$enableAnonymousAccessCheckbox.prop("checked");$("#"+this.settings.ClientIds.CopyPublicLink).toggle(b)};d.prototype.togglePlanDefaultStatusContainer=function(){var b=$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).val()===this.settings.PlanActivationTypeManually;$("#"+this.settings.ClientIds.AutoActivationInfoContainer).toggle(!b);$("#"+this.settings.ClientIds.PlanDefaultStatusContainer).toggle(b)};
d.prototype.toggleElementsColumns=function(){for(var b=$("#"+this.settings.ClientIds.ElementColumnsRadioList+" input:checked").val()===this.settings.UseGenericElementsColumn,a=this.planColumnsGrid,c=0;c<this.settings.SeparateElementColumnIds.length;c++)$(a.getRowById(this.settings.SeparateElementColumnIds[c])).toggle(!b);$(a.getRowById(this.settings.GenericElementsColumnId)).toggle(b)};d.prototype.reorderFieldSuccess=function(){$("#"+this.settings.ClientIds.ReorderDataHiddenField).val("true")};d.prototype.collectDataForSaving=
function(){if(this.$useTopicsCheckbox.prop("checked")){var b=$("#"+this.settings.ClientIds.TopicColumnDataHiddenField),a=this.topicColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(b,a,this.deletedTopicColumns)}b=$("#"+this.settings.ClientIds.PlanColumnDataHiddenField);a=this.planColumnsGrid.getRowsContainer().find("."+this.settings.Css.GridRow);this.collectData(b,a,this.deletedPlanColumns)};d.prototype.collectData=function(b,a,c){var d=this,e=[];a.each(function(a,
b){a=$(b);b=a.find("."+d.settings.Css.ColumnTitle);var f=a.find("."+d.settings.Css.ColumnType),g=a.find("."+d.settings.Css.ColumnVisibleFor),h=a.find(d.settings.ShowOnCoursePageInputSelector),m={};m.Id=a.data(d.settings.DataAttributes.GridRowId);m.Title=b.val().trim();m.ColumnType=f.val();m.VisibleFor=g.val();m.ShowOnCoursePage=h.is(":checked");m.IsDeleted=!1;e.push(m);e=e.concat(c)});b.val(JSON.stringify(e))};d.prototype.attachEvents=function(){var b=this;this.$useTopicsCheckbox.on("change",function(){b.toggleTopicSettings()});
this.$enableAnonymousAccessCheckbox.on("change",function(){b.togglePublicCopyLink()});$("#"+this.settings.ClientIds.PlanActivationTypeDropdown).on("change",function(){b.togglePlanDefaultStatusContainer()});this.topicColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(a){a=$(a.currentTarget);b.validateColumnName(a)});this.planColumnsGrid.getRowsContainer().find("input."+this.settings.Css.ColumnTitle).on("input paste",function(a){a=$(a.currentTarget);
b.validateColumnName(a)});$("#"+this.settings.ClientIds.ElementColumnsRadioList).on("change",function(){b.toggleElementsColumns()})};d.prototype.disableDragAndDropForColumnsByIds=function(b,a){a=a?this.topicColumnsGrid:this.planColumnsGrid;for(var c=0;c<b.length;c++)a.getRowById(b[c]).removeClass(this.settings.Css.ReorderableGridRow)};d.prototype.toggleAddPlanRichTextColumnLink=function(){var b=this.countOfPlanRichTextColumns<this.settings.MaxNumberOfRichTextColumnsInPlan;this.$addPlanRichTextColumnLink.toggleHyperlink(b);
b?this.$addPlanRichTextColumnLink.removeAttr("title"):this.$addPlanRichTextColumnLink.attr("title",this.settings.Terms.AddPlanRichTextColumnLinkDisabledTooltip)};d.prototype.disabledCheckboxOnClick=function(){return!1};return d}();e.CustomizePlanner=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){return function(){}}();e.CurrentParameters=d;d=function(){function b(a,b){window[a]=this;this.settings=b;this.$container=$("#"+this.settings.Controls.ContainerId)}b.prototype.clearContainer=function(){this.$container&&(this.$container.find("iframe,object").css("visibility","hidden"),this.$container.html(""))};b.prototype.openDialog=function(a,b,d,e,f){this.currentParameters||(this.currentParameters={});this.currentParameters.EventId=b;this.currentParameters.CourseId=
a;null!=d&&window[this.settings.Controls.DialogTarget].setTitle(d);void 0!=e&&(this.currentParameters.ViewForPersonId=e);void 0!=f&&(this.currentParameters.ChildId=f);this.clearContainer();window[this.settings.Controls.DialogTarget].openDialog()};b.prototype.loadEventPlans=function(){if(this.currentParameters){var a=this.$container;a&&$.ajax({type:"GET",url:this.settings.WebMethods.GetEventPlansXhtml,async:!1,data:{courseId:this.currentParameters.CourseId,eventUniqueId:this.currentParameters.EventId,
childId:null==this.currentParameters.ChildId?0:this.currentParameters.ChildId,viewForPersonId:null==this.currentParameters.ViewForPersonId?0:this.currentParameters.ViewForPersonId,dashboardHierarchyId:this.settings.DashboardHierarchyId}}).done(function(b){a.html(b.contentHtml);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a)}).fail(function(b){return a.html(b.responseText)})}};b.prototype.togglePlanDetails=function(a,b,d,e,f,l){var c=this,g=this,h=$(a),m=h.parent().find("."+this.settings.CssClasses.PlanContainerCss);
a=m.is(":visible");h.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.PlanDetailsExpanderImage)).toggleClass(this.settings.CssClasses.ForwardImage,a).toggleClass(this.settings.CssClasses.ChevronDownImage,!a);m.data(this.settings.DataAttributes.PlanDetailsContentLoaded)||$.ajax({type:"GET",url:this.settings.WebMethods.GetSinglePlanXhtml,async:!1,data:{courseId:b,planId:d,childId:e,viewForPersonId:f,showFullPlannerLink:l,dashboardHierarchyId:this.settings.DashboardHierarchyId}}).done(function(a){m.html(a.contentHtml);
m.data(g.settings.DataAttributes.PlanDetailsContentLoaded,"true");CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(m)}).fail(function(a){return m.html(a.responseText)});m.slideToggle("fast",function(){h.prop("title",m.is(":visible")?c.settings.Terms.HideDetails:c.settings.Terms.ViewDetails);m.css("overflow","")})};return b}();e.EventPlansDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function b(a,c){var d=this;window[a]=this;b.instanceName=a;this._settings=c;this._planner=e.Planner.getInstance();$("#"+c.MoveToTopicOkButtonId).click(function(){d.movePlansToTopicOkBtnClick()})}b.getInstance=function(){return window[b.instanceName]};b.prototype.openDialog=function(a,b){void 0===b&&(b=null);var c=e.Cards.TopicCard.getInstance(a);null==b&&(b=c.getSelectedPlanIds(!0));null!=b&&(this.initTopicDropDownListControl(),this._topicId=
a,this._planIds=b,this.reloadTopicList(),this._topicDropDownList.val(a.toString()),0<this._topicDropDownList.children().length&&this.getCssModal().openDialog())};b.prototype.movePlansToTopicOkBtnClick=function(){var a=this,b=this._topicId,d=this._topicDropDownList.val();if(b==d)CssModal.closeDialog();else{var f=e.Cards.TopicCard.getInstance(b),m=e.Cards.TopicCard.getInstance(d),l=f.getPlanGrid(),k=m.getPlanGrid();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Plan.MovePlansToTopic,
data:{courseId:this._planner.settings.CourseId,srcTopicId:b,dstTopicId:d,planIds:this._planIds,start:this._planner.settings.FilterStartDate,end:this._planner.settings.FilterEndDate,showPlanDates:this._planner.settings.ShowDates}}).done(function(b){l.toggleSelectAll(!1);k.removeEmptyText();var c=!m.hasPlans&&a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table;f.hasPlans=b.srcTopicHasPlans;m.hasPlans=!0;if(k.getGridElement().is(":visible"))if(c)for(m.refreshPlanGrid(),c=0;c<b.sortedPlanIds.length;c++)l.getRowById(b.sortedPlanIds[c]).remove();
else{c=k.getRowsContainer();for(var d=0;d<b.sortedPlanIds.length;d++)c.append(l.getRowById(b.sortedPlanIds[d]));a._planner.currentDisplayMode===a._planner.settings.DisplayModes.Table&&k.updateHeaderRowCheckBoxSelection();m.isTopicSelected()&&m.toggleTopicSelection()}else for(c=0;c<b.sortedPlanIds.length;c++)l.getRowById(b.sortedPlanIds[c]).remove();0===l.getRowsCount()&&l.getRowsContainer().html(b.emptyGridText);f.updateTopicExpanderLink(b.srcExpanderText);m.updateTopicExpanderLink(b.dstExpanderText);
f.hidePlanMoveOptionsIfNecessary();m.hidePlanMoveOptionsIfNecessary();CssModal.closeDialog()})}};b.prototype.initTopicDropDownListControl=function(){null==this._topicDropDownList&&(this._topicDropDownList=$("#"+this._settings.TopicDropDownListId))};b.prototype.reloadTopicList=function(){var a=this;this._topicDropDownList.empty();e.Cards.TopicCard.getAllTopicCardContainers().each(function(b,d){b=$(d);b=e.Cards.TopicCard.getInstanceByContainer(b);b=$('<option value="'+b.getTopicId()+'"></option>').text(b.getTopicName());
a._topicDropDownList.append(b)})};b.prototype.getCssModal=function(){return window[this._settings.MoveToTopicCssModalId]};return b}();f.PlanMoveToTopicDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d;(function(a){a[a.Initial=0]="Initial";a[a.Progress=1]="Progress";a[a.Error=2]="Error";a[a.Result=3]="Result"})(d||(d={}));var b;(function(a){a[a.CopyPlans=0]="CopyPlans";a[a.CopyTopics=1]="CopyTopics"})(b||(b={}));var a=function(){function a(b,c){this.settings=c;window[b]=this;a.instanceName=b;this.terms=c.Terms;this.css=c.Css;this.controls=c.Controls;this.webMethods=c.WebMethods;this.controlInitialized=!1}a.prototype.open=function(a,c,e,f){if(null!=c){this.initControls();
this.idsToCopy=c();if(a){if(null==this.idsToCopy||!this.idsToCopy.length){CCL.CommonFunctions.jAlertAjaxError(this.terms.NoTopicsSelected,this.terms.Alert,this.terms.Ok,!1);return}this.currentCopyMode=b.CopyTopics;this.$selectCourseLabel.text(this.terms.CopyTopicsToCourse)}else{if(null==this.idsToCopy||!this.idsToCopy.length){CCL.CommonFunctions.jAlertAjaxError(this.terms.NoPlansSelected,this.terms.Alert,this.terms.Ok,!1);return}this.currentCopyMode=b.CopyPlans;this.$selectCourseLabel.text(this.terms.CopyPlansToCourse)}this.clearSelectionCallback=
e;this.topicIdForCopyPlans=f;this.setCopyStage(d.Initial);this.getCssModal().openDialog()}};a.prototype.copy=function(){this.$coursesList.val()?(this.setCopyStage(d.Progress),this.copyInternal(this.currentCopyMode===b.CopyPlans?this.webMethods.CopyPlans:this.webMethods.CopyTopics)):this.$selectCourseErrorContainer.show()};a.prototype.copyInternal=function(a){var b=this,c=0<this.$optionOverwriteAssessmentCriteria.length?this.$optionOverwriteAssessmentCriteria.prop("checked"):!1;CCL.CommonFunctions.safeAjaxPost({url:a,
data:{sourceCourseId:this.settings.CourseId,targetCourseId:parseInt(this.$coursesList.val()),targetTopicId:parseInt(this.$targetCourseTopicsDropdown.val()),clearDates:this.$optionClearDates.prop("checked"),copyResourcesAndActivities:this.$optionCopyResourcesAndActivities.prop("checked"),overwriteAssessmentCriteria:c,elementIds:this.idsToCopy}}).done(function(a){b.$resultMessageHolder.html(a.ResultMessage);b.$resultNotesHolder.hide();0<a.ResultWarningNotes.length&&(b.$resultNotesHolder.show(),b.$resultNotesHolder.find("ol").html(a.ResultWarningNotes).show());
b.setCopyStage(d.Result)}).fail(function(){b.setCopyStage(d.Error)})};a.prototype.updateTopicsDropdown=function(a){var b=this;0!==a&&(this.$targetCourseTopicsDropdown.children().remove(),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetTopics,data:{courseId:this.settings.CourseId,targetCourseId:a,originalTopicId:this.topicIdForCopyPlans}}).done(function(a){0===a.length&&b.$targetCourseTopicsPanel.hide();var c=b.settings.TopicsDropdownDefaultValue;c=$.grep(a,function(a){return!a.IsNewGroup});
c=b.addItemsToTopicDropdown(c,b.$targetCourseTopicsDropdown);a=$.grep(a,function(a){return a.IsNewGroup});if(a.length){var d=$("<optgroup></optgroup>").attr("label",b.terms.CreateNewTopic);b.addItemsToTopicDropdown(a,d);d.appendTo(b.$targetCourseTopicsDropdown)}b.$targetCourseTopicsDropdown.val(c.toString())}).fail(function(){b.setCopyStage(d.Error)}))};a.prototype.addItemsToTopicDropdown=function(a,b){var c=this.settings.TopicsDropdownDefaultValue;$.each(a,function(a,d){b.append($("<option />").val(d.TopicId.toString()).text(d.Name));
d.Selected&&(c=d.TopicId)});return c};a.prototype.getCssModal=function(){return window[this.settings.CssModalClientInstance]};a.prototype.initControls=function(){var a=this;this.controlInitialized||(this.$selectCourseLabel=$("#"+this.controls.SelectCourseLabel),this.$coursesList=$("#"+this.controls.CoursesList),this.$optionClearDates=$("#"+this.controls.OptionClearDates),this.$optionOverwriteAssessmentCriteria=$("#"+this.controls.OptionOverwriteAssessmentCriteria),this.$optionCopyResourcesAndActivities=
$("#"+this.controls.OptionCopyResourcesAndActivities),this.$resultMessageHolder=$("#"+this.controls.ResultMessageHolder),this.$resultNotesHolder=$("#"+this.controls.ResultNotesHolder),this.$overwriteAssessmentCriteriaPanel=$("#"+this.controls.OverwriteAssessmentCriteriaPanel),this.$dialogCancelButton=$("#"+this.controls.DialogCancelButton),this.$dialogOkButton=$("#"+this.controls.DialogOkButton),this.$dialogCloseButton=$("."+this.css.DialogCloseButton),this.$initialPanel=$("#"+this.controls.InitialPanel),
this.$progressPanel=$("#"+this.controls.ProgressPanel),this.$resultPanel=$("#"+this.controls.ResultPanel),this.$errorPanel=$("#"+this.controls.ErrorPanel),this.$copyOptions=$("#"+this.controls.CopyOptions),this.$targetCourseTopicsPanel=$("#"+this.controls.TargetCourseTopicsPanel),this.$targetCourseTopicsDropdown=$("#"+this.controls.TargetCourseTopicsList),this.$selectCourseErrorContainer=this.$initialPanel.find("."+this.css.CopyError),this.$coursesList.on("change",function(b){a.onCourseListChange(b)}),
this.controlInitialized=!0)};a.prototype.setCopyStage=function(a){switch(a){case d.Initial:this.$coursesList.val(null);this.$optionClearDates.prop("checked",!1);this.$optionCopyResourcesAndActivities.prop("checked",!0);0<this.$overwriteAssessmentCriteriaPanel.length&&(this.$overwriteAssessmentCriteriaPanel.show(),this.setOverwriteAssessmentCriteriaControlsState(e.CopyDialogOverwriteAssessmentCriteriaState.Show,!0));this.$targetCourseTopicsPanel.hide();this.$dialogOkButton.text(this.terms.Copy);this.$copyOptions.hide();
this.$selectCourseErrorContainer.hide();break;case d.Result:null!=this.clearSelectionCallback&&this.clearSelectionCallback();break;case d.Error:this.$dialogOkButton.text(this.terms.Retry)}this.$dialogCloseButton.toggle(a!==d.Progress);this.$dialogCancelButton.toggle(a!==d.Progress).text(a===d.Initial?this.terms.Cancel:this.terms.Close);this.$dialogOkButton.toggle(a===d.Initial||a===d.Error);this.$initialPanel.toggle(a===d.Initial);this.$progressPanel.toggle(a===d.Progress);this.$resultPanel.toggle(a===
d.Result);this.$errorPanel.toggle(a===d.Error)};a.prototype.setOverwriteAssessmentCriteriaControlsState=function(a,b){0<this.$optionOverwriteAssessmentCriteria.length&&(this.$optionOverwriteAssessmentCriteria.prop("disabled",a===e.CopyDialogOverwriteAssessmentCriteriaState.Disable),this.$overwriteAssessmentCriteriaPanel.toggleClass(this.css.Inactive,a===e.CopyDialogOverwriteAssessmentCriteriaState.Disable),this.$overwriteAssessmentCriteriaPanel.find("#"+this.controls.OverwriteAssessmentCriteriaLabel).toggle(a===
e.CopyDialogOverwriteAssessmentCriteriaState.Disable),b&&this.$optionOverwriteAssessmentCriteria.prop("checked",!1))};a.prototype.onCourseListChange=function(a){var c=$(a.currentTarget).val();this.$selectCourseErrorContainer.toggle(!c);this.$copyOptions.toggle(0!==c.length);if(this.currentCopyMode===b.CopyPlans&&0!==c.length){var d=!0;this.settings.CourseIdsNotUsedTopics&&($.each(this.settings.CourseIdsNotUsedTopics,function(a,b){return b===c?d=!1:!0}),this.$targetCourseTopicsPanel.toggle(d));d&&
this.updateTopicsDropdown(c)}0<this.$overwriteAssessmentCriteriaPanel.length&&(this.settings.OverwriteAssessmentCriteriaStateData?(a=parseInt(this.settings.OverwriteAssessmentCriteriaStateData[c]),this.$overwriteAssessmentCriteriaPanel.toggle(a!==e.CopyDialogOverwriteAssessmentCriteriaState.Hide),0<this.$optionOverwriteAssessmentCriteria.length&&this.setOverwriteAssessmentCriteriaControlsState(a,!1)):this.$overwriteAssessmentCriteriaPanel.toggle(c!==this.settings.CourseId))};return a}();e.PlannerCopyDialog=
a})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){window[b]=this;d.instanceName=b;this._settings=a;this._terms=a.Terms;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId}d.getInstance=function(){return window[d.instanceName]};d.prototype.addTopic=function(b,a,c,d){CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.AddTopic,data:{courseId:this._courseId,topicName:b,topicColorSchema:a},success:function(a){null!=c&&c();a&&a.refreshUrl&&(window.location.href=
a.refreshUrl)},error:function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c);null!=d&&d()}})};d.prototype.shareTopic=function(b,a){var c=this;if(b){var d=e.Cards.TopicCard.getInstance(b);CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.ShareablePlanner.CheckTopicDataForSharing,data:{courseId:this._courseId,topicId:b,isTopicSharedByAnotherAuthor:a}}).done(function(a){a&&a.conflictMessage?CCL.CommonFunctions.jAjaxAlert(a.conflictMessage,c._planner.terms.Alert,c._planner.terms.Ok):a&&
a.warningMessage?c._planner.showConfirmDialog(a.warningMessage,function(a){a&&d.redirectToShareTopic()}):d.redirectToShareTopic()}).fail(CCL.CommonFunctions.alertAjaxError)}};d.prototype.stopSharingTopic=function(b,a){var c=this;a&&CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.ShareablePlanner.StopSharingTopic,data:{courseId:this._courseId,topicId:a}}).done(function(a){a&&a.message?CCL.CommonFunctions.jAjaxAlert(a.message,c._planner.terms.Alert,c._planner.terms.Ok):window.location=
window.location}).fail(CCL.CommonFunctions.alertAjaxError)};d.prototype.deleteTopic=function(b){this.deleteTopics([b],!1)};d.prototype.deleteTopics=function(b,a){var c=this;void 0===b&&(b=null);void 0===a&&(a=!0);a&&null==b&&(b=e.Cards.TopicCard.getSelectedTopicIds(!0));null!=b&&(a=this.getDeleteTopicsConfirmationMessage(b),this._planner.showConfirmDialog(a,function(a){a&&CCL.CommonFunctions.safeAjaxPost({url:c._planner.webMethods.Topic.DeleteTopics,data:{courseId:c._courseId,topicIds:b}}).done(function(a){0<
a.deletedTopics.length&&($.each(a.deletedTopics,function(a,b){b.topicId&&0<b.topicId&&(e.Cards.TopicCard.getInstance(b.topicId).getTopicCardContainer().remove(),c.updateFilterAfterDeleting(b.topicId));b.folderId&&0<b.folderId&&e.PlannerUtility.deleteTopicFolderNode(b.folderId)}),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary(),c._planner.showNoTopicMessageIfNecessary(),c.showTopicFeedbackMessage(a.restoreText),c._planner.togglePlannerSharing())}).fail(CCL.CommonFunctions.alertAjaxError)},this._planner.terms.Delete,
this._planner.terms.Cancel))};d.prototype.restoreTopics=function(b){CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.RestoreTopics,data:{courseId:this._courseId,topicIds:b}}).done(function(a){a&&a.refreshUrl&&(window.location.href=a.refreshUrl)}).fail(CCL.CommonFunctions.alertAjaxError)};d.prototype.moveUpTopic=function(b){if(b){var a=e.Cards.TopicCard.getInstance(b).getTopicCardContainer(),c=a.prev();if(c){var d=e.Cards.TopicCard.getInstanceByContainer(c).getTopicId();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.SwapTopics,
data:{courseId:this._courseId,firstTopicId:b,secondTopicId:d},success:function(b){b&&(a.insertBefore(c),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};d.prototype.moveDownTopic=function(b){if(b){var a=e.Cards.TopicCard.getInstance(b).getTopicCardContainer(),c=a.next();if(c){var d=e.Cards.TopicCard.getInstanceByContainer(c).getTopicId();CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.Topic.SwapTopics,data:{courseId:this._courseId,
firstTopicId:b,secondTopicId:d},success:function(b){b&&(a.insertAfter(c),e.Cards.TopicCard.hideTopicMoveOptionsIfNecessary())},error:CCL.CommonFunctions.alertAjaxError})}}};d.prototype.updateFilterAfterDeleting=function(b){var a=this._planner.getPlannerFilter().find("optgroup[label='Topic']");a.find("option[value='t"+b+"']").remove();0===a.find("option[value^='t']").length&&a.remove()};d.prototype.showTopicFeedbackMessage=function(b){this._planner.getPlannerFeedback().showMessage(CCL.FeedbackType.Information,
b)};d.prototype.getDeleteTopicsConfirmationMessage=function(b){if(null==b||0===b.length)return"";var a=!1;e.Cards.TopicCard.getTopicCardsForTopicIds(b).forEach(function(b){b.hasConnectedFolder&&(a=!0)});b=1<b.length;var c="";return c=a?b?this._terms.DeleteTopicsConnectedToFolderConfirmText:this._terms.DeleteOneTopicConnectedToFolderConfirmText:b?this._terms.DeleteTopicsConfirmText:this._terms.DeleteOneTopicConfirmText};return d}();e.TopicCommonLogic=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){var c=this;window[b.instanceName]=this;this.playPlanContentItemIdAttributeName=a;$("body").on("click",CCL.CommonFunctions.getDataSelector(this.playPlanContentItemIdAttributeName),function(a){a.preventDefault();(a=$(a.currentTarget))&&(a=a.data(c.playPlanContentItemIdAttributeName))&&b.openPlayPlanDialog(a)});if((a=window.top.history.state)&&a.playPlanDialogState){var d=a.playPlanDialogState;d.itemId&&$(function(){b.openPlayPlanDialog(d.itemId)})}}b.openPlayPlanDialog=
function(a){var b=a.split("_")[0];e.PlayPlanDialog.getClientInstance().open(b,a)};b.getInstance=function(){return window[b.instanceName]};b.instanceName="playPlanDialogOpenerClientInstanceName";return b}();e.PlayPlanDialogOpener=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){var c=this;this.indexDialogWidth=500;this.itemIdDataAttributeName="itemId";this.lastTreeLinkIdToNavigate=this.lastPlanItemIndexBeforeNavigateByTreeLink=void 0;this.onEscape=function(a){a.which===CCL.CommonConstants.keyCodes.escape&&(c.indexDialog.isOpened()?c.indexDialog.closeDialog():c.toggleDialog(!1))};this.closeTooltip=function(a){setTimeout(function(){return c.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,d){setTimeout(function(){c.toolTip.isTooltipOpened()||
c.$tooltipContentLabel.html(b);c.toolTip.openTooltip(a,c.tooltipPositionSettings)},d)};window[b.clientInstanceName]=this;this.settings=a;$(function(){c.$body=$("body");c.$bodyWrapper=$("."+c.settings.CssClasses.BodyWrapper);c.$dialog=$("#"+c.settings.Controls.Dialog);c.$topicColumnNameLabel=$("#"+c.settings.Controls.TopicColumnNameLabel);c.$planColumnNameLabel=$("#"+c.settings.Controls.PlanColumnNameLabel);c.$topicTitleLabel=$("#"+c.settings.Controls.TopicTitleLabel);c.$planTitleLabel=$("#"+c.settings.Controls.PlanTitleLabel);
c.$errorLabel=$("#"+c.settings.Controls.ErrorMessageLabel);c.$frame=$("#"+c.settings.Controls.Frame);c.$loadingIndicator=$("#"+c.settings.Controls.LoadingIndicator);c.$prevButtons=$("."+c.settings.CssClasses.PrevButton);c.$nextButtons=$("."+c.settings.CssClasses.NextButton);c.$indexButtons=$("."+c.settings.CssClasses.IndexButton);c.$indexCancelMobileButton=$("#"+c.settings.Controls.IndexMobileCancelButton);c.$closeButton=$("#"+c.settings.Controls.CloseButton);c.$tooltipContentLabel=$("#"+c.settings.Controls.TooltipContentLabel);
c.$indexDialogContainer=$("#"+c.settings.Controls.IndexContainer);c.focusTracker=new CCL.FocusTracker(c.$dialog);c.$prevButtons.click(function(){return c.goToPreviousItem()});c.$nextButtons.click(function(){return c.goToNextItem()});c.$indexButtons.click(function(){return c.openIndexDialog()});c.$indexCancelMobileButton.click(function(){return c.indexDialog.closeDialog()});c.$closeButton.click(function(){return c.toggleDialog(!1)});c.initTooltip();c.toggleToolTip(c.$indexButtons,c.settings.Terms.ShowAllResources,
!0);c.toggleToolTip(c.$closeButton,c.settings.Terms.CloseThisPlan,!0);c.indexDialog=new ContextDialog(c.$indexDialogContainer,{setFocus:!0,showHeader:!1,showCloseLink:!1,showArrow:!0,expandParentFrame:!1,closeOnEscape:!1,footerContent:c.settings.Controls.IndexMobileCancelContainer,width:c.indexDialogWidth,zIndex:5,marginTop:1,marginLeft:0,align:"right",valign:"bottom",arrowOffset:"manual",arrowLeft:c.indexDialogWidth-c.$indexButtons.outerWidth()/2});CCL.CommonFunctions.attachPostMessageEventListener($(window),
CCL.CommonWindowMessages.MessageNames.fullScreenDialogOpening,function(a,b){c.notifyFullScreenDialog(b)}.bind(c))})}b.prototype.registerTreeLinkCustomHandler=function(){var a=this;this.settings.TreeLinkHandlerSettings.IsTreeLinksEnabledInExtensions&&CCL.CustomTreeLinkNavigationManager.registerCustomHandler(function(b){a.handleTreeLinkNavigationEvent(b)})};b.prototype.removeTreeLinkCustomHandler=function(){this.settings.TreeLinkHandlerSettings.IsTreeLinksEnabledInExtensions&&CCL.CustomTreeLinkNavigationManager.removeCustomHandler()};
b.prototype.handleTreeLinkNavigationEvent=function(a){var b=this;this.lastTreeLinkIdToNavigate=a.linkId;this.lastPlanItemIndexBeforeNavigateByTreeLink=this.currentPlanItemIndex;if(!a.linkId||0>=a.sourceId)this.showInformationFeedback(a.context===CCL.TreeLinkContext.library?this.settings.TreeLinkHandlerSettings.Terms.TreeLinkIsInLibrary:this.settings.TreeLinkHandlerSettings.Terms.ErrorOccurred);else{var d=this.settings.TreeLinkHandlerSettings.TreeLinksGetInfoForCustomNavigation.replace("{id}",a.linkId).replace("{sourceElementId}",
a.sourceId.toString()),e=function(){return b.lastTreeLinkIdToNavigate!==a.linkId||b.lastPlanItemIndexBeforeNavigateByTreeLink!==b.currentPlanItemIndex?!0:!1};$.get(d).done(function(c){if(!e())if(c.HasError)b.showInformationFeedback(c.ErrorDescription);else{var d=b.settings.TreeLinkHandlerSettings.KpiSettings;CCL.CommonFunctions.measureKpi(d.url,d.section,d.clickOnTreeLinkMeasurement,d.context).always(function(){if("_blank"===a.target)window.open(c.TargetElementContentUrl,"_blank");else{var d=b.playPlanItems.filter(function(a){return a.ElementId===
c.TargetElementId});d.length?b.loadPlayPlanItem(d[0]):window.top.location.assign(c.TargetElementUrl)}})}}).fail(function(){e()||b.showInformationFeedback(b.settings.TreeLinkHandlerSettings.Terms.ErrorOccurred)})}};b.getClientInstance=function(){return window[b.clientInstanceName]};b.prototype.open=function(a,b){this.playPlanItems=null;this.disableNavigationButtonsIfNeeds();this.clearContentFrame();this.toggleDialog(!0);this.loadPlanItems(a,b)};b.prototype.notifyFullScreenDialog=function(a){a&&CCL.CommonFunctions.makePostMessageCall(a,
new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.fullScreenDialogCollapseTitle))};b.prototype.displayOnboardingIfNeeds=function(){var a=this;this.isNavigationButtonDisabled(this.$nextButtons)||$.get(this.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl).done(function(b){b.IsCompleted||(a.openTooltip(a.$nextButtons,a.settings.Terms.GoToNextResource,500),CCL.CommonFunctions.safeAjax({url:a.settings.WebMethods.PlayPlanNavigationOnboardingFeatureUrl,type:"PUT",
headers:(c={},c[a.settings.AntiforgerySettings.HeaderName]=a.settings.AntiforgerySettings.HeaderValue,c)}));var c})};b.prototype.adjustDialogPositionOnIosDevice=function(a){if(CCL.CommonFunctions.isIosDevice()){var b=$(window.top).height()-this.$closeButton.height();this.$bodyWrapper.css("overflow",a?"hidden":"");this.$bodyWrapper.height(a?""+b:"auto")}};b.prototype.toggleDialog=function(a){this.suspendUpdateBreadCrumbsAndNavigation(a);this.toggleEscapeHandler(a);this.adjustDialogPositionOnIosDevice(a);
this.$body.css("overflow",a?"hidden":"");this.$dialog.toggle(a);a?(this.hideInformationFeedback(!1),CCL.CommonFunctions.makePostMessageCall(window.top,{messageName:CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame}),this.suspendExpandCollaplseContentAreaFrame(!0),this.registerTreeLinkCustomHandler(),this.$startLink=$(":focus"),this.$closeButton.focus(),this.focusTracker.startTrackFocus()):(this.clearContentFrame(),this.suspendExpandCollaplseContentAreaFrame(!1),CCL.CommonFunctions.makePostMessageCall(window.top,
{messageName:CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame}),this.removeTreeLinkCustomHandler(),this.focusTracker.stopTrackFocus(),this.$startLink.focus());IframeResizer.reportSetIframeDefaultHeight()};b.prototype.toggleEscapeHandler=function(a){if(a)this.$body.on("keyup",this.onEscape);else this.$body.off("keyup",this.onEscape)};b.prototype.clearContentFrame=function(){this.hideInformationFeedback();this.updateHistoryState(null);this.setFrameUrl("about:blank")};b.prototype.loadPlanItems=
function(a,b){var c=this;this.loadPlanItemsInProgress||(this.loadPlanItemsInProgress=!0,this.toggleHeaderLoadingText(!0),this.$errorLabel.hide(),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadItems,data:{planId:a}}).done(function(a){c.toggleHeaderLoadingText(!1);a&&(a.TopicColumnName&&c.$topicColumnNameLabel.text(a.TopicColumnName+":"),a.PlanColumnName&&c.$planColumnNameLabel.text(a.PlanColumnName+":"),a.TopicTitle&&c.$topicTitleLabel.text(a.TopicTitle),a.PlanTitle&&c.$planTitleLabel.text(a.PlanTitle),
c.$topicColumnNameLabel.toggle(a.UseTopics),c.$topicTitleLabel.toggle(a.UseTopics),c.$planColumnNameLabel.toggle(a.UseTopics),c.playPlanItems=a.Items,c.updateIndexDialogContainer(),c.currentPlanItemIndex=-1,(a=c.playPlanItems.filter(function(a){return a.ItemId===b})[0])?c.loadPlayPlanItem(a):c.navigateToPlayPlanItem(0),c.displayOnboardingIfNeeds())}).fail(function(a){a.status>=CCL.CommonConstants.httpStatusCodes.badRequest&&(null!=a.responseText&&0<a.responseText.length||null!=a.statusText&&0<a.statusText.length)?
c.showErrorMessage(null!=a.responseText&&0<a.responseText.length?a.responseText:a.statusText):c.showUnableToShowPlanErrorMessage()}).always(function(){c.loadPlanItemsInProgress=!1}))};b.prototype.toggleHeaderLoadingText=function(a){a?(this.$topicColumnNameLabel.add(this.$planColumnNameLabel).add(this.$topicTitleLabel).text(""),this.$planTitleLabel.text(this.settings.Terms.Loading)):this.$planTitleLabel.text("")};b.prototype.loadPlayPlanItem=function(a){this.hideInformationFeedback();this.updateHistoryState(a);
a?(this.currentPlanItemIndex=this.playPlanItems.indexOf(a),this.disableNavigationButtonsIfNeeds(),this.markCurrentItemAsSelected(a),this.setFrameUrl(a.ContentUrl)):this.showUnableToShowPlanErrorMessage()};b.prototype.updateHistoryState=function(a){var b=window.top.history.state||{};a?b.playPlanDialogState={itemId:a.ItemId}:b.playPlanDialogState&&delete b.playPlanDialogState;window.top.history.replaceState(b,null)};b.prototype.markCurrentItemAsSelected=function(a){this.$indexDialogContainer.find("."+
this.settings.CssClasses.IndexItem).removeClass(this.settings.CssClasses.IndexSelectedItem);a=CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,a.ItemId);this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem+a).addClass(this.settings.CssClasses.IndexSelectedItem)};b.prototype.navigateToPlayPlanItem=function(a){this.currentPlanItemIndex!==a&&this.loadPlayPlanItem(this.playPlanItems[a])};b.prototype.goToPreviousItem=function(){this.isNavigationButtonDisabled(this.$prevButtons)||
1<=this.currentPlanItemIndex&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex-1])};b.prototype.goToNextItem=function(){this.isNavigationButtonDisabled(this.$nextButtons)||this.currentPlanItemIndex<this.playPlanItems.length-1&&this.loadPlayPlanItem(this.playPlanItems[this.currentPlanItemIndex+1])};b.prototype.openIndexDialog=function(){if(!this.isNavigationButtonDisabled(this.$indexButtons)){var a=this.$indexButtons.offset().left+this.$indexButtons.outerWidth()-this.indexDialogWidth,
b=this.$indexButtons.outerHeight();this.indexDialog.openDialogAt(a,b,!1);this.closeTooltip(0);if(a=this.playPlanItems[this.currentPlanItemIndex-1])a=this.$indexDialogContainer.find("."+this.settings.CssClasses.IndexItem+CCL.CommonFunctions.getDataSelector(this.itemIdDataAttributeName,a.ItemId)),this.$indexDialogContainer.animate({scrollTop:a.offset().top})}};b.prototype.updateIndexDialogContainer=function(){var a=this;this.$indexDialogContainer.html("");var b=$('<ul class="'+this.settings.CssClasses.IndexList+
'"></ul>');$.each(this.playPlanItems,function(c,d){a.renderItem(b,d,c)});b.appendTo(this.$indexDialogContainer)};b.prototype.renderItem=function(a,b,d){var c=this;$("<li data-"+this.itemIdDataAttributeName+"="+b.ItemId+">").append('<a href="javascript:void(0);">\n                             <img alt="" src="'+b.IconUrl+'" class="'+this.settings.CssClasses.IndexItemIcon+'"/>\n                             <span class="'+this.settings.CssClasses.IndexItemTitle+'">'+b.ItemTitle+"</span>\n                        </a>").addClass(this.settings.CssClasses.IndexItem).appendTo(a).click(function(){c.indexDialog.closeDialog();
c.navigateToPlayPlanItem(d)})};b.prototype.showUnableToShowPlanErrorMessage=function(){this.showErrorMessage(this.settings.Terms.UnableToShowPlan)};b.prototype.showErrorMessage=function(a){this.$errorLabel.text(a);this.$errorLabel.show();this.$loadingIndicator.hide()};b.prototype.showInformationFeedback=function(a){CCL.InformationFeedback.showFeedback(this.$dialog,a,{disableAutomaticHiding:!0})};b.prototype.hideInformationFeedback=function(a){void 0===a&&(a=!0);CCL.InformationFeedback.hideFeedback(this.$dialog,
a)};b.prototype.disableNavigationButtonsIfNeeds=function(){this.disableNavigationButton(this.$nextButtons,null==this.playPlanItems||this.currentPlanItemIndex===this.playPlanItems.length-1,this.settings.Terms.GoToNextResource);this.disableNavigationButton(this.$prevButtons,null==this.playPlanItems||0===this.currentPlanItemIndex,this.settings.Terms.GoToPreviousResource);this.disableNavigationButton(this.$indexButtons,null==this.playPlanItems||1===this.playPlanItems.length,this.settings.Terms.ShowAllResources)};
b.prototype.disableNavigationButton=function(a,b,d){var c=this.isNavigationButtonDisabled(a)!==b;a.toggleHyperlink(!b);c&&this.toggleToolTip(a,d,!b)};b.prototype.suspendUpdateBreadCrumbsAndNavigation=function(a){CCL.CommonFunctions.makePostMessageCall(window.top,new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendUpdateBreadCrumbsAndNavigation,{suspend:a}))};b.prototype.suspendExpandCollaplseContentAreaFrame=function(a){CCL.CommonFunctions.makePostMessageCall(window.top,
new CCL.CommonWindowMessages.GenericMessageWithData(CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame,{suspend:a}))};b.prototype.setFrameUrl=function(a){a?(this.$frame.prop("src",a),this.$loadingIndicator.hide()):(this.$frame.contents().find("html").html(""),this.$loadingIndicator.show())};b.prototype.isNavigationButtonDisabled=function(a){return!a.getIfHyperLinkEnabled()};b.prototype.initTooltip=function(){this.tooltipPositionSettings={My:"right+23 top",At:"center bottom+10",
Arrow:"bottom"};this.$toolTipContainer=$("#"+this.settings.Controls.TooltipContainer);this.toolTip=new CCL.CustomTooltip("playPlanToolTip",{contentContainer:this.$toolTipContainer,zIndex:10},this.settings.CssClasses.CustomTooltipCssClasses);this.$toolTipContainer.show()};b.prototype.toggleToolTip=function(a,b,d){var c=this;if(!CCL.CommonFunctions.isMobileDevice())if(d)a.on("mouseover",function(){c.indexDialog.isOpened()||c.openTooltip(a,b,0)}).on("mouseleave",function(){return c.closeTooltip(0)});
else this.closeTooltip(0),a.off("mouseover mouseleave")};b.clientInstanceName="playPlanDialogClientInstanceName";return b}();e.PlayPlanDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){var d=function(){function b(a,b){this.settings=b;window[a]=this;this.$okButton=$("#"+this.settings.Controls.OkButton);this.$cancelButton=$("#"+this.settings.Controls.CancelButton)}b.prototype.open=function(a,b,d,e){var c=this;null!=a&&(this.updateGridViewCallback=b,this.clearSelectionCallback=d,this.planIdList=a,this.toggleInProcess(!1),this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker],this.setPlanDatesModal=window[this.settings.ClientInstanceNames.SetPlanDatesModal],
this.datePicker.callbacks.onUserSelectionUpdated||(this.datePicker.callbacks.onUserSelectionUpdated=function(){c.setPlanDatesModal.adjustWindowSize()}),this.datePicker.clearData(),this.datePicker.setRecurringMode(this.planIdList),this.datePicker.showCurrentMode(),null!=e&&f.Planner.Cards.TopicCard.setDefaultDate(this.datePicker,e),this.setPlanDatesModal.openDialog())};b.prototype.setPlanDates=function(){this.toggleInProcess(!0);this.datePicker=window[this.settings.ClientInstanceNames.TimeSpanPicker];
if(null!=this.datePicker&&this.datePicker.validateDates())switch(this.datePicker.getCurrentMode()){case e.DatePickerMode.TimeSpan:this.updatePlansTimeSpan();break;case e.DatePickerMode.WeekAndDay:this.updatePlansWeekAndDay();break;case e.DatePickerMode.Event:this.updatePlansEvents()}else this.toggleInProcess(!1)};b.prototype.toggleInProcess=function(a){this.$okButton.toggleClass(this.settings.CssClasses.InProgress,a);a?(this.$okButton.attr("disabled","disabled"),this.$cancelButton.attr("disabled",
"disabled")):(this.$okButton.removeAttr("disabled"),this.$cancelButton.removeAttr("disabled"))};b.prototype.updatePlansTimeSpan=function(){var a=this,b=this.datePicker.getWeekDays();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansTimeSpan,data:{courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartDate(),stop:this.datePicker.getStopDate(),weekNumber:this.datePicker.getWeekNumber(),weekDays:0===b.length?"":JSON.stringify(b),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&
a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,c,d){CCL.CommonFunctions.alertAjaxError(b,c,d);a.toggleInProcess(!1)})};b.prototype.updatePlansWeekAndDay=function(){var a=this,b=this.datePicker.getWeekDays();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansWeekAndDay,data:{courseId:this.settings.CourseId,planIds:this.planIdList,start:this.datePicker.getStartWeek(),stop:this.datePicker.getStopWeek(),weekNumber:this.datePicker.getWeekNumber(),
weekDays:0===b.length?"":JSON.stringify(b),isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(b,c,d){CCL.CommonFunctions.alertAjaxError(b,c,d);a.toggleInProcess(!1)})};b.prototype.updatePlansEvents=function(){var a=this,b=this.datePicker.getEvents();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SetPlansEvents,data:{courseId:this.settings.CourseId,
planIds:this.planIdList,firstPlanEventIds:b,filterStartDate:this.settings.FilterStartDateTime,filterStopDate:this.settings.FilterStopDateTime,isDateColumnDisplayed:this.settings.IsDateColumnDisplayed}}).done(function(b){a.updateGridViewCallback&&a.updateGridViewCallback(b);a.clearSelectionCallback&&a.clearSelectionCallback();a.closeDialog()}).fail(function(){a.datePicker.showErrorMsg(e.DatePickerMode.Event);a.toggleInProcess(!1)})};b.prototype.closeDialog=function(){window.location.href=this.settings.DefaultTarget};
return b}();k.SetPlanDatesDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function b(a,b){var c=this;window[a]=this;this.settings=b;$(function(){c.topicColorPicker=window[c.settings.ColorPickerClientInstanceName];c.planner=e.Planner.getInstance()})}b.prototype.setupAndOpenTopicColorPicker=function(a){a=e.Cards.TopicCard.getInstance(a);this.topicColorPicker.getSelectedColorKey()!==a.getColorSchema()&&(this.topicColorPicker.setPickerLink(a.getColorPickerLink()),this.topicColorPicker.setColor(a.getColorSchema()),this.topicColorPicker.openPopup())};
b.prototype.updateTopicColor=function(a,b){CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Topic.SetTopicColorSchema,data:{courseId:this.planner.settings.CourseId,topicId:a,topicColorSchema:b}}).done(function(c){e.Cards.TopicCard.getInstance(a).setTopicColorSchema(b,c.topicColorSchemaCss)}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};return b}();f.TopicColorPicker=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b,a){var c=this;this.addingPlanIsInProgress=!1;this.closeTooltip=function(a){setTimeout(function(){return c.toolTip.closeTooltip()},a)};this.openTooltip=function(a,b,d){setTimeout(function(){c.$toolTipContent.html(b);c.toolTip.openTooltip(a,c.tooltipPositionSettings)},d)};window[b]=this;d.clientInstanceName=b;this.settings=a;this.courseId=this.settings.CourseId;this.kpi=this.settings.Kpi;this.$container=$("#"+this.settings.Controls.Container);
this.$addNewPlanLink=$("#"+this.settings.Controls.AddNewPlanLink);this.$addNewPlanLinkContainer=$("#"+this.settings.Controls.AddNewPlanLinkContainer);this.$newPlanToolTipContent=$("#"+this.settings.Controls.NewPlanToolTip);this.$toolTipContent=$("#"+this.settings.Controls.FieldsToolTip);this.initNewPlanToolTip();this.initFieldsToolTip();$(function(){c.datePeriodSelector=window[c.settings.Controls.DatePeriodSelector];$(c.datePeriodSelector).on(f.Controls.DatePeriodSelector.periodChangedEventName,function(a,
b){return c.loadPlans(b.startDate,b.endDate)});c.$container.on("click","."+c.settings.Css.SinglePlanEmptyOverlay,function(){return c.addPlan(!1)});c.$addNewPlanLink.on("click",function(){return c.addPlan(!0)});c.cbExpander=window[c.settings.Controls.Expander];CCL.CommonFunctions.attachPostMessageEventListener($(window),e.PlannerConstants.postMessages.SendElementIdToCourseFeature,function(a){e.Cells.Plan.ResourcesCell.PlanCbResourcesCell.getPlanActivityResourceCellInstance().refreshResourcesCell(a.relatedEntityId,
a.customId,!0)})})}d.getInstance=function(){return window[d.clientInstanceName]};d.prototype.getContainer=function(){return this.$container};d.prototype.getFilterStartDate=function(){return this.datePeriodSelector.getStartDate()};d.prototype.getFilterStopDate=function(){return this.datePeriodSelector.getEndDate()};d.prototype.reloadPlans=function(){this.loadPlans(this.datePeriodSelector.getStartDate(),this.datePeriodSelector.getEndDate())};d.prototype.getLibraryBrowserDialog=function(){return window[this.settings.Controls.LibraryBrowserDialog]};
d.prototype.changeDatePeriod=function(b){this.datePeriodSelector.changeDatePeriod(b)};d.prototype.measureEditPlan=function(){CCL.CommonFunctions.measureKpi(this.kpi.Url,this.kpi.Section,this.kpi.EditPlanMeasurement,this.kpi.Context)};d.prototype.updatePlansFolder=function(b,a){$("."+this.settings.Css.SinglePlanContainer+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,b)).attr("data-"+e.PlannerConstants.dataAttributes.FolderId,a)};d.prototype.loadPlans=function(b,a){var c=
this;this.datePeriodSelector.toggleNavigationButtons(!1);this.togglePlanTitleToolTip(this.$container,!1);this.$container.append($("<div>").addClass(this.settings.Css.LoadingIndicator));this.cbExpander.renderShowMoreLinkIfNeed(!1);CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.LoadPlans,data:{courseId:this.settings.CourseId,start:b,stop:a}}).done(function(a){c.$container.html(a.html);c.refreshCbExpander(!c.isSelectedWeekNotEmpty());c.renderAddNewPlanLinkIfNeeds();c.disableKeyboardNavigationIfWeekIsEmpty();
c.toggleFieldsToolTip(!0);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(c.$container)}).fail(function(a,b,d){c.$container.empty();CCL.CommonFunctions.alertAjaxError(a,b,d)}).always(function(){c.datePeriodSelector.toggleNavigationButtons(!0)})};d.prototype.refreshCbExpander=function(b){this.cbExpander&&this.cbExpander.renderShowMoreLinkIfNeed(b);this.$container.removeClass(this.settings.Css.PlansContainerMinHeight)};d.prototype.addPlan=function(b){var a=this;this.addingPlanIsInProgress||
(this.addingPlanIsInProgress=!0,this.toggleFieldsToolTip(!1),CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.AddPlan,data:{courseId:this.settings.CourseId,start:this.datePeriodSelector.getStartDate(),stop:this.datePeriodSelector.getEndDate()}}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)}).done(function(c){b?(a.$container.append(c.ControlHtml),c=a.$container.find("."+a.settings.Css.SinglePlanContainer).last(),$("html, body",window.document).stop().animate({scrollTop:c.offset().top})):
(a.$container.html(c.ControlHtml),a.$container.find("."+a.settings.Css.PlanTitleCell).find("."+a.settings.Css.HtmlTextCellViewer).click(),a.togglePlanTitleToolTip(a.$container,!0));a.refreshCbExpander(!0);a.renderAddNewPlanLinkIfNeeds();CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(a.$container)}).always(function(){a.addingPlanIsInProgress=!1}))};d.prototype.renderAddNewPlanLinkIfNeeds=function(){this.$addNewPlanLinkContainer.toggle(this.isSelectedWeekNotEmpty())};d.prototype.isSelectedWeekNotEmpty=
function(){return 0<$("."+this.settings.Css.SinglePlanContainer).not("[data-"+e.PlannerConstants.dataAttributes.PlanId+"=0]").length};d.prototype.togglePlanTitleToolTip=function(b,a){b=b.find("."+this.settings.Css.PlanTitleCell).find("div"+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.HybridEditorItem));0<b.length&&this.showNewPlanToolTip(b,a)};d.prototype.initNewPlanToolTip=function(){this.newPlanToolTip=new CCL.CustomTooltip("newPlanToolTip",{contentContainer:this.$newPlanToolTipContent,
zIndex:1},this.settings.Css.CustomTooltipCssClasses);this.$newPlanToolTipContent.show()};d.prototype.initFieldsToolTip=function(){this.toolTip=new CCL.CustomTooltip("fieldsToolTip",{contentContainer:this.$toolTipContent,zIndex:1},this.settings.Css.CustomTooltipCssClasses);this.tooltipPositionSettings={My:"center bottom",At:"center top-10",Arrow:"top"};this.$toolTipContent.show()};d.prototype.disableKeyboardNavigationIfWeekIsEmpty=function(){var b=$("."+this.settings.Css.SinglePlanEmptyOverlay);0<
b.length&&(this.$container.find("*").prop("tabindex","-1"),b.attr("tabindex","0"))};d.prototype.showNewPlanToolTip=function(b,a){var c=this,d,f,m=function(a){clearTimeout(f);clearTimeout(d);f=setTimeout(function(){c.newPlanToolTip.isTooltipOpened()&&(c.newPlanToolTip.closeTooltip(),b.off(e.PlannerConstants.events.HybridEditorItemInlineModeChanged),c.toggleFieldsToolTip(!0))},a)},l=function(a){clearTimeout(f);clearTimeout(d);d=setTimeout(function(){c.newPlanToolTip.openTooltip(b,{My:"center top",At:"center bottom+10",
Arrow:"bottom"});b.on(e.PlannerConstants.events.HybridEditorItemInlineModeChanged,function(a,b){b.isEditMode||m(300)})},a)};a?l(300):m(0)};d.prototype.toggleTooltipForField=function(b,a,c){var d=this;void 0===c&&(c="");if(!CCL.CommonFunctions.isMobileDevice())if(a)b.on("mouseover",function(a){return d.openTooltip(b,c,0)}).on("mouseleave",function(){return d.closeTooltip(0)});else this.closeTooltip(0),b.off("mouseover mouseleave")};d.prototype.toggleFieldsToolTip=function(b){var a=this;if(!CCL.CommonFunctions.isMobileDevice()){var c=
this.$container.find("."+this.settings.Css.PlanTitleCell);c.each(function(b){return a.toggleTooltipForField($(c[b]),!0,a.settings.Terms.PlanTitleCellTooltip)});var d=this.$container.find("."+this.settings.Css.PlanTopicCell);d.each(function(b){return a.toggleTooltipForField($(d[b]),!0,a.settings.Terms.PlanTopicCellTooltip)});var e=this.$container.find("."+this.settings.Css.PlanDateCell);e.each(function(b){return a.toggleTooltipForField($(e[b]),!0,a.settings.Terms.PlanDateCellTooltip)});var f=this.$container.find("."+
this.settings.Css.PlanEmptyThumbnailCell).closest("."+this.settings.Css.PlanThumbnailCell);f.each(function(b){return a.toggleTooltipForField($(f[b]),!0,a.settings.Terms.PlanThumbnailCellTooltip)})}};return d}();e.CbPlanner=k})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;window[b.ClientInstanceName]=this;this.settings=b;this.folderSelector=window[b.FolderSelectorInstanceName];this.dialog=window[b.DialogInstanceName];this.grid=this.folderSelector.controls.grid;this.tree=this.folderSelector.controls.tree;this.tbody=$("#"+this.settings.LearningObjectiveTableClientId+" > tbody");this.checkBoxClientId=b.LearningObjectiveGridClientId+"_select_new";$(document).keyup(function(b){return a.keyup(b)});$(document).keydown(function(b){return a.keydown(b)});
this.dialog.setAfterOpenDialog(function(){a.dialog.setCloseConfirmation(function(){return!a.isEditorShown})})}d.prototype.showEditor=function(){var b=this,a=function(){b.isEditorShown||(b.initEditor(),b.tbody.prepend(b.editor),$("#"+b.checkBoxClientId).prop("checked",!0).prop("disabled",!0),b.toggleInsertButtons(!1));b.isEditorVisibleOnDisplay()||b.editor.animate({scrollTop:0},250);setTimeout(function(){b.editorInput.focus()},250)};this.folderSelector.selectedId===this.settings.NodeIdCreatedRoot?
a():this.folderSelector.navigateToNode(this.settings.NodeIdCreatedRoot,!1,!0,function(){return a()})};d.prototype.initEditor=function(){var b=this,a=$(this.settings.EditorTemplate),c=a.find("td").first(),d=this.grid.createCheckbox(this.checkBoxClientId);c.append(d);CCL.ModernCheckbox.BuildCheckbox(d,this.grid.cclGridConstants.terms.selectOneRow,!0,!0);this.editorInput=a.find("#"+this.settings.EditorClientId);this.editor=a;this.editorInput.on("blur",function(){return b.createLearningObjective()})};
d.prototype.createLearningObjective=function(){var b=this,a=this.editorInput.val().trim();if(""===a)this.removeEditor();else{this.editor.remove();var c=(new Date).getTime();this.renderGridRow({Id:c.toString(),Title:a});CCL.CommonFunctions.safeAjaxPost({data:{title:this.editorInput.val(),courseId:this.settings.CourseId},url:this.settings.CreateLearningObjectiveUrl}).done(function(a){var d=a.Items[0];b.addToCache(a);if(b.folderSelector.selectedId===b.settings.NodeIdCreatedRoot){if(a=b.tbody.find("#"+
c))a.data("id",d.Id),a.attr("data-id",d.Id);a.find("."+b.folderSelector.settings.cssClasses.itemCell+" > span").text(d.Title);b.grid._addRemoveSelectedValue(d.Id,!0);b.refreshTreeRow()}else b.folderSelector.controls.tree.refresh(b.settings.NodeIdCreatedRoot);b.toggleInsertButtons(!0)}).fail(function(){b.tbody.find("#"+c).remove();b.folderSelector.showErrorFeedback()})}};d.prototype.renderGridRow=function(b){var a=$("<tr id='"+b.Id+"' data-id=''></tr>").addClass(this.grid.cclGridConstants.cssClasses.selectedRow),
c=$("<td></td>").prop("class",this.grid.cclGridConstants.cssClasses.selectColumn),d=this.settings.LearningObjectiveGridClientId+"_select_"+b.Id,e=this.grid.createCheckbox(d);c.append(e);CCL.ModernCheckbox.BuildCheckbox(e,this.grid.cclGridConstants.terms.selectOneRow,!0,!0);a.append(c);c=$("<td></td>").addClass(this.folderSelector.settings.cssClasses.itemCell);b=$("<span class='LearningObjective'></span>").text(b.Title);c.append(b);a.append(c);this.tbody.prepend(a);this.grid.allowSelecting&&(this.initCheckBox(d,
!0),this.grid.addCheckBoxHandler(d))};d.prototype.refreshTreeRow=function(){this.folderSelector.controls.tree&&(this.folderSelector.selectedId=this.folderSelector.rootId,this.folderSelector.controls.tree.refresh(this.folderSelector.selectedId),this.folderSelector.navigateToNode(this.settings.NodeIdCreatedRoot,!1,!1),this.folderSelector.selectedId=this.settings.NodeIdCreatedRoot)};Object.defineProperty(d.prototype,"isEditorShown",{get:function(){return 1===this.tbody.find("#"+this.settings.EditorClientId).length},
enumerable:!0,configurable:!0});d.prototype.addToCache=function(b){var a=this.folderSelector.getCachedFolderData(this.settings.NodeIdCreatedRoot);if(null!=b.Folders)for(var c=a.folders,d=b.Folders.length,e=0;e<d;e++){var f=b.Folders[e];c.splice(0,0,{id:f.Id,title:f.Title,description:f.Description,cssClass:f.CssClass,isFolder:f.IsFolder,selectedByDefault:f.SelectedByDefault,setRootAsParent:f.SetRootAsParent})}c=a.items.pages[1];if(null!=b.Items)for(d=b.Items.length,e=0;e<d;e++)f=b.Items[e],c.splice(0,
0,{id:f.Id,title:f.Title,description:f.Description,cssClass:f.CssClass,isFolder:f.IsFolder,selectable:f.Selectable,selectedByDefault:!1});a.virtualItemCount++;this.folderSelector.cache[this.settings.NodeIdCreatedRoot]=a};d.prototype.isEditorVisibleOnDisplay=function(){var b=$(window).scrollTop(),a=b+$(window).height(),c=this.editorInput.offset().top;return c+this.editorInput.height()<=a&&c>=b};d.prototype.keyup=function(b){this.isEditorShown&&b.which===CCL.CommonConstants.keyCodes.escape&&(this.removeEditor(),
event.preventDefault())};d.prototype.keydown=function(b){this.isEditorShown&&b.which===CCL.CommonConstants.keyCodes.enter&&(this.createLearningObjective(),event.preventDefault())};d.prototype.toggleInsertButtons=function(b){this.folderSelector.toggleSelectButtons(b)};d.prototype.removeEditor=function(){this.editor.remove();this.toggleInsertButtons(this.grid.getSelectedIds()&&0!==this.grid.getSelectedIds().length)};d.prototype.initCheckBox=function(b,a){$("#"+b).prop("checked",a)};return d}();e.LearningObjectiveInlineEditor=
f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){window[d.clientInstanceName]=this;this.settings=b}d.getInstance=function(){return window[d.clientInstanceName]};d.prototype.updateLearningObjectiveDataSource=function(b){return this.updateLearningObjectivesDataSource([b])};d.prototype.updateLearningObjectivesDataSource=function(b){var a=this;return CCL.CommonFunctions.safeAjaxPost({url:this.settings.GetLearningObjectivesTooltipDataWebMethod,data:{learningObjectiveIds:b}}).done(function(b){$.each(b,
function(b,c){window[a.settings.TooltipDataSourceMethods.AddToDataSource](b,c.title,c.description,c.path)})}).fail(CCL.CommonFunctions.alertAjaxError)};d.clientInstanceName="PlannerLearningObjectiveToolTipManagerClientInstanceName";return d}();e.PlannerLearningObjectiveToolTipManager=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){window[b]=this;d.dataAttributes=a.DataAttributes;d.events=a.Events;d.postMessages=a.PostMessages}return d}();e.PlannerConstants=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){window[b]=this;d.instanceName=b;this._planner=e.Planner.getInstance()}d.getInstance=function(){return window[d.instanceName]};d.prototype.printTopics=function(){var b=this,a=e.Cards.TopicCard.getSelectedTopicIds(!0);null!=a&&(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),a.forEach(function(a){b.prepareTopicForPrint(a)}),window.print())};d.prototype.printPlans=function(b){(b=b.getTopicId())?(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),
this.prepareTopicForPrint(b)):this._planner.settings.UseTopics?(e.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),e.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint();window.print()};d.prototype.prepareAllPlansForPrint=function(){var b=this;e.Cards.TopicCard.getAllTopicCardContainers().each(function(a,c){c=e.Cards.TopicCard.getInstanceByContainer($(c)).getPlanGrid();a=c.getSelectedRows();c=c.getRows();0<
a.length?(c.addClass(b._planner.css.NoPrint),a.removeClass(b._planner.css.NoPrint)):c.removeClass(b._planner.css.NoPrint)})};d.prototype.prepareTopicForPrint=function(b){var a=e.Cards.TopicCard.getInstance(b);b=a.getTopicCardContainer();var c=a.getPlanGrid();a=c.getRows();c=c.getSelectedRows();b.removeClass(this._planner.css.NoPrint);0<c.length?(a.addClass(this._planner.css.NoPrint),c.removeClass(this._planner.css.NoPrint)):a.removeClass(this._planner.css.NoPrint)};d.prototype.printPlanner=function(b){null==
b?this._planner.settings.UseTopics?(e.Cards.TopicCard.getAllTopicCardContainers().removeClass(this._planner.css.NoPrint),e.Cards.TopicCard.getPlansForAllTopics().removeClass(this._planner.css.NoPrint)):this.prepareAllPlansForPrint():(e.Cards.TopicCard.getAllTopicCardContainers().addClass(this._planner.css.NoPrint),this.prepareTopicForPrint(b));window.print()};return d}();e.PlannerPrint=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f;(function(b){b[b.NotLoaded=0]="NotLoaded";b[b.Loading=1]="Loading";b[b.Loaded=2]="Loaded"})(f||(f={}));var d=function(){return function(b,a,c){function d(a){var b=-a.width()/2;a=a.height();l.openDialogAt(b,a,!0);$(window.top).trigger($.Event("QuickAddMenuShow"))}var e=f.NotLoaded,m=$("<div class='ccl-context-dialog-content-container'></div>").hide();b.parent().append(m);var l=new ContextDialog(m,{showHeader:!1,showCloseLink:!1,useMobileViewIfNeeded:!1,valign:"bottom",
marginTop:12,marginBottom:0,marginLeft:0,marginRight:10,cssClass:c,toggleElement:b,noTitle:!0}),k=l.closeDialog;l.setCloseFunction(function(a){k(a);$(window.top).trigger($.Event("QuickAddMenuHide"))});window.addEventListener("orientationchange",function(a){return l.closeDialog(a)});m.click(function(){return l.closeDialog()});b.click(function(b){l.isOpened()?l.closeDialog():e===f.Loaded?d($(b.currentTarget)):e===f.NotLoaded&&(e=f.Loading,$.get(a,function(a){a&&(m.append(a),d($(b.currentTarget)));e=
f.Loaded}).fail(function(){return e=f.NotLoaded}))})}}();e.QuickAddMenu=d})(f.Controls||(f.Controls={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(k){(function(d){var b=function(){function a(a,b){var c=this;this.settings=b;window[a]=this;this.courseId=b.CourseId;$(function(){$("body").on("keyup","."+c.settings.Css.ImageUploaderContainer,function(a){var b=$(a.target);a.which===CCL.CommonConstants.keyCodes.enter&&b.getIfHyperLinkEnabled()&&b.find("input").click();a.preventDefault()}).on("change","."+c.settings.Css.ImageUploaderContainer,function(a){return c.uploadImage(a)}).on("click","."+c.settings.Css.DeleteButton,
function(a){return c.deleteImage(a)})})}a.prototype.uploadImage=function(a){var b=this,c=$(a.target),d=c.closest("."+this.settings.Css.CellContainer);this.hideImageLoadingError(d);a=a.target;c=parseInt(c.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId),10);var l=f.UploadFileHelper.getFormDataWithAttachedFilesAndFileSizes(a);if(a=l.formData)if(l.fileSizes[0]>this.settings.MaxImageSizeInBytes)this.showImageLoadingError(d,this.settings.Terms.MaximumFileSizeForUpload);
else{var k=this.showLoading(d);e.CbPlanner.getInstance()&&e.CbPlanner.getInstance().toggleTooltipForField(d,!1);c=this.settings.WebMethods.UploadImage.replace("{courseId}",this.settings.CourseId.toString()).replace("{planId}",c.toString());$.ajax({type:"POST",url:c,contentType:!1,processData:!1,dataType:"json",data:a}).done(function(a){a.success?d.replaceWith(a.content):(b.toggleAddImage(d,!0),b.showImageLoadingError(d,a.errorMessage))}).fail(function(){CCL.CommonFunctions.jAlertAjaxError(b.settings.Terms.SomethingWentWrong,
b.settings.Terms.ErrorMessage,b.settings.Terms.Ok,!1)}).always(function(){return b.hideLoading(d,k)})}};a.prototype.deleteImage=function(a){var b=this;a=$(a.target);var c=a.closest("."+this.settings.Css.CellContainer);a=parseInt(a.closest("."+this.settings.Css.PlanContainer).data(e.PlannerConstants.dataAttributes.PlanId),10);CCL.CommonFunctions.safeAjax({type:"DELETE",url:this.settings.WebMethods.DeletePlanThumbnail,data:{courseId:this.settings.CourseId,planId:a}}).done(function(a){var d=c.parent();
c.replaceWith(a.controlHtml);e.CbPlanner.getInstance()&&e.CbPlanner.getInstance().toggleTooltipForField(d.find("."+b.settings.Css.CellContainer),!0,b.settings.Terms.AddImageTooltip)})};a.prototype.showLoading=function(a){var b=a.css("position");a.css("position","relative").append($('<div class="'+this.settings.Css.AjaxLoader+'"></div>'));this.toggleAddImage(a,!1);return b};a.prototype.hideLoading=function(a,b){a.css("position",b);a.find("."+this.settings.Css.AjaxLoader).replaceWith("")};a.prototype.showImageLoadingError=
function(a,b){b=$('<div class="'+this.settings.Css.ImageErrorMessage+'">'+b+"</div>");a.append(b)};a.prototype.hideImageLoadingError=function(a){a.find("."+this.settings.Css.ImageErrorMessage).replaceWith("")};a.prototype.toggleAddImage=function(a,b){a.find("."+this.settings.Css.AddImage).toggle(b)};return a}();d.PlanThumbnailCell=b})(k.Plan||(k.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){function d(b){var a=window.top;return window!=a?$("#item"+b,a.document):null}e.deleteTopicFolderNode=function(b){b&&(b=d(b))&&b.remove()};e.updateTopicFolderNode=function(b,a){b&&(b=d(b))&&(a=document.createTextNode(a),b.children("a:first").contents().filter(function(){return 3===this.nodeType}).replaceWith(a))}})(e.PlannerUtility||(e.PlannerUtility={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.topicsAutocomplete=function(a,b){c.topicsAutocompleteRequest&&c.topicsAutocompleteRequest.abort&&c.topicsAutocompleteRequest.abort();c.topicsAutocompleteRequest=CCL.CommonFunctions.safeAjaxPost({url:c.settings.WebMethods.FindTopics,data:{courseId:c.courseId,searchText:a.term}}).done(function(a){a.length?b($.map(a,function(a){return{label:a.Name,value:a.TopicId,metadata:a}})):b([{label:"",value:""}])}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,
b,c)}).always(function(){c.topicsAutocompleteRequest=void 0})};this.onTopicSelect=function(a,b){c.selectedTopic=b.item.metadata;c.$textInput.val(c.selectedTopic.Name);c.$textInput[0].blur();return!1};window[b]=this;this.courseId=a.CourseId;this.$textInput=$("#"+a.InputClientId);this.settings=a;var d=this;this.$textInput.autocomplete({focus:function(a){a.preventDefault()},position:{collision:"none flip",of:this.$textInput},source:this.topicsAutocomplete,select:this.onTopicSelect,delay:this.settings.Autocomplete.Delay,
minLength:this.settings.Autocomplete.MinLength,create:function(){$(this).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append(b.metadata?String.format("<span>{0}</span>",CCL.CommonFunctions.htmlEncode(b.metadata.Name)):String.format("<span class='{0}'>{1}</span>",d.settings.Css.NoMatches,d.settings.Terms.NoMatches)).appendTo(a)};$(this).data("ui-autocomplete")._renderMenu=function(a,b){var c=this;$.each(b,function(b,d){c._renderItemData(a,d)});a.hasClass(d.settings.Css.AutocompleteMenu)||
a.addClass(d.settings.Css.AutocompleteMenu)}}});$(function(){a.CurrentTopic&&(c.currentTopic=a.CurrentTopic,c.$textInput.val(c.currentTopic.Name));c.$textInput.blur(function(){return c.onTopicChangeHandler()});c.$textInput.keydown(function(a){return c.keyDown(a)});c.cbPlanner=e.CbPlanner.getInstance()})}d.prototype.getPlanId=function(){var b=this.$textInput.closest("."+this.settings.Css.OnePlanContainer);return parseInt(b.data(e.PlannerConstants.dataAttributes.PlanId),10)};d.prototype.getCurrentTopicId=
function(){return this.currentTopic?this.currentTopic.TopicId:0};d.prototype.getSelectedTopicId=function(){return this.selectedTopic?this.selectedTopic.TopicId:0};d.prototype.checkIfNeedsToUpdateTopic=function(){var b=!0,a=this.$textInput.val().trim();this.currentTopic||this.selectedTopic||""!==a||(b=!1);if(this.getCurrentTopicId()===this.getSelectedTopicId()&&0<this.getCurrentTopicId()||this.currentTopic.Name===a)b=!1;return b};d.prototype.onTopicChangeHandler=function(){var b=this;if(this.checkIfNeedsToUpdateTopic()){var a=
this.getPlanId();CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ConnectPlanToTopic,data:{courseId:this.courseId,topicId:this.getSelectedTopicId(),planId:a,topicName:this.$textInput.val()}}).done(function(c){if(c){var d=c.topicInfo;b.currentTopic&&b.currentTopic.TopicId===d.TopicId||b.$textInput.attr("data-"+b.settings.TopicIdDataAttribute,d.TopicId);b.currentTopic=d;b.selectedTopic=null;b.$textInput.val(b.currentTopic.Name);c.isCurrentTopicRenamed&&(b.updateTopicName(b.currentTopic.TopicId,
b.currentTopic.Name),e.PlannerUtility.updateTopicFolderNode(c.topicConnectedFolderId,d.Name));b.cbPlanner.updatePlansFolder(a,c.topicConnectedFolderId)}}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})}};d.prototype.keyDown=function(b){b.which===CCL.CommonConstants.keyCodes.enter&&(b.preventDefault(),this.$textInput[0].blur());b.which===CCL.CommonConstants.keyCodes.escape&&(b.preventDefault(),this.selectedTopic=null,this.currentTopic&&this.$textInput.val(this.currentTopic.Name))};
d.prototype.updateTopicName=function(b,a){b=$("."+this.settings.Css.PlansContainer).find("."+this.settings.Css.TopicNameInput+CCL.CommonFunctions.getDataSelector(this.settings.TopicIdDataAttribute,b));$.each(b,function(b,d){$(d).val(a)})};return d}();e.TopicSelector=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,b,a){var c=this;this.sortDirection="DESC";this.refreshGrid=function(a,b){CCL.CommonFunctions.safeAjaxPost({url:c.context.WebMethods.LearnerLetters,data:{PersonId:c.context.PersonId,PageIndex:a-1,PageSize:b,SortDirection:c.sortDirection,SortColumn:c.sortColumn}}).done(function(a){null!=a&&(c.letters(a),c.updateScrollBarYHandler())})};this.pagerEventHandler=function(a){a===c.context.Pager.Name&&(a=window[a],c.refreshGrid(a.pageNumber,a.pageSize))};
this.changeSortColumn=function(a){c.sortColumn===a?c.sortDirection="DESC"===c.sortDirection?"ASC":"DESC":c.sortColumn=a;a=window[c.context.Pager.Name];c.refreshGrid(a.pageNumber,a.pageSize)};this.getCourseTitle=function(a){return a?a:c.context.LanguageTerms.All};this.openLetterLink=function(a){window.open(a,"_blank")};this.openProfile=function(a,b){a===c.context.PersonId?$("li[data-tab='about']").find("a").trigger("click"):document.showProfileCard?document.showProfileCard(a):window.raw_popup(b,"",
"resizable,scrollbars,height=500,width=750")};this.updateScrollBarYHandler=function(){c.lettersTabPage.perfectScrollbar("update");return!0};this.context=d;this.letters=ko.observableArray(b);this.sortColumn=d.Sort.CreatedDateColumnSortName;this.lettersTabPage=a;$(document).off(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName);$(document).on(this.context.Pager.OnPageNumberChangedEventName+" "+this.context.Pager.OnPageSizeChangedEventName,function(a,b){return c.pagerEventHandler(b)});
document.profileCardScope.isWindowLoading=!1;$(".c-modal__mask").on("click",document.profileCardScope.closeProfileCardWindow);a.perfectScrollbar({suppressScrollX:!0});this.updateScrollBarYHandler();$(window).on("resize",this.updateScrollBarYHandler);d=$(".c-profileCard[data-personid='"+d.PersonId+"']");ko.utils.domNodeDisposal.addDisposeCallback(d[0],function(){$(window).off("resize",this.updateScrollBarYHandler)})}}();e.ProfileLetters=f})(f.ProfileCard||(f.ProfileCard={}))})(ItslearningWeb||(ItslearningWeb=
{}));
(function(f){(function(e){var k=function(d){function b(a){var b=this;d.call(this,a.Urls.CheckSession,a.Resources.AnErrorOccurred);this.settings=a;this.toggleLightBulletinSubscriptionForPerson=function(a,c){return $.ajax({type:"PUT",url:b.settings.Urls.ToggleLightBulletinSubscriptionForPerson,data:{lightBulletinId:a,subscribe:c},dataType:"json"})};this.getStreamList=function(a,c){return $.ajax({type:"GET",url:b.settings.Urls.GetStreamList,data:{boundaryNotificationActiveFromTicks:a,boundaryNotificationId:c}})}}__extends(b,
d);return b}(f.CommonAjaxClient);e.StreamAjaxClient=k})(f.Stream||(f.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=f.LightBulletin.LightBulletinUtility,d=function(){function b(a,b){var c=this;this.controls=a;this.settings=b;this.numberOfRepeatsOfCheckingLastItemForIos=12;this.intervalBeforeCheckForLoading=250;this.minVisiblePartOfLastItemToLoadMore=.5;this.afterAddingComment=function(a){a=a.userData.sourceId;var b=c.getBulletinById(a);c.lightBulletinSingleItemDataManager.subscribeToCommentsIfNeeded(b,a)};this.lightBulletinMenuClicked=function(a){var b=c.lightBulletinSingleItemDataManager.getLightBulletinActionDropDownItem(a),
d=c.getBulletinById(b.LightBulletinId);switch(b.ActionType){case f.LightBulletin.LightBulletinDropDownMenuActionType.ToggleSubscription:var e=c.lightBulletinSingleItemDataManager.getSingleItemData(d).SubscriptionStatus!==f.LightBulletin.PersonSubscriptionStatus.Subscribed;c.ajaxClient.toggleLightBulletinSubscriptionForPerson(b.LightBulletinId,e).done(function(b){return f.LightBulletin.GenericResponseHandler.handle(b,function(){return c.lightBulletinSingleItemDataManager.updateSubscriptionStatus(d,
a,e)})}).fail(c.ajaxClient.handleAjaxError);c.resetFocusOnCurrentItem(d);break;case f.LightBulletin.LightBulletinDropDownMenuActionType.ImmersiveReader:window.fetch("/restapi/personal/immersivereader/v1?ResourceType=Bulletin&ResourceId="+b.LightBulletinId).then(function(a){if(a.ok)a.json().then(function(a){window.ImmersiveReader.launchAsync(a.AccessToken,a.SubDomain,{title:a.Title,chunks:[{content:a.Text}]},{uiZIndex:1E6})});else throw Error(a.statusText);})}};this.resetLastItem=function(){c.lastItem.removeAttr("data-"+
c.settings.DataAttributes.BoundaryNotificationActiveFromTicks).removeAttr("data-"+c.settings.DataAttributes.BoundaryNotificationId);c.lastItem=$()};this.getCurrentLastItem=function(){return c.controls.ItemsContainer.find("[data-"+c.settings.DataAttributes.BoundaryNotificationActiveFromTicks+"]")};this.isAllItemsLoaded=function(){return 0===c.lastItem.length};this.lightBulletinContentNodeSelector="[data-"+this.settings.DataAttributes.LightBulletinId+"]";e.StreamContentBlockInstance=this;this.lastItem=
this.getCurrentLastItem();this.isFirstCallLazy=!0;this.oembedError=new f.LightBulletin.EmbedError(this.settings.OembedErrorCssClasses,this.settings.OembedErrorResources);this.linkifyTextNodes(this.controls.ItemsContainer);this.isIosDevice=CCL.CommonFunctions.isIosDevice();this.textExpander=new CCL.TextExpander("LightBulletinTextExpander",this.settings.TextExpanderSettings);this.lightBulletinShowMoreLinkRenderer=new f.LightBulletin.ShowMoreLinkRenderer(this.settings.ShowMoreLinkRendererSettings,this.textExpander);
this.lightBulletinEmbedAsynchronousLoader=new f.LightBulletin.EmbedAsynchronousLoader({isIosDevice:this.isIosDevice,cssClasses:{noBorder:this.settings.CssClasses.Border0,ajaxLoader:this.settings.CssClasses.AjaxLoader,oembedError:this.settings.OembedErrorCssClasses.OembedBoxError},selectors:{embedBox:"."+this.settings.CssClasses.OembedBox,bulletinItem:this.lightBulletinContentNodeSelector},dataAttributes:{embedIframeUrl:this.settings.DataAttributes.EmbedIframeUrl}});this.lightBulletinSingleItemDataManager=
new f.LightBulletin.LightBulletinSingleItemDataManager(this.settings.LightBulletinSingleDataDataAttributes,this.settings.LightBulletinSingleItemDataResources);this.ajaxClient=new e.StreamAjaxClient(this.settings);this.listenToEmbedPostmessages();this.isAllItemsLoaded()||(this.isMobile()||this.loadIfReachedLastItem(!1,0),$(window).on(this.isIosDevice?"touchmove":"scroll",function(){c.isMobile()||c.loadIfReachedLastItem(!1,c.isIosDevice?c.numberOfRepeatsOfCheckingLastItemForIos:0)}),this.controls.ShowMoreLink.click(function(a){c.controls.ShowMoreLink.hide();
c.loadIfReachedLastItem(!0,0);a.preventDefault()}));f.LightBulletin.EmbedResizer.listenToEmbedSizePostmessages(this.controls.ItemsContainer,this.settings.CssClasses.OembedContent,this.lightBulletinShowMoreLinkRenderer,this.lightBulletinEmbedAsynchronousLoader);this.renderShowMoreInLightBulletins(this.controls.ItemsContainer.find(this.lightBulletinContentNodeSelector));this.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(this.controls.ItemsContainer);this.lightBulletinEmbedAsynchronousLoader.loadEmbedContentAsync();
this.lightBulletinSingleItemDataManager.registerDropDownMenuClickHandler(this.isIosDevice,this.lightBulletinMenuClicked)}b.prototype.resetFocusOnCurrentItem=function(a){$(a).parent().find(".itsl-cb-stream-item-header > a").first().focus()};b.prototype.loadIfReachedLastItem=function(a,b){var c=this;if(this.isAllItemsLoaded()||!a&&!CCL.CommonFunctions.isOnScreen(this.lastItem,this.minVisiblePartOfLastItemToLoadMore,this.minVisiblePartOfLastItemToLoadMore,this.isIosDevice?window.parent:window))0<b&&
setTimeout(function(){c.loadIfReachedLastItem(a,b-1)},this.intervalBeforeCheckForLoading);else{var d=this.lastItem.attr("data-"+this.settings.DataAttributes.BoundaryNotificationActiveFromTicks),e=this.lastItem.attr("data-"+this.settings.DataAttributes.BoundaryNotificationId);this.resetLastItem();this.ajaxClient.getStreamList(d,e).done(function(a){a&&(a=$(a),c.controls.ItemsContainer.append(a),c.linkifyTextNodes(a),c.renderShowMoreInLightBulletins(c.controls.ItemsContainer.find(c.lightBulletinContentNodeSelector)),
c.isFirstCallLazy&&($.ajax(c.settings.Urls.MeasureLazyLoading),c.isFirstCallLazy=!1),c.lightBulletinEmbedAsynchronousLoader.appendIframeHolders(a));c.lastItem=c.getCurrentLastItem();c.isAllItemsLoaded()||c.controls.ShowMoreLink.show()}).fail(CCL.CommonFunctions.alertAjaxError)}};b.prototype.renderShowMoreInLightBulletins=function(a){var b=this;a.each(function(a,c){a=$(c);k.setTabindexToHiddenElements(a,b.lightBulletinShowMoreLinkRenderer.findClickablePlaceholder(a),"."+b.settings.CssClasses.ElementLink)});
this.lightBulletinShowMoreLinkRenderer.renderShowMoreWithImagesHack(a,"[data-"+this.settings.DataAttributes.AttachedImage+"]",this.lightBulletinContentNodeSelector,function(a,c){k.setTabindexToHiddenElements(a,c,"."+b.settings.CssClasses.ElementLink)})};b.prototype.linkifyTextNodes=function(a){f.LightBulletin.LightBulletinLinkifyWrapper.linkifyNodes(a.find("[data-"+this.settings.DataAttributes.LightBulletinContent+"]"))};b.prototype.isMobile=function(){return CCL.CommonFunctions.checkScreenSize(CCL.CommonConstants.mediaScreenSizes.mobile,
!1)};b.prototype.getBulletinById=function(a){return this.controls.ItemsContainer.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.LightBulletinId,a))};b.prototype.listenToEmbedPostmessages=function(){var a=this;CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.getEmbeddedContentData,function(b){var c=a.controls.ItemsContainer.find("#"+b.oembedPlaceHolderId);a.lightBulletinEmbedAsynchronousLoader.removeAjaxLoader(c);a.controls.ItemsContainer.removeClass(a.settings.CssClasses.AjaxLoader);
b.isPlainLink&&!a.oembedError.hasOembedError(c)&&(c.append(a.oembedError.generateOembedError({originalEmbedCode:b.originalEmbedCode,oembedPlaceHolder:c},a.lightBulletinEmbedAsynchronousLoader)),a.lightBulletinShowMoreLinkRenderer.renderShowMoreLink(c.closest(a.lightBulletinContentNodeSelector),!1))})};return b}();e.StreamContentBlock=d})(f.Stream||(f.Stream={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this._templates={};window[b]=this;d.instanceName=b;this._settings=a;this.css=a.Css;this.webMethods=a.WebMethods;b=$("#"+this._settings.Controls.PlanTemplateId).html();var e=$("#"+this._settings.Controls.TopicTemplateId).html();this._templates[this._settings.Controls.PlanTemplateId]=Handlebars.compile(b);this._templates[this._settings.Controls.TopicTemplateId]=Handlebars.compile(e);this._container=$("."+a.Css.Container);setTimeout(function(){c.initTimeline()},
100);this._planContextDialog=new ContextDialog("#"+this._settings.Controls.PlanContextDialogId,{valign:"bottom",width:500,zIndex:2,closeButtonTooltip:a.Terms.Close})}d.getInstance=function(){return window[d.instanceName]};d.prototype.getContainer=function(){return this._container};d.prototype.isEmpty=function(){return this._settings.UseTopics?0===this._topics.length:0===this._plans.length};d.prototype.refresh=function(){return this._settings.UseTopics?this.loadTopics():this.loadTopicPlans()};d.prototype.toggleTimeline=
function(b,a){var c=this;this.getContainer().hide();b?($("#"+this._settings.Controls.LoadingLabelId).show(),this.refresh().done(function(){return c.showEmptyMessageIfNecessary()})):a&&this.toggleEmptyMessage(!1);$("#"+this._settings.Controls.LoadingLabelId).hide()};d.prototype.showEmptyMessageIfNecessary=function(){this.toggleEmptyMessage(this.isPlannerTimelineEmpty());this.getContainer().toggle(!this.isPlannerTimelineEmpty())};d.prototype.toggleEmptyMessage=function(b){var a=this._container.parent().find("."+
this._settings.Css.NoTopicsMessage);a&&a.toggle(b)};d.prototype.isPlannerTimelineEmpty=function(){return this._settings.UseTopics&&0===this._topics.length||!this._settings.UseTopics&&0===this._plans.length};d.prototype.initTimeline=function(){var b=this;this._timeline=new vis.Timeline(this._container[0],null,{margin:{item:{vertical:25,horizontal:5E3}},selectable:!1,locale:this._settings.Language,order:function(a,c){return b.orderTimelineItems(a,c)},template:function(a){return(0,b._templates[a.template])(a)},
zoomMin:432E6,zoomMax:321408E5,maxHeight:500});this._timeline.on("click",function(a){b._planContextDialog.isOpened()&&b._planContextDialog.closeDialog();b.expandCollapseTimelineItem(a)});$(document).trigger(this._settings.Events.TimelineControlInitialized)};d.prototype.expandCollapseTimelineItem=function(b){if(null!=b.item&&!$(b.event.target).hasClass(this.css.ItemTitle)){var a=b.item.split("#");if(1===a.length){var c=this.getTopicItem(b.item);a=this._timeline.itemSet.itemFromTarget(b.event).dom.box;
$(a).toggleClass(this.css.TopicArrowCollapsed,null!=c.Plans);$(a).toggleClass(this.css.TopicArrowExpanded,null==c.Plans);$(a).attr("title",this._settings.Terms.HidePlans);null!=c.Plans?(this.removeItemsFromTopicTimeline(c),$(a).attr("title",this._settings.Terms.ShowPlans)):this.loadTopicPlans(b.item)}else c=a[1],(a=this.getPlanItem(b.item,a[0]))&&this.openDialogAndLoadPlanContents(c,a.Content,b)}};d.prototype.openDialogAndLoadPlanContents=function(b,a,c){var d=this;this._planContextDialog.setTitle(a);
this._planContextDialog.openDialog(c.event.srcEvent);this._planContextDialog.setContent(this._settings.Terms.Loading);CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetSinglePlanForPlannerXhtml,data:{planId:b,courseId:this._settings.CourseId,childId:this._settings.ChildId,dashboardHierarchyId:this._settings.DashboardHierarchyId}}).done(function(a){d._planContextDialog.setContent(a.contentHtml);CCL.CustomTreeLinkNavigationManager.subscribeOnTreeLinkClick(d._planContextDialog.mainContainer)})};
d.prototype.refreshTimeline=function(){var b=this,a=[],c=[];this._settings.UseTopics?$.each(this._topics,function(d,e){a.push(b.getTimelineItem(e,!1,e.Id,e.ColorSchemaClass));c.push({id:e.Id,content:"",order:e.Order});null!=e.Plans&&$.each(e.Plans,function(c,d){a.push(b.getTimelineItem(d,!0,e.Id,d.Active?e.ColorSchemaClass:b._settings.Css.InactivePlan))})}):$.each(this._plans,function(d,e){a.push(b.getTimelineItem(e,!0,e.Id,e.Active?b._settings.Css.DefaultColorSchemaClass:b._settings.Css.InactivePlan));
c.push({id:e.Id,content:"",order:e.Order})});0<a.length&&this._timeline.setData({groups:c,items:a})};d.prototype.setViewOptions=function(b,a,c,d){this._timeline.setOptions({start:b,end:a,min:c,max:d})};d.prototype.addItemsToTopicTimeline=function(b){var a=this;$.each(b.Plans,function(c,d){a._timeline.itemsData.add(a.getTimelineItem(d,!0,b.Id,d.Active?b.ColorSchemaClass:a._settings.Css.InactivePlan))})};d.prototype.removeItemsFromTopicTimeline=function(b){if(null!=b.Plans){var a=[];$.each(b.Plans,
function(b,d){a.push(d.Id)});this._timeline.itemsData.remove(a);b.Plans=null}};d.prototype.loadTopics=function(){var b=this;return CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetTopicsForPlannerTimeline,data:{courseId:this._settings.CourseId,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId,topicId:this._settings.FilteredTopicId,termId:this._settings.FilteredTermId}}).done(function(a){a&&a.topics&&(b.setViewOptions(a.initialStart,
a.initialEnd,a.minStart,a.maxEnd),b._topics=a.topics,b.refreshTimeline())}).fail(function(){return CCL.CommonFunctions.alertAjaxError})};d.prototype.loadTopicPlans=function(b){var a=this;void 0===b&&(b="");return CCL.CommonFunctions.safeAjaxPost({url:this._settings.WebMethods.GetPlansForPlannerTimeline,data:{courseId:this._settings.CourseId,topicIdString:b,start:this._settings.FilterStartDate,end:this._settings.FilterEndDate,childId:this._settings.ChildId}}).done(function(c){if(c&&c.plans)if(a._settings.UseTopics){var d=
a.getTopicItem(b);d.Plans=c.plans;a.addItemsToTopicTimeline(d);c.topicStartDate&&c.topicStopDate&&(d.Start=c.topicStartDate,d.End=c.topicStopDate,a._timeline.itemsData.update(a.getTimelineItem(d,!1,d.Id,d.ColorSchemaClass)))}else a.setViewOptions(c.initialStart,c.initialEnd,c.minStart,c.maxEnd),a._plans=c.plans,a.refreshTimeline()}).fail(function(){return CCL.CommonFunctions.alertAjaxError})};d.prototype.getTopicItem=function(b){return this.getItem(this._topics,b)};d.prototype.getPlanItem=function(b,
a){void 0===a&&(a=null);a=null!=a&&this._settings.UseTopics?this.getTopicItem(a).Plans:this._plans;return this.getItem(a,b)};d.prototype.getItem=function(b,a){var c=null;$.each(b,function(b,d){return d.Id===a?(c=d,!1):!0});return c};d.prototype.getTimelineItem=function(b,a,c,d){var e=this.isTopicExpanded(b,a)?this._settings.Css.TopicArrowExpanded:this._settings.Css.TopicArrowCollapsed;return{id:b.Id,content:b.Content,start:b.Start,end:b.End,className:a?d+" "+this._settings.Css.Plan:d+" "+e,group:c,
subgroup:a?b.Order:0,template:a?this._settings.Controls.PlanTemplateId:this._settings.Controls.TopicTemplateId,custom:a?b.ElementsCount:null,active:b.Active,title:a?this._settings.Terms.OpenPlanDetails:this.isTopicExpanded(b,a)?this._settings.Terms.HidePlans:this._settings.Terms.ShowPlans}};d.prototype.isTopicExpanded=function(b,a){return!a&&null!=b.Plans};d.prototype.orderTimelineItems=function(b,a){return a.subgroup-b.subgroup};d.prototype.parseDateFromString=function(b){return null!=b?$.datepicker.parseDate(this._settings.DateTimeFormat,
b):null};return d}();e.PlannerTimeline=f})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){this.dataAttributes=b;this.resources=a}d.prototype.getLightBulletinActionDropDownItem=function(b){return b.data(this.dataAttributes.LightBulletinActionDropDownItem)};d.prototype.getSingleItemData=function(b){return b.data(this.dataAttributes.LightBulletinSingleItemData)};d.prototype.updateSingleItemData=function(b,a){b.data(this.dataAttributes.LightBulletinSingleItemData,a)};d.prototype.refreshSingleItemData=function(b,a){var c=this.getSingleItemData(b);
a(c);this.updateSingleItemData(b,c);return c};d.prototype.getToggleSubscriptionLink=function(b){return $(CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItemToggleSubscriptionLink,b))};d.prototype.updateSubscriptionStatus=function(b,a,c){this.refreshSingleItemData(b,function(a){return a.SubscriptionStatus=c?e.PersonSubscriptionStatus.Subscribed:e.PersonSubscriptionStatus.UnsubscribedManually});a.text(c?this.resources.TurnOffNotifications:this.resources.TurnOnNotifications)};
d.prototype.registerDropDownMenuClickHandler=function(b,a){$(document).on(b?"touchstart":"click",CCL.CommonFunctions.getDataSelector(this.dataAttributes.LightBulletinActionDropDownItem),function(b){b.preventDefault();a($(b.currentTarget))})};d.prototype.subscribeToCommentsIfNeeded=function(b,a){this.getSingleItemData(b).SubscriptionStatus===e.PersonSubscriptionStatus.WasNotSubscribed&&this.updateSubscriptionStatus(b,this.getToggleSubscriptionLink(a),!0)};return d}();e.LightBulletinSingleItemDataManager=
f})(f.LightBulletin||(f.LightBulletin={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(b,a,c,d){var e=this;this.$itemSelector=b;this.idDataAttribute=a;this.selectAllItemId=c;this.languageTerms=d;this.hasItems=function(){return 0<e.getAllItems().length};this.getItemId=function(a){a=e.getItemIdByDataAttribute(e.getItem(a));return e.areAllItemsSelected(a)?null:a};this.setDefaultItemText=function(a){a=e.getItem(a);var b=e.getItemIdByDataAttribute(a);a=e.areAllItemsSelected(b)?e.languageTerms.All+" "+e.languageTerms.Items.toLowerCase():
a.text();e.$itemSelector.text(a)};this.getAllItems=function(){return e.$itemSelector.parent().find("[data-"+e.idDataAttribute+"]")};this.isItem=function(a){return null!=a.closest("[data-"+e.idDataAttribute+"]")};this.getItem=function(a){return a.closest("[data-"+e.idDataAttribute+"]")};this.getItemIdByDataAttribute=function(a){return a.data(e.idDataAttribute)};this.areAllItemsSelected=function(a){return a===e.selectAllItemId}}}(),d=function(){function b(a,c,d){var e=this;this.settings=c;this.controls=
d;this.initPerfectScrollbar=function(){e.controls.MenuContainer.perfectScrollbar({suppressScrollX:!0});$(window).on("resize",e.updateScrollBarYHandler)};this.updateScrollBarYHandler=function(){e.controls.MenuContainer.perfectScrollbar("update")};this.onItemClickHandler=function(a){var c=e.itemSelectorManagerManager.getItemId($(a.target));void 0!==c&&(e.selectedItemId=c,e.itemSelectorManagerManager.setDefaultItemText($(a.target)),e.controls.ItemSelector.trigger(b.itemSelectorOnChangeEventName,e))};
window[a]=this;this.itemSelectorManagerManager=new f(this.controls.ItemSelector,this.settings.DataAttributes.ItemId,this.settings.SelectAllItemId,this.settings.LanguageTerms);this.initPerfectScrollbar();this.controls.ItemSelector.parent().on("focusin",function(){e.controls.ItemSelector.addClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.parent().on("focusout",function(){e.controls.ItemSelector.removeClass(e.settings.CssClasses.MenuIsActive)});this.controls.ItemSelector.on("keyup",
function(a){a.which===CCL.CommonConstants.keyCodes.enter&&e.controls.ItemSelector.trigger("click")});this.controls.MenuContainer.on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",this.onItemClickHandler);this.itemSelectorManagerManager.getAllItems().on("keyup",function(a){a.which===CCL.CommonConstants.keyCodes.enter&&(e.onItemClickHandler(a),e.controls.MenuContainer.trigger("click"))})}Object.defineProperty(b.prototype,"hasItems",{get:function(){return this.itemSelectorManagerManager.hasItems()},
enumerable:!0,configurable:!0});b.itemSelectorOnChangeEventName="itemSelector:onchange";return b}();e.ItemSelector=d})(f.ItemSelector||(f.ItemSelector={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){this.settings=b;this.modalDialog=window[this.settings.ContainerId]}d.prototype.openDialog=function(b,a){this.modalDialog.setAjaxUrl(this.settings.DialogContentUrl,a,!1);this.modalDialog.setTitle(b.header);$("#"+this.settings.HeaderId).text(b.assessmentName);this.modalDialog.openDialog(!1)};return d}();e.TermAssessmentDialogManager=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,d){var c=this;this.serviceUrls=b;this.model=d;this.getAssessments=function(){var a={supervisorType:c.model.supervisorType,courseId:c.model.courseId,termId:c.model.termId(),categoryIds:c.model.categoryIds()};a=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.Assessments,data:a,dataType:"json"});a.done(function(a){c.model.addAssessments(a)});return a};this.getAssessmentPersonResults=function(){var b={supervisorType:c.model.supervisorType,courseId:c.model.courseId,
assessmentIds:c.model.assessments().map(function(a){return a.id}),paging:{pageIndex:c.model.assessmentPersonResultsCurrentPage,pageSize:a.pageSize},sortDescending:c.model.sortDescending};b=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.AssessmentPersonResults,data:b,dataType:"json"});b.done(function(a){c.model.addAssessmentPersonResults(a)});return b}}a.pageSize=50;return a}(),d=function(){function a(a){var b=this;this.settings=a;this.isScrollingInProgress=!1;this.assessmentPersonResultsCurrentPage=
0;this.sortDescending=!1;this.initialise=function(){b.areAssessmentsBeingLoaded(!0);b.dataFetcher.getAssessments()};this.addAssessments=function(a){a&&(a=a.map(function(a){return{id:a.Id,title:a.Title}}),[].push.apply(b.assessments(),a),b.assessments.valueHasMutated());b.areAssessmentsBeingLoaded(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.addAssessmentPersonResults=function(a){if(a){var c=a.map(function(a){return{personId:a.PersonId,fullName:a.FullName,pictureUrl:a.PictureUrl,
fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,score:a.Score?a.Score:"-",hasComment:a.HasComment}})}});[].push.apply(b.assessmentPersonResults(),c);b.assessmentPersonResults.valueHasMutated()}0===b.assessmentPersonResultsCurrentPage?b.areAssessmentsPersonResultsBeingLoaded(!1):b.isAssessmentsPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.pageSize)&&
b.areAllAssessmentPersonResultsRetreived(!0);b.assessmentPersonResultsCurrentPage++;b.$assessmentColumnsContainer.perfectScrollbar("update")};this.openProfileCard=function(a){document.showProfileCard?document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.isScrolledToTheBottom(!1);b.fetchAssessmentPersonResultsData(b.resetAssessmentRecordScroll)};this.fetchAssessmentsData=
function(){b.cancelDataFetching();b.areAssessmentsBeingLoaded(!0);b.assessments([]);b.clearAssessmentPersonResultsData();b.fetchAssessmentsCallbackDebouncer.invokeCallback({},200)};this.clearAssessmentPersonResultsData=function(){b.areAssessmentsPersonResultsBeingLoaded(!0);b.assessmentPersonResults([]);b.isAssessmentsPersonResultsPageBeingLoaded(!1);b.areAllAssessmentPersonResultsRetreived(!1);b.assessmentPersonResultsCurrentPage=0;b.isScrolledToTheBottom(!1);b.resultsScrollLeft=0;b.resultsScrollTop=
0};this.fetchAssessmentPersonResultsData=function(a){void 0===a&&(a=null);b.cancelDataFetching();b.clearAssessmentPersonResultsData();b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(a,200)};this.fetchAssessmentPersonResultsPage=function(){b.isAssessmentsPersonResultsPageBeingLoaded(!0);b.fetchAssessmentPersonResultsCallbackDebouncer.invokeCallback(null,200)};this.cancelDataFetching=function(){null!=b.fetchAssessmentPersonResultsPromise&&b.fetchAssessmentPersonResultsPromise.readyState!==
b.fetchAssessmentPersonResultsPromise.DONE&&b.fetchAssessmentPersonResultsPromise.abort();null!=b.fetchAssessmentsPromise&&b.fetchAssessmentsPromise.readyState!==b.fetchAssessmentsPromise.DONE&&b.fetchAssessmentsPromise.abort()};this.onAssessmentResultsScrollHandler=function(){if(!b.isScrollingInProgress){b.isScrollingInProgress=!0;var a=b.$assessmentColumnsContainer.scrollLeft();a!==b.resultsScrollLeft&&(b.resultsScrollLeft=a,$("."+b.settings.CssClasses.AssessmentHeaders).scrollLeft(b.resultsScrollLeft));
a=b.$assessmentColumnsContainer.scrollTop();a!==b.resultsScrollTop&&(b.fetchAssessmentPersonResultsPageOnScrollHandler(a),b.resultsScrollTop=a,$("."+b.settings.CssClasses.StudentsColumn).scrollTop(b.resultsScrollTop),Math.ceil(b.$assessmentColumnsContainer[0].scrollHeight-b.$assessmentColumnsContainer[0].scrollTop)===b.$assessmentColumnsContainer[0].clientHeight&&b.isScrolledToTheBottom(!0));b.isScrollingInProgress=!1}};this.resetAssessmentRecordScroll=function(){b.$assessmentColumnsContainer.scrollTop(0);
b.$studentsColumn.scrollTop(0)};this.fetchAssessmentPersonResultsPageOnScrollHandler=function(a){!b.areAssessmentsPersonResultsBeingLoaded()&&!b.areAllAssessmentPersonResultsRetreived()&&a>b.resultsScrollTop&&(a=$("."+b.settings.CssClasses.AssessmentColumnsContainer+" > ."+b.settings.CssClasses.AssessmentColumn).first().children(),a=a.eq(a.length-k.pageSize/2),CCL.CommonFunctions.isOnScreen(a,.5,.5)&&b.fetchAssessmentPersonResultsPage())};this.initialiseTermFilter=function(){b.$termFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,
b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,c){b.termId(c.selectedItemId);b.fetchAssessmentsData()};this.initialiseCategoryFilter=function(){b.$categoryFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onCategoryFilterItemClickHandler)};this.onCategoryFilterItemClickHandler=function(a,c){b.categoryIds(c.selectedItemIds);b.fetchAssessmentsData()};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchAssessmentsCallbackDebouncer=
new CCL.CallbackDebouncer(function(){b.fetchAssessmentsPromise=b.dataFetcher.getAssessments()});this.fetchAssessmentPersonResultsCallbackDebouncer=new CCL.CallbackDebouncer(function(a){b.fetchAssessmentPersonResultsPromise=b.dataFetcher.getAssessmentPersonResults();a&&b.fetchAssessmentPersonResultsPromise.done(function(){return a()})});this.termId=ko.observable(null);this.categoryIds=ko.observableArray([]);this.areAssessmentsBeingLoaded=ko.observable(!0);this.assessments=ko.observableArray([]);this.areAssessmentsPersonResultsBeingLoaded=
ko.observable(!0);this.isAssessmentsPersonResultsPageBeingLoaded=ko.observable(!1);this.areAllAssessmentPersonResultsRetreived=ko.observable(!1);this.assessmentPersonResults=ko.observableArray([]);this.persons=ko.computed(function(){return b.assessmentPersonResults().map(function(a){return a})});this.resultsScrollLeft=this.$assessmentColumnsContainer.scrollLeft();this.resultsScrollTop=this.$assessmentColumnsContainer.scrollTop();this.initialiseTermFilter();this.initialiseCategoryFilter();this.isScrolledToTheBottom=
ko.observable(!1)}Object.defineProperty(a.prototype,"$assessmentColumnsContainer",{get:function(){return $("."+this.settings.CssClasses.AssessmentColumnsContainer)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$studentsColumn",{get:function(){return $("."+this.settings.CssClasses.StudentsColumn)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"$categoryFilter",{get:function(){return $("#"+this.settings.ClientIds.CategoryFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"courseId",{get:function(){return this.settings.CourseId},enumerable:!0,configurable:!0});return a}();e.AssessmentRecordViewModel=d;var b=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=
function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};var c=new f.KnockoutCustomBindingsManager;c.registerSafeImgBinding();c.registerPerfectScrollBarBinding();this.model=new d(a);ko.applyBindings(this.model,this.$container[0]);this.model.initialise();this.$container.on("click",this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,
"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();e.AssessmentRecord=b})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function a(b,d){var c=this;this.serviceUrls=b;this.model=d;this.getDataForOrganisation=function(){var a={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId()};a=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.Filters,data:a,dataType:"html"});a.done(function(a){c.model.updateOrganisation(a)});return a};this.getCourses=function(){var b={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),
paging:{pageIndex:c.model.coursesCurrentPage,pageSize:a.coursesPageSize}};b=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.Courses,data:b,dataType:"json"});b.done(function(a){c.model.addCourses(a);c.model.areCoursesBeingLoaded(!1)});return b};this.getTermAssessments=function(){if(!c.model.currentCourse())return null;var a={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),courseId:c.model.currentCourse().id,hierarchyIds:c.model.hierarchyIds()};
a=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.TermAssessments,data:a,dataType:"json"});a.done(function(a){a&&c.model.addTermAssessments(a);c.model.areCourseTermAssessmentsBeingLoaded(!1)});return a};this.getTermAssessmentPersonResults=function(){if(!c.model.currentCourse())return null;var b={supervisorType:c.model.supervisorType,organisationId:c.model.organisationId(),termId:c.model.termId(),courseId:c.model.currentCourse().id,hierarchyIds:c.model.hierarchyIds(),finalAssessmentIds:c.model.termAssessments().map(function(a){return a.id}),
paging:{pageIndex:c.model.termAssessmentPersonResultsCurrentPage,pageSize:a.termAssessmentPersonResultsPageSize},sortDescending:c.model.sortDescending};b=CCL.CommonFunctions.safeAjaxPost({url:c.serviceUrls.TermAssessmentPersonResults,data:b,dataType:"json"});b.done(function(a){c.model.addTermAssessmentPersonResults(a);c.model.areCourseTermAssessmentsResultsBeingLoaded(!1)});return b}}a.coursesPageSize=10;a.termAssessmentPersonResultsPageSize=50;return a}(),d=function(){function a(a){var b=this;this.settings=
a;this.isResultsHorisontalScrollInProgress=!1;this.termAssessmentPersonResultsCurrentPage=this.coursesCurrentPage=0;this.sortDescending=!1;this.updateOrganisation=function(a){$("."+b.settings.CssClasses.FiltersContainer).replaceWith($(a));b.initialiseFilters();b.fetchCoursesData()};this.addCourses=function(a){var c=0===b.coursesCurrentPage,d=a.map(function(a,d){return{id:a.Id,title:a.Title,isSelected:c?0===d:!1,assessmentRecordTooltip:b.getAssessmentRecordTooltip(a.Title)}});[].push.apply(b.courses(),
d);b.courses.valueHasMutated();b.coursesCount(b.courses().length);c?(b.areCoursesBeingLoaded(!1),b.enableHierarchyFilter(),0<b.coursesCount()&&b.selectCourse(b.courses()[0])):b.isCoursesPageBeingLoaded(!1);(0===a.length||a.length<k.coursesPageSize)&&b.areAllCoursesRetreived(!0);b.coursesCurrentPage++};this.selectCourse=function(a){b.currentCourse(a);b.fetchTermAssessmentsData();$(window).scrollTop(0)};this.openAssessmentRecord=function(a){window.location.href=b.settings.ServiceUrls.AssessmentRecord+
"?courseId="+a.id+"&supervisorType="+b.settings.SupervisorType};this.selectStudent=function(a){b.currentStudent(a)};this.clearStudent=function(){b.currentStudent(null)};this.addTermAssessments=function(a){a=a.map(function(a){return{id:a.Id,title:a.Title}});[].push.apply(b.termAssessments(),a);b.termAssessments.valueHasMutated();b.termAssessmentsCount(b.termAssessments().length);b.fetchTermAssessmentPersonResultsData()};this.addTermAssessmentPersonResults=function(a){if(a){var c=a.map(function(a){return{personId:a.PersonId,
fullName:a.FullName,pictureUrl:a.PictureUrl,fallbackProfileUrl:a.FallbackProfileUrl,fallbackPictureUrl:a.FallbackPictureUrl,tooltipText:a.TooltipText,results:a.Results.map(function(a){return{gradebookItemId:a.GradebookItemId,score:a.Score,hasComment:a.HasComment}})}});[].push.apply(b.termAssessmentPersonResults(),c);b.termAssessmentPersonResults.valueHasMutated();b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length)}0===b.termAssessmentPersonResultsCurrentPage?b.areCourseTermAssessmentsResultsBeingLoaded(!1):
b.isTermAssessmentPersonResultsPageBeingLoaded(!1);(!a||0===a.length||a.length<k.termAssessmentPersonResultsPageSize)&&b.areAllTermAssessmentPersonResultsRetreived(!0);b.termAssessmentPersonResultsCurrentPage++};this.openProfileCard=function(a){document.showProfileCard?document.showProfileCard(a.personId):window.raw_popup(a.fallbackProfileUrl,"","resizable,scrollbars,height=500,width=750")};this.sortByName=function(){b.sortDescending=!b.sortDescending;b.fetchTermAssessmentPersonResultsData();$(window).scrollTop(0)};
this.showMoreCourses=function(){b.fetchCoursesPage()};this.showMoreResults=function(){b.fetchTermAssessmentPersonResultsPage()};this.scrollResultsContainer=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsFixedHeadersWrapper),$("."+b.settings.CssClasses.ResultsContainer))};this.scrollResultsFixedHeader=function(){b.scrollHorisontaly($("."+b.settings.CssClasses.ResultsContainer),$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper))};this.ajustResultsFixedHeaderPosition=function(){b.onResultsFixedHeaderPositionChangeHandler()};
this.scrollHorisontaly=function(a,c){b.isResultsHorisontalScrollInProgress||(b.isResultsHorisontalScrollInProgress=!0,c.scrollLeft(a.scrollLeft()),b.isResultsHorisontalScrollInProgress=!1)};this.isScrolledIntoView=function(a){return a.offset().top>=$(window).scrollTop()};this.onResultsFixedHeaderPositionChangeHandler=function(){var a=$("."+b.settings.CssClasses.StudentHeader);if(0<a.length){var c=CCL.CommonFunctions.isElementFullyShownInWindow(a),d=$("."+b.settings.CssClasses.ResultsContainer),e=
CCL.CommonFunctions.isElementFullyShownInWindow(d),f=$("."+b.settings.CssClasses.StudentFixedHeader),g=$("."+b.settings.CssClasses.ResultsFixedHeadersWrapper);if(c&&e)f.css({display:"none"}),g.css({display:"none"});else{c=c||b.isScrolledIntoView(d)?a.offset().top-$(window).scrollTop():0;f.css({display:"block",position:"fixed",top:c,height:a.outerHeight(!0),width:a.outerWidth(!0)});g.css({display:"block",position:"fixed",top:c,left:a.offset().left+a.outerWidth(!0),height:a.outerHeight(!0),width:d.outerWidth(!0)});
g.perfectScrollbar("update");$("."+b.settings.CssClasses.ResultsFixedHeadersContainer).css({display:"flex",width:d[0].scrollWidth});a=$("."+b.settings.CssClasses.ResultsFixedHeader);var k=$("."+b.settings.CssClasses.ResultsHeader);a.each(function(a,b){$(b).css({width:k.eq(a).outerWidth(!0)})})}}};this.openAssessmentDialog=function(a,c){var d=e.termAssessmentDialogManagerInstance;if(d){var f=ko.utils.arrayFirst(b.termAssessments(),function(a){return a.id===c}),g=ko.utils.arrayFirst(b.termAssessmentPersonResults(),
function(b){return b.personId===a});d.openDialog({header:g.fullName,assessmentName:f.title},{personId:a,gradebookItemId:c,supervisorType:b.settings.SupervisorType})}};this.openAssessmentDialogForCurrentStudent=function(a,c){b.openAssessmentDialog(a().personId,c)};this.getPersonGradebookItemResult=function(a,c){var d=ko.utils.arrayFirst(b.termAssessmentPersonResults(),function(b){return b.personId===a().personId});return ko.utils.arrayFirst(d.results,function(a){return a.gradebookItemId===c})};this.initialiseFilters=
function(){b.initialiseOrganisationFilter();b.initialiseTermFilter();b.initialiseHierarchyFilter()};this.disableFilters=function(){b.$organisationFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$organisationFilter.prop("disabled",!0);b.$termFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$termFilter.prop("disabled",!0);b.disableHierarchyFilter()};this.disableHierarchyFilter=function(){b.$hierarchyFilter.addClass(b.settings.CssClasses.FilterDisabled);b.$hierarchyFilter.prop("disabled",
!0)};this.enableHierarchyFilter=function(){window[b.settings.ClientIds.HierarchyFilter].hasItems&&(b.$hierarchyFilter.removeClass(b.settings.CssClasses.FilterDisabled),b.$hierarchyFilter.removeProp("disabled"))};this.initialiseOrganisationFilter=function(){b.$organisationFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onOrganisationFilterClickHandler)};this.onOrganisationFilterClickHandler=function(a,c){b.organisationId(c.selectedItemId);b.fetchOrganisationData()};this.initialiseTermFilter=
function(){b.$termFilter.on(f.ItemSelector.ItemSelector.itemSelectorOnChangeEventName,b.onTermFilterItemClickHandler)};this.onTermFilterItemClickHandler=function(a,c){b.termId(c.selectedItemId);b.fetchCoursesData()};this.initialiseHierarchyFilter=function(){b.$hierarchyFilter.on(f.ItemMultiSelector.ItemMultiSelector.itemMultiSelectorOnChangeEventName,b.onHierarchyFilterItemClickHandler)};this.onHierarchyFilterItemClickHandler=function(a,c){b.hierarchyIds(c.selectedItemIds);b.fetchTermAssessmentPersonResultsData()};
this.fetchOrganisationData=function(){b.clearFilters();b.clearCoursesData();b.cancelDataFetching();b.disableFilters();b.fetchFiltersCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesData=function(){b.clearCoursesData();b.clearTermAssessmentsData();b.cancelDataFetching();b.disableHierarchyFilter();b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchCoursesPage=function(){b.isCoursesPageBeingLoaded(!0);b.fetchCoursesCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentsData=
function(){b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData();b.cancelDataFetching();b.fetchTermAssessmentsCallbackDebouncer.invokeCallback({},200)};this.fetchTermAssessmentPersonResultsData=function(){b.clearTermAssessmentPersonResultsData();b.cancelDataFetching();b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.onFetchTermAssessmentPersonResultsPageHandler=function(a){if(!b.areCourseTermAssessmentsResultsBeingLoaded()&&!b.areAllTermAssessmentPersonResultsRetreived()&&
!b.isStudentSelectedInMobile()){a=$(a.target).scrollTop();if(a>b.termAssessmentPersonResultsListScrollTop){var c=$("."+b.settings.CssClasses.MobileStudentContainer).is(":visible")?$("."+b.settings.CssClasses.MobileStudentContainer).children():$("."+b.settings.CssClasses.StudentsContainer).children();c=c.eq(c.length-k.termAssessmentPersonResultsPageSize/2);CCL.CommonFunctions.isOnScreen(c,.5,.5)&&b.fetchTermAssessmentPersonResultsPage()}b.termAssessmentPersonResultsListScrollTop=a}};this.fetchTermAssessmentPersonResultsPage=
function(){b.isTermAssessmentPersonResultsPageBeingLoaded(!0);b.fetchTermAssessmentPersonResultsCallbackDebouncer.invokeCallback({},200)};this.cancelDataFetching=function(){null!=b.fetchFiltersPromise&&b.fetchFiltersPromise.readyState!==b.fetchFiltersPromise.DONE&&b.fetchFiltersPromise.abort();null!=b.fetchCoursesPromise&&b.fetchCoursesPromise.readyState!==b.fetchCoursesPromise.DONE&&b.fetchCoursesPromise.abort();null!=b.fetchTermAssessmentsPromise&&b.fetchTermAssessmentsPromise.readyState!==b.fetchTermAssessmentsPromise.DONE&&
b.fetchTermAssessmentsPromise.abort();null!=b.fetchTermAssessmentPersonResultsPromise&&b.fetchTermAssessmentPersonResultsPromise.readyState!==b.fetchTermAssessmentPersonResultsPromise.DONE&&b.fetchTermAssessmentPersonResultsPromise.abort()};this.clearFilters=function(){b.termId(null);b.hierarchyIds([])};this.clearCoursesData=function(){b.courses([]);b.coursesCount(b.courses().length);b.areCoursesBeingLoaded(!0);b.isCoursesPageBeingLoaded(!1);b.currentCourse(null);b.areAllCoursesRetreived(!1);b.coursesCurrentPage=
0;b.clearTermAssessmentsData();b.clearTermAssessmentPersonResultsData()};this.clearTermAssessmentsData=function(){b.termAssessments([]);b.termAssessmentsCount(b.termAssessments().length);b.areCourseTermAssessmentsBeingLoaded(!0)};this.clearTermAssessmentPersonResultsData=function(){b.termAssessmentPersonResults([]);b.termAssessmentPersonResultsCount(b.termAssessmentPersonResults().length);b.areCourseTermAssessmentsResultsBeingLoaded(!0);b.isTermAssessmentPersonResultsPageBeingLoaded(!1);b.currentStudent(null);
b.areAllTermAssessmentPersonResultsRetreived(!1);b.termAssessmentPersonResultsCurrentPage=0;b.ajustResultsFixedHeaderPosition()};this.getAssessmentRecordTooltip=function(a){a=CCL.CommonFunctions.htmlEncode(a);return CCL.CommonFunctions.formatString(b.settings.LanguageTerms.AssessmentRecordTooltip,a)};this.dataFetcher=new k(this.settings.ServiceUrls,this);this.fetchCoursesCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchCoursesPromise=b.dataFetcher.getCourses()});this.fetchFiltersCallbackDebouncer=
new CCL.CallbackDebouncer(function(){b.fetchFiltersPromise=b.dataFetcher.getDataForOrganisation()});this.fetchTermAssessmentsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentsPromise=b.dataFetcher.getTermAssessments()});this.fetchTermAssessmentPersonResultsCallbackDebouncer=new CCL.CallbackDebouncer(function(){b.fetchTermAssessmentPersonResultsPromise=b.dataFetcher.getTermAssessmentPersonResults()});this.organisationId=ko.observable(this.settings.OrganisationId);this.termId=
ko.observable(0===this.settings.TermId?null:this.settings.TermId);this.currentCourse=ko.observable(null);this.hierarchyIds=ko.observableArray(this.settings.HierarchyIds);this.currentCourseTitle=ko.pureComputed(function(){var a="";null!=b.currentCourse()&&(a=b.currentCourse().title);return a});this.areCoursesInitiated=ko.observable(!1);this.areCoursesBeingLoaded=ko.observable(!0);this.isCoursesPageBeingLoaded=ko.observable(!1);this.areCourseTermAssessmentsBeingLoaded=ko.observable(!0);this.areCourseTermAssessmentsResultsBeingLoaded=
ko.observable(!0);this.isTermAssessmentPersonResultsPageBeingLoaded=ko.observable(!1);this.courses=ko.observableArray([]);this.coursesCount=ko.observable(0);this.areAllCoursesRetreived=ko.observable(!1);this.termAssessments=ko.observableArray([]);this.termAssessmentsCount=ko.observable(0);this.termAssessmentPersonResults=ko.observableArray([]);this.termAssessmentPersonResultsCount=ko.observable(0);this.areAllTermAssessmentPersonResultsRetreived=ko.observable(!1);this.persons=ko.computed(function(){return b.termAssessmentPersonResults().map(function(a){return a})});
this.currentStudent=ko.observable(null);this.isStudentSelectedInMobile=ko.computed(function(){return b.currentStudent()&&CCL.CommonFunctions.isMobileDevice()});this.initialiseFilters();this.termAssessmentPersonResultsListScrollTop=$(window).scrollTop();$(window).on("resize scroll touchmove",this.onResultsFixedHeaderPositionChangeHandler);$(window).on("scroll touchmove",this.onFetchTermAssessmentPersonResultsPageHandler)}Object.defineProperty(a.prototype,"$organisationFilter",{get:function(){return $("#"+
this.settings.ClientIds.OrganisationFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$termFilter",{get:function(){return $("#"+this.settings.ClientIds.TermFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"$hierarchyFilter",{get:function(){return $("#"+this.settings.ClientIds.HierarchyFilter)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"supervisorType",{get:function(){return this.settings.SupervisorType},enumerable:!0,configurable:!0});
return a}();e.TermAssessmentsViewModel=d;var b=function(){function a(a){var b=this;this.settings=a;this.preventFromDropDownMenuFromClosing=function(a){$(a.target).is(b.$container.children().first())&&a.stopPropagation()};a=new f.KnockoutCustomBindingsManager;a.registerSafeImgBinding();a.registerPerfectScrollBarBinding();this.model=new d(this.settings);ko.applyBindings(this.model,this.$container[0]);this.model.dataFetcher.getCourses().done(function(){b.model.areCoursesInitiated(!0)});this.$container.on("click",
this.preventFromDropDownMenuFromClosing);ko.utils.domNodeDisposal.addDisposeCallback(this.$container[0],function(){b.$container.off("click",b.preventFromDropDownMenuFromClosing)})}Object.defineProperty(a.prototype,"$container",{get:function(){return $("."+this.settings.CssClasses.Container)},enumerable:!0,configurable:!0});return a}();e.TermAssessments=b})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){var b=this;this.context=a;$("#"+this.context.Controls.DeleteButtonId).on(CCL.CommonFunctions.isMobileDevice()?"touchstart":"click",function(){return b.deleteSelectedTerms()})}b.prototype.deleteSelectedTerms=function(){var a=this,b=window[this.context.Controls.DataGridName],d=b.GetSelectedValues(),e=[];d&&0<d.length&&(e=d.substr(0,d.length-1).split(","));if(!b.GetNumberOfSelectedRows())return jAlert(this.context.Settings.PleaseMakeSelectionMessage),
!1;b=this.context.Settings.DeleteWarningMessage.replace(/#NumberOfSelectedRows/g,b.GetNumberOfSelectedRows());for(var f in e)if(e.hasOwnProperty(f)&&-1!==this.context.TermIdsUsedInGradebook.indexOf(e[f])){b=this.context.Settings.DeleteWarningMessageWithExistTermInGradebook;break}$.alerts.okButton=this.context.Settings.YesButtonText;$.alerts.cancelButton=this.context.Settings.NotButtonText;jConfirm(b,this.context.Settings.WarningDialogTitle,function(b){b&&__doPostBack("__Page",a.context.Settings.PostBackArgumentDelete)});
return!1};return b}();e.TermManagement=d})(e.TermManagement||(e.TermManagement={}))})(f.Terms||(f.Terms={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(d,b){var a=[],c=d.ArrowButton.find("img"),e=new DivToggler({divId:b.ClientIds.TopMenuArea,isCollapsed:!b.TopmenuExpanded,afterToggle:function(){e.settings.isCollapsed?(c.removeClass(b.CssClasses.ArrowUp).addClass(b.CssClasses.ArrowDown),d.ArrowButton.prop("title",b.Terms.ClickToMaximise)):(c.removeClass(b.CssClasses.ArrowDown).addClass(b.CssClasses.ArrowUp),d.ArrowButton.prop("title",b.Terms.ClickToMinimise))},changeDivVisibility:!0}),f=new DivToggler({divId:b.ClientIds.BottomNavigationBarWrapper,
isCollapsed:!1,changeDivVisibility:!0}),m=$(window);e.initialize();d.ArrowButton.click(function(){e.toggleDiv(function(){CCL.CommonFunctions.safeAjax({type:"PUT",url:b.Urls.ToggleTopMenuState,data:{show:!e.settings.isCollapsed}})});window[b.SetIframeDefaultHeightFunctionName]()});a.push(e);f.initialize();a.push(f);b.ClientIds.TopNavigationContainer&&a.push(new DivToggler({divId:b.ClientIds.TopNavigationContainer,isCollapsed:!1,changeDivVisibility:!0}));if(b.UseLeftmenuToggler){var k=function(a,c,
e){d.LeftMenuToggler.prop("title",a?b.Terms.OpenMenu:b.Terms.HideMenu).toggleClass(c,!a).toggleClass(e,a)},q=new DivToggler({divId:b.ClientIds.LeftArea,isCollapsed:!b.LeftMenuExpanded,changeDivVisibility:!1,afterToggle:function(){var a=q.settings.isCollapsed,c=b.CssClasses.DesktopLefttoggleExpand,e=b.CssClasses.DesktopLefttoggleCollapse,f=b.CssClasses.DesktopLeftmenuHidden;d.LeftArea.toggleClass(b.CssClasses.DesktopLeftmenuVisible,!a).toggleClass(f,a);k(a,c,e)}}),n=new LeftMenu;n.settings={treeMenuClientID:b.ClientIds.TreeMenu,
contentAreaIframeClientID:b.ClientIds.ContentAreaIframe,arrowButtonClientID:d.ArrowButton.prop("id")};n.initialize();var p=new DivToggler({divId:b.ClientIds.LeftArea,isCollapsed:!0,changeDivVisibility:!1,afterToggle:function(){var a=p.settings.isCollapsed,c=b.CssClasses.MobileLeftmenuHidden;d.LeftArea.toggleClass(b.CssClasses.MobileLeftmenuVisible,!a).toggleClass(c,a);k(p.settings.isCollapsed,b.CssClasses.MobileLefttoggleExpand,b.CssClasses.MobileLefttoggleCollapse);p.settings.isCollapsed||(a=CCL.CommonFunctions.calculateRightAndBottomOffset(d.MenuIframe),
n.recalculateHeight(IframeResizer.getIframeDefaultWidthAndHeight(m,d.MenuIframe,a).height),b.IsIosDevice&&n.forceRefreshOnIos())}});d.LeftMenuToggler.click(function(){n.isDesktopMode()?q.toggleDiv(function(){CCL.CommonFunctions.safeAjax({type:"PUT",url:b.Urls.ToggleLeftMenuState,data:{show:!q.settings.isCollapsed}})}):p.toggleDiv()});d.MainSidebar.on("click","a",function(){var a=$(this).attr("href");"#"===a||0===a.toLowerCase().indexOf("javascript:")||n.isDesktopMode()||p.toggleDiv()});p.initialize();
a.push(p);q.initialize();a.push(q)}window.divTogglers=a;CCL.CommonFunctions.attachPostMessageEventListener(m,[CCL.CommonWindowMessages.MessageNames.disableFullScreen,CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame,CCL.CommonWindowMessages.MessageNames.enableFullScreen,CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame],function(a,b){if(!window.top[CCL.CommonWindowMessages.MessageNames.suspendExpandCollaplseContentAreaFrame]){var c;if(a.messageName===CCL.CommonWindowMessages.MessageNames.collapseContentAreaFrame||
a.messageName===CCL.CommonWindowMessages.MessageNames.disableFullScreen){$(window.top.divTogglers).each(function(){this.settings.isCollapsed||this.expandDiv()});var e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasCollapsed);var f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.collapseExtensionIframe)}else a.messageName!==CCL.CommonWindowMessages.MessageNames.expandContentAreaFrame&&!CCL.CommonWindowMessages.MessageNames.enableFullScreen||
window.top.isProfileCardOpened||($(window.top.divTogglers).each(function(){var a=this.settings.isCollapsed;this.collapseDiv();this.settings.isCollapsed=a}),e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.contentAreaFrameHasExpanded),f=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.expandExtensionIframe));(c=1===d.MenuIframe.length?d.MenuIframe.get(0).contentWindow:void 0)&&CCL.CommonFunctions.makePostMessageCall(c,f);CCL.CommonFunctions.makePostMessageCall(b,
e)}});CCL.CommonFunctions.attachPostMessageEventListener(m,CCL.CommonWindowMessages.MessageNames.collapseLeftMenu,function(){q.collapseDiv()});CCL.CommonFunctions.attachPostMessageEventListener(m,CCL.CommonWindowMessages.MessageNames.toggleBreadcrumbs,function(a,c){a.extendedData?$("."+b.CssClasses.BreadcrumbsContainer).parent().slideDown(0):$("."+b.CssClasses.BreadcrumbsContainer).parent().slideUp(0)})}}();e.BottomNavigationBar=f})(f.TopMenu||(f.TopMenu={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){e.GradeExportInstance=this;this.controls=b;this.context=a;this.init()}d.prototype.dismissSyncItemNotifications=function(){$.post(this.context.WebMethods.CancelSyncItemNotification,{courseId:this.context.Settings.CourseId}).fail(function(b){e.Utils.handleAjaxError(b)})};d.prototype.init=function(){var b=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;$(document).on(d.showFeedbackEventTitle,
function(a,c,d){return b.showFeedback(c,d)})};d.prototype.showFeedback=function(b,a){var c=this;this.changeFeedbackContainer(a);null!=b&&CCL.InformationFeedback.showFeedbackWithextraButton(this.controls.Container,b,this.context.LanguageTerms.GotIt,function(){c.closeFeedback()})};d.prototype.changeFeedbackContainer=function(b){null!=b&&$(document).find("."+CCL.CommonCssClasses.InformationFeedback.Container).css("top",b.top+20)};d.prototype.closeFeedback=function(){CCL.InformationFeedback.hideFeedback(this.controls.Container)};
d.showFeedbackEventTitle="LineItemsTransfer:showFeedback";return d}();e.GradeExport=f})(f.OneRoster||(f.OneRoster={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){var a=this;this.toggleValidator=ValidatorEnable;this.self=this;e.AddAssessmentInstance=this;this.context=b;this.window=$(window);var c=this;jQuery.alerts.okButton=this.context.LanguageTerms.Ok;jQuery.alerts.cancelButton=this.context.LanguageTerms.Cancel;this.initialDefaultScore=1===this.context.Controls.DefaultScore.length?this.context.Controls.DefaultScore.val():"";this.initialDefaultAssessmentItemId=1===this.context.Controls.DefaultAssessmentItemId.length?
this.context.Controls.DefaultAssessmentItemId.val():"";this.context.Controls.OkButton.click(function(){return a.approveChanges(a)});this.secondSectionSeparator=this.context.Controls.WhereCountSection.parent().find("div."+this.context.CssClasses.FormSectionSeparator).last();this.toggleCustomExistingSections(this);this.context.Controls.CustomRadioButton.click(function(){a.toggleCustomExistingSections(a)});this.context.Controls.ExistingAssessment.click(function(){a.toggleCustomExistingSections(a)});
this.toggleFinalAssessmentCheckbox();this.context.Controls.AddDefaultAssessmentCheckBox.click(function(){a.toggleDefaultAssessmentControls(a)});this.context.Controls.DefaultAssessmentItemList.change(function(){a.saveDefaultAssessmentItemListSelection(a)});this.context.Controls.RetrieveLearningObjectivesFromPlannerButton.click(function(){a.retrieveLearningObjectivesFromPlanner(a)});$(document).on(c.context.Settings.LearningObjectiveItemsChangedClientEventName,function(a,b){c.refreshAssessmentTypeList(c,
a,b)});1===this.context.Controls.AssessmentScaleList.length&&(this.context.Controls.AssessmentScaleList.change(function(){c.toggleWeightPanelAccordingToAssessmentScale(this.value);c.toggleMaxScorePanelAccordingToAssessmentScale();c.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale()}),this.toggleWeightPanelAccordingToAssessmentScale(this.context.Controls.AssessmentScaleList.val()))}d.prototype.toggleCustomExistingSections=function(b){var a=b.context.Controls.CustomRadioButton.prop("checked");
b.toggle(b.context.Controls.ExistingSection,!a);b.toggle(b.context.Controls.CustomSection,a);b.toggle(b.context.Controls.AssessmentScaleListHolder,a);b.context.Controls.AssessmentScaleName.toggle(!a||0===b.context.Controls.AssessmentScaleList.length);b.toggle(b.context.Controls.EditableMaxScoreHolder,a);b.context.Controls.MaxScoreLabel.toggle(!a||0===b.context.Controls.MaxScore.length);b.context.Settings.UseTerms&&(0<b.context.Settings.SelectedTermId&&b.toggle(b.context.Controls.FinalAssessmentPanel,
a),b.context.Controls.FinalAssessmentCheckbox.prop("checked")&&b.toggleFinalAssessmentSettings(a),0<b.context.Settings.SelectedTermId&&b.toggleWhereOrHowSection(b.context.Controls.WhereCountSection,a||b.context.Controls.CategoryListPanel.is(":visible")));b.context.Settings.UseTerms&&0!==b.context.Settings.SelectedTermId||b.context.Controls.CustomRadioButton.prop("disabled")&&a||b.toggleBottomWarningMessageForElement(b);b.toggleWeightPanelAccordingToAssessmentScale(null);b.toggleMaxScorePanelAccordingToAssessmentScale();
b.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale();b.toggleIsManualAssessmentVisible()};d.prototype.toggleIsManualAssessmentVisible=function(){var b=this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&this.context.Controls.FinalAssessmentCheckbox.prop("checked")||!this.context.Controls.CustomRadioButton.prop("checked");this.toggle(this.context.Controls.IsManualAssessmentVisibleTogglePanel,!b)};d.prototype.toggleFinalAssessmentCheckbox=function(){this.toggleFinalAssessmentSettings(this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&
this.context.Controls.FinalAssessmentCheckbox.prop("checked"))};d.prototype.toggleFinalAssessmentSettings=function(b){this.toggleIsManualAssessmentVisible();this.toggle(this.context.Controls.CategoryListPanel,!b);this.context.Settings.UseTerms&&0<this.context.Settings.SelectedTermId&&this.toggleWhereOrHowSection(this.context.Controls.HowAssessSection,!b);this.toggleWeightPanelAccordingToAssessmentScale(null);this.toggleMaxScorePanelAccordingToAssessmentScale()};d.prototype.toggleWhereOrHowSection=
function(b,a){b.is(":visible")&&a||(this.toggle(b,a),this.secondSectionSeparator.toggle(this.context.Controls.HowAssessSection.is(":visible")&&a))};d.prototype.toggleWeightPanelAccordingToAssessmentScale=function(b){1===this.context.Controls.WeightPanel.length&&this.toggle(this.context.Controls.WeightPanel,(!this.context.Controls.FinalAssessmentCheckbox.is(":visible")||!this.context.Controls.FinalAssessmentCheckbox.prop("checked"))&&(1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?
this.isAssessmentScaleSupportWeighting(b||this.context.Controls.AssessmentScaleList.val()):this.context.Settings.IsAssessmentScaleOfTheColumnSupportWeighting))};d.prototype.toggleMaxScorePanelAccordingToAssessmentScale=function(){1===this.context.Controls.MaxScorePanel.length&&this.toggle(this.context.Controls.MaxScorePanel,1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.is(":visible")?this.isAssessmentScaleSupportScore():this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore)};
d.prototype.saveDefaultAssessmentItemListSelection=function(b){b.context.Controls.DefaultAssessmentItemId.val(b.context.Controls.DefaultAssessmentItemList.val())};d.prototype.toggleAddDefaultAssessmentCheckBoxAccordingToAssessmentScale=function(){1===this.context.Controls.AddDefaultAssessmentPanel.length&&(this.isAssessmentScaleSelected()||this.isAssessmentScaleSupportScore()?this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("disabled"):(this.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"),
this.context.Controls.AddDefaultAssessmentCheckBox.prop("disabled","disabled")),this.toggleDefaultAssessmentControls(this))};d.prototype.toggleDefaultAssessmentControls=function(b){var a=b.context.Controls.CustomRadioButton.prop("checked")&&!b.usedFinalAssessmentOption(),c=!1,d=!1;a?(c=b.context.Controls.AddDefaultAssessmentCheckBox.prop("checked"),d=b.isAssessmentScaleSupportScore(),c&&!d&&$.getJSON(b.context.WebMethods.GetAssessmentItems,{assessmentId:this.getAssessmentId(),courseId:this.context.Settings.CourseId}).done(function(a){b.context.Controls.DefaultAssessmentItemList.empty();
for(var c=0,d=a.length;c<d;c+=1){var e=a[c];b.context.Controls.DefaultAssessmentItemList.append('<option value="'+e.AssessmentItemId+'">'+e.Title+"</option>")}""!==b.context.Controls.DefaultAssessmentItemId.val()&&b.context.Controls.DefaultAssessmentItemList.val(b.context.Controls.DefaultAssessmentItemId.val())}).fail(function(a){return CCL.CommonFunctions.alertAjaxError(a,null,null)})):(b.context.Controls.DefaultAssessmentItemList.empty(),b.context.Controls.DefaultAssessmentItemId.val(""),b.context.Controls.DefaultScore.val(""),
b.context.Controls.AddDefaultAssessmentCheckBox.removeAttr("checked"));b.toggle(b.context.Controls.AddDefaultAssessmentPanel,a);b.toggle(b.context.Controls.DefaultAssessmentItemListPanel,a&&c&&!d);b.toggle(b.context.Controls.DefaultScorePanel,a&&c&&d)};d.prototype.isAssessmentScaleSupportWeighting=function(b){return parseInt(b.split(":")[1])===this.context.Settings.AssessmentTotalsAverage};d.prototype.isAssessmentScaleSupportScore=function(){return 1===this.context.Controls.AssessmentScaleList.length&&
parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0])===this.context.Settings.ScoreItemValue||0===this.context.Controls.AssessmentScaleList.length&&this.context.Settings.IsAssessmentScaleOfTheColumnSupportScore};d.prototype.toggleBottomWarningMessageForElement=function(b){if(window[b.context.Settings.BottomMessageClientInstanceName]){var a=!b.context.Controls.CustomRadioButton.prop("checked")&&b.context.Settings.IsAssessmentScaleOfTheColumnSupportScore;window[b.context.Settings.BottomMessageClientInstanceName].self.context.Controls.container.toggle(a);
a&&(b.context.Controls.FinalAssessmentCheckbox.prop("checked",!1),b.toggleFinalAssessmentCheckbox());b.context.Controls.FinalAssessmentCheckbox.prop("disabled",a)}};d.prototype.usedFinalAssessmentOption=function(){return 1===this.context.Controls.FinalAssessmentCheckbox.length&&this.context.Controls.FinalAssessmentCheckbox.is(":visible")&&this.context.Controls.FinalAssessmentCheckbox.prop("checked")};d.prototype.isAssessmentScaleSelected=function(){return null!=this.getAssessmentId()};d.prototype.getAssessmentId=
function(){return 1===this.context.Controls.AssessmentScaleList.length&&this.context.Controls.AssessmentScaleList.val()!==this.context.Settings.NotSelectedAssessmentScaleValue?parseInt(this.context.Controls.AssessmentScaleList.val().split(":")[0]):0===this.context.Controls.AssessmentScaleList.length&&0<this.context.Settings.SelectedAssessmentId?this.context.Settings.SelectedAssessmentId:null};d.prototype.toggle=function(b,a){var c=this;if(1===b.length){var d=function(a,b){for(var d=0,e=a.length;d<
e;d++)c.toggleValidator(a[d],b)};b.toggle(a);b.hasClass(this.context.CssClasses.FormContainer)?b.find('input:not([type="hidden"]), select, textarea').each(function(a,b){d($(b).nextAll("span[id$=Validator]").toArray(),$(b).is(":visible"))}):d(b.nextAll("span[id$=Validator]").toArray(),a)}};d.prototype.approveChanges=function(b){return b.confirmationDefaultAssessmentEditRequired()?(jConfirm(b.context.Controls.AddDefaultAssessmentCheckBox.prop("checked")?b.context.LanguageTerms.DefaultAssessmentChaingingConfirmMessage:
b.context.LanguageTerms.DefaultAssessmentTurningOffConfirmMessage,b.context.LanguageTerms.PleaseConfirm,function(a){if(a)if(b.pageIsValid())b.context.Functions.SuccessSubmit();else return!1;return!0}),!1):!0};d.prototype.confirmationDefaultAssessmentEditRequired=function(){if(!this.context.Settings.IsEditModeAndCustomAssessment)return!1;var b=1===this.context.Controls.AddDefaultAssessmentCheckBox.length&&this.context.Controls.AddDefaultAssessmentCheckBox.prop("checked");return this.context.Settings.UseDefaultAssessment&&
!b||this.context.Settings.UseDefaultAssessment&&b&&(1===this.context.Controls.DefaultScore.length&&this.context.Controls.DefaultScore.val()!==this.initialDefaultScore||1===this.context.Controls.DefaultAssessmentItemId.length&&this.context.Controls.DefaultAssessmentItemId.val()!==this.initialDefaultAssessmentItemId)};d.prototype.pageIsValid=function(){return Page_ClientValidate&&"function"===typeof Page_ClientValidate?(Page_ClientValidate(),Page_IsValid):!0};d.prototype.retrieveLearningObjectivesFromPlanner=
function(b){b.context.Controls.OkButton.attr("disabled","disabled");b.context.Controls.RetrieveLearningObjectivesFromPlannerButton.addClass(b.context.CssClasses.ButtonInProgerssClass).attr("disabled","disabled");CCL.CommonFunctions.safeAjaxPost({data:{termId:b.context.Settings.TermId,courseId:b.context.Settings.CourseId},dataType:"json",url:b.context.WebMethods.GetLearningObjectivesFromPlanner}).done(function(a){a.Success||alert(a.Message);a=$.unique((a.LearningObjectiveIds?a.LearningObjectiveIds:
[]).concat(window[b.context.Controls.LearningObjectivesEditorKey].getObjectiveIdsArray()));window[b.context.Controls.LearningObjectivesEditorKey].addLearningObjectives(a)}).fail(function(a){CCL.CommonFunctions.alertAjaxError(a,null,null)}).always(function(){b.context.Controls.OkButton.removeAttr("disabled");b.context.Controls.RetrieveLearningObjectivesFromPlannerButton.removeClass(b.context.CssClasses.ButtonInProgerssClass).removeAttr("disabled")})};d.prototype.refreshAssessmentTypeList=function(b,
a,c){b.context.Controls.AssessmentTypeListPanel.find("["+b.context.Settings.IncludeLearningObjectivesAttribute+"='False']").toggle(!(0<c.length))};return d}();e.AddAssessment=f})(f.AssessmentRecord||(f.AssessmentRecord={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.settings=b;this.controls=a;this.document=$(document);window[this.settings.ClientInstanceName]=this;this.formCheckBeforeUnload=new CCL.FormCheckBeforeUnload(this.controls.form,this.settings.Terms.BeforeUnloadWarningMessage,{cancelButtonId:this.settings.ClientIds.CancelButton});this.controls.usePlagiarismCheckBox.click(function(a){c.controls.plagiarismInfoMessage.toggle()});this.controls.useAnonymousSubmissionCheckBox.click(function(a){c.controls.anonymousSubmissionInfoMessage.toggle()});
this.settings.ConnectAssessmentCriteriaToScale&&this.controls.assessmentDropDown.change(function(){c.toggleCriteriaWeights(!1)})}d.prototype.toggleCriteriaWeights=function(b){var a=this.controls.assessmentDropDown.find("option:selected").val();this.document.trigger(this.settings.LearningObjectivesEditorToggleCriteriaWeightsVisibilityMethodName,{show:!b&&a!==this.settings.AssessmentScaleControlDoNotUseAssessmentValue})};return d}();e.AddEditLearningToolElement=f})(f.LearningToolElement||(f.LearningToolElement=
{}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(a){this.settings=a;this.document=$(document);window[this.settings.ClientInstanceName]=this}b.prototype.checkIfTransitionAllowed=function(a,b){var c=[];this.settings.AllowedTypeTransitions.forEach(function(b){b.Type==a&&(c=b.AllowedChildrenTypes)});return 0<c.length&&-1<$.inArray(b,c)};b.prototype.extractType=function(a){var b=this.settings.NodeNamePrefix,d=a.indexOf(b);if(0>d)return"";var e=a.indexOf(" ",d);0>e&&(e=a.length-1);return a.substring(d+
b.length,e)};b.prototype.findParentWithType=function(a,b,d){b=this.settings.NodeNamePrefix+b;if(d&&$(a).hasClass(b))return a;a=$(a).parents("."+b);return 0<a.length?a.get(0):null};b.prototype.moveNode=function(a,b,d,e,f){var c=this,g=$("#"+a);b=$("#"+d);var h=$("#"+e),m={};m[this.settings.RequestItems.RepositoryTreeEntityClientIdToMove]=a;m[this.settings.RequestItems.RepositoryTreeEntityToMoveType]=this.extractType(g.attr("class"));m[this.settings.RequestItems.NewParentRepositoryTreeEntityClientId]=
d;m[this.settings.RequestItems.NewParentRepositoryTreeEntityType]=this.extractType(b.attr("class"));m[this.settings.RequestItems.RelativeRepositoryTreeEntityClientId]=e;m[this.settings.RequestItems.RelativeRepositoryTreeEntityType]=this.extractType(h.attr("class"));m[this.settings.RequestItems.RelativeMovePosition]=f;m[this.settings.RequestItems.HierarchyId]=this.settings.HierarchyId;m[this.settings.RequestItems.CountryCode]=this.settings.CountryCode;CCL.CommonFunctions.safeAjax({type:"PUT",url:this.settings.MoveUrl,
data:m}).done(function(){g.children("a").first().effect("highlight",{},2500)}).fail(function(){jAlert(c.settings.Terms.TreeMenuErrorWhileMoving,c.settings.Terms.Error,function(){location.reload()})})};b.prototype.beforeMove=function(a){if(this.extractType(a.o[0].className)===this.settings.TreeTypeDescriptor){a=a.np[0];var b=this.extractType(a.className)===this.settings.TreeTypeCriterion;return b&&$(a).find("li."+this.settings.NodeNamePrefix+this.settings.TreeTypeDescriptor).length>=this.settings.MaxNumberOfAchievementLevels?
(jAlert(this.settings.Terms.YouCannotAddMoreThanXDescriptors),!1):b}return!0};b.prototype.checkOnMove=function(a){if(a.np[0]!=a.op[0]){var b=this.extractType(a.np[0].className),d=this.extractType(a.o[0].className);if(!b||!d||!this.checkIfTransitionAllowed(b,d)||this.findParentWithType(a.np[0],this.settings.TreeTypeSubject,!0)!=this.findParentWithType(a.o[0],this.settings.TreeTypeSubject,!1))return!1}return!0};return b}();e.LearningObjectiveRepository=d})(e.LearningObjectiveRepository||(e.LearningObjectiveRepository=
{}))})(f.Administration||(f.Administration={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){var c=this;this.checkAsyncTaskStatusTimeoutMilliseconds=5E3;this.selectedPersonIds=[];e.AssessmentLettersInstance=this;this.settings=b;this.controls=a;this.letterGroupGridRowsContainer=this.controls.letterGroupGridInstance.getRowsContainer();this.letterGroupGridRows=this.controls.letterGroupGridInstance.getRows();this.letterGroupGridRowsContainer.on("click",CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupDownloadLink),
function(){CCL.CommonFunctions.safeAjaxPost({url:c.settings.ServiceUrlsModel.AddKpiOnDownloadLetterGroupPdf,data:{isViewerRoleHeadteacher:c.settings.IsViewerRoleHeadteacher}}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})});this.controls.createLetterGroupButton.click(this.openCreateLetterGroupPopup);this.scheduleCheckExportToPdfAsyncTaskStatus();this.scheduleCheckLettersGeneratedAsyncTaskStatus();this.settings.IsScrollToGroupLettersFeedbackControlNeeded&&this.scrollToGroupLettersFeedback()}
d.prototype.openViewRecipientsDialog=function(b,a,c){b=window[e.AssessmentLettersInstance.settings.ClientInstanceNames.ViewRecipientsDialogInstance];c=CCL.CommonFunctions.formatString(e.AssessmentLettersInstance.settings.LanguageTerms.RecipientsFor,c);b.setTitle(c);b.setAjaxUrl(e.AssessmentLettersInstance.settings.ServiceUrlsModel.GetLetterGroupRecipients,{letterGroupId:a,isViewerRoleHeadteacher:e.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher},!1);b.openDialog(!1)};d.prototype.publishLetterGroupAction=
function(b,a,c){var d=this,e={letterGroupId:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher};$.alerts.okButton=this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.PublishLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(a){a&&d.postJsonToService(d.settings.ServiceUrlsModel.PublishLetterGroup,e).done(function(a){window.location=window.location})})};d.prototype.deleteLetterGroupAction=
function(b){$.alerts.okButton=this.settings.LanguageTerms.Yes;$.alerts.cancelButton=this.settings.LanguageTerms.No;jConfirm(this.settings.LanguageTerms.DeleteLetterGroupConfirmationMessage,this.settings.LanguageTerms.PleaseConfirm,function(a){a&&b()})};d.prototype.exportToPdfLetterGroupAction=function(b,a){$(b).attr("disabled")||a()};d.prototype.openCreateLetterGroupPopup=function(){var b=window[e.AssessmentLettersInstance.settings.ClientInstanceNames.CreateLetterPopupInstance],a=[],c=e.AssessmentLettersInstance.controls.learnersGridInstance.GetSelectedValues();
c&&0<c.length&&(a=c.substr(0,c.length-1).split(","));0===a.length?jAlert(e.AssessmentLettersInstance.settings.LanguageTerms.SelectAtLeastOneLearner,e.AssessmentLettersInstance.settings.LanguageTerms.AlertTitle,null):0===$(a).not(e.AssessmentLettersInstance.selectedPersonIds).length&&0===$(e.AssessmentLettersInstance.selectedPersonIds).not(a).length?b.openDialog():CCL.CommonFunctions.safeAjaxPost({url:e.AssessmentLettersInstance.settings.ServiceUrlsModel.GetCreateLetterGroupPopupTitle,data:{personIds:a,
termName:e.AssessmentLettersInstance.settings.TermName,isViewerRoleHeadteacher:e.AssessmentLettersInstance.settings.IsViewerRoleHeadteacher}}).done(function(c){e.AssessmentLettersInstance.selectedPersonIds=a;b.setAboutHtml(c);b.openDialog()}).fail(function(a,b,c){CCL.CommonFunctions.alertAjaxError(a,b,c)})};d.prototype.scheduleCheckExportToPdfAsyncTaskStatus=function(){var b=this;setTimeout(function(){b.checkExportToPdfAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};d.prototype.checkExportToPdfAsyncTaskStatus=
function(){var b=this,a=[];this.controls.letterGroupGridInstance.getRows().each(function(b,d){a.push($(d).data("id"))});0<a.length&&CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceUrlsModel.GetLetterGroupsFeedback,data:{letterGroupIds:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(c){var d=window[b.settings.ClientInstanceNames.GroupLettersTasksStatusFeedbackInstance];c=$(c);var e=c.attr(b.settings.DataAttributes.FeedbackProgress);e!==b.settings.DataAttributes.FeedbackProgressValueWait&&
e!==b.settings.DataAttributes.FeedbackProgressValueOk&&e!==b.settings.DataAttributes.FeedbackProgressValueError||d.showMessage(e===b.settings.DataAttributes.FeedbackProgressValueError?CCL.FeedbackType.Error:CCL.FeedbackType.Information,c.html());e!==b.settings.DataAttributes.FeedbackProgressValueOk&&e!==b.settings.DataAttributes.FeedbackProgressValueError||b.deleteLetterGroupAsyncTaskExportAsPdf();e===b.settings.DataAttributes.FeedbackProgressValueOk&&b.injectLetterGroupDownloadLinks(a);b.scheduleCheckExportToPdfAsyncTaskStatus()}).fail(function(a,
b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.scheduleCheckLettersGeneratedAsyncTaskStatus=function(){var b=this;0<this.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString(".{0}",this.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&setInterval(function(){b.checkLettersGeneratedAsyncTaskStatus()},this.checkAsyncTaskStatusTimeoutMilliseconds)};d.prototype.checkLettersGeneratedAsyncTaskStatus=function(){var b=this,a=[];this.controls.letterGroupGridInstance.getRows().each(function(c,
d){0<$(d).find(CCL.CommonFunctions.formatString(".{0}",b.settings.CssClasses.LetterGroupGeneratingInProgress)).length&&a.push($(d).data("id"))});0<a.length&&this.postJsonToService(this.settings.ServiceUrlsModel.GetGenerateLettersJobStatus,{letterGroupIds:a,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(a){var b=!1;a.forEach(function(a){a.IsLetterGroupBusy||(b=!0)});b&&(window.location=window.location)})};d.prototype.publishLetterGroups=function(b,a){this.postJsonToService(this.settings.ServiceUrlsModel.PublishLetterGroup,
{letterGroupIds:b,isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}).done(function(){a()})};d.prototype.deleteLetterGroupAsyncTaskExportAsPdf=function(){this.postJsonToService(this.settings.ServiceUrlsModel.DeleteLetterGroupAsyncTaskExportAsPdf,{isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher})};d.prototype.injectLetterGroupDownloadLinks=function(b){var a=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.ServiceUrlsModel.GetLetterGroupDownloadLinks,data:{letterGroupIds:b,
isViewerRoleHeadteacher:this.settings.IsViewerRoleHeadteacher}}).done(function(b){$(b).children().each(function(b,c){b=$(c);c=a.letterGroupGridRowsContainer.find(CCL.CommonFunctions.formatString("[{0}='{1}'] ",a.settings.DataAttributes.LetterGroupDownloadLink,b.attr(a.settings.DataAttributes.LetterGroupDownloadLink)));0<c.length&&c.replaceWith(b)})}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.postJsonToService=function(b,a){return CCL.CommonFunctions.safeAjaxPost({dataType:"JSON",
url:b,data:a}).fail(function(a,b,d){CCL.CommonFunctions.alertAjaxError(a,b,d)})};d.prototype.scrollToGroupLettersFeedback=function(){$("html, body").animate({scrollTop:this.controls.groupLettersGridLabel.offset().top},1E3)};return d}();e.AssessmentLetters=f})(f.Supervisor||(f.Supervisor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(){function a(a,b){this.PlanId=a;this.ColumnId=b}a.distinctArray=function(a){return a.reduce(function(a,b){0===a.filter(function(a){return b.PlanId===a.PlanId&&b.ColumnId===a.ColumnId}).length&&a.push(b);return a},[])};return a}();b.PlannerCell=a;var c=function(b){function c(a,f,g){b.call(this,f,e.Planner.getInstance().settings.CourseId,g);this._planElementMovingDisabled=!1;window[a]=this;c.instanceName=a;this._css=f.Css;
this._terms=f.Terms;this._elementColumnIds=f.ElementColumnIds;this._planner=e.Planner.getInstance();this._activateElementsByPlan=this._planner.settings.ActivateElementsByPlan;this._planExpandableContentCellCommonLogic=d.PlanExpandableContentCellCommonLogic.getInstance();a=top;this._activateElementsByPlan&&a.reloadFolder&&a.reloadFolder("item0","planner",!0);this.attachEvents()}__extends(c,b);c.prototype.refreshResourcesCell=function(a,b,c){this.refreshActivityResourceCell(a,b,!0,!0,!1);c&&this.measureKpiEditPlan()};
c.getPlanActivityResourceCellInstance=function(){return window[c.instanceName]};c.onFileUploadSuccess=function(a){c.getPlanActivityResourceCellInstance().onFileUploadSuccess(a)};c.onFileUploadFailed=function(a,b){c.getPlanActivityResourceCellInstance().onFileUploadFailed(a,b)};c.onFileSelected=function(a){c.getPlanActivityResourceCellInstance().onFileSelected(a)};c.getActivityResourceListItemSelector=function(){return"."+c.getPlanActivityResourceCellInstance()._css.ActivityResourceListItem};c.prototype.refreshActivityResourceCell=
function(a,b,c,d,e){void 0===d&&(d=!0);this.reloadPlanElements(a,b,d,c,e)};c.prototype.updateContent=function(a,b,c,d,f){var g=this;b=this.getActivityResourceCell(b,c);b.html(a);a=top;d&&a.reloadFolder&&a.reloadFolder("item0","planner",f,!0);if(this._activateElementsByPlan){d=b.find("."+this._css.ActivityResourceListItem);var h=this._planner.getContainer();0<d.length&&d.each(function(a,b){var c=$(b);a=c.find("."+g._css.ActivityResourceListItemLink).first();b=c.data(g._planner.data.ElementId);void 0==
b||0>=a.length||(a=h.find("."+g._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(g._planner.data.ElementId,b)),0<a.length&&a.each(function(){var a=$(this),b=c.clone();a.replaceWith(b)}))})}this.initDragAndDrop(e.Cards.TopicCard.getParentTopicCardContainer(b))};c.prototype.initDragAndDrop=function(a){var b=this;null==a&&(a=e.Cards.TopicCard.getAllTopicCardContainers());a.each(function(a,c){var d=$(c);b._elementColumnIds.forEach(function(a){a=d.find("."+b._css.ActivityResourceCell+
CCL.CommonFunctions.getDataSelector(b._planner.data.ColumnId,a)+" > ul");b.setDragAndDrop(a)})})};c.prototype.reloadPlanElements=function(a,b,c,d,e){var f=this;this._planElementMovingDisabled=!0;void 0==e&&(e=!this.getActivityResourceCell(a,b).find("."+this._planExpandableContentCellCommonLogic.css.ExpanderLink).hasClass(this._planExpandableContentCellCommonLogic.css.ExpanderLinkExpanded));CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.ReloadPlanElements,data:{courseId:this.courseId,
planId:a,columnId:b,showCollapsedList:e}}).done(function(e){f.updateContent(e.ControlHtml,a,b,c,d);f._planElementMovingDisabled=!1}).fail(function(){return f._planElementMovingDisabled=!1})};c.prototype.removeElementFromPlan=function(a){var c=this,d=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ElementId),f=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.PlanId),g=this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId);b.prototype.deletePlanElement.call(this,
f,d,!1).done(function(){c.refreshActivityResourceCell(f,g,!1,!1);c.measureKpiEditPlan()})};c.prototype.deleteElementFromCourse=function(c){var d=this,f=this.getDataAttributeValueAsNumber(c,e.PlannerConstants.dataAttributes.ElementId);c=this.getDataAttributeValueAsNumber(c,e.PlannerConstants.dataAttributes.PlanId);b.prototype.deletePlanElement.call(this,c,f,!0).done(function(){var b=top;b.reloadFolder&&b.reloadFolder("item0","planner");b=d.findCellsToRefresh(f);a.distinctArray(b).forEach(function(a){d.refreshActivityResourceCell(a.PlanId,
a.ColumnId,!1,!1)});d.measureKpiEditPlan()})};c.prototype.getActivityResourceCell=function(a,b){return $("."+this._css.ActivityResourceCell+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).closest("."+this._planner.getPlannerCellCssClass())};c.prototype.getActivityResourceList=function(a,b){return this.getActivityResourceCell(a,b).find("ul")};c.prototype.findCellsToRefresh=function(b){var c=this,d=[];this._planner.getContainer().find("."+
this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,b)).each(function(b,e){e=$(e);b=e.data(c._planner.data.PlanId);e=e.data(c._planner.data.ColumnId);d.push(new a(b,e))});this.getChildElementIds(b).forEach(function(a){d=$.merge(d,c.findCellsToRefresh(a))});return d};c.prototype.getChildElementIds=function(a){var b=this,c=[];this._planner.getContainer().find("."+this._css.ActivityResourceListItem+CCL.CommonFunctions.getDataSelector(this._planner.data.ParentFolderId,
a)).each(function(a,d){a=$(d).data(b._planner.data.ElementId);-1===c.indexOf(a)&&c.push(a)});return c};c.prototype.swapPlanElements=function(a,b,c,d){var e=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.SwapPlanElements,data:{courseId:this.courseId,firstElementId:b,secondElementId:c,planId:a,columnId:d}}).done(function(){e.reloadPlanElements(a,d,!1,!1)})};c.prototype.movePlanElement=function(a,b,c,d,e){var f=this;this._planElementMovingDisabled=!0;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.MovePlanElement,
data:{courseId:this.courseId,sourcePlanId:a,targetPlanId:b,elementId:c,columnId:d,elementIds:e}}).done(function(){a!==b&&(f.refreshActivityResourceCell(a,d,!1),f.refreshActivityResourceCell(b,d,f._planner.settings.ActivateElementsByPlan));f._planElementMovingDisabled=!1}).fail(function(){f.refreshActivityResourceCell(a,d,!1);a!==b&&f.refreshActivityResourceCell(b,d,!1);f._planElementMovingDisabled=!1})};c.prototype.moveElementToPlan=function(a,b,c,d){var e=this;CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.MoveElementToPlan,
data:{courseId:this.courseId,elementId:c,sourcePlanId:a,targetPlanId:b,columnId:d}}).done(function(c){c.Success&&(e.refreshActivityResourceCell(a,d,!1),e.refreshActivityResourceCell(b,d,e._planner.settings.ActivateElementsByPlan))})};c.prototype.getPrevElementId=function(a,b,c){var d=this,e=null,f=this.getActivityResourceCell(a,c).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,c){c=$(c);var g=f.eq(a-1);c.data(d._planner.data.ElementId)==b&&0<a&&(e=g.data(d._planner.data.ElementId))});
return e};c.prototype.getNextElementId=function(a,b,c){var d=this,e=null,f=this.getActivityResourceCell(a,c).find("."+this._css.ActivityResourceListItem);$.each(f,function(a,c){c=$(c);var g=f.eq(a+1);c.data(d._planner.data.ElementId)==b&&a<f.length-1&&(e=g.data(d._planner.data.ElementId))});return e};c.prototype.getNextPlanId=function(a,b){var c=null,d=e.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(d,function(b,e){if(e===a)return b<d.length-1&&(c=d[b+1]),
!1});return c};c.prototype.getPrevPlanId=function(a,b){var c=null,d=e.Cards.TopicCard.getParentTopicCard(this.getActivityResourceCell(a,b)).getPlanIds();$.each(d,function(b,e){if(e===a)return 0<b&&(c=d[b-1]),!1});return c};c.prototype.updateMoveOptions=function(a,b){if(a.length){var c=a.data(this._planner.data.ElementId),d=a.data(this._planner.data.ColumnId);a=a.data(this._planner.data.PlanId);var e="data-"+this._planner.data.PlanId,f=this.getActionLink(this._css.MoveUpResourceLink,c,d,b),g=this.getActionLink(this._css.MoveDownResourceLink,
c,d,b),h=this.getActionLink(this._css.MoveResourceToPrevPlanLink,c,d,b),k=this.getActionLink(this._css.MoveResourceToNextPlanLink,c,d,b),m=this.getActionLink(this._css.RemoveFromPlanLink,c,d,b);b=this.getActionLink(this._css.DeleteFromCourseLink,c,d,b);f.attr(e,a);g.attr(e,a);h.attr(e,a);k.attr(e,a);m.attr(e,a);b.attr(e,a)}};c.prototype.hideMoveOptionsIfNecessary=function(a){if(a.length){var b=a.siblings("."+this._css.ActivityResourceListItem),c=b.data(this._planner.data.ElementId);a=b.data(this._planner.data.ColumnId);
var d=b.data(this._planner.data.PlanId),e=this.getActionLink(this._css.MoveUpResourceLink,c,a,d).closest("li"),f=this.getActionLink(this._css.MoveDownResourceLink,c,a,d).closest("li"),g=this.getActionLink(this._css.MoveResourceToPrevPlanLink,c,a,d).closest("li");b=this.getActionLink(this._css.MoveResourceToNextPlanLink,c,a,d).closest("li");var h=this.getPrevElementId(d,c,a);e.toggle(null!=h);c=this.getNextElementId(d,c,a);f.toggle(null!=c);c=this.getPrevPlanId(d,a);g.toggle(null!=c);a=this.getNextPlanId(d,
a);b.toggle(null!=a)}};c.prototype.getActionLink=function(a,b,c,d){return $("."+a+CCL.CommonFunctions.getDataSelector(this._planner.data.ElementId,b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,c)+CCL.CommonFunctions.getDataSelector(this._planner.data.PlanId,d))};c.prototype.setDragAndDrop=function(a){var b=this;a.each(function(c,d){c=$(d);if(null!=c.sortable("instance"))return c.sortable("option","connectWith",a),!0;c.sortable({connectWith:a,axis:"y",scroll:!0,scrollSensitivity:50,
scrollSpeed:10,handle:"."+b._planner.css.ReorderDragHandler,cursor:"move",dropOnEmpty:!0,items:"."+b.settings.Css.ElementListItem,containment:e.Cards.TopicCard.getParentTopicCard(c).getPlanGrid().getRowsContainer()});c.on("sortstart",function(a,b){b.item.data("oldIndexValue",b.item.index())});c.on("sortreceive",function(a,c){var d=$(c.item).find("."+b._css.ActivityResourceListItem),e=d.data(b._planner.data.ElementId);b._planElementMovingDisabled?c.sender.sortable("cancel"):$(a.target).find("."+b._css.ActivityResourceListItem).each(function(a,
f){if(f==d[0])return!0;if($(f).data(b._planner.data.ElementId)==e)return c.sender.sortable("cancel"),!1})});c.on("sortstop",function(a,c){var d=parseInt(c.item.index(),10),f=parseInt(c.item.data("oldIndexValue"),10),g=$(c.item),h=g.find("."+b._css.ActivityResourceListItem),k=h.data(b._planner.data.PlanId),m=h.data(b._planner.data.ColumnId),l=h.data(b._planner.data.ElementId),n=e.Cards.TopicCard.getParentPlanContainer(h).data(b._planner.data.GridRowId);if(k!==n||f!==d){var q=[];g.parent().find("."+
b._css.ActivityResourceListItem).each(function(a,c){a=$(c);m===a.data(b._planner.data.ColumnId)&&(a=a.data(b._planner.data.ElementId),q.push(a))});b._planElementMovingDisabled?(a=null!=c.sender?c.sender:$(a.currentTarget),null!=a&&a.sortable("cancel")):(b.movePlanElement(k,n,l,m,q),h.attr("data-"+b._planner.data.PlanId,n),h.data(b._planner.data.PlanId,n),b.updateMoveOptions(h,k))}})})};c.prototype.getLearningObjectiveIds=function(a,b){var c=d.LearningObjectivesCell.PlanLearningObjectivesCell.getPlanLearningObjectivesCellInstance();
return c?c.getLearningObjectiveIds(a,b):[]};c.prototype.measureKpiEditPlan=function(){this._planner.measureEditPlan()};c.prototype.attachSpecificEvents=function(){var a=this;$(document).on("click","."+this._css.DeleteFromCourseLink,function(b){var c=$(b.currentTarget);CCL.CommonFunctions.jAjaxConfirm(a._terms.DeleteFromCourseConfirmation,a._planner.terms.ConfirmTitle,a._planner.terms.Yes,a._planner.terms.No,function(b){b&&a.deleteElementFromCourse(c)})}).on("click","."+this._css.MoveUpResourceLink,
function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var e=a.getPrevElementId(b,c,d);e&&a.swapPlanElements(b,c,e,d)}).on("click","."+this._css.MoveDownResourceLink,function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=
a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var e=a.getNextElementId(b,c,d);e&&a.swapPlanElements(b,c,e,d)}).on("click","."+this._css.MoveResourceToNextPlanLink,function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var e=a.getNextPlanId(c,d);e&&a.moveElementToPlan(c,e,b,d)}).on("click","."+this._css.MoveResourceToPrevPlanLink,
function(b){var c=$(b.currentTarget);b=a.getDataAttributeValueAsNumber(c,a._planner.data.ElementId);var d=a.getDataAttributeValueAsNumber(c,a._planner.data.ColumnId);c=a.getDataAttributeValueAsNumber(c,a._planner.data.PlanId);var e=a.getPrevPlanId(c,d);e&&a.moveElementToPlan(c,e,b,d)}).on("click","."+this._css.ActionLink,function(b){a.hideMoveOptionsIfNecessary($(b.currentTarget))}).on(this._planner.events.PlanActivityResourceCellOutdated,function(b,c){null!=c&&a._elementColumnIds.forEach(function(b){a.refreshActivityResourceCell(c.planId,
b,!1,a._activateElementsByPlan)})})};c.prototype.getLibraryBrowserDialog=function(){return this._planner.getLibraryBrowserDialog()};c.prototype.getPlanId=function(a){a=this.getPlanContainer(a);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.GridRowId)};c.prototype.getColumnId=function(a){a=a.closest("."+this._planner.getPlannerCellCssClass()).find("."+this.settings.Css.ActivityResourceCell);return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.ColumnId)};
c.prototype.getElementDialogOffset=function(){return-15};c.prototype.getFolderId=function(a){return this.getDataAttributeValueAsNumber(a,e.PlannerConstants.dataAttributes.FolderId)};return c}(b.PlanResourcesCellBase);b.PlanActivityResourceCell=c})(d.ResourcesCell||(d.ResourcesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(a){function b(c,d){var f=this;a.call(this,d);window[c]=this;b.instanceName=c;this.planner=e.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.showDates=this.planner.settings.ShowDates;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;$(function(){f.attachEvents()})}__extends(b,a);b.getPlanDateCellInstance=function(){return window[b.instanceName]};
b.prototype.updateContent=function(a,b,c){this.getDateCell(b).replaceWith(a);a=[{planId:b,planActive:c}];$(document).trigger(e.PlannerConstants.events.PlanActivationChanged,{planActivations:a})};b.prototype.updatePlanTimeSpan=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanTimeSpan,data:{courseId:this.courseId,planId:a,start:c.getStartDate(),stop:c.getStopDate(),showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();
b.refreshDatesCell(a);var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.TimeSpan)}).fail(function(){c.showErrorMsg(e.DatePickerMode.TimeSpan)})};b.prototype.updatePlanWeekAndDay=function(a){var b=this,c=this.getDatePicker();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanWeekAndDay,data:{courseId:this.courseId,planId:a,start:c.getStartWeek(),stop:c.getStopWeek(),showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();
b.refreshDatesCell(a);var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.WeekAndDay)}).fail(function(){c.showErrorMsg(e.DatePickerMode.WeekAndDay)})};b.prototype.updatePlanEvents=function(a){var b=this,c=this.getDatePicker(),d=c.getEvents();return CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.UpdatePlanEvents,data:{courseId:this.courseId,planId:a,activityIds:d,filterStartDate:this.startDate,filterStopDate:this.endDate,
showPlanDates:this.showDates}}).done(function(a){if(a){b.closeDatePicker();b.refreshDatesCell(a);var d=e.Cards.TopicCard.getInstance(a.topicId);d&&d.updateTopicExpanderLink(a.expanderText)}else c.showErrorMsg(e.DatePickerMode.Event)}).fail(function(){c.showErrorMsg(e.DatePickerMode.Event)})};b.prototype.setDefaultDate=function(a,b){b=b.data(e.PlannerConstants.dataAttributes.TopicId);e.Cards.TopicCard.setDefaultDate(a,b)};b.prototype.getCurrentPlanId=function(a){a=a.parent().find("input:hidden");return parseInt(a.data(e.PlannerConstants.dataAttributes.PlanId).toString(),
10)};b.prototype.openContextDialog=function(a){this.contextDialog.openDialog(a)};b.prototype.focusOnDateEditAction=function(a){this.getDateCell(a).find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanCellAction)).focus()};b.prototype.refreshDatesCell=function(a){this.updateContent(a.dateCell,a.planId,a.planActive);this.planner.settings.ActivateElementsByPlan&&$(document).trigger(e.PlannerConstants.events.PlanActivityResourceCellOutdated,{planId:a.planId})};b.prototype.getDateCell=
function(a){return $("."+this.css.CellContent+" input:hidden"+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).closest("."+this.css.CellContent)};b.prototype.attachEvents=function(){var a=this;$(document).on(e.PlannerConstants.events.PlanDateCellChange,function(b,c){void 0!=c.dateCellObject&&a.refreshDatesCell(c.dateCellObject)});$(document).on(e.PlannerConstants.events.PlanDateCellsChanged,function(b,c){void 0!=c.dateCellObjects&&$.each(c.dateCellObjects,function(b,
c){a.getDateCell(c.PlanId).replaceWith(c.Content)})})};return b}(b.PlanDateCellBase);b.PlanDateCell=a})(d.DateCell||(d.DateCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){(function(b){var a=function(a){function b(b,c){a.call(this,b,c,e.Planner.getInstance().getContainer())}__extends(b,a);b.prototype.removeLearningObjective=function(b){var c=this,d=b.data(e.PlannerConstants.dataAttributes.PlanId);b=b.data(e.PlannerConstants.dataAttributes.LearningObjectiveId);var f=!this.getLearningObjectivesListCell(d).find("."+this.settings.Css.ExpanderLink).hasClass(this.settings.Css.ExpanderLinkExpanded);a.prototype.removeLOFromPlan.call(this,
d,b,f).done(function(a){c.updateContent(a.ControlHtml,d)})};b.prototype.getCurrentPlanId=function(a){return a.data(e.PlannerConstants.dataAttributes.PlanId)};b.prototype.getLearningObjectivesListCell=function(a){return $("."+this.settings.Css.LearningObjectivesList+CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)).closest("."+e.Planner.getInstance().getPlannerCellCssClass())};b.prototype.getLearningObjectiveIds=function(a,b){void 0===b&&(b=!1);var c=this.getLearningObjectivesListCell(a),
d=this.getLearningObjectiveDataAttribute(b);a=c.find(CCL.CommonFunctions.getDataSelector(e.PlannerConstants.dataAttributes.PlanId,a)+CCL.CommonFunctions.getDataSelector(d));var f=[];0<a.length&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(d))&&(a=parseInt(a.data(d).toString(),10),-1===$.inArray(a,f)&&f.push(a))});return f};return b}(b.PlanLearningObjectivesCellBase);b.PlanLearningObjectivesCell=a})(d.LearningObjectivesCell||(d.LearningObjectivesCell={}))})(f.Plan||(f.Plan={}))})(e.Cells||(e.Cells=
{}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){e[e.RichText=0]="RichText";e[e.Theme=1]="Theme";e[e.Lesson=3]="Lesson";e[e.LessonDescription=4]="LessonDescription";e[e.Date=5]="Date";e[e.ClassHours=6]="ClassHours";e[e.LearningObjectives=7]="LearningObjectives";e[e.Resources=8]="Resources";e[e.Activities=9]="Activities";e[e.Term=10]="Term";e[e.Rubric=11]="Rubric";e[e.Elements=12]="Elements"})(e.ColumnType||(e.ColumnType={}));(function(e){e[e.Resource=0]="Resource";e[e.Activity=1]="Activity";e[e.LearningObjectiveAssessmentSupported=
2]="LearningObjectiveAssessmentSupported"})(e.ElementCategory||(e.ElementCategory={}));(function(e){e[e.TimeSpan=0]="TimeSpan";e[e.WeekAndDay=1]="WeekAndDay";e[e.Event=2]="Event"})(e.DatePickerMode||(e.DatePickerMode={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a){window[b]=this;d.instanceName=b;this.terms=a;this.planner=e.Planner.getInstance();this.courseId=this.planner.settings.CourseId;this.startDate=this.planner.settings.FilterStartDate;this.endDate=this.planner.settings.FilterEndDate;this.showPlanDates=this.planner.settings.ShowDates;this.useTopics=this.planner.settings.UseTopics;this.addingPlanInProgress=!1}d.getInstance=function(){return window[d.instanceName]};d.prototype.addPlan=function(b){var a=
this;if(!this.addingPlanInProgress){this.addingPlanInProgress=!0;this.planner.toggleEnableDisplayModeSwitcher(!1);var c=e.Cards.TopicCard.getInstance(b),d=c.getLastPlanId();d||(d=0);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.AddPlan,data:{courseId:this.courseId,topicId:b,start:this.startDate,end:this.endDate,insertAfterPlanId:d,showPlanDates:this.showPlanDates,currentDisplayMode:this.planner.currentDisplayMode},success:function(b){a.useTopics&&(c.getTopicExpanderLink().html(b.topicExpanderText),
c.hasPlans=b.hasPlans);c.appendNewPlan(b.planRow,b.planId);c.showPlanActionMenu();c.hidePlanMoveOptionsIfNecessary();a.planner.toggleEnableDisplayModeSwitcher(!0);a.addingPlanInProgress=!1},error:function(b,c,d){CCL.CommonFunctions.alertAjaxError(b,c,d);a.planner.toggleEnableDisplayModeSwitcher(!0);a.addingPlanInProgress=!1}})}};d.prototype.removePlan=function(b,a){this.removePlans(b,[a],!1)};d.prototype.removePlans=function(b,a,c){var d=this;void 0===a&&(a=null);void 0===c&&(c=!0);var f=e.Cards.TopicCard.getInstance(b);
c&&null==a&&(a=f.getSelectedPlanIds(!0));null!=a&&this.planner.showConfirmDialog(c?this.terms.DeletePlansConfirmation:this.terms.DeletePlanConfirmation,function(e){e&&CCL.CommonFunctions.safeAjaxPost({url:d.planner.webMethods.Plan.RemovePlans,traditional:!0,data:{courseId:d.courseId,topicId:b,planIds:a,updatePlanCount:d.useTopics,start:d.startDate,end:d.endDate,showPlanDates:d.showPlanDates,isBulkAction:c},success:function(b){d.useTopics&&(f.getTopicExpanderLink().html(b.topicExpanderText),f.hasPlans=
b.hasPlans);f.showPlanFeedbackMessage(CCL.FeedbackType.Information,b.restoreText);f.clearPlanSelection();f.removePlansFromGrid(a,b.emptyGridText);f.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError})},this.planner.terms.Delete,this.planner.terms.Cancel)};d.prototype.restorePlans=function(b,a){var c=this,d=e.Cards.TopicCard.getInstance(b);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.RestorePlans,traditional:!0,data:{courseId:this.courseId,topicId:b,planIds:a,
start:this.startDate,end:this.endDate,updatePlanCount:this.useTopics,showPlanDates:this.showPlanDates},success:function(a){c.useTopics&&(d.getTopicExpanderLink().html(a.topicExpanderText),d.hasPlans=a.hasPlans);d.refreshPlanGrid(function(){a.restoreText&&d.showPlanFeedbackMessage(CCL.FeedbackType.Information,a.restoreText)})},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.togglePlanStatus=function(b,a,c){this.togglePlansStatus(b,c,[a],!1)};d.prototype.togglePlansStatus=function(b,a,c,d){var f=
this;void 0===c&&(c=null);void 0===d&&(d=!0);var g=e.Cards.TopicCard.getInstance(b);d&&null==c&&(c=g.getSelectedPlanIds(!0));if(null!=c){var k=function(b){CCL.CommonFunctions.safeAjaxPost({url:f.planner.webMethods.Plan.TogglePlansStatus,traditional:!0,data:{courseId:f.courseId,planIds:c,activate:a,showPlanDates:f.showPlanDates,toggleElementsActivation:b,isBulkAction:d},success:function(b){1===c.length?g.showPlanFeedbackMessage(CCL.FeedbackType.Information,a?f.terms.PlanActivated:f.terms.PlanDeactivated):
g.showPlanFeedbackMessage(CCL.FeedbackType.Information,a?f.terms.PlansActivated:f.terms.PlansDeactivated);d&&g.clearPlanSelection();$.each(b,function(a,b){$(document).trigger(f.planner.events.PlanDateCellChange,{dateCellObject:b,planContainer:g.getPlanContainerById(b.planId)})})},error:CCL.CommonFunctions.alertAjaxError})};!a&&this.planner.settings.ActivateElementsByPlan&&g.containsPlanElements(c)?this.planner.showConfirmDialog(d?this.terms.PlansDeactivatedWithElementsWarning:this.terms.PlanDeactivatedWithElementsWarning,
function(a){k(a)}):k(!0)}};d.prototype.notifyAboutChanges=function(b){null!=b&&CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.NotifyAboutChanges,data:{courseId:this.courseId,planId:b},success:function(){},error:CCL.CommonFunctions.alertAjaxError})};d.prototype.movePlan=function(b,a,c){this.movePlans(b,c,[a])};d.prototype.movePlans=function(b,a,c){void 0===c&&(c=null);var d=e.Cards.TopicCard.getInstance(b);null==c&&(c=d.getSelectedPlanIds(!0));null!=c&&(c.length>=d.getPlanGrid().getRowsCount()||
CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.Plan.MovePlans,traditional:!0,data:{courseId:this.courseId,topicId:b,planIds:c,moveUp:a,start:this.startDate,end:this.endDate},success:function(a){d.sortPlans(a.sortedPlanIds);d.hidePlanMoveOptionsIfNecessary()},error:CCL.CommonFunctions.alertAjaxError}))};d.prototype.setPlanDates=function(b){var a=e.Cards.TopicCard.getInstance(b),c=a.getSelectedPlanIds(!0);null!=c&&this.planner.getSetDateDialog().open(c,function(b){a.updatePlanCellsCallback(b)},
function(){a.clearPlanSelection()},b)};d.prototype.sharePlans=function(b){var a=this,c=e.Cards.TopicCard.getInstance(b),d=c.getSelectedPlanIds(!0);null!=d&&CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.ShareablePlanner.CheckPlanDataForSharing,data:{courseId:this.courseId,planIds:d}}).done(function(b){b&&b.conflictMessage?CCL.CommonFunctions.jAjaxAlert(b.conflictMessage,a.planner.terms.Alert,a.planner.terms.Ok):b&&b.warningMessage?a.planner.showConfirmDialog(b.warningMessage,function(a){a&&
c.redirectToSharePlans(d)}):c.redirectToSharePlans(d)}).fail(CCL.CommonFunctions.alertAjaxError)};d.prototype.stopSharingPlan=function(b,a,c){var d=this,f=e.Cards.TopicCard.getInstance(a);CCL.CommonFunctions.safeAjaxPost({url:this.planner.webMethods.ShareablePlanner.StopSharingPlans,data:{courseId:this.courseId,planIds:[c]}}).done(function(){d.planner.settings.UseTopics&&f&&f.clearPlanSelection();$(b).parent().hide()}).fail(CCL.CommonFunctions.alertAjaxError)};return d}();e.PlanCommonLogic=f})(f.Planner||
(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(a){function b(b,c,d){var e=this;a.call(this,b,c);$(function(){e.columnsData=[];e.addColumnsToEdit(d)})}__extends(b,a);b.getInstance=function(){return window[d.PlannerInlineCellBase.clientInstanceName]};b.prototype.addColumnsToEdit=function(a){var c=this;$.each(a,function(a,d){c.columnsData[d.HybridEditorItemId]=d;(a=$("div["+e.PlannerConstants.dataAttributes.HybridEditorItem+"][id *= "+d.HybridEditorItemId+"]"))&&a.data(b.hybridEditorItemIdDataAttr,
d.HybridEditorItemId)})};b.prototype.getEditorItemSettings=function(b){return(b=this.columnsData[b])?a.prototype.getSettings.call(this,b):{}};b.prototype.measureKpiEditPlan=function(){e.Planner.getInstance().measureEditPlan()};b.prototype.getColumnData=function(a){return this.columnsData[a.data(b.hybridEditorItemIdDataAttr).toString()]};b.prototype.replaceMediaContentWithPlaceholders=function(){return e.Planner.getInstance().isTableCurrentMode()};return b}(d.PlannerInlineCellBase);d.PlannerInlineCell=
b})(f.InlineCell||(f.InlineCell={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){var d=function(){function b(a,b){var c=this;this.focusTitle=function(){c.$topicTitle.select()};window[a]=this;this.settings=b;this.planner=e.Planner.getInstance();this.$topicTitle=$("#"+this.settings.Controls.TopicTitleId);this.$errorMessage=$("#"+this.settings.Controls.ErrorMessageId);this.$saveButton=$("#"+this.settings.Controls.SaveButtonId);this.attachEventHandlers()}b.prototype.open=function(){var a=this,b=this.getDialog(),d=this.getColorPicker();this.clearForm();
CCL.CommonFunctions.safeAjaxPost({url:this.settings.WebMethods.GetRandomColorSchemeForNewTopic+"/"+this.planner.settings.CourseId}).done(function(a){d.setColor(a.topicColorSchema)}).fail(function(){d.setColor(a.settings.TopicDefaultColorSchema)});b.openDialog()};b.prototype.getColorPicker=function(){return window[this.settings.Controls.ColorPickerId]};b.prototype.attachEventHandlers=function(){var a=this;this.$saveButton.click(function(){return a.validateAndSave()});this.$topicTitle.keypress(function(b){return 13===
b.keyCode?(a.validateAndSave(),!1):!0})};b.prototype.clearForm=function(){this.$errorMessage.hide();this.$saveButton.toggleHyperlink(!0)};b.prototype.validateAndSave=function(){if(this.$saveButton.getIfHyperLinkEnabled()){var a=$.trim(this.$topicTitle.val());if(0<a.length){var b=this.getColorPicker().getSelectedColorKey();this.addTopic(a,b)}else this.$errorMessage.show()}};b.prototype.addTopic=function(a,b){var c=this;this.$saveButton.toggleHyperlink(!1);e.TopicCommonLogic.getInstance().addTopic(a,
b,CssModal.closeDialog,function(){c.$saveButton.toggleHyperlink(!0)})};b.prototype.getDialog=function(){return window[this.settings.TopicAddDialogInstance]};return b}();f.TopicAddDialog=d})(e.Dialogs||(e.Dialogs={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(){function a(b,d){window[b]=this;a.instanceName=b;this._settings=d;this._css=d.Css;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._currentColumnId=this._currentTopicId=0;this.attachEvents()}a.getTopicLearningObjectivesCellInstance=function(){return window[a.instanceName]};a.prototype.updateLearningObjectives=function(a){var b=this,c=this._currentTopicId,d=this._currentColumnId;CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.LearningObjective.AddTopicLearningObjectives,
data:{courseId:this._courseId,learningObjectiveIds:a,topicId:c,columnId:d}}).done(function(a){b.getLearningObjectivesListCell(c,d).html(a.contentHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.getLearningObjectivesListCell=function(a,b){return $("."+this._css.CardCell+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,a)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,b)).parent()};a.prototype.getLearningObjectiveIds=function(a,b,d){var c=this;a=a.find(""+
CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,b)+CCL.CommonFunctions.getDataSelector(this._planner.data.ColumnId,d)+CCL.CommonFunctions.getDataSelector(this._planner.data.LearningObjectiveId));var e=[];0<a.size()&&$.each(a,function(a,b){a=$(b);$.isNumeric(a.data(c._planner.data.LearningObjectiveId))&&e.push(parseInt(a.data(c._planner.data.LearningObjectiveId)))});return e};a.prototype.removeLearningObjective=function(a,b,d){var c=this;CCL.CommonFunctions.safeAjax({type:"DELETE",url:this._planner.webMethods.LearningObjective.RemoveTopicLearningObjective,
data:{courseId:this._courseId,topicId:a,learningObjectiveId:d,columnId:b}}).done(function(d){c.getLearningObjectivesListCell(a,b).html(d.contentHtml)}).fail(CCL.CommonFunctions.alertAjaxError)};a.prototype.attachEvents=function(){var a=this;this._planner.getContainer().on("click","."+this._css.AddLearningObjectives,function(b){a._currentTopicId=$(b.currentTarget).data(a._planner.data.TopicId);a._currentColumnId=$(b.currentTarget).data(a._planner.data.ColumnId);b=window[a._settings.LearningObjectiveSelector];
b.setSelectedIds(a.getLearningObjectiveIds(a.getLearningObjectivesListCell(a._currentTopicId,a._currentColumnId),a._currentTopicId,a._currentColumnId),!0);b.openDialog()});$(document).on("click","."+this._css.RemoveLearningObjective,function(b){b=$(b.currentTarget);a.removeLearningObjective(b.data(a._planner.data.TopicId),b.data(a._planner.data.ColumnId),b.data(a._planner.data.LearningObjectiveId))})};return a}();d.TopicLearningObjectivesCell=b})(f.Topic||(f.Topic={}))})(e.Cells||(e.Cells={}))})(f.Planner||
(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(f){(function(d){var b=function(){function a(b,d){window[b]=this;a.instanceName=b;this._settings=d;this._css=d.Css;this._terms=d.Terms;this._planner=e.Planner.getInstance();this._courseId=this._planner.settings.CourseId;this._contextDialog=new ContextDialog($("#"+d.TermEditorId),{title:this._terms.TermContextDialogTitle,footerContent:d.TermEditorFooterId,setFocus:!1,width:"auto",zIndex:1});$.each($("."+this._css.TermRadioButton),function(a,b){$(b).find(":radio").attr("name",
"TermGroup")});this.attachEvents()}a.getTopicTermCellInstance=function(){return window[a.instanceName]};a.prototype.editTerm=function(a,b,d,e){this._currentTopicId=d;this._activeContainer=b.parent();this._contextDialog.openDialog(a);null!=e?$("."+this._css.TermRadioButton+CCL.CommonFunctions.getDataSelector(this._planner.data.CourseTermId,e)).find(":radio").attr("checked","checked").focus():($("."+this._css.TermRadioButton).find(":radio:checked").removeAttr("checked").blur(),$("."+this._css.TermRadioButton+
":first").find(":radio").focus())};a.prototype.attachEvents=function(){var a=this;this._contextDialog.setBeforeCloseDialog(function(){a.beforeCloseClontextDialog()});this._planner.getContainer().on("click","."+this._css.EditTermLink,function(b){var c=$(b.currentTarget),d=c.data(a._planner.data.TopicId),e=c.data(a._planner.data.CourseTermId);!a._contextDialog.mainContainer.is(":visible")&&0<d&&a.editTerm(b,c,d,e)});$("#"+this._settings.SaveTermButtonId).on("click",function(){a._contextDialog.closeDialog()});
$("#"+this._settings.ClearTermLinkId).on("click",function(){$("."+a._css.TermRadioButton).find(":radio:checked").removeAttr("checked")})};a.prototype.beforeCloseClontextDialog=function(){var a=this,b=$("."+this._css.EditTermLink+CCL.CommonFunctions.getDataSelector(this._planner.data.TopicId,this._currentTopicId)).data(this._planner.data.CourseTermId),d=$("."+this._css.TermRadioButton).has(":radio:checked").data(this._planner.data.CourseTermId);b!==d&&CCL.CommonFunctions.safeAjaxPost({url:this._planner.webMethods.TopicTerm.UpdateTopicTerm,
data:{courseId:this._courseId,topicId:this._currentTopicId,courseTermId:void 0!==d?d:0,start:this._planner.settings.FilterStartDate,stop:this._planner.settings.FilterEndDate}}).done(function(b){if(b){a._activeContainer.replaceWith(b.termCell);$(document).trigger(a._planner.events.PlanDateCellsChanged,{dateCellObjects:b.dateCells});var c=e.Cards.TopicCard.getInstance(a._currentTopicId);c&&c.setTermDates(a._planner.parseDateFromString(b.termStartDate),a._planner.parseDateFromString(b.termStopDate))}})};
return a}();d.TopicTermCell=b})(f.Topic||(f.Topic={}))})(e.Cells||(e.Cells={}))})(f.Planner||(f.Planner={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){e.mentorFeedbackOverviewInstance=this;this.context=b;this.$window=$(window);this.setMentorFeedbackSelectorAction();this.setCompleteButtonAction();this.setUndoButtonAction();this.context.Settings.IsToolbarButtonsAvailable?(this.setfeedbackSetupAction(),this.setMultipleAssessAction()):(window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+this.context.Controls.FeedbackSetupButtonId)),window[this.context.Controls.PersonGrid].disableToolbarItem($("#"+
this.context.Controls.AssessMultipleButtonId)));b=$("."+this.context.CssClasses.HybridEditorItemCss);this.bindToEditorItemEvents(b);window[this.context.Controls.PersonGrid].toggleSelectAll(!1)}d.prototype.onSetFeedbackColumnValueError=function(b,a){a=a.xhrObject.status;CCL.CommonFunctions.jAlertAjaxError(409===a?this.context.LanguageTerms.AlertMessage:this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,409===a);b.stopPropagation()};d.prototype.bindToEditorItemEvents=
function(b){var a=this;b.on(this.context.Events.HybridEditorItemAjaxError,function(b,d){a.onSetFeedbackColumnValueError(b,d)}).on(this.context.Events.HybridEditorItemSaveError,function(b,d){a.onSetFeedbackColumnValueError(b,d)})};d.prototype.checkLogAvailability=function(b){var a=window[e.mentorFeedbackOverviewInstance.context.Controls.PersonGrid].getRowById(b);a=$("."+e.mentorFeedbackOverviewInstance.context.CssClasses.MentorFeedbackSelectorCss,a).attr(e.mentorFeedbackOverviewInstance.context.Settings.MentorFeedbackIdAttribute);
e.mentorFeedbackOverviewInstance.safeAjaxPostHandler(e.mentorFeedbackOverviewInstance.context.WebMethods.LogAvailability,{mentorFeedbackId:a},function(a){e.mentorFeedbackOverviewInstance.toggleLogLink(a.available,b)})};d.prototype.setfeedbackSetupAction=function(){var b=this;$("#"+this.context.Controls.FeedbackSetupButtonId).click(function(){return b.isAnyStudentSelected(function(a){for(var c,d="",e=0;e<a.length;e++){var f=b.getLearnerMentorFeedbackId(a[e]);if(0===e)c=f;else if(c!==f){d=b.context.LanguageTerms.DifferentMfConfirmation;
break}}var k=b.context.Urls.FeedbackSetupDialogUrl+"&"+b.context.Settings.PersonIdAttribute+"="+a.join(",");""!==d?jConfirm(d,b.context.LanguageTerms.PleaseConfirm,function(a){a&&b.openDialog(k,b.context.Controls.FeedbackSetupDialog)}):b.openDialog(k,b.context.Controls.FeedbackSetupDialog)})})};d.prototype.setMultipleAssessAction=function(){var b=this;$("#"+this.context.Controls.AssessMultipleButtonId).click(function(){return b.isAnyStudentSelected(function(a){for(var c=0,d=b.context.LanguageTerms.WarningNoMfSelected,
e=0;e<a.length;e++){var f=b.getLearnerMentorFeedbackId(a[e]);if(0!==f){if(0!==c&&c!==f){d=b.context.LanguageTerms.WarningDifferentMfSelected;break}c=f;d=""}}""!==d?jAlert(d,b.context.LanguageTerms.AlertTitle,null):(a=b.context.Urls.AssessMultipleDialogUrl+"&"+b.context.Settings.TermAssessmentAttributeId+"="+c+"&"+b.context.Settings.PersonIdAttribute+"="+a.join(","),b.openDialog(a,b.context.Controls.AssesMultipleDialog))})})};d.prototype.openDialog=function(b,a){window[a].setIframeUrl(b);window[a].openDialog()};
d.prototype.isAnyStudentSelected=function(b){var a=window[this.context.Controls.PersonGrid].getSelectedValues();0===a.length?jAlert(this.context.LanguageTerms.AlertNoPersonSelected,this.context.LanguageTerms.AlertTitle,null):b(a)};d.prototype.getLearnerMentorFeedbackId=function(b){return+$("select["+this.context.Settings.LearnerIdAttribute+"='"+b+"']").val()};d.prototype.setCompleteButtonAction=function(){var b=this;$("#"+this.context.Controls.CompleteTermButtonId).click(function(){jConfirm(b.context.LanguageTerms.CompleteTermWarning,
b.context.LanguageTerms.PleaseConfirm,function(a){a&&b.safeAjaxPostHandler(b.context.WebMethods.CompleteTerm,{organizationId:b.context.Settings.OrganizationId,termId:b.context.Settings.TermId},function(){$("#"+b.context.Controls.CompleteContainer).hide();$("#"+b.context.Controls.UndoContainer).show()})})})};d.prototype.setUndoButtonAction=function(){var b=this;$("#"+this.context.Controls.UndoCompleteTermButtonId).click(function(){b.safeAjaxPostHandler(b.context.WebMethods.UndoCompleteTerm,{organizationId:b.context.Settings.OrganizationId,
termId:b.context.Settings.TermId},function(){$("#"+b.context.Controls.UndoContainer).hide();$("#"+b.context.Controls.CompleteContainer).show()})})};d.prototype.ajaxHandler=function(b,a,c){var d=this;this.errorRised=!1;$.ajax({type:"POST",url:b,dataType:"json",data:a,success:c,error:function(a){return d.ajaxErrorHandler(a)}})};d.prototype.safeAjaxPostHandler=function(b,a,c){var d=this;this.errorRised=!1;CCL.CommonFunctions.safeAjaxPost({url:b,dataType:"json",data:a,success:c,error:function(a){return d.ajaxErrorHandler(a)}})};
d.prototype.ajaxErrorHandler=function(b){this.errorRised||(this.errorRised=!0,409===b.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertMessage,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,!0):0===b.status?CCL.CommonFunctions.jAlertAjaxError(this.context.LanguageTerms.AlertStoringProblem,this.context.LanguageTerms.AlertTitle,this.context.LanguageTerms.Ok,!1):CCL.CommonFunctions.alertAjaxError(b,null,null))};d.prototype.setMentorFeedbackSelectorAction=
function(){var b=this;$("."+this.context.CssClasses.MentorFeedbackSelectorCss).focus(function(a){return b.feedbackSetupPreviousValue=$(a.target).val()}).change(function(a){var c=$(a.target).attr(b.context.Settings.LearnerIdAttribute);$.getJSON(b.context.WebMethods.IsMentorFeedbackValuesExist,{learnerId:c,organisationId:b.context.Settings.OrganizationId,hierarchyId:b.context.Settings.HierarchyId,termId:b.context.Settings.TermId},function(c){c.result?jConfirm(b.context.LanguageTerms.ChangeFeedbackSetupWarning,
b.context.LanguageTerms.PleaseConfirm,function(c){c?b.changeMentorSetup(a):$(a.target).val(b.feedbackSetupPreviousValue)}):b.changeMentorSetup(a)})})};d.prototype.changeMentorSetup=function(b){var a=this,c=$(b.target),d=c.attr(this.context.Settings.LearnerIdAttribute),e=$("."+d),f=c.val();this.toggleLogLink(!1,d);if(f===this.context.Settings.DefaultMentorFeedbackSelectorValue)b=c.attr(this.context.Settings.MentorFeedbackIdAttribute),this.safeAjaxPostHandler(this.context.WebMethods.RemoveFeedbackSetup,
{mentorFeedbackId:b,learnerId:d,organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId},function(){e.addClass(a.context.CssClasses.HiddenCss);$("."+a.context.CssClasses.CommentLabelCss,e).text("");for(var b=$("."+a.context.CssClasses.HybridEditorItemCss,e),d=0;d<b.length;d++){var f=$(b[d]);f.hybridEditorItem().hybridEditorItem("resetValue");f.hybridEditorItem().hybridEditorItem("setToolTip","");var g=f.hybridEditorItem().hybridEditorItem("option","webMethodParams");
g.mentorFeedbackId="";g.columnId="";f.hybridEditorItem().hybridEditorItem("option","webMethodParams",g)}$("."+a.context.CssClasses.CommentPanelCss,e).addClass(a.context.CssClasses.HiddenCss);c.attr(a.context.Settings.MentorFeedbackIdAttribute,"")});else{var k=c.attr(this.context.Settings.LearnerNameAttribute);this.safeAjaxPostHandler(this.context.WebMethods.SetFeedbackSetup,{organisationId:this.context.Settings.OrganizationId,hierarchyId:this.context.Settings.HierarchyId,learnerId:d,termAssessmentId:f},
function(b){c.attr(a.context.Settings.MentorFeedbackIdAttribute,b.mentorFeedbackId);e.removeClass(a.context.CssClasses.HiddenCss);var g=a.context.TermAssessmentCustomColumns[f],h=$("."+a.context.CssClasses.CommentLabelCss,e),m=$("."+a.context.CssClasses.HybridEditorItemCss,e),l=$("."+a.context.CssClasses.CommentPanelCss,e);a.setUrlToLogLink(b.mentorFeedbackId,d);for(var q,t,v=0;v<g.length;v++)$(h[v]).text(g[v].Name),t=$(m[v]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",
g[v].ToolTip+" "+k),q=t.hybridEditorItem().hybridEditorItem("option","webMethodParams"),q.mentorFeedbackId=b.mentorFeedbackId,q.columnId=String(g[v].CustomColumnId),t.hybridEditorItem().hybridEditorItem("option","webMethodParams",q),$(l[v]).removeClass(a.context.CssClasses.HiddenCss);if(g.length<h.length)for(b=h.length,g=g.length;g<b;g++)$(h[g]).text(""),t=$(m[g]),t.hybridEditorItem().hybridEditorItem("resetValue"),t.hybridEditorItem().hybridEditorItem("setToolTip",""),q=t.hybridEditorItem().hybridEditorItem("option",
"webMethodParams"),q.mentorFeedbackId="",q.columnId="",t.hybridEditorItem().hybridEditorItem("option","webMethodParams",q),$(l[g]).addClass(a.context.CssClasses.HiddenCss)})}};d.prototype.setUrlToLogLink=function(b,a){var c=window[this.context.Controls.PersonGrid].getRowById(a);$("."+this.context.CssClasses.LogLinkCss,c).attr("href",this.context.Urls.LogLink+"?"+this.context.Settings.PersonIdAttribute+"="+a+"&"+this.context.Settings.SupervisorTypeRequestItem+"="+this.context.Settings.SupervisorType+
"&"+this.context.Settings.MentorFeedbackIdRequestItem+"="+b)};d.prototype.toggleLogLink=function(b,a){var c=window[this.context.Controls.PersonGrid].getRowById(a);a=$("."+this.context.CssClasses.LogLinkCss,c);c=$("."+this.context.CssClasses.NoLogLabelCss,c);b?(a.removeClass(this.context.CssClasses.HiddenCss),c.addClass(this.context.CssClasses.HiddenCss)):(a.addClass(this.context.CssClasses.HiddenCss),c.removeClass(this.context.CssClasses.HiddenCss))};return d}();e.MentorFeedbackOverview=f})(f.Mentor||
(f.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b){e.mentorFeedbackAssessMultipleInstance=this;this.context=b;this.window=$(window);this.setOkClickEvent()}d.prototype.setOkClickEvent=function(){var b=this;$("#"+this.context.Settings.OkClientId).click(function(){for(var a="",c=$('[id*="CustomColumnValue"]'),d=0;d<c.length;d++){var e=$(c[d]);e.val().trim()&&(e=e.attr("data-cc-id"),-1<b.context.Settings.FilledCustomColumns.indexOf(e)&&(a=b.context.Settings.TermCommentWarning))}""!==a?jConfirm(a,
b.context.Settings.TermPleaseConfirm,function(a){a&&b.context.Functions.OkPostbackScript()}):b.context.Functions.OkPostbackScript()})};return d}();e.MentorFeedbackAssessMultiple=f})(f.Mentor||(f.Mentor={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(b){b[b.Expanded=1]="Expanded";b[b.Collapsed=2]="Collapsed";b[b.Loading=3]="Loading"})(e.FolderExpandState||(e.FolderExpandState={}));var k=e.FolderExpandState,d=function(){function b(a,b,d){var c=this;this.settings=b;this.controls=d;this.inputTypeCheckboxSelector="input:checkbox";this.stateChangedHandler=function(a){var b=$(a.target);a=c.closestItem(b);b=c.updateItemState(a,b.is(":checked"));a.find(c.inputTypeCheckboxSelector).first().focus();c.controls.Container.trigger(c.settings.StateChangedEventName,
b)};window[a]=this;this.checkboxStateMachine=new f.CheckboxStateMachine.Machine;this.setupListItemFocusedAreaClickHandler()}Object.defineProperty(b.prototype,"itemSelector",{get:function(){return CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.ItemId)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"listItemFocusedAreaSelector",{get:function(){return"."+this.settings.CssClasses.ListItemFocusedArea},enumerable:!0,configurable:!0});b.prototype.init=function(a){this.initParameters=
a};b.prototype.expandFolder=function(a){var b=this,d=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=d.data(this.settings.DataAttributes.FolderActionExpand),f=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();e?this.setFolderState(f,d,k.Expanded):(this.setFolderState(f,d,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){f.append(a);b.setFolderState(f,d,k.Expanded);
b.onFolderContentLoaded()}))};b.prototype.onFolderContentLoaded=function(){var a=this;this.initParameters.itemStates.forEach(function(b,d){a.checkboxStateMachine.isElementChecked(b)&&(b=a.getCheckbox(d))&&0<b.length&&b.prop("checked",!0)});this.initParameters.disabledItemIds&&this.initParameters.disabledItemIds.forEach(function(b){(b=a.getCheckbox(b))&&b.prop("disabled",!0)})};b.prototype.countItemsChanged=function(){return f.MapUtils.reduce(this.initParameters.itemStates,function(a,b,d){return d===
f.CheckboxStateMachine.State.AttachedByUser||d===f.CheckboxStateMachine.State.DetachedByUser?a+1:a},0)};b.prototype.countCheckedItems=function(){var a=this;return f.MapUtils.reduce(this.initParameters.itemStates,function(b,d,e){return a.checkboxStateMachine.isElementChecked(e)?b+1:b},0)};b.prototype.setupListItemFocusedAreaClickHandler=function(){var a=this;this.controls.Container.on((b={},b.change=this.stateChangedHandler,b),this.inputTypeCheckboxSelector);this.controls.Container.on("click",this.listItemFocusedAreaSelector,
function(b){b=$(b.target);var c=a.closestItem(b);a.isClickTargetEnabled(b,c)&&(a.targetIsFolderActionExpand(b)?a.expandOrCollapseFolder(c):a.isListItemFocusedArea(b)&&(b=a.getCheckbox(a.getItemId(c)),b.prop("checked",!b.is(":checked")).change()))});this.controls.Container.on("keyup",this.listItemFocusedAreaSelector,function(b){b.which===CCL.CommonConstants.keyCodes.space&&(b=$(b.target),a.targetIsFolderActionExpand(b)&&a.expandOrCollapseFolder(a.closestItem(b)))});var b};b.prototype.isClickTargetEnabled=
function(a,b){return 0>=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length||this.initParameters.allowFolderSelection&&this.isCheckboxExistAndEnabled(b)};b.prototype.targetIsFolderActionExpand=function(a){return a.is(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand))||0<a.closest(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).length};b.prototype.updateItemState=function(a,b){a=
this.getItemId(a);var c=this.initParameters.itemStates.get(a)||f.CheckboxStateMachine.State.Empty;b=this.checkboxStateMachine.validateAndTransferElementStateAfterClick(b,c);this.initParameters.itemStates.set(a,b);return this.countCheckedItems()};b.prototype.expandOrCollapseFolder=function(a){var b=this,d=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderActionExpand)).first(),e=d.data(this.settings.DataAttributes.FolderActionExpand),f=a.find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderAppendTarget)).first();
e?e===k.Expanded?this.setFolderState(f,d,k.Collapsed):e===k.Collapsed&&this.setFolderState(f,d,k.Expanded):(this.setFolderState(f,d,k.Loading),a={folderId:this.getItemId(a)},this.getFolderContent(a).done(function(a){f.append(a);b.setFolderState(f,d,k.Expanded);b.onFolderContentLoaded()}))};b.prototype.isCheckboxExistAndEnabled=function(a){return(a=this.getCheckbox(this.getItemId(a)))&&0<a.length&&a.is(":enabled")};b.prototype.setFolderState=function(a,b,d){a.toggle(d===k.Expanded);this.closestListItemFocusedArea(b).find(CCL.CommonFunctions.getDataSelector(this.settings.DataAttributes.FolderTitle)).toggleClass(this.settings.CssClasses.FontBold,
d===k.Expanded);b.data(this.settings.DataAttributes.FolderActionExpand,d);a=b.find("."+this.settings.CssClasses.FolderStateExpanded+",."+this.settings.CssClasses.FolderStateCollapsed);a.toggleClass(this.settings.CssClasses.FolderStateCollapsed,d!==k.Expanded);a.toggleClass(this.settings.CssClasses.FolderStateExpanded,d===k.Expanded)};b.prototype.isClosestLabel=function(a){return 0<a.closest("label").length};b.prototype.getFolderContent=function(a){return $.ajax({type:"GET",url:this.settings.Urls.FolderContent,
data:a,dataType:"html"})};b.prototype.isListItemFocusedArea=function(a){return a.is(this.listItemFocusedAreaSelector)};b.prototype.closestListItemFocusedArea=function(a){return a.closest(this.listItemFocusedAreaSelector)};b.prototype.closestItem=function(a){return a.closest(this.itemSelector)};b.prototype.getItemId=function(a){return a.data(this.settings.DataAttributes.ItemId)};b.prototype.getCheckbox=function(a){return $("#"+this.controls.CheckboxItemPrefix+a)};return b}();e.TreeViewSelector=d})(f.TreeViewSelector||
(f.TreeViewSelector={}))})(ItslearningWeb||(ItslearningWeb={}));(function(f){(function(e){e.getFormDataWithAttachedFilesAndFileSizes=function(e){e=e.files;var d=[];if(0<e.length&&FormData){for(var b=new FormData,a=0;a<e.length;a++)0<e[a].size&&(b.append("file"+a,e[a]),d.push(e[a].size));return{formData:b,fileSizes:d}}}})(f.UploadFileHelper||(f.UploadFileHelper={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){return function(){this.timeout=500}}();e.IframeLoadingIndicatorSettings=f;f=function(){function d(b){var a=this;this.settings=b;this.showAfterDelay=!0;this.loadingIndicator=$("#"+this.settings.loadingIndicatorClientId);$(window).load(function(){$("#"+a.settings.iframeClientId).ready(function(){a.hideIndicator()})});$(document).on("cssmodal:show",function(){a.hideIndicator()});setTimeout(function(){a.showAfterDelay&&a.loadingIndicator.show()},this.settings.timeout)}
d.prototype.hideIndicator=function(){if(null!=this.settings.onHideCallback)this.settings.onHideCallback();this.showAfterDelay=!1;this.loadingIndicator.hide()};return d}();e.IframeLoadingIndicator=f})(f.ViewLearningToolElement||(f.ViewLearningToolElement={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){(function(e){var d=function(){function b(){var a=this;this.featureDialogMap={};this.antiForgerySettings={};this.dispatch=function(b){switch(b.type){case CCL.Onboarding.Extensions.MessageType.CompleteFeature:a.completeFeatures(b.features);break;case CCL.Onboarding.Extensions.MessageType.TriggerOnboardingFeature:a.triggerFeature(b.featureId);break;case CCL.Onboarding.Extensions.MessageType.HideOverlay:a.hideOverlay();break;case CCL.Onboarding.Extensions.MessageType.ShowOverlay:a.showOverlay();
break;case CCL.Onboarding.Extensions.MessageType.RequestFeatureState:a.requestFeatureState(b.featureId).done(function(c,d,e){d=a.extensionIframe.get(0).contentWindow;e=new CCL.CommonWindowMessages.GenericMessage(CCL.CommonWindowMessages.MessageNames.extensionOnboarding);var f={featureId:b.featureId,type:CCL.Onboarding.Extensions.MessageType.ReceiveFeatureState};$.extend(f,c);CCL.CommonFunctions.makePostMessageCallWithData(d,e,f)})}};this.triggerFeature=function(b){b&&a.requestFeatureState(b).done(function(c,
d,e){c.IsCompleted?a.triggerFeature(a.featureDialogMap[b].nextFeatureId):(c=window[a.featureDialogMap[b].dialogClientId],c.blockHighlightZone=!0,c.openDialog(function(c){c?a.completeFeatures([a.featureDialogMap[b].featuresForComplete]):a.triggerFeature(a.featureDialogMap[b].nextFeatureId)}))})};this.completeFeatures=function(b){for(var c=0;c<b.length;c++){var d=b[c];d&&CCL.CommonFunctions.safeAjax({url:a.onboardingServiceUrl.replace("{featureId}",d),type:"PUT",headers:(e={},e[a.antiForgerySettings.headerName]=
a.antiForgerySettings.headerValue,e)})}var e}}b.prototype.init=function(a,b,d){this.pageOptions=d;this.onboardingServiceUrl=a;this.extensionIframe=b;this.antiForgerySettings=this.pageOptions.antiForgerySettings;this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentLearningToolOptions]={dialogClientId:d.optionsOnboradingClientId,nextFeatureId:CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders,featuresForComplete:[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]};
this.featureDialogMap[CCL.Onboarding.Extensions.OnboardingFeatures.AssignmentReminders]={dialogClientId:d.pageFunctionsClientId};CCL.CommonFunctions.attachPostMessageEventListener($(window),CCL.CommonWindowMessages.MessageNames.extensionOnboarding,this.dispatch)};b.prototype.showOverlay=function(){this.extensionIframe.css("position","relative");this.extensionIframe.css("z-index","1000");$("<div></div>").appendTo(document.body).addClass(this.pageOptions.cssClasses.onboardingDialogMask).css({opacity:"0",
filter:"alpha(opacity=0)","z-index":997}).fadeTo(0,1)};b.prototype.hideOverlay=function(){this.extensionIframe.css("position","");this.extensionIframe.css("z-index","");$("."+this.pageOptions.cssClasses.onboardingDialogMask).remove()};b.prototype.requestFeatureState=function(a){return $.ajax({url:this.onboardingServiceUrl.replace("{featureId}",a),type:"GET"})};return b}();e.PostMessageDispatcher=d})(e.ViewLearningToolElement||(e.ViewLearningToolElement={}))})(f.Onboarding||(f.Onboarding={}))})(ItslearningWeb||
(ItslearningWeb={}));
(function(f){var e;(function(d){d[d.Stopped=0]="Stopped";d[d.RecordingStarted=1]="RecordingStarted";d[d.PreviewSeeked=2]="PreviewSeeked";d[d.PreviewStarted=3]="PreviewStarted";d[d.PreviewPaused=4]="PreviewPaused";d[d.Closing=5]="Closing"})(e||(e={}));var k=function(){function d(b,a){this.wasInterrupted=!1;this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=this.recordingChromeStartTimeMs=this.recordingVideoPreInterval=this.currentRecordDuration=0;
window[b]=this;this.settings=a;this.eventNames=a.EventNames;this.initialize()}d.prototype.initialize=function(){var b=this;this.settings.IsVideo?(this.video=document.getElementById(this.settings.VideoId),this.video.muted=!0,this.video.onended=function(){b.onPlaybackEnded()},window.isChrome&&(this.audio=document.getElementById(this.settings.AudioId),this.audio.muted=!0),this.constraints={audio:!0,video:{mandatory:{maxWidth:this.video.clientWidth,maxHeight:this.video.clientHeight,minWidth:this.video.clientWidth,
minHeight:this.video.clientHeight}}},this.settings.RequestMediaResourcesOnLoad&&this.showVideoFrame()):(this.audio=document.getElementById(this.settings.AudioId),this.audio.muted=!0,this.audio.onended=function(){b.onPlaybackEnded()},this.constraints={audio:!0,video:!1},this.settings.RequestMediaResourcesOnLoad&&!this.audioStream&&navigator.getUserMedia(this.constraints,function(a){window.isChrome&&(a=new window.MediaStream(a.getAudioTracks()));b.audioStream=a},function(){b.showAlert(b.settings.AccessDeniedErrorMessage)}));
this.currentState=e.Stopped};d.prototype.startRecording=function(){var b=this;this.settings.IsVideo?(this.video.onended=function(){b.onPlaybackEnded()},this.startRecordingVideo()):(this.audio.onended=function(){b.onPlaybackEnded()},this.startRecordingAudio());this.currentState=e.RecordingStarted};d.prototype.stopRecording=function(){this.settings.IsVideo?this.stopRecordingVideo():this.stopRecordingAudio()};d.prototype.getCurrentTime=function(){return this.currentState===e.Stopped?0:window.isChrome?
this.getChromeCurrentTime():this.settings.IsVideo?this.video.currentTime-this.recordingVideoPreInterval:this.audio.currentTime};d.prototype.getChromeCurrentTime=function(){return this.settings.IsVideo?this.video.currentTime-this.recordingVideoPreInterval:(this.currentState===e.RecordingStarted?(new Date).getTime()-this.recordingChromeStartTimeMs:this.currentState===e.PreviewPaused?this.previewChromeAudioPauseTimeMs-this.previewChromeAudioStartTimeMs-this.previewChromeAudioPauseIntervalMs:(new Date).getTime()-
this.previewChromeAudioStartTimeMs-this.previewChromeAudioPauseIntervalMs)/1E3};d.prototype.getDuration=function(){return this.currentRecordDuration};d.prototype.preparePreview=function(){this.settings.IsVideo?this.prepareVideoPreview():this.prepareAudioPreview()};d.prototype.prepareVideoPreview=function(){var b=this;window.isChrome&&this.audioUrl&&(this.audio.pause(),this.audio.currentTime=0,this.audio.src=this.audioUrl,this.audio.load());$(this.video).one("loadeddata",function(){b.video.duration&&
Infinity!==b.video.duration&&(b.currentRecordDuration=b.video.duration);b.recordingVideoPreInterval=0;$(document).trigger(b.eventNames.PreviewPreparedEventName)});$(this.video).one("error",function(){0===b.getCurrentTime()&&$(document).trigger(b.eventNames.PreviewPreparedFailedEventName)});this.video.src=this.videoUrl;this.video.load()};d.prototype.prepareAudioPreview=function(){var b=this;$(this.audio).one("loadeddata",function(){b.audio.duration&&Infinity!==b.audio.duration&&(b.currentRecordDuration=
b.audio.duration);$(document).trigger(b.eventNames.PreviewPreparedEventName)});this.audio.src=this.audioUrl;this.audio.load()};d.prototype.previewRecord=function(){this.currentState!==e.PreviewSeeked&&this.reloadPlayer();this.settings.IsVideo?(this.video.muted=!1,window.isChrome&&this.audioUrl&&(this.audio.muted=!1,this.audio.play()),this.video.play()):(this.audio.muted=!1,this.audio.play(),0===this.previewChromeAudioStartTimeMs&&(this.previewChromeAudioStartTimeMs=(new Date).getTime()));this.currentState=
e.PreviewStarted};d.prototype.reloadPlayer=function(){this.settings.IsVideo?this.supportsSeek()?this.seek(0):(this.video.load(),window.isChrome&&this.audioUrl&&this.audio.load()):this.supportsSeek()?this.seek(0):this.audio.load()};d.prototype.pauseResumePreview=function(b){this.settings.IsVideo?this.pauseResumeRecordingVideo(b):this.pauseResumePreviewAudio(b);this.currentState=b?e.PreviewPaused:e.PreviewStarted};d.prototype.pauseResumeRecordingVideo=function(b){b?(this.video.pause(),window.isChrome&&
this.audioUrl&&this.audio.pause()):(this.video.play(),window.isChrome&&this.audio.play())};d.prototype.pauseResumePreviewAudio=function(b){b?(this.audio.pause(),this.previewChromeAudioPauseTimeMs=(new Date).getTime()):(this.audio.play(),this.previewChromeAudioPauseIntervalMs+=(new Date).getTime()-this.previewChromeAudioPauseTimeMs)};d.prototype.deleteRecord=function(){this.settings.IsVideo?(window.isChrome&&this.audioUrl&&(this.audio.pause(),this.audio.src="",this.audio.muted=!0,this.audio.load()),
this.video.onended=null,this.video.pause(),this.video.muted=!0,this.video.src="",this.video.load(),this.showVideoFrame()):(this.audio.onended=null,this.audio.pause(),this.audio.muted=!0,this.audio.src="",this.audio.load());this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=this.recordingChromeStartTimeMs=this.recordingVideoPreInterval=this.currentRecordDuration=0;this.currentState=e.Stopped};d.prototype.closeRecordingSession=function(){var b=
this.currentState;this.currentState=e.Closing;b===e.RecordingStarted&&this.stopRecording();this.video&&this.video.pause();this.audio&&this.audio.pause();window.isChrome?(this.videoStream&&(0<this.videoStream.getVideoTracks().length&&this.videoStream.getVideoTracks()[0].stop(),0<this.videoStream.getAudioTracks().length&&this.videoStream.getAudioTracks()[0].stop()),this.audioStream&&0<this.audioStream.getAudioTracks().length&&this.audioStream.getAudioTracks()[0].stop()):(this.audioStream&&this.audioStream.stop(),
this.videoStream&&this.videoStream.stop());this.wasInterrupted&&(this.audioStream=this.videoStream=null,this.wasInterrupted=!1);this.currentState=e.Stopped};d.prototype.uploadRecord=function(b,a){try{a={Name:a};a.IsVideo=this.settings.IsVideo;var c=new FormData;if(window.isChrome&&this.settings.IsVideo&&this.audioUrl){var d=this.recorderAudio.getBlob(),e=this.recorderVideo.getBlob();c.append("file",d,"audio.wav");c.append("file",e,"video.webm");a.Type="WebRtcChrome";a.MimeType=d.type+","+e.type}else{var f=
this.settings.IsVideo?this.recorderVideo.getBlob():this.recorderAudio.getBlob();c.append("file",f,this.settings.IsVideo?"video.webm":window.isChrome?"audio.wav":"audio.ogg");a.Type="WebRtc";a.MimeType=f.type}b=0<b.indexOf("?")?b+"&"+$.param(a):b+"?"+$.param(a);var k=this;$.ajax(b,{type:"POST",contentType:!1,processData:!1,async:!0,data:c,dataType:"json",timeout:36E5,success:function(a){try{"none"===a.data.ErrorCode.toLowerCase()?$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,[a.data.FileName,
""]):$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",a.data.ErrorCode])}catch(n){$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",""])}},error:function(){$(document).trigger(k.eventNames.RecordingUploadCompletedEventName,["",""])}})}catch(q){$(document).trigger(this.eventNames.RecordingUploadCompletedEventName,["",""])}};d.prototype.seek=function(b){this.settings.IsVideo?(this.video.currentTime=b,window.isChrome&&this.audioUrl&&(this.audio.currentTime=
b)):(this.audio.currentTime=b,window.isChrome&&(this.previewChromeAudioStartTimeMs=this.currentState===e.PreviewPaused?this.previewChromeAudioPauseTimeMs-1E3*b:(new Date).getTime()-1E3*b,this.previewChromeAudioPauseIntervalMs=0));this.currentState===e.Stopped&&(this.currentState=e.PreviewSeeked)};d.prototype.supportsSeek=function(){var b=this.settings.IsVideo?this.video:this.audio;return b&&0<b.seekable.length};d.prototype.showVideoFrame=function(b){var a=this;void 0===b&&(b=!1);if(this.videoStream){if(this.isVideoAvailable(this.videoStream)&&
(this.video.src=URL.createObjectURL(this.videoStream),this.video.load(),this.video.play(),b))this.onUserMediaVideo(this,this.videoStream)}else{var c=this;navigator.getUserMedia(this.constraints,function(c){if(a.isVideoAvailable(c)&&(a.videoStream=c,a.video.src=URL.createObjectURL(a.videoStream),a.video.load(),a.video.play(),b))a.onUserMediaVideo(a,a.videoStream)},function(){c.showAlert(c.settings.AccessDeniedErrorMessage)})}};d.prototype.isVideoAvailable=function(b){var a=this;return 0===b.getVideoTracks().length?
(this.showConfirmAudioSwitch(this.settings.ChangeToAudioRecorderMessage,function(c){c?(a.video.style.display="none",a.settings.IsVideo=!1,a.audioStream=window.isChrome?new window.MediaStream(b.getAudioTracks()):b,a.initialize(),$(document).trigger(a.eventNames.SwitchToAudioRecorderEventName)):(a.closeRecordingSession(),$(document).trigger(a.eventNames.SwitchToUploadTabEventName))}),!1):!0};d.prototype.showConfirmAudioSwitch=function(b,a){var c=this.settings.UploadFileButtonText.replace(/(["])/g,"&quot;");
window.top.jConfirm?(window.top.$.alerts.cancelButton=c,window.top.jConfirm(b,"",a)):($.alerts.cancelButton=c,jConfirm(b,"",a))};d.prototype.onPlaybackEnded=function(){this.isPreview()?this.currentState!==e.Closing&&(this.currentState=e.Stopped,this.previewChromeAudioPauseIntervalMs=this.previewChromeAudioPauseTimeMs=this.previewChromeAudioStartTimeMs=0,$(document).trigger(this.eventNames.RecordingPlaybackEndedEventName)):(this.wasInterrupted=!0,$(document).trigger(this.eventNames.RecordingInteruptedEventName))};
d.prototype.startRecordingVideo=function(){var b=this;if(this.videoStream)this.onUserMediaVideo(this,this.videoStream);else{var a=this;navigator.getUserMedia(this.constraints,function(b){a.videoStream=b;a.showVideoFrame(!0)},function(){b.showAlert(a.settings.AccessDeniedErrorMessage)})}};d.prototype.onUserMediaVideo=function(b,a){if(a.getAudioTracks()&&0!==a.getAudioTracks().length)this.onUserMediaVideoAndAudio(b,a);else this.onUserMediaVideoNoAudio(b,a)};d.prototype.onUserMediaVideoAndAudio=function(b,
a){b.video.muted=!0;var c={type:"video",video:b.video,width:b.video.clientWidth,height:b.video.clientHeight,canvas:{width:b.video.clientWidth,height:b.video.clientHeight},disableLogs:b.settings.DisableLogs,frameInterval:30,recorderType:null};window.isChrome?(b.recorderAudio=RecordRTC(a,{type:"audio",numberOfAudioChannels:1,disableLogs:b.settings.DisableLogs,onAudioProcessStarted:function(){b.recordingVideoPreInterval=b.video.currentTime;$(document).trigger(b.eventNames.HasUserMediaAccessEventName);
b.video.play();b.recorderVideo.startRecording()}}),b.recorderVideo=RecordRTC(a,c),b.recorderAudio.startRecording()):(b.recorderVideo=RecordRTC(a,c),b.recordingVideoPreInterval=b.video.currentTime,$(document).trigger(b.eventNames.HasUserMediaAccessEventName),b.video.play(),b.recorderVideo.startRecording());b.currentState=e.RecordingStarted};d.prototype.onUserMediaVideoNoAudio=function(b,a){b.video.muted=!0;b.recorderVideo=RecordRTC(a,{type:"video",video:b.video,width:b.video.clientWidth,height:b.video.clientHeight,
canvas:{width:b.video.clientWidth,height:b.video.clientHeight},disableLogs:b.settings.DisableLogs,frameInterval:30,recorderType:null});b.recordingVideoPreInterval=b.video.currentTime;$(document).trigger(b.eventNames.HasUserMediaAccessEventName);b.video.play();b.recorderVideo.startRecording();b.currentState=e.RecordingStarted};d.prototype.startRecordingAudio=function(){var b=this,a=this;if(a.audioStream)a.onUserMediaAudio(a,a.audioStream);else navigator.getUserMedia(a.constraints,function(b){window.isChrome&&
(b=new window.MediaStream(b.getAudioTracks()));a.audioStream=b;a.onUserMediaAudio(a,a.audioStream)},function(){b.showAlert(a.settings.AccessDeniedErrorMessage)});window.isAudio=!0};d.prototype.onUserMediaAudio=function(b,a){$(document).trigger(b.eventNames.HasUserMediaAccessEventName);b.recorderAudio=RecordRTC(a,{type:"audio",numberOfAudioChannels:1,disableLogs:b.settings.DisableLogs});b.audio.src=URL.createObjectURL(b.audioStream);b.audio.muted=!0;b.audio.play();b.recordingChromeStartTimeMs=(new Date).getTime();
b.recorderAudio.startRecording();b.currentState=e.RecordingStarted};d.prototype.stopRecordingAudio=function(){var b=this;b.recorderAudio&&(window.isChrome||b.recorderAudio.resumeRecording(),b.recorderAudio.stopRecording(function(a){b.audio.pause();b.currentRecordDuration=b.getCurrentTime();b.audioUrl=a;b.currentState=e.Stopped;b.triggerStoppedEvent()}))};d.prototype.stopRecordingVideo=function(){this.recorderAudio?this.stopVideoAndAudioRecorders():this.stopVideoNoAudioRecorders()};d.prototype.stopVideoAndAudioRecorders=
function(){var b=this;this.recorderAudio&&this.recorderVideo&&this.recorderVideo.stopRecording(function(a){b.video.pause();b.currentRecordDuration=b.getCurrentTime();b.recorderAudio.stopRecording(function(c){b.videoUrl=a;b.audioUrl=c;b.currentState=e.Stopped;b.triggerStoppedEvent()})})};d.prototype.stopVideoNoAudioRecorders=function(){if(this.recorderVideo){window.isChrome||this.recorderVideo.resumeRecording();var b=this;b.recorderVideo.stopRecording(function(a){b.video.pause();b.currentRecordDuration=
b.getCurrentTime();b.videoUrl=a;b.currentState=e.Stopped;b.triggerStoppedEvent()})}};d.prototype.triggerStoppedEvent=function(){this.currentState!==e.Closing&&$(document).trigger(this.eventNames.RecordingStoppedEventName)};d.prototype.isPreview=function(){return this.currentState===e.PreviewStarted||this.currentState===e.PreviewSeeked||this.currentState===e.PreviewPaused};d.prototype.showAlert=function(b){window.top.jAlert?window.top.jAlert(b,"",null):jAlert(b,"",null)};return d}();f.WebRtcRecorder=
k})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var k=function(){function d(b,a){var c=this;window[b]=this;this.settings=a;$(function(){CCL.CommonFunctions.attachPostMessageEventListener($(window),c.settings.SendElementIdToCourseFeature,function(a){c.elementList.addElement(a.elementId).done(function(){return c.refreshLeftMenu(a.folderId,a.elementId,a.notFocusingOnElement)})});c.elementList=window[c.settings.ClientInstanceNames.ElementListClient];c.feedback=window[c.settings.ClientInstanceNames.Feedback];c.$titleTextBox=
$("#"+c.settings.Controls.TitleTextBox);c.$saveButton=$("#"+c.settings.Controls.SaveButton);c.$learningObjectiveSelector=$("#"+c.settings.Controls.LearningObjectiveSelector);c.$saveButton.click(function(){var a=""!==c.$titleTextBox.val();a||(c.feedback.showMessage(CCL.FeedbackType.Error,c.settings.Terms.ValidationError),$("html, body").animate({scrollTop:0}));return a});$("."+c.settings.Css.AddLinkCss).click(function(a){return c.onAddLinkClick($(a.currentTarget))})})}d.prototype.addElement=function(b,
a,c,d){this.elementList.addElementItem(b,a,c,d)};d.prototype.removeElement=function(b){this.elementList.deleteElement(b)};d.prototype.refreshLeftMenu=function(b,a,c){var d=top;d&&d.reloadFolder&&(d.reloadFolder(),d.reloadFolder("item"+b,"item"+a),d.notFocusingOnElement=c)};d.prototype.onAddLinkClick=function(b){var a=this,c=parseInt(b.data(this.settings.DataAttributes.ElementType),10);if(parseInt(b.data(this.settings.DataAttributes.ElementExternalSource),10)===f.AddResourceMenu.ElementExternalSourceType.Course){b=
{locationId:this.settings.CourseId,locationType:f.AddResourceMenu.ElementExternalSourceType.Course};var d=this.elementList.getElementIds(),e=new Map;$.each(d,function(a,b){e.set(b,f.CheckboxStateMachine.State.Saved)});d=c===f.ElementLinkDialog.ContentElementType.Resources?this.settings.Terms.AddResource:this.settings.Terms.AddActivity;c={elementStates:f.MapUtils.makeCopy(e),elementType:c,showAll:!1,header:d,learningObjectiveId:this.$learningObjectiveSelector.val(),allowFolderSelection:!1,openerPage:f.ElementLinkDialog.ElementsPopupOpener.WorkingPortfolioTask,
afterOkClickCallback:function(b){var c=[],d=[];b&&b.forEach(function(a,b){a===f.CheckboxStateMachine.State.AttachedByUser||a===f.CheckboxStateMachine.State.Saved?c.push(b):a===f.CheckboxStateMachine.State.DetachedByUser&&d.push(b)});a.elementList.deleteElements(d);a.elementList.addElements(c)}};f.ElementLinkDialog.elementLinkDialogManagerInstance.openDialog(c,b)}};return d}();e.AddEditTask=k})(f.WorkingPortfolio||(f.WorkingPortfolio={}))})(ItslearningWeb||(ItslearningWeb={}));
(function(f){(function(e){var f=function(){function d(b,a,c){this.settings=a;this.getSelectedIds=c;window[b]=this}d.prototype.transferToPortfolio=function(b){if(null!=this.getSelectedIds){var a=this.getSelectedIds();0===a.length?CCL.CommonFunctions.jAlertAjaxError(this.settings.Terms.NoElementsSelected,this.settings.Terms.Alert,this.settings.Terms.Ok,!1):(b=""+this.settings.TransferPageUrlConstantPart+("&"+this.getTransferLocationRequestItem(b))+("&"+this.settings.RequestItems.ElementIds+"="+a.join()),
window.location.href=b)}};d.prototype.getTransferLocationRequestItem=function(b){var a=b.startsWith(this.settings.Prefixes.CourseIdPrefix),c=a?this.settings.RequestItems.CourseId:this.settings.RequestItems.PortfolioId;b=parseInt(b.substring((a?this.settings.Prefixes.CourseIdPrefix:this.settings.Prefixes.PortfolioIdPrefix).length),10);return c+"="+b};return d}();e.WorkingPortfolio=f})(f.WorkingPortfolio||(f.WorkingPortfolio={}))})(ItslearningWeb||(ItslearningWeb={}));
